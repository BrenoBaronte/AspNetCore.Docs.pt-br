---
title: "Inicialização do aplicativo no núcleo do ASP.NET"
author: ardalis
description: "Explica a classe de inicialização no núcleo do ASP.NET."
keywords: "ASP.NET Core, inicialização, configurar método, o método ConfigureServices"
ms.author: tdykstra
manager: wpickett
ms.date: 02/29/2017
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/startup
ms.openlocfilehash: 94db2ff530b5de7fe357cfb591d09b984cb248f9
ms.sourcegitcommit: 6e83c55eb0450a3073ef2b95fa5f5bcb20dbbf89
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/28/2017
---
# <a name="application-startup-in-aspnet-core"></a><span data-ttu-id="9ae1f-104">Inicialização do aplicativo no núcleo do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9ae1f-104">Application Startup in ASP.NET Core</span></span>

<span data-ttu-id="9ae1f-105">Por [Steve Smith](https://ardalis.com/) e [Tom Dykstra](https://github.com/tdykstra/)</span><span class="sxs-lookup"><span data-stu-id="9ae1f-105">By [Steve Smith](https://ardalis.com/) and [Tom Dykstra](https://github.com/tdykstra/)</span></span>

<span data-ttu-id="9ae1f-106">O `Startup` classe configura os serviços e pipeline de solicitação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-106">The `Startup` class configures services and the application's request pipeline.</span></span> 

## <a name="the-startup-class"></a><span data-ttu-id="9ae1f-107">A classe de inicialização</span><span class="sxs-lookup"><span data-stu-id="9ae1f-107">The Startup class</span></span>

<span data-ttu-id="9ae1f-108">Aplicativos do ASP.NET Core exigem um `Startup` classe, que é chamado `Startup` por convenção.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-108">ASP.NET Core apps require a `Startup` class, which is named `Startup` by convention.</span></span> <span data-ttu-id="9ae1f-109">Especifique o nome da classe de inicialização no `Main` do programa [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [ `UseStartup<TStartup>` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) método.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-109">You specify the startup class name in the `Main` program's [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [`UseStartup<TStartup>`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) method.</span></span> <span data-ttu-id="9ae1f-110">Consulte [hospedagem](xref:fundamentals/hosting) para saber mais sobre `WebHostBuilder`, que é executado antes de `Startup`.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-110">See [Hosting](xref:fundamentals/hosting) to learn more about `WebHostBuilder`, which runs before `Startup`.</span></span>

<span data-ttu-id="9ae1f-111">Você pode definir separada `Startup` classes para diferentes ambientes e apropriada um será selecionado em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-111">You can define separate `Startup` classes for different environments, and the appropriate one will be selected at runtime.</span></span> <span data-ttu-id="9ae1f-112">Se você especificar `startupAssembly` no [WebHost configuração](https://docs.microsoft.com/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) ou opções de hospedagem carregará esse assembly de inicialização e procure um `Startup` ou `Startup[Environment]` tipo.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-112">If you specify `startupAssembly` in the [WebHost configuration](https://docs.microsoft.com/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) or options, hosting will load that startup assembly and search for a `Startup` or `Startup[Environment]` type.</span></span> <span data-ttu-id="9ae1f-113">A classe sufixo cujo nome corresponde ao que o ambiente atual será ser priorizado, portanto, se o aplicativo é executado no *desenvolvimento* ambiente e inclui tanto um `Startup` e um `StartupDevelopment` classe, o `StartupDevelopment` classe será usado.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-113">The class whose name suffix matches the current environment will be prioritized, so if the app is run in the *Development* environment, and includes both a `Startup` and a `StartupDevelopment` class, the `StartupDevelopment` class will be used.</span></span> <span data-ttu-id="9ae1f-114">Consulte [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) na `StartupLoader` e [trabalhando com vários ambientes](environments.md#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-114">See [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) in `StartupLoader` and [Working with multiple environments](environments.md#startup-conventions).</span></span>

<span data-ttu-id="9ae1f-115">Como alternativa, você pode definir um fixa `Startup` classe que será usado, independentemente do ambiente chamando `UseStartup<TStartup>`.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-115">Alternatively, you can define a fixed `Startup` class that will be used regardless of the environment by calling `UseStartup<TStartup>`.</span></span> <span data-ttu-id="9ae1f-116">Essa é a abordagem recomendada.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-116">This is the recommended approach.</span></span>

<span data-ttu-id="9ae1f-117">O `Startup` construtor da classe pode aceitar as dependências que são fornecidas por meio de [injeção de dependência](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-117">The `Startup` class constructor can accept dependencies that are provided through [dependency injection](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="9ae1f-118">Uma abordagem comum é usar `IHostingEnvironment` configurar [configuração](xref:fundamentals/configuration) fontes.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-118">A common approach is to use `IHostingEnvironment` to set up [configuration](xref:fundamentals/configuration) sources.</span></span>

<span data-ttu-id="9ae1f-119">O `Startup` classe deve incluir um `Configure` método e, opcionalmente, pode incluir um `ConfigureServices` método, que são chamados quando o aplicativo for iniciado.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-119">The `Startup` class must include a `Configure` method and can optionally include a `ConfigureServices` method, both of which are called when the application starts.</span></span> <span data-ttu-id="9ae1f-120">A classe também pode incluir [versões específicas do ambiente desses métodos](xref:fundamentals/environments#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-120">The class can also include [environment-specific versions of these methods](xref:fundamentals/environments#startup-conventions).</span></span> <span data-ttu-id="9ae1f-121">`ConfigureServices`, se presente, é chamado antes de `Configure`.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-121">`ConfigureServices`, if present, is called before `Configure`.</span></span>

<span data-ttu-id="9ae1f-122">Saiba mais sobre [tratamento de exceções durante a inicialização do aplicativo](xref:fundamentals/error-handling#startup-exception-handling).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-122">Learn about [handling exceptions during application startup](xref:fundamentals/error-handling#startup-exception-handling).</span></span>

## <a name="the-configureservices-method"></a><span data-ttu-id="9ae1f-123">O método ConfigureServices</span><span class="sxs-lookup"><span data-stu-id="9ae1f-123">The ConfigureServices method</span></span>

<span data-ttu-id="9ae1f-124">O [ConfigureServices](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) é opcional; mas se usado, ele é chamado antes do `Configure` método pelo host da web.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-124">The [ConfigureServices](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) method is optional; but if used, it's called before the `Configure` method by the web host.</span></span> <span data-ttu-id="9ae1f-125">O host da web pode configurar alguns serviços antes de ``Startup`` métodos são chamados (consulte [hospedagem](xref:fundamentals/hosting)).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-125">The web host may configure some services before ``Startup`` methods are called (see [hosting](xref:fundamentals/hosting)).</span></span> <span data-ttu-id="9ae1f-126">Por convenção, [opções de configuração](xref:fundamentals/configuration) são definidas nesse método.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-126">By convention, [Configuration options](xref:fundamentals/configuration) are set in this method.</span></span>

<span data-ttu-id="9ae1f-127">Para recursos que exigem configuração significativa há `Add[Service]` métodos de extensão em [IServiceCollection](https://docs.microsoft.com/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-127">For features that require substantial setup there are `Add[Service]` extension methods on [IServiceCollection](https://docs.microsoft.com/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span></span> <span data-ttu-id="9ae1f-128">Este exemplo do modelo de site da web padrão configura o aplicativo para usar os serviços de Entity Framework, identidade e MVC:</span><span class="sxs-lookup"><span data-stu-id="9ae1f-128">This example from the default web site template configures the app to use services for Entity Framework, Identity, and MVC:</span></span>

[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=4,7,11&start=40&end=55)]

<span data-ttu-id="9ae1f-129">Adicionando serviços para o contêiner de serviços fiquem disponíveis dentro de seu aplicativo por meio de [injeção de dependência](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-129">Adding services to the services container makes them available within your application via [dependency injection](xref:fundamentals/dependency-injection).</span></span>

## <a name="services-available-in-startup"></a><span data-ttu-id="9ae1f-130">Serviços disponíveis na inicialização</span><span class="sxs-lookup"><span data-stu-id="9ae1f-130">Services Available in Startup</span></span>

<span data-ttu-id="9ae1f-131">Injeção de dependência do ASP.NET Core fornece serviços durante a inicialização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-131">ASP.NET Core dependency injection provides services during an application's startup.</span></span> <span data-ttu-id="9ae1f-132">Você pode solicitar esses serviços, incluindo a interface adequada como um parâmetro em sua `Startup` construtor da classe ou seus `Configure` método.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-132">You can request these services by including the appropriate interface as a parameter on your `Startup` class's constructor or its `Configure` method.</span></span> <span data-ttu-id="9ae1f-133">O `ConfigureServices` método só aceita um `IServiceCollection` parâmetro (mas qualquer pode serviço registrado ser recuperado desta coleção, então parâmetros adicionais não são necessários).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-133">The `ConfigureServices` method only takes an `IServiceCollection` parameter (but any registered service can be retrieved from this collection, so additional parameters are not necessary).</span></span>

<span data-ttu-id="9ae1f-134">Abaixo estão alguns dos serviços normalmente solicitados por `Startup` métodos:</span><span class="sxs-lookup"><span data-stu-id="9ae1f-134">Below are some of the services typically requested by `Startup` methods:</span></span>

* <span data-ttu-id="9ae1f-135">No construtor: `IHostingEnvironment`,`ILogger<Startup>`</span><span class="sxs-lookup"><span data-stu-id="9ae1f-135">In the constructor:  `IHostingEnvironment`, `ILogger<Startup>`</span></span>
* <span data-ttu-id="9ae1f-136">Em `ConfigureServices`:`IServiceCollection`</span><span class="sxs-lookup"><span data-stu-id="9ae1f-136">In `ConfigureServices`:  `IServiceCollection`</span></span>
* <span data-ttu-id="9ae1f-137">Em `Configure`: `IApplicationBuilder`, `IHostingEnvironment`,`ILoggerFactory`</span><span class="sxs-lookup"><span data-stu-id="9ae1f-137">In `Configure`:  `IApplicationBuilder`, `IHostingEnvironment`, `ILoggerFactory`</span></span>

<span data-ttu-id="9ae1f-138">Todos os serviços adicionados pelo ``WebHostBuilder`` ``ConfigureServices`` método pode ser solicitado pelo ``Startup`` construtor de classe ou seus ``Configure`` método.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-138">Any services added by the ``WebHostBuilder`` ``ConfigureServices`` method may be requested by the ``Startup`` class constructor or its ``Configure`` method.</span></span> <span data-ttu-id="9ae1f-139">Use `WebHostBuilder` fornecer qualquer um dos serviços necessários durante `Startup` métodos.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-139">Use `WebHostBuilder` to provide any services you need during `Startup` methods.</span></span>

## <a name="the-configure-method"></a><span data-ttu-id="9ae1f-140">O método de configurar</span><span class="sxs-lookup"><span data-stu-id="9ae1f-140">The Configure method</span></span>

<span data-ttu-id="9ae1f-141">O `Configure` método é usado para especificar como o aplicativo ASP.NET responde a solicitações HTTP.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-141">The `Configure` method is used to specify how the ASP.NET application will respond to HTTP requests.</span></span> <span data-ttu-id="9ae1f-142">O pipeline de solicitação está configurado com a adição de [middleware](middleware.md) componentes para uma `IApplicationBuilder` instância fornecida pelo injeção de dependência.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-142">The request pipeline is configured by adding [middleware](middleware.md) components to an `IApplicationBuilder` instance that is provided by dependency injection.</span></span>

<span data-ttu-id="9ae1f-143">No exemplo a seguir do modelo de site da web padrão, vários métodos de extensão são usados para configurar o pipeline com suporte para [BrowserLink](http://vswebessentials.com/features/browserlink), páginas de erro, arquivos estáticos, ASP.NET MVC e identidade.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-143">In the following example from the default web site template, several extension methods are used to configure the pipeline with support for [BrowserLink](http://vswebessentials.com/features/browserlink), error pages, static files, ASP.NET MVC, and Identity.</span></span>

[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=8,9,10,14,17,19,21&start=58&end=84)]

<span data-ttu-id="9ae1f-144">Cada `Use` método de extensão adiciona um [middleware](xref:fundamentals/middleware) componente ao pipeline de solicitação.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-144">Each `Use` extension method adds a [middleware](xref:fundamentals/middleware) component to the request pipeline.</span></span> <span data-ttu-id="9ae1f-145">Por exemplo, o `UseMvc` método de extensão adiciona o [roteamento](routing.md) middleware no pipeline de solicitação e configura [MVC](xref:mvc/overview) como o manipulador padrão.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-145">For instance, the `UseMvc` extension method adds the [routing](routing.md) middleware to the request pipeline and configures [MVC](xref:mvc/overview) as the default handler.</span></span>

<span data-ttu-id="9ae1f-146">Para obter mais informações sobre como usar `IApplicationBuilder`, consulte [Middleware](xref:fundamentals/middleware).</span><span class="sxs-lookup"><span data-stu-id="9ae1f-146">For more information about how to use `IApplicationBuilder`, see [Middleware](xref:fundamentals/middleware).</span></span>

<span data-ttu-id="9ae1f-147">Serviços adicionais, como `IHostingEnvironment` e `ILoggerFactory` também pode ser especificado na assinatura do método, caso em que esses serviços estarão [injetado](dependency-injection.md) se elas estiverem disponíveis.</span><span class="sxs-lookup"><span data-stu-id="9ae1f-147">Additional services, like `IHostingEnvironment` and `ILoggerFactory` may also be specified in the method signature, in which case these services will be [injected](dependency-injection.md) if they are available.</span></span> 

## <a name="additional-resources"></a><span data-ttu-id="9ae1f-148">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="9ae1f-148">Additional Resources</span></span>

* [<span data-ttu-id="9ae1f-149">Trabalhando com vários ambientes</span><span class="sxs-lookup"><span data-stu-id="9ae1f-149">Working with Multiple Environments</span></span>](xref:fundamentals/environments)
* [<span data-ttu-id="9ae1f-150">Middleware</span><span class="sxs-lookup"><span data-stu-id="9ae1f-150">Middleware</span></span>](xref:fundamentals/middleware)
* [<span data-ttu-id="9ae1f-151">Registro em log</span><span class="sxs-lookup"><span data-stu-id="9ae1f-151">Logging</span></span>](xref:fundamentals/logging)
* [<span data-ttu-id="9ae1f-152">Configuração</span><span class="sxs-lookup"><span data-stu-id="9ae1f-152">Configuration</span></span>](xref:fundamentals/configuration)
