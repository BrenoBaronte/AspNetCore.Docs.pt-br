---
<span data-ttu-id="874b3-101">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-101">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-102">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-102">'Blazor'</span></span>
- <span data-ttu-id="874b3-103">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-103">'Identity'</span></span>
- <span data-ttu-id="874b3-104">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-104">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-105">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-105">'Razor'</span></span>
- <span data-ttu-id="874b3-106">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-106">'SignalR' uid:</span></span> 

---
# <a name="httpsys-web-server-implementation-in-aspnet-core"></a><span data-ttu-id="874b3-107">Implementação do servidor Web HTTP.sys no ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="874b3-107">HTTP.sys web server implementation in ASP.NET Core</span></span>

<span data-ttu-id="874b3-108">Por [Tom Dykstra](https://github.com/tdykstra) e [Chris Ross](https://github.com/Tratcher)</span><span class="sxs-lookup"><span data-stu-id="874b3-108">By [Tom Dykstra](https://github.com/tdykstra) and [Chris Ross](https://github.com/Tratcher)</span></span>

::: moniker range=">= aspnetcore-3.1"

<span data-ttu-id="874b3-109">O [HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) é um [servidor Web para ASP.NET Core](xref:fundamentals/servers/index) executado apenas no Windows.</span><span class="sxs-lookup"><span data-stu-id="874b3-109">[HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) is a [web server for ASP.NET Core](xref:fundamentals/servers/index) that only runs on Windows.</span></span> <span data-ttu-id="874b3-110">O HTTP.sys é uma alternativa ao servidor [Kestrel](xref:fundamentals/servers/kestrel) e oferece alguns recursos não disponibilizados pelo Kestrel.</span><span class="sxs-lookup"><span data-stu-id="874b3-110">HTTP.sys is an alternative to [Kestrel](xref:fundamentals/servers/kestrel) server and offers some features that Kestrel doesn't provide.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="874b3-111">O HTTP.sys não é compatível com o [Módulo do ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e não pode ser usado com IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-111">HTTP.sys isn't compatible with the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and can't be used with IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-112">O HTTP.sys dá suporte aos seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="874b3-112">HTTP.sys supports the following features:</span></span>

* [<span data-ttu-id="874b3-113">Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="874b3-113">Windows Authentication</span></span>](xref:security/authentication/windowsauth)
* <span data-ttu-id="874b3-114">Compartilhamento de porta</span><span class="sxs-lookup"><span data-stu-id="874b3-114">Port sharing</span></span>
* <span data-ttu-id="874b3-115">HTTPS com SNI</span><span class="sxs-lookup"><span data-stu-id="874b3-115">HTTPS with SNI</span></span>
* <span data-ttu-id="874b3-116">HTTP/2 sobre TLS (Windows 10 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-116">HTTP/2 over TLS (Windows 10 or later)</span></span>
* <span data-ttu-id="874b3-117">Transmissão direta de arquivo</span><span class="sxs-lookup"><span data-stu-id="874b3-117">Direct file transmission</span></span>
* <span data-ttu-id="874b3-118">Cache de resposta</span><span class="sxs-lookup"><span data-stu-id="874b3-118">Response caching</span></span>
* <span data-ttu-id="874b3-119">WebSockets (Windows 8 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-119">WebSockets (Windows 8 or later)</span></span>

<span data-ttu-id="874b3-120">Versões do Windows com suporte:</span><span class="sxs-lookup"><span data-stu-id="874b3-120">Supported Windows versions:</span></span>

* <span data-ttu-id="874b3-121">Windows 7 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-121">Windows 7 or later</span></span>
* <span data-ttu-id="874b3-122">Windows Server 2008 R2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-122">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="874b3-123">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="874b3-123">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="when-to-use-httpsys"></a><span data-ttu-id="874b3-124">Quando usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-124">When to use HTTP.sys</span></span>

<span data-ttu-id="874b3-125">O HTTP.sys é útil nas implantações em que:</span><span class="sxs-lookup"><span data-stu-id="874b3-125">HTTP.sys is useful for deployments where:</span></span>

* <span data-ttu-id="874b3-126">É necessário expor o servidor diretamente à Internet sem usar o IIS.</span><span class="sxs-lookup"><span data-stu-id="874b3-126">There's a need to expose the server directly to the Internet without using IIS.</span></span>

  ![O HTTP.sys se comunica diretamente com a Internet](httpsys/_static/httpsys-to-internet.png)

* <span data-ttu-id="874b3-128">As implantações internas exigem um recurso que não está disponível no Kestrel, como a [Autenticação do Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="874b3-128">An internal deployment requires a feature not available in Kestrel, such as [Windows Authentication](xref:security/authentication/windowsauth).</span></span>

  ![O HTTP.sys se comunica diretamente com a rede interna](httpsys/_static/httpsys-to-internal.png)

<span data-ttu-id="874b3-130">O HTTP.sys é uma tecnologia madura que protege contra vários tipos de ataques e proporciona as propriedades de robustez, segurança e escalabilidade de um servidor Web completo.</span><span class="sxs-lookup"><span data-stu-id="874b3-130">HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server.</span></span> <span data-ttu-id="874b3-131">O próprio IIS é executado como um ouvinte HTTP sobre o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-131">IIS itself runs as an HTTP listener on top of HTTP.sys.</span></span>

## <a name="http2-support"></a><span data-ttu-id="874b3-132">Suporte do HTTP/2</span><span class="sxs-lookup"><span data-stu-id="874b3-132">HTTP/2 support</span></span>

<span data-ttu-id="874b3-133">O [HTTP/2](https://httpwg.org/specs/rfc7540.html) estará habilitado para aplicativos ASP.NET Core se os seguintes requisitos básicos forem atendidos:</span><span class="sxs-lookup"><span data-stu-id="874b3-133">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is enabled for ASP.NET Core apps if the following base requirements are met:</span></span>

* <span data-ttu-id="874b3-134">Windows Server 2016/Windows 10 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-134">Windows Server 2016/Windows 10 or later</span></span>
* <span data-ttu-id="874b3-135">Conexão [ALPN (Negociação de protocolo de camada de aplicativo)](https://tools.ietf.org/html/rfc7301#section-3)</span><span class="sxs-lookup"><span data-stu-id="874b3-135">[Application-Layer Protocol Negotiation (ALPN)](https://tools.ietf.org/html/rfc7301#section-3) connection</span></span>
* <span data-ttu-id="874b3-136">Conexão TLS 1.2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-136">TLS 1.2 or later connection</span></span>

<span data-ttu-id="874b3-137">Se uma conexão HTTP/2 for estabelecida, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) relatará `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="874b3-137">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span>

<span data-ttu-id="874b3-138">O HTTP/2 está habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="874b3-138">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="874b3-139">Se uma conexão HTTP/2 não tiver sido estabelecida, a conexão retornará para HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="874b3-139">If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1.</span></span> <span data-ttu-id="874b3-140">Em uma versão futura do Windows, os sinalizadores de configuração de HTTP/2 estarão disponíveis e contarão com a capacidade de desabilitar o HTTP/2 com HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-140">In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</span></span>

## <a name="kernel-mode-authentication-with-kerberos"></a><span data-ttu-id="874b3-141">Autenticação de modo kernel com Kerberos</span><span class="sxs-lookup"><span data-stu-id="874b3-141">Kernel mode authentication with Kerberos</span></span>

<span data-ttu-id="874b3-142">O HTTP.sys delega à autenticação de modo kernel com o protocolo de autenticação Kerberos.</span><span class="sxs-lookup"><span data-stu-id="874b3-142">HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol.</span></span> <span data-ttu-id="874b3-143">Não há suporte para autenticação de modo de usuário com o Kerberos e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-143">User mode authentication isn't supported with Kerberos and HTTP.sys.</span></span> <span data-ttu-id="874b3-144">A conta do computador precisa ser usada para descriptografar o token/tíquete do Kerberos que é obtido do Active Directory e encaminhado pelo cliente ao servidor para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="874b3-144">The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user.</span></span> <span data-ttu-id="874b3-145">Registre o SPN (nome da entidade de serviço) do host, não do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-145">Register the Service Principal Name (SPN) for the host, not the user of the app.</span></span>

## <a name="how-to-use-httpsys"></a><span data-ttu-id="874b3-146">Como usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-146">How to use HTTP.sys</span></span>

### <a name="configure-the-aspnet-core-app-to-use-httpsys"></a><span data-ttu-id="874b3-147">Configurar o aplicativo ASP.NET Core para usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-147">Configure the ASP.NET Core app to use HTTP.sys</span></span>

<span data-ttu-id="874b3-148">Chame o método de extensão <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> ao compilar o host, especificando qualquer <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions> necessária.</span><span class="sxs-lookup"><span data-stu-id="874b3-148">Call the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> extension method when building the host, specifying any required <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions>.</span></span> <span data-ttu-id="874b3-149">O exemplo a seguir define as opções para seus valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-149">The following example sets options to their default values:</span></span>

[!code-csharp[](httpsys/samples/3.x/SampleApp/Program.cs?name=snippet1&highlight=5-13)]

<span data-ttu-id="874b3-150">A configuração adicional do HTTP.sys é tratada por meio das [configurações do registro](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span><span class="sxs-lookup"><span data-stu-id="874b3-150">Additional HTTP.sys configuration is handled through [registry settings](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span></span>

<span data-ttu-id="874b3-151">**Opções do HTTP.sys**</span><span class="sxs-lookup"><span data-stu-id="874b3-151">**HTTP.sys options**</span></span>

| <span data-ttu-id="874b3-152">Propriedade</span><span class="sxs-lookup"><span data-stu-id="874b3-152">Property</span></span> | <span data-ttu-id="874b3-153">Descrição</span><span class="sxs-lookup"><span data-stu-id="874b3-153">Description</span></span> | <span data-ttu-id="874b3-154">Padrão</span><span class="sxs-lookup"><span data-stu-id="874b3-154">Default</span></span> |
| ---
<span data-ttu-id="874b3-155">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-155">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-156">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-156">'Blazor'</span></span>
- <span data-ttu-id="874b3-157">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-157">'Identity'</span></span>
- <span data-ttu-id="874b3-158">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-158">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-159">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-159">'Razor'</span></span>
- <span data-ttu-id="874b3-160">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-160">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-161">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-161">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-162">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-162">'Blazor'</span></span>
- <span data-ttu-id="874b3-163">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-163">'Identity'</span></span>
- <span data-ttu-id="874b3-164">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-164">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-165">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-165">'Razor'</span></span>
- <span data-ttu-id="874b3-166">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-166">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-167">---- | título do---: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-167">---- | --- title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-168">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-168">'Blazor'</span></span>
- <span data-ttu-id="874b3-169">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-169">'Identity'</span></span>
- <span data-ttu-id="874b3-170">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-170">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-171">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-171">'Razor'</span></span>
- <span data-ttu-id="874b3-172">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-172">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-173">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-173">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-174">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-174">'Blazor'</span></span>
- <span data-ttu-id="874b3-175">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-175">'Identity'</span></span>
- <span data-ttu-id="874b3-176">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-176">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-177">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-177">'Razor'</span></span>
- <span data-ttu-id="874b3-178">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-178">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-179">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-179">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-180">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-180">'Blazor'</span></span>
- <span data-ttu-id="874b3-181">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-181">'Identity'</span></span>
- <span data-ttu-id="874b3-182">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-182">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-183">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-183">'Razor'</span></span>
- <span data-ttu-id="874b3-184">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-184">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-185">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Controlar se a entrada/saída síncrona é permitida para o `HttpContext.Request.Body` e o `HttpContext.Response.Body` .</span><span class="sxs-lookup"><span data-stu-id="874b3-185">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Control whether synchronous input/output is allowed for the `HttpContext.Request.Body` and `HttpContext.Response.Body`.</span></span><span data-ttu-id="874b3-186"> | `false`| | [Authentication. AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Permitir solicitações anônimas.</span><span class="sxs-lookup"><span data-stu-id="874b3-186"> | `false` | | [Authentication.AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Allow anonymous requests.</span></span><span data-ttu-id="874b3-187"> | `true`| | [Autenticação. esquemas](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Especifique os esquemas de autenticação permitidos.</span><span class="sxs-lookup"><span data-stu-id="874b3-187"> | `true` | | [Authentication.Schemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Specify the allowed authentication schemes.</span></span> <span data-ttu-id="874b3-188">É possível modificar a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-188">May be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-189">Os valores são fornecidos pela [Enumeração AuthenticationSchemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic` , `Kerberos` , `Negotiate` , `None` e `NTLM` .</span><span class="sxs-lookup"><span data-stu-id="874b3-189">Values are provided by the [AuthenticationSchemes enum](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic`, `Kerberos`, `Negotiate`, `None`, and `NTLM`.</span></span><span data-ttu-id="874b3-190"> | `None`| | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Tente o cache do [modo kernel](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) para obter respostas com cabeçalhos qualificados.</span><span class="sxs-lookup"><span data-stu-id="874b3-190"> | `None` | | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Attempt [kernel-mode](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) caching for responses with eligible headers.</span></span> <span data-ttu-id="874b3-191">A resposta pode não incluir `Set-Cookie`, `Vary` ou cabeçalhos `Pragma`.</span><span class="sxs-lookup"><span data-stu-id="874b3-191">The response may not include `Set-Cookie`, `Vary`, or `Pragma` headers.</span></span> <span data-ttu-id="874b3-192">Ela deve incluir um cabeçalho `Cache-Control` que seja `public` e um valor `shared-max-age` ou `max-age`, ou um cabeçalho `Expires`.</span><span class="sxs-lookup"><span data-stu-id="874b3-192">It must include a `Cache-Control` header that's `public` and either a `shared-max-age` or `max-age` value, or an `Expires` header.</span></span><span data-ttu-id="874b3-193"> | `true`| | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | O número máximo de aceitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="874b3-193"> | `true` | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | The maximum number of concurrent accepts.</span></span> <span data-ttu-id="874b3-194">| 5 &times; [ambiente. <br> ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | O número máximo de conexões simultâneas a serem aceitas.</span><span class="sxs-lookup"><span data-stu-id="874b3-194">| 5 &times; [Environment.<br>ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | The maximum number of concurrent connections to accept.</span></span> <span data-ttu-id="874b3-195">Usar `-1` como infinito.</span><span class="sxs-lookup"><span data-stu-id="874b3-195">Use `-1` for infinite.</span></span> <span data-ttu-id="874b3-196">Usar `null` a fim de usar a configuração que abranja toda máquina do registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-196">Use `null` to use the registry's machine-wide setting.</span></span> | `null`<br><span data-ttu-id="874b3-197">(em todo o computador</span><span class="sxs-lookup"><span data-stu-id="874b3-197">(machine-wide</span></span><br><span data-ttu-id="874b3-198">configuração) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | Consulte a seção <a href="#maxrequestbodysize">MaxRequestBodySize</a> .</span><span class="sxs-lookup"><span data-stu-id="874b3-198">setting) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | See the <a href="#maxrequestbodysize">MaxRequestBodySize</a> section.</span></span> <span data-ttu-id="874b3-199">| 30 milhões bytes</span><span class="sxs-lookup"><span data-stu-id="874b3-199">| 30000000 bytes</span></span><br><span data-ttu-id="874b3-200">(~ 28,6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | O número máximo de solicitações que podem ser enfileiradas.</span><span class="sxs-lookup"><span data-stu-id="874b3-200">(~28.6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | The maximum number of requests that can be queued.</span></span> <span data-ttu-id="874b3-201">| 1000 | | `RequestQueueMode` | Isso indica se o servidor é responsável por criar e configurar a fila de solicitações ou se deve ser anexado a uma fila existente.</span><span class="sxs-lookup"><span data-stu-id="874b3-201">| 1000 | | `RequestQueueMode` | This indicates whether the server is responsible for creating and configuring the request queue, or if it should attach to an existing queue.</span></span><br><span data-ttu-id="874b3-202">A maioria das opções de configuração existentes não se aplicam ao anexar a uma fila existente.</span><span class="sxs-lookup"><span data-stu-id="874b3-202">Most existing configuration options do not apply when attaching to an existing queue.</span></span><span data-ttu-id="874b3-203"> | `RequestQueueMode.Create`| | `RequestQueueName` | O nome da fila de solicitações de HTTP. sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-203"> | `RequestQueueMode.Create` | | `RequestQueueName` | The name of the HTTP.sys request queue.</span></span><span data-ttu-id="874b3-204"> | `null`(Fila anônima) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indique se as gravações do corpo da resposta que falham devido a desconexões do cliente devem lançar exceções ou concluídas normalmente.</span><span class="sxs-lookup"><span data-stu-id="874b3-204"> | `null` (Anonymous queue) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indicate if response body writes that fail due to client disconnects should throw exceptions or complete normally.</span></span> | `false`<br><span data-ttu-id="874b3-205">(concluído normalmente) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expor a configuração de HTTP. sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> , que também pode ser configurada no registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-205">(complete normally) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expose the HTTP.sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> configuration, which may also be configured in the registry.</span></span> <span data-ttu-id="874b3-206">Siga os links de API para saber mais sobre cada configuração, inclusive os valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-206">Follow the API links to learn more about each setting, including default values:</span></span><ul><li><span data-ttu-id="874b3-207">[Timeoutmanager. DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): tempo permitido para a API do servidor http drenar o corpo da entidade em uma conexão Keep-Alive.</span><span class="sxs-lookup"><span data-stu-id="874b3-207">[TimeoutManager.DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): Time allowed for the HTTP Server API to drain the entity body on a Keep-Alive connection.</span></span></li><li><span data-ttu-id="874b3-208">[Timeoutmanager. EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): tempo permitido para o corpo da entidade de solicitação chegar.</span><span class="sxs-lookup"><span data-stu-id="874b3-208">[TimeoutManager.EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): Time allowed for the request entity body to arrive.</span></span></li><li><span data-ttu-id="874b3-209">[Timeoutmanager. HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): tempo permitido para a API do servidor http analisar o cabeçalho da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-209">[TimeoutManager.HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): Time allowed for the HTTP Server API to parse the request header.</span></span></li><li><span data-ttu-id="874b3-210">[Timeoutmanager. IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): tempo permitido para uma conexão ociosa.</span><span class="sxs-lookup"><span data-stu-id="874b3-210">[TimeoutManager.IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): Time allowed for an idle connection.</span></span></li><li><span data-ttu-id="874b3-211">[Timeoutmanager. MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): a taxa mínima de envio para a resposta.</span><span class="sxs-lookup"><span data-stu-id="874b3-211">[TimeoutManager.MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): The minimum send rate for the response.</span></span></li><li><span data-ttu-id="874b3-212">[Timeoutmanager. RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): tempo permitido para a solicitação permanecer na fila de solicitações antes que o aplicativo a pegue.</span><span class="sxs-lookup"><span data-stu-id="874b3-212">[TimeoutManager.RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): Time allowed for the request to remain in the request queue before the app picks it up.</span></span></li></ul> <span data-ttu-id="874b3-213">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Especifique o <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> a ser registrado com http. sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-213">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Specify the <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> to register with HTTP.sys.</span></span> <span data-ttu-id="874b3-214">A mais útil é [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), que é usada para adicionar um prefixo à coleção.</span><span class="sxs-lookup"><span data-stu-id="874b3-214">The most useful is [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), which is used to add a prefix to the collection.</span></span> <span data-ttu-id="874b3-215">É possível modificá-las a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-215">These may be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-216">|  |</span><span class="sxs-lookup"><span data-stu-id="874b3-216">|  |</span></span>

<a name="maxrequestbodysize"></a>

<span data-ttu-id="874b3-217">**MaxRequestBodySize**</span><span class="sxs-lookup"><span data-stu-id="874b3-217">**MaxRequestBodySize**</span></span>

<span data-ttu-id="874b3-218">O tamanho máximo permitido em bytes para todos os corpos de solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-218">The maximum allowed size of any request body in bytes.</span></span> <span data-ttu-id="874b3-219">Quando é definido como `null`, o tamanho máximo do corpo da solicitação é ilimitado.</span><span class="sxs-lookup"><span data-stu-id="874b3-219">When set to `null`, the maximum request body size is unlimited.</span></span> <span data-ttu-id="874b3-220">Esse limite não afeta as conexões atualizadas que são sempre ilimitadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-220">This limit has no effect on upgraded connections, which are always unlimited.</span></span>

<span data-ttu-id="874b3-221">O método recomendado para substituir o limite em um aplicativo ASP.NET Core MVC para um único `IActionResult` é usar o atributo <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> em um método de ação:</span><span class="sxs-lookup"><span data-stu-id="874b3-221">The recommended method to override the limit in an ASP.NET Core MVC app for a single `IActionResult` is to use the <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> attribute on an action method:</span></span>

```csharp
[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
```

<span data-ttu-id="874b3-222">Uma exceção é gerada quando o aplicativo tenta configurar o limite de uma solicitação, depois que o aplicativo inicia a leitura da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-222">An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request.</span></span> <span data-ttu-id="874b3-223">É possível usar uma propriedade `IsReadOnly` para indicar se a propriedade `MaxRequestBodySize` está no estado somente leitura, o que significa que é tarde demais para configurar o limite.</span><span class="sxs-lookup"><span data-stu-id="874b3-223">An `IsReadOnly` property can be used to indicate if the `MaxRequestBodySize` property is in a read-only state, meaning it's too late to configure the limit.</span></span>

<span data-ttu-id="874b3-224">Se o aplicativo precisar substituir <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> mediante solicitação, use o <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span><span class="sxs-lookup"><span data-stu-id="874b3-224">If the app should override <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> per-request, use the <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span></span>

[!code-csharp[](httpsys/samples/3.x/SampleApp/Startup.cs?name=snippet1&highlight=6-7)]

<span data-ttu-id="874b3-225">Quando usar o Visual Studio, verifique se que o aplicativo está configurado para executar o IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-225">If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-226">No Visual Studio, o perfil de inicialização padrão destina-se ao IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-226">In Visual Studio, the default launch profile is for IIS Express.</span></span> <span data-ttu-id="874b3-227">Para executar o projeto como um aplicativo de console, altere manualmente o perfil selecionado, conforme mostrado na captura de tela a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-227">To run the project as a console app, manually change the selected profile, as shown in the following screen shot:</span></span>

![Selecionar o perfil do aplicativo de console](httpsys/_static/vs-choose-profile.png)

### <a name="configure-windows-server"></a><span data-ttu-id="874b3-229">Configurar o Windows Server</span><span class="sxs-lookup"><span data-stu-id="874b3-229">Configure Windows Server</span></span>

1. <span data-ttu-id="874b3-230">Determine as portas que serão abertas para o aplicativo e use o [Firewall do Windows](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) ou o cmdlet do PowerShell [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) para abrir as portas de firewall e permitir que o tráfego chegue até o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-230">Determine the ports to open for the app and use [Windows Firewall](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) or the [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys.</span></span> <span data-ttu-id="874b3-231">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-231">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-232">Ao implantar em uma VM do Azure, abra as portas no [Grupo de Segurança de Rede](/azure/virtual-machines/windows/nsg-quickstart-portal).</span><span class="sxs-lookup"><span data-stu-id="874b3-232">When deploying to an Azure VM, open the ports in the [Network Security Group](/azure/virtual-machines/windows/nsg-quickstart-portal).</span></span> <span data-ttu-id="874b3-233">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-233">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-234">Obtenha e instale os certificados X.509, se precisar.</span><span class="sxs-lookup"><span data-stu-id="874b3-234">Obtain and install X.509 certificates, if required.</span></span>

   <span data-ttu-id="874b3-235">No Windows, crie certificados autoassinados, usando o [cmdlet do PowerShell New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate).</span><span class="sxs-lookup"><span data-stu-id="874b3-235">On Windows, create self-signed certificates using the [New-SelfSignedCertificate PowerShell cmdlet](/powershell/module/pkiclient/new-selfsignedcertificate).</span></span> <span data-ttu-id="874b3-236">Para ver um exemplo sem suporte, confira [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span><span class="sxs-lookup"><span data-stu-id="874b3-236">For an unsupported example, see [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span></span>

   <span data-ttu-id="874b3-237">Instale certificados autoassinados ou assinados pela AC no repositório **Computador Local** > **Pessoal** do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-237">Install either self-signed or CA-signed certificates in the server's **Local Machine** > **Personal** store.</span></span>

1. <span data-ttu-id="874b3-238">Se o aplicativo for uma [implantação dependente de estrutura](/dotnet/core/deploying/#framework-dependent-deployments-fdd), instale o .NET Core, o .NET Framework ou ambos (caso o aplicativo .NET Core seja direcionado ao .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="874b3-238">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), install .NET Core, .NET Framework, or both (if the app is a .NET Core app targeting the .NET Framework).</span></span>

   * <span data-ttu-id="874b3-239">**.NET Core**: se o aplicativo exigir o .NET Core, obtenha e execute o instalador do **.NET Core Runtime** de [downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-239">**.NET Core**: If the app requires .NET Core, obtain and run the **.NET Core Runtime** installer from [.NET Core Downloads](https://dotnet.microsoft.com/download).</span></span> <span data-ttu-id="874b3-240">Não instale o SDK completo no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-240">Don't install the full SDK on the server.</span></span>
   * <span data-ttu-id="874b3-241">**.NET Framework**: se o aplicativo exigir .NET Framework, consulte o [Guia de instalação do .NET Framework](/dotnet/framework/install/).</span><span class="sxs-lookup"><span data-stu-id="874b3-241">**.NET Framework**: If the app requires .NET Framework, see the [.NET Framework installation guide](/dotnet/framework/install/).</span></span> <span data-ttu-id="874b3-242">Instale o .NET Framework necessário.</span><span class="sxs-lookup"><span data-stu-id="874b3-242">Install the required .NET Framework.</span></span> <span data-ttu-id="874b3-243">O instalador do .NET Framework mais recente está disponível na página [Downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-243">The installer for the latest .NET Framework is available from the [.NET Core Downloads](https://dotnet.microsoft.com/download) page.</span></span>

   <span data-ttu-id="874b3-244">Se o aplicativo for uma [implantação autocontida](/dotnet/core/deploying/#self-contained-deployments-scd), ele incluirá o runtime em sua implantação.</span><span class="sxs-lookup"><span data-stu-id="874b3-244">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), the app includes the runtime in its deployment.</span></span> <span data-ttu-id="874b3-245">Nenhuma instalação do framework é necessária no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-245">No framework installation is required on the server.</span></span>

1. <span data-ttu-id="874b3-246">Configure URLs e portas no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-246">Configure URLs and ports in the app.</span></span>

   <span data-ttu-id="874b3-247">Por padrão, o ASP.NET Core é associado a `http://localhost:5000`.</span><span class="sxs-lookup"><span data-stu-id="874b3-247">By default, ASP.NET Core binds to `http://localhost:5000`.</span></span> <span data-ttu-id="874b3-248">Para configurar portas e prefixos de URL, as opções incluem:</span><span class="sxs-lookup"><span data-stu-id="874b3-248">To configure URL prefixes and ports, options include:</span></span>

   * <xref:Microsoft.AspNetCore.Hosting.HostingAbstractionsWebHostBuilderExtensions.UseUrls*>
   * <span data-ttu-id="874b3-249">O argumento de linha de comando `urls`</span><span class="sxs-lookup"><span data-stu-id="874b3-249">`urls` command-line argument</span></span>
   * <span data-ttu-id="874b3-250">A variável de ambiente `ASPNETCORE_URLS`</span><span class="sxs-lookup"><span data-stu-id="874b3-250">`ASPNETCORE_URLS` environment variable</span></span>
   * <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes>

   <span data-ttu-id="874b3-251">O exemplo de código a seguir mostra como usar <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> com o endereço IP local do servidor `10.0.0.4` na porta 443:</span><span class="sxs-lookup"><span data-stu-id="874b3-251">The following code example shows how to use <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> with the server's local IP address `10.0.0.4` on port 443:</span></span>

   [!code-csharp[](httpsys/samples_snapshot/3.x/Program.cs?highlight=7)]

   <span data-ttu-id="874b3-252">Uma vantagem de usar `UrlPrefixes` é que uma mensagem de erro é gerada imediatamente no caso de prefixos formatados de forma incorreta.</span><span class="sxs-lookup"><span data-stu-id="874b3-252">An advantage of `UrlPrefixes` is that an error message is generated immediately for improperly formatted prefixes.</span></span>

   <span data-ttu-id="874b3-253">As configurações de `UrlPrefixes` substituem as configurações `UseUrls`/`urls`/`ASPNETCORE_URLS`.</span><span class="sxs-lookup"><span data-stu-id="874b3-253">The settings in `UrlPrefixes` override `UseUrls`/`urls`/`ASPNETCORE_URLS` settings.</span></span> <span data-ttu-id="874b3-254">Portanto, uma vantagem de usar `UseUrls`, `urls` e a variável de ambiente `ASPNETCORE_URLS` é que fica mais fácil alternar entre o Kestrel e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-254">Therefore, an advantage of `UseUrls`, `urls`, and the `ASPNETCORE_URLS` environment variable is that it's easier to switch between Kestrel and HTTP.sys.</span></span>

   <span data-ttu-id="874b3-255">O HTTP.sys usa os [formatos de cadeia de caracteres UrlPrefix da API do Servidor HTTP](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span><span class="sxs-lookup"><span data-stu-id="874b3-255">HTTP.sys uses the [HTTP Server API UrlPrefix string formats](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span></span>

   > [!WARNING]
   > <span data-ttu-id="874b3-256">Associações de curinga de nível superior (`http://*:80/` e `http://+:80`) **não** devem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-256">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="874b3-257">Associações de curinga de nível superior criam vulnerabilidades de segurança no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-257">Top-level wildcard bindings create app security vulnerabilities.</span></span> <span data-ttu-id="874b3-258">Isso se aplica a curingas fortes e fracos.</span><span class="sxs-lookup"><span data-stu-id="874b3-258">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="874b3-259">Use nomes de host explícitos ou endereços IP em vez de curingas.</span><span class="sxs-lookup"><span data-stu-id="874b3-259">Use explicit host names or IP addresses rather than wildcards.</span></span> <span data-ttu-id="874b3-260">Associações de curinga de subdomínio (por exemplo, `*.mysub.com`) não serão um risco à segurança se você controlar todo o domínio pai (ao contrário de `*.com`, o qual é vulnerável).</span><span class="sxs-lookup"><span data-stu-id="874b3-260">Subdomain wildcard binding (for example, `*.mysub.com`) isn't a security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="874b3-261">Para obter mais informações, consulte [RFC 7230: Section 5,4: host](https://tools.ietf.org/html/rfc7230#section-5.4).</span><span class="sxs-lookup"><span data-stu-id="874b3-261">For more information, see [RFC 7230: Section 5.4: Host](https://tools.ietf.org/html/rfc7230#section-5.4).</span></span>

1. <span data-ttu-id="874b3-262">Pré-registre os prefixos de URL no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-262">Preregister URL prefixes on the server.</span></span>

   <span data-ttu-id="874b3-263">O *netsh.exe* é a ferramenta interna destinada a configurar o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-263">The built-in tool for configuring HTTP.sys is *netsh.exe*.</span></span> <span data-ttu-id="874b3-264">Com o *netsh.exe*, é possível reservar prefixos de URL e atribuir certificados X.509.</span><span class="sxs-lookup"><span data-stu-id="874b3-264">*netsh.exe* is used to reserve URL prefixes and assign X.509 certificates.</span></span> <span data-ttu-id="874b3-265">A ferramenta exige privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-265">The tool requires administrator privileges.</span></span>

   <span data-ttu-id="874b3-266">Use a ferramenta *netsh.exe* para registrar as URLs do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-266">Use the *netsh.exe* tool to register URLs for the app:</span></span>

   ```console
   netsh http add urlacl url=<URL> user=<USER>
   ```

   * <span data-ttu-id="874b3-267">`<URL>`: O Uniform Resource Locator (URL) totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="874b3-267">`<URL>`: The fully qualified Uniform Resource Locator (URL).</span></span> <span data-ttu-id="874b3-268">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-268">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-269">Use um nome de host válido ou o endereço IP local.</span><span class="sxs-lookup"><span data-stu-id="874b3-269">Use a valid hostname or local IP address.</span></span> <span data-ttu-id="874b3-270">*A URL deve incluir uma barra à direita.*</span><span class="sxs-lookup"><span data-stu-id="874b3-270">*The URL must include a trailing slash.*</span></span>
   * <span data-ttu-id="874b3-271">`<USER>`: Especifica o nome do usuário ou do grupo de usuários.</span><span class="sxs-lookup"><span data-stu-id="874b3-271">`<USER>`: Specifies the user or user-group name.</span></span>

   <span data-ttu-id="874b3-272">No exemplo a seguir, o endereço IP local do servidor é `10.0.0.4`:</span><span class="sxs-lookup"><span data-stu-id="874b3-272">In the following example, the local IP address of the server is `10.0.0.4`:</span></span>

   ```console
   netsh http add urlacl url=https://10.0.0.4:443/ user=Users
   ```

   <span data-ttu-id="874b3-273">Quando uma URL é registrada, a ferramenta responde com `URL reservation successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-273">When a URL is registered, the tool responds with `URL reservation successfully added`.</span></span>

   <span data-ttu-id="874b3-274">Para excluir uma URL registrada, use o comando `delete urlacl`:</span><span class="sxs-lookup"><span data-stu-id="874b3-274">To delete a registered URL, use the `delete urlacl` command:</span></span>

   ```console
   netsh http delete urlacl url=<URL>
   ```

1. <span data-ttu-id="874b3-275">Registre certificados X.509 no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-275">Register X.509 certificates on the server.</span></span>

   <span data-ttu-id="874b3-276">Use a ferramenta *netsh.exe* para registrar certificados do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-276">Use the *netsh.exe* tool to register certificates for the app:</span></span>

   ```console
   netsh http add sslcert ipport=<IP>:<PORT> certhash=<THUMBPRINT> appid="{<GUID>}"
   ```

   * <span data-ttu-id="874b3-277">`<IP>`: Especifica o endereço IP local para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-277">`<IP>`: Specifies the local IP address for the binding.</span></span> <span data-ttu-id="874b3-278">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-278">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-279">Use um endereço IP válido.</span><span class="sxs-lookup"><span data-stu-id="874b3-279">Use a valid IP address.</span></span>
   * <span data-ttu-id="874b3-280">`<PORT>`: Especifica a porta para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-280">`<PORT>`: Specifies the port for the binding.</span></span>
   * <span data-ttu-id="874b3-281">`<THUMBPRINT>`: A impressão digital do certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="874b3-281">`<THUMBPRINT>`: The X.509 certificate thumbprint.</span></span>
   * <span data-ttu-id="874b3-282">`<GUID>`: Um GUID gerado pelo desenvolvedor para representar o aplicativo para fins informativos.</span><span class="sxs-lookup"><span data-stu-id="874b3-282">`<GUID>`: A developer-generated GUID to represent the app for informational purposes.</span></span>

   <span data-ttu-id="874b3-283">Para fins de referência, armazene o GUID no aplicativo como uma marca de pacote:</span><span class="sxs-lookup"><span data-stu-id="874b3-283">For reference purposes, store the GUID in the app as a package tag:</span></span>

   * <span data-ttu-id="874b3-284">No Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-284">In Visual Studio:</span></span>
     * <span data-ttu-id="874b3-285">Abra as propriedades do projeto do aplicativo, clicando com o botão direito do mouse no aplicativo no **Gerenciador de Soluções** e selecionando **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="874b3-285">Open the app's project properties by right-clicking on the app in **Solution Explorer** and selecting **Properties**.</span></span>
     * <span data-ttu-id="874b3-286">Selecione a guia **Pacote**.</span><span class="sxs-lookup"><span data-stu-id="874b3-286">Select the **Package** tab.</span></span>
     * <span data-ttu-id="874b3-287">Insira o GUID que você criou no campo **Marcas**.</span><span class="sxs-lookup"><span data-stu-id="874b3-287">Enter the GUID that you created in the **Tags** field.</span></span>
   * <span data-ttu-id="874b3-288">Quando não estiver usando o Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-288">When not using Visual Studio:</span></span>
     * <span data-ttu-id="874b3-289">Abra o arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-289">Open the app's project file.</span></span>
     * <span data-ttu-id="874b3-290">Adicione uma propriedade `<PackageTags>` a um `<PropertyGroup>` novo ou existente com o GUID que você criou:</span><span class="sxs-lookup"><span data-stu-id="874b3-290">Add a `<PackageTags>` property to a new or existing `<PropertyGroup>` with the GUID that you created:</span></span>

       ```xml
       <PropertyGroup>
         <PackageTags>9412ee86-c21b-4eb8-bd89-f650fbf44931</PackageTags>
       </PropertyGroup>
       ```

   <span data-ttu-id="874b3-291">No exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-291">In the following example:</span></span>

   * <span data-ttu-id="874b3-292">O endereço IP local do servidor é `10.0.0.4`.</span><span class="sxs-lookup"><span data-stu-id="874b3-292">The local IP address of the server is `10.0.0.4`.</span></span>
   * <span data-ttu-id="874b3-293">Um gerador GUID aleatório online fornece o valor `appid`.</span><span class="sxs-lookup"><span data-stu-id="874b3-293">An online random GUID generator provides the `appid` value.</span></span>

   ```console
   netsh http add sslcert 
       ipport=10.0.0.4:443 
       certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
       appid="{9412ee86-c21b-4eb8-bd89-f650fbf44931}"
   ```

   <span data-ttu-id="874b3-294">Quando um certificado é registrado, a ferramenta responde com `SSL Certificate successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-294">When a certificate is registered, the tool responds with `SSL Certificate successfully added`.</span></span>

   <span data-ttu-id="874b3-295">Para excluir um registro de certificado, use o comando `delete sslcert`:</span><span class="sxs-lookup"><span data-stu-id="874b3-295">To delete a certificate registration, use the `delete sslcert` command:</span></span>

   ```console
   netsh http delete sslcert ipport=<IP>:<PORT>
   ```

   <span data-ttu-id="874b3-296">Documentação de referência do *netsh.exe*:</span><span class="sxs-lookup"><span data-stu-id="874b3-296">Reference documentation for *netsh.exe*:</span></span>

   * [<span data-ttu-id="874b3-297">Comandos Netsh para HTTP (Hypertext Transfer Protocol)</span><span class="sxs-lookup"><span data-stu-id="874b3-297">Netsh Commands for Hypertext Transfer Protocol (HTTP)</span></span>](https://technet.microsoft.com/library/cc725882.aspx)
   * [<span data-ttu-id="874b3-298">Cadeias de caracteres de UrlPrefix</span><span class="sxs-lookup"><span data-stu-id="874b3-298">UrlPrefix Strings</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx)

1. <span data-ttu-id="874b3-299">Execute o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-299">Run the app.</span></span>

   <span data-ttu-id="874b3-300">Não é necessário ter privilégios de administrador para executar o aplicativo ao associar ao localhost usando HTTP (não HTTPS) com um número de porta maior do que 1024.</span><span class="sxs-lookup"><span data-stu-id="874b3-300">Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024.</span></span> <span data-ttu-id="874b3-301">Para outras configurações (por exemplo, usar um endereço IP local ou associação à porta 443), execute o aplicativo com privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-301">For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</span></span>

   <span data-ttu-id="874b3-302">O aplicativo responde no endereço IP público do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-302">The app responds at the server's public IP address.</span></span> <span data-ttu-id="874b3-303">Neste exemplo, o servidor é acessado pela Internet como seu endereço IP público de `104.214.79.47`.</span><span class="sxs-lookup"><span data-stu-id="874b3-303">In this example, the server is reached from the Internet at its public IP address of `104.214.79.47`.</span></span>

   <span data-ttu-id="874b3-304">Um certificado de desenvolvimento é usado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="874b3-304">A development certificate is used in this example.</span></span> <span data-ttu-id="874b3-305">A página é carregada com segurança após ignorar o aviso de certificado não confiável do navegador.</span><span class="sxs-lookup"><span data-stu-id="874b3-305">The page loads securely after bypassing the browser's untrusted certificate warning.</span></span>

   ![Janela do navegador mostrando a página de Índice do aplicativo carregada](httpsys/_static/browser.png)

## <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="874b3-307">Servidor proxy e cenários de balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="874b3-307">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="874b3-308">Para aplicativos hospedados pelo HTTP.sys que interagem com solicitações da Internet ou de uma rede corporativa, podem ser necessárias configurações adicionais ao hospedar atrás de balanceadores de carga e de servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="874b3-308">For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers.</span></span> <span data-ttu-id="874b3-309">Para obter mais informações, veja [Configurar o ASP.NET Core para trabalhar com servidores proxy e balanceadores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="874b3-309">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="874b3-310">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="874b3-310">Additional resources</span></span>

* [<span data-ttu-id="874b3-311">Habilitar a autenticação do Windows com HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-311">Enable Windows Authentication with HTTP.sys</span></span>](xref:security/authentication/windowsauth#httpsys)
* [<span data-ttu-id="874b3-312">API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="874b3-312">HTTP Server API</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364510.aspx)
* [<span data-ttu-id="874b3-313">Repositório aspnet/HttpSysServer do GitHub (código-fonte)</span><span class="sxs-lookup"><span data-stu-id="874b3-313">aspnet/HttpSysServer GitHub repository (source code)</span></span>](https://github.com/aspnet/HttpSysServer/)
* [<span data-ttu-id="874b3-314">O host</span><span class="sxs-lookup"><span data-stu-id="874b3-314">The host</span></span>](xref:fundamentals/index#host)
* <xref:test/troubleshoot>

::: moniker-end

::: moniker range="= aspnetcore-3.0"

<span data-ttu-id="874b3-315">O [HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) é um [servidor Web para ASP.NET Core](xref:fundamentals/servers/index) executado apenas no Windows.</span><span class="sxs-lookup"><span data-stu-id="874b3-315">[HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) is a [web server for ASP.NET Core](xref:fundamentals/servers/index) that only runs on Windows.</span></span> <span data-ttu-id="874b3-316">O HTTP.sys é uma alternativa ao servidor [Kestrel](xref:fundamentals/servers/kestrel) e oferece alguns recursos não disponibilizados pelo Kestrel.</span><span class="sxs-lookup"><span data-stu-id="874b3-316">HTTP.sys is an alternative to [Kestrel](xref:fundamentals/servers/kestrel) server and offers some features that Kestrel doesn't provide.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="874b3-317">O HTTP.sys não é compatível com o [Módulo do ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e não pode ser usado com IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-317">HTTP.sys isn't compatible with the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and can't be used with IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-318">O HTTP.sys dá suporte aos seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="874b3-318">HTTP.sys supports the following features:</span></span>

* [<span data-ttu-id="874b3-319">Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="874b3-319">Windows Authentication</span></span>](xref:security/authentication/windowsauth)
* <span data-ttu-id="874b3-320">Compartilhamento de porta</span><span class="sxs-lookup"><span data-stu-id="874b3-320">Port sharing</span></span>
* <span data-ttu-id="874b3-321">HTTPS com SNI</span><span class="sxs-lookup"><span data-stu-id="874b3-321">HTTPS with SNI</span></span>
* <span data-ttu-id="874b3-322">HTTP/2 sobre TLS (Windows 10 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-322">HTTP/2 over TLS (Windows 10 or later)</span></span>
* <span data-ttu-id="874b3-323">Transmissão direta de arquivo</span><span class="sxs-lookup"><span data-stu-id="874b3-323">Direct file transmission</span></span>
* <span data-ttu-id="874b3-324">Cache de resposta</span><span class="sxs-lookup"><span data-stu-id="874b3-324">Response caching</span></span>
* <span data-ttu-id="874b3-325">WebSockets (Windows 8 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-325">WebSockets (Windows 8 or later)</span></span>

<span data-ttu-id="874b3-326">Versões do Windows com suporte:</span><span class="sxs-lookup"><span data-stu-id="874b3-326">Supported Windows versions:</span></span>

* <span data-ttu-id="874b3-327">Windows 7 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-327">Windows 7 or later</span></span>
* <span data-ttu-id="874b3-328">Windows Server 2008 R2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-328">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="874b3-329">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="874b3-329">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="when-to-use-httpsys"></a><span data-ttu-id="874b3-330">Quando usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-330">When to use HTTP.sys</span></span>

<span data-ttu-id="874b3-331">O HTTP.sys é útil nas implantações em que:</span><span class="sxs-lookup"><span data-stu-id="874b3-331">HTTP.sys is useful for deployments where:</span></span>

* <span data-ttu-id="874b3-332">É necessário expor o servidor diretamente à Internet sem usar o IIS.</span><span class="sxs-lookup"><span data-stu-id="874b3-332">There's a need to expose the server directly to the Internet without using IIS.</span></span>

  ![O HTTP.sys se comunica diretamente com a Internet](httpsys/_static/httpsys-to-internet.png)

* <span data-ttu-id="874b3-334">As implantações internas exigem um recurso que não está disponível no Kestrel, como a [Autenticação do Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="874b3-334">An internal deployment requires a feature not available in Kestrel, such as [Windows Authentication](xref:security/authentication/windowsauth).</span></span>

  ![O HTTP.sys se comunica diretamente com a rede interna](httpsys/_static/httpsys-to-internal.png)

<span data-ttu-id="874b3-336">O HTTP.sys é uma tecnologia madura que protege contra vários tipos de ataques e proporciona as propriedades de robustez, segurança e escalabilidade de um servidor Web completo.</span><span class="sxs-lookup"><span data-stu-id="874b3-336">HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server.</span></span> <span data-ttu-id="874b3-337">O próprio IIS é executado como um ouvinte HTTP sobre o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-337">IIS itself runs as an HTTP listener on top of HTTP.sys.</span></span>

## <a name="http2-support"></a><span data-ttu-id="874b3-338">Suporte do HTTP/2</span><span class="sxs-lookup"><span data-stu-id="874b3-338">HTTP/2 support</span></span>

<span data-ttu-id="874b3-339">O [HTTP/2](https://httpwg.org/specs/rfc7540.html) estará habilitado para aplicativos ASP.NET Core se os seguintes requisitos básicos forem atendidos:</span><span class="sxs-lookup"><span data-stu-id="874b3-339">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is enabled for ASP.NET Core apps if the following base requirements are met:</span></span>

* <span data-ttu-id="874b3-340">Windows Server 2016/Windows 10 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-340">Windows Server 2016/Windows 10 or later</span></span>
* <span data-ttu-id="874b3-341">Conexão [ALPN (Negociação de protocolo de camada de aplicativo)](https://tools.ietf.org/html/rfc7301#section-3)</span><span class="sxs-lookup"><span data-stu-id="874b3-341">[Application-Layer Protocol Negotiation (ALPN)](https://tools.ietf.org/html/rfc7301#section-3) connection</span></span>
* <span data-ttu-id="874b3-342">Conexão TLS 1.2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-342">TLS 1.2 or later connection</span></span>

<span data-ttu-id="874b3-343">Se uma conexão HTTP/2 for estabelecida, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) relatará `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="874b3-343">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span>

<span data-ttu-id="874b3-344">O HTTP/2 está habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="874b3-344">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="874b3-345">Se uma conexão HTTP/2 não tiver sido estabelecida, a conexão retornará para HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="874b3-345">If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1.</span></span> <span data-ttu-id="874b3-346">Em uma versão futura do Windows, os sinalizadores de configuração de HTTP/2 estarão disponíveis e contarão com a capacidade de desabilitar o HTTP/2 com HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-346">In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</span></span>

## <a name="kernel-mode-authentication-with-kerberos"></a><span data-ttu-id="874b3-347">Autenticação de modo kernel com Kerberos</span><span class="sxs-lookup"><span data-stu-id="874b3-347">Kernel mode authentication with Kerberos</span></span>

<span data-ttu-id="874b3-348">O HTTP.sys delega à autenticação de modo kernel com o protocolo de autenticação Kerberos.</span><span class="sxs-lookup"><span data-stu-id="874b3-348">HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol.</span></span> <span data-ttu-id="874b3-349">Não há suporte para autenticação de modo de usuário com o Kerberos e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-349">User mode authentication isn't supported with Kerberos and HTTP.sys.</span></span> <span data-ttu-id="874b3-350">A conta do computador precisa ser usada para descriptografar o token/tíquete do Kerberos que é obtido do Active Directory e encaminhado pelo cliente ao servidor para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="874b3-350">The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user.</span></span> <span data-ttu-id="874b3-351">Registre o SPN (nome da entidade de serviço) do host, não do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-351">Register the Service Principal Name (SPN) for the host, not the user of the app.</span></span>

## <a name="how-to-use-httpsys"></a><span data-ttu-id="874b3-352">Como usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-352">How to use HTTP.sys</span></span>

### <a name="configure-the-aspnet-core-app-to-use-httpsys"></a><span data-ttu-id="874b3-353">Configurar o aplicativo ASP.NET Core para usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-353">Configure the ASP.NET Core app to use HTTP.sys</span></span>

<span data-ttu-id="874b3-354">Chame o método de extensão <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> ao compilar o host, especificando qualquer <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions> necessária.</span><span class="sxs-lookup"><span data-stu-id="874b3-354">Call the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> extension method when building the host, specifying any required <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions>.</span></span> <span data-ttu-id="874b3-355">O exemplo a seguir define as opções para seus valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-355">The following example sets options to their default values:</span></span>

[!code-csharp[](httpsys/samples/3.x/SampleApp/Program.cs?name=snippet1&highlight=5-13)]

<span data-ttu-id="874b3-356">A configuração adicional do HTTP.sys é tratada por meio das [configurações do registro](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span><span class="sxs-lookup"><span data-stu-id="874b3-356">Additional HTTP.sys configuration is handled through [registry settings](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span></span>

<span data-ttu-id="874b3-357">**Opções do HTTP.sys**</span><span class="sxs-lookup"><span data-stu-id="874b3-357">**HTTP.sys options**</span></span>

| <span data-ttu-id="874b3-358">Propriedade</span><span class="sxs-lookup"><span data-stu-id="874b3-358">Property</span></span> | <span data-ttu-id="874b3-359">Descrição</span><span class="sxs-lookup"><span data-stu-id="874b3-359">Description</span></span> | <span data-ttu-id="874b3-360">Padrão</span><span class="sxs-lookup"><span data-stu-id="874b3-360">Default</span></span> |
| ---
<span data-ttu-id="874b3-361">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-361">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-362">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-362">'Blazor'</span></span>
- <span data-ttu-id="874b3-363">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-363">'Identity'</span></span>
- <span data-ttu-id="874b3-364">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-364">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-365">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-365">'Razor'</span></span>
- <span data-ttu-id="874b3-366">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-366">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-367">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-367">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-368">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-368">'Blazor'</span></span>
- <span data-ttu-id="874b3-369">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-369">'Identity'</span></span>
- <span data-ttu-id="874b3-370">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-370">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-371">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-371">'Razor'</span></span>
- <span data-ttu-id="874b3-372">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-372">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-373">---- | título do---: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-373">---- | --- title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-374">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-374">'Blazor'</span></span>
- <span data-ttu-id="874b3-375">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-375">'Identity'</span></span>
- <span data-ttu-id="874b3-376">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-376">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-377">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-377">'Razor'</span></span>
- <span data-ttu-id="874b3-378">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-378">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-379">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-379">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-380">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-380">'Blazor'</span></span>
- <span data-ttu-id="874b3-381">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-381">'Identity'</span></span>
- <span data-ttu-id="874b3-382">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-382">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-383">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-383">'Razor'</span></span>
- <span data-ttu-id="874b3-384">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-384">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-385">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-385">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-386">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-386">'Blazor'</span></span>
- <span data-ttu-id="874b3-387">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-387">'Identity'</span></span>
- <span data-ttu-id="874b3-388">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-388">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-389">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-389">'Razor'</span></span>
- <span data-ttu-id="874b3-390">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-390">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-391">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Controlar se a entrada/saída síncrona é permitida para o `HttpContext.Request.Body` e o `HttpContext.Response.Body` .</span><span class="sxs-lookup"><span data-stu-id="874b3-391">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Control whether synchronous input/output is allowed for the `HttpContext.Request.Body` and `HttpContext.Response.Body`.</span></span><span data-ttu-id="874b3-392"> | `false`| | [Authentication. AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Permitir solicitações anônimas.</span><span class="sxs-lookup"><span data-stu-id="874b3-392"> | `false` | | [Authentication.AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Allow anonymous requests.</span></span><span data-ttu-id="874b3-393"> | `true`| | [Autenticação. esquemas](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Especifique os esquemas de autenticação permitidos.</span><span class="sxs-lookup"><span data-stu-id="874b3-393"> | `true` | | [Authentication.Schemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Specify the allowed authentication schemes.</span></span> <span data-ttu-id="874b3-394">É possível modificar a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-394">May be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-395">Os valores são fornecidos pela [Enumeração AuthenticationSchemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic` , `Kerberos` , `Negotiate` , `None` e `NTLM` .</span><span class="sxs-lookup"><span data-stu-id="874b3-395">Values are provided by the [AuthenticationSchemes enum](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic`, `Kerberos`, `Negotiate`, `None`, and `NTLM`.</span></span><span data-ttu-id="874b3-396"> | `None`| | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Tente o cache do [modo kernel](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) para obter respostas com cabeçalhos qualificados.</span><span class="sxs-lookup"><span data-stu-id="874b3-396"> | `None` | | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Attempt [kernel-mode](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) caching for responses with eligible headers.</span></span> <span data-ttu-id="874b3-397">A resposta pode não incluir `Set-Cookie`, `Vary` ou cabeçalhos `Pragma`.</span><span class="sxs-lookup"><span data-stu-id="874b3-397">The response may not include `Set-Cookie`, `Vary`, or `Pragma` headers.</span></span> <span data-ttu-id="874b3-398">Ela deve incluir um cabeçalho `Cache-Control` que seja `public` e um valor `shared-max-age` ou `max-age`, ou um cabeçalho `Expires`.</span><span class="sxs-lookup"><span data-stu-id="874b3-398">It must include a `Cache-Control` header that's `public` and either a `shared-max-age` or `max-age` value, or an `Expires` header.</span></span><span data-ttu-id="874b3-399"> | `true`| | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | O número máximo de aceitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="874b3-399"> | `true` | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | The maximum number of concurrent accepts.</span></span> <span data-ttu-id="874b3-400">| 5 &times; [ambiente. <br> ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | O número máximo de conexões simultâneas a serem aceitas.</span><span class="sxs-lookup"><span data-stu-id="874b3-400">| 5 &times; [Environment.<br>ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | The maximum number of concurrent connections to accept.</span></span> <span data-ttu-id="874b3-401">Usar `-1` como infinito.</span><span class="sxs-lookup"><span data-stu-id="874b3-401">Use `-1` for infinite.</span></span> <span data-ttu-id="874b3-402">Usar `null` a fim de usar a configuração que abranja toda máquina do registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-402">Use `null` to use the registry's machine-wide setting.</span></span> | `null`<br><span data-ttu-id="874b3-403">(em todo o computador</span><span class="sxs-lookup"><span data-stu-id="874b3-403">(machine-wide</span></span><br><span data-ttu-id="874b3-404">configuração) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | Consulte a seção <a href="#maxrequestbodysize">MaxRequestBodySize</a> .</span><span class="sxs-lookup"><span data-stu-id="874b3-404">setting) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | See the <a href="#maxrequestbodysize">MaxRequestBodySize</a> section.</span></span> <span data-ttu-id="874b3-405">| 30 milhões bytes</span><span class="sxs-lookup"><span data-stu-id="874b3-405">| 30000000 bytes</span></span><br><span data-ttu-id="874b3-406">(~ 28,6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | O número máximo de solicitações que podem ser enfileiradas.</span><span class="sxs-lookup"><span data-stu-id="874b3-406">(~28.6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | The maximum number of requests that can be queued.</span></span> <span data-ttu-id="874b3-407">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indique se as gravações do corpo da resposta que falham devido a desconexões do cliente devem lançar exceções ou concluídas normalmente.</span><span class="sxs-lookup"><span data-stu-id="874b3-407">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indicate if response body writes that fail due to client disconnects should throw exceptions or complete normally.</span></span> | `false`<br><span data-ttu-id="874b3-408">(concluído normalmente) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expor a configuração de HTTP. sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> , que também pode ser configurada no registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-408">(complete normally) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expose the HTTP.sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> configuration, which may also be configured in the registry.</span></span> <span data-ttu-id="874b3-409">Siga os links de API para saber mais sobre cada configuração, inclusive os valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-409">Follow the API links to learn more about each setting, including default values:</span></span><ul><li><span data-ttu-id="874b3-410">[Timeoutmanager. DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): tempo permitido para a API do servidor http drenar o corpo da entidade em uma conexão Keep-Alive.</span><span class="sxs-lookup"><span data-stu-id="874b3-410">[TimeoutManager.DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): Time allowed for the HTTP Server API to drain the entity body on a Keep-Alive connection.</span></span></li><li><span data-ttu-id="874b3-411">[Timeoutmanager. EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): tempo permitido para o corpo da entidade de solicitação chegar.</span><span class="sxs-lookup"><span data-stu-id="874b3-411">[TimeoutManager.EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): Time allowed for the request entity body to arrive.</span></span></li><li><span data-ttu-id="874b3-412">[Timeoutmanager. HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): tempo permitido para a API do servidor http analisar o cabeçalho da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-412">[TimeoutManager.HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): Time allowed for the HTTP Server API to parse the request header.</span></span></li><li><span data-ttu-id="874b3-413">[Timeoutmanager. IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): tempo permitido para uma conexão ociosa.</span><span class="sxs-lookup"><span data-stu-id="874b3-413">[TimeoutManager.IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): Time allowed for an idle connection.</span></span></li><li><span data-ttu-id="874b3-414">[Timeoutmanager. MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): a taxa mínima de envio para a resposta.</span><span class="sxs-lookup"><span data-stu-id="874b3-414">[TimeoutManager.MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): The minimum send rate for the response.</span></span></li><li><span data-ttu-id="874b3-415">[Timeoutmanager. RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): tempo permitido para a solicitação permanecer na fila de solicitações antes que o aplicativo a pegue.</span><span class="sxs-lookup"><span data-stu-id="874b3-415">[TimeoutManager.RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): Time allowed for the request to remain in the request queue before the app picks it up.</span></span></li></ul> <span data-ttu-id="874b3-416">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Especifique o <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> a ser registrado com http. sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-416">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Specify the <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> to register with HTTP.sys.</span></span> <span data-ttu-id="874b3-417">A mais útil é [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), que é usada para adicionar um prefixo à coleção.</span><span class="sxs-lookup"><span data-stu-id="874b3-417">The most useful is [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), which is used to add a prefix to the collection.</span></span> <span data-ttu-id="874b3-418">É possível modificá-las a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-418">These may be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-419">|  |</span><span class="sxs-lookup"><span data-stu-id="874b3-419">|  |</span></span>

<a name="maxrequestbodysize"></a>

<span data-ttu-id="874b3-420">**MaxRequestBodySize**</span><span class="sxs-lookup"><span data-stu-id="874b3-420">**MaxRequestBodySize**</span></span>

<span data-ttu-id="874b3-421">O tamanho máximo permitido em bytes para todos os corpos de solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-421">The maximum allowed size of any request body in bytes.</span></span> <span data-ttu-id="874b3-422">Quando é definido como `null`, o tamanho máximo do corpo da solicitação é ilimitado.</span><span class="sxs-lookup"><span data-stu-id="874b3-422">When set to `null`, the maximum request body size is unlimited.</span></span> <span data-ttu-id="874b3-423">Esse limite não afeta as conexões atualizadas que são sempre ilimitadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-423">This limit has no effect on upgraded connections, which are always unlimited.</span></span>

<span data-ttu-id="874b3-424">O método recomendado para substituir o limite em um aplicativo ASP.NET Core MVC para um único `IActionResult` é usar o atributo <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> em um método de ação:</span><span class="sxs-lookup"><span data-stu-id="874b3-424">The recommended method to override the limit in an ASP.NET Core MVC app for a single `IActionResult` is to use the <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> attribute on an action method:</span></span>

```csharp
[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
```

<span data-ttu-id="874b3-425">Uma exceção é gerada quando o aplicativo tenta configurar o limite de uma solicitação, depois que o aplicativo inicia a leitura da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-425">An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request.</span></span> <span data-ttu-id="874b3-426">É possível usar uma propriedade `IsReadOnly` para indicar se a propriedade `MaxRequestBodySize` está no estado somente leitura, o que significa que é tarde demais para configurar o limite.</span><span class="sxs-lookup"><span data-stu-id="874b3-426">An `IsReadOnly` property can be used to indicate if the `MaxRequestBodySize` property is in a read-only state, meaning it's too late to configure the limit.</span></span>

<span data-ttu-id="874b3-427">Se o aplicativo precisar substituir <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> mediante solicitação, use o <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span><span class="sxs-lookup"><span data-stu-id="874b3-427">If the app should override <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> per-request, use the <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span></span>

[!code-csharp[](httpsys/samples/3.x/SampleApp/Startup.cs?name=snippet1&highlight=6-7)]

<span data-ttu-id="874b3-428">Quando usar o Visual Studio, verifique se que o aplicativo está configurado para executar o IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-428">If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-429">No Visual Studio, o perfil de inicialização padrão destina-se ao IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-429">In Visual Studio, the default launch profile is for IIS Express.</span></span> <span data-ttu-id="874b3-430">Para executar o projeto como um aplicativo de console, altere manualmente o perfil selecionado, conforme mostrado na captura de tela a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-430">To run the project as a console app, manually change the selected profile, as shown in the following screen shot:</span></span>

![Selecionar o perfil do aplicativo de console](httpsys/_static/vs-choose-profile.png)

### <a name="configure-windows-server"></a><span data-ttu-id="874b3-432">Configurar o Windows Server</span><span class="sxs-lookup"><span data-stu-id="874b3-432">Configure Windows Server</span></span>

1. <span data-ttu-id="874b3-433">Determine as portas que serão abertas para o aplicativo e use o [Firewall do Windows](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) ou o cmdlet do PowerShell [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) para abrir as portas de firewall e permitir que o tráfego chegue até o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-433">Determine the ports to open for the app and use [Windows Firewall](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) or the [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys.</span></span> <span data-ttu-id="874b3-434">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-434">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-435">Ao implantar em uma VM do Azure, abra as portas no [Grupo de Segurança de Rede](/azure/virtual-machines/windows/nsg-quickstart-portal).</span><span class="sxs-lookup"><span data-stu-id="874b3-435">When deploying to an Azure VM, open the ports in the [Network Security Group](/azure/virtual-machines/windows/nsg-quickstart-portal).</span></span> <span data-ttu-id="874b3-436">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-436">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-437">Obtenha e instale os certificados X.509, se precisar.</span><span class="sxs-lookup"><span data-stu-id="874b3-437">Obtain and install X.509 certificates, if required.</span></span>

   <span data-ttu-id="874b3-438">No Windows, crie certificados autoassinados, usando o [cmdlet do PowerShell New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate).</span><span class="sxs-lookup"><span data-stu-id="874b3-438">On Windows, create self-signed certificates using the [New-SelfSignedCertificate PowerShell cmdlet](/powershell/module/pkiclient/new-selfsignedcertificate).</span></span> <span data-ttu-id="874b3-439">Para ver um exemplo sem suporte, confira [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span><span class="sxs-lookup"><span data-stu-id="874b3-439">For an unsupported example, see [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span></span>

   <span data-ttu-id="874b3-440">Instale certificados autoassinados ou assinados pela AC no repositório **Computador Local** > **Pessoal** do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-440">Install either self-signed or CA-signed certificates in the server's **Local Machine** > **Personal** store.</span></span>

1. <span data-ttu-id="874b3-441">Se o aplicativo for uma [implantação dependente de estrutura](/dotnet/core/deploying/#framework-dependent-deployments-fdd), instale o .NET Core, o .NET Framework ou ambos (caso o aplicativo .NET Core seja direcionado ao .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="874b3-441">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), install .NET Core, .NET Framework, or both (if the app is a .NET Core app targeting the .NET Framework).</span></span>

   * <span data-ttu-id="874b3-442">**.NET Core**: se o aplicativo exigir o .NET Core, obtenha e execute o instalador do **.NET Core Runtime** de [downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-442">**.NET Core**: If the app requires .NET Core, obtain and run the **.NET Core Runtime** installer from [.NET Core Downloads](https://dotnet.microsoft.com/download).</span></span> <span data-ttu-id="874b3-443">Não instale o SDK completo no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-443">Don't install the full SDK on the server.</span></span>
   * <span data-ttu-id="874b3-444">**.NET Framework**: se o aplicativo exigir .NET Framework, consulte o [Guia de instalação do .NET Framework](/dotnet/framework/install/).</span><span class="sxs-lookup"><span data-stu-id="874b3-444">**.NET Framework**: If the app requires .NET Framework, see the [.NET Framework installation guide](/dotnet/framework/install/).</span></span> <span data-ttu-id="874b3-445">Instale o .NET Framework necessário.</span><span class="sxs-lookup"><span data-stu-id="874b3-445">Install the required .NET Framework.</span></span> <span data-ttu-id="874b3-446">O instalador do .NET Framework mais recente está disponível na página [Downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-446">The installer for the latest .NET Framework is available from the [.NET Core Downloads](https://dotnet.microsoft.com/download) page.</span></span>

   <span data-ttu-id="874b3-447">Se o aplicativo for uma [implantação autocontida](/dotnet/core/deploying/#self-contained-deployments-scd), ele incluirá o runtime em sua implantação.</span><span class="sxs-lookup"><span data-stu-id="874b3-447">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), the app includes the runtime in its deployment.</span></span> <span data-ttu-id="874b3-448">Nenhuma instalação do framework é necessária no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-448">No framework installation is required on the server.</span></span>

1. <span data-ttu-id="874b3-449">Configure URLs e portas no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-449">Configure URLs and ports in the app.</span></span>

   <span data-ttu-id="874b3-450">Por padrão, o ASP.NET Core é associado a `http://localhost:5000`.</span><span class="sxs-lookup"><span data-stu-id="874b3-450">By default, ASP.NET Core binds to `http://localhost:5000`.</span></span> <span data-ttu-id="874b3-451">Para configurar portas e prefixos de URL, as opções incluem:</span><span class="sxs-lookup"><span data-stu-id="874b3-451">To configure URL prefixes and ports, options include:</span></span>

   * <xref:Microsoft.AspNetCore.Hosting.HostingAbstractionsWebHostBuilderExtensions.UseUrls*>
   * <span data-ttu-id="874b3-452">O argumento de linha de comando `urls`</span><span class="sxs-lookup"><span data-stu-id="874b3-452">`urls` command-line argument</span></span>
   * <span data-ttu-id="874b3-453">A variável de ambiente `ASPNETCORE_URLS`</span><span class="sxs-lookup"><span data-stu-id="874b3-453">`ASPNETCORE_URLS` environment variable</span></span>
   * <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes>

   <span data-ttu-id="874b3-454">O exemplo de código a seguir mostra como usar <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> com o endereço IP local do servidor `10.0.0.4` na porta 443:</span><span class="sxs-lookup"><span data-stu-id="874b3-454">The following code example shows how to use <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> with the server's local IP address `10.0.0.4` on port 443:</span></span>

   [!code-csharp[](httpsys/samples_snapshot/3.x/Program.cs?highlight=7)]

   <span data-ttu-id="874b3-455">Uma vantagem de usar `UrlPrefixes` é que uma mensagem de erro é gerada imediatamente no caso de prefixos formatados de forma incorreta.</span><span class="sxs-lookup"><span data-stu-id="874b3-455">An advantage of `UrlPrefixes` is that an error message is generated immediately for improperly formatted prefixes.</span></span>

   <span data-ttu-id="874b3-456">As configurações de `UrlPrefixes` substituem as configurações `UseUrls`/`urls`/`ASPNETCORE_URLS`.</span><span class="sxs-lookup"><span data-stu-id="874b3-456">The settings in `UrlPrefixes` override `UseUrls`/`urls`/`ASPNETCORE_URLS` settings.</span></span> <span data-ttu-id="874b3-457">Portanto, uma vantagem de usar `UseUrls`, `urls` e a variável de ambiente `ASPNETCORE_URLS` é que fica mais fácil alternar entre o Kestrel e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-457">Therefore, an advantage of `UseUrls`, `urls`, and the `ASPNETCORE_URLS` environment variable is that it's easier to switch between Kestrel and HTTP.sys.</span></span>

   <span data-ttu-id="874b3-458">O HTTP.sys usa os [formatos de cadeia de caracteres UrlPrefix da API do Servidor HTTP](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span><span class="sxs-lookup"><span data-stu-id="874b3-458">HTTP.sys uses the [HTTP Server API UrlPrefix string formats](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span></span>

   > [!WARNING]
   > <span data-ttu-id="874b3-459">Associações de curinga de nível superior (`http://*:80/` e `http://+:80`) **não** devem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-459">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="874b3-460">Associações de curinga de nível superior criam vulnerabilidades de segurança no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-460">Top-level wildcard bindings create app security vulnerabilities.</span></span> <span data-ttu-id="874b3-461">Isso se aplica a curingas fortes e fracos.</span><span class="sxs-lookup"><span data-stu-id="874b3-461">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="874b3-462">Use nomes de host explícitos ou endereços IP em vez de curingas.</span><span class="sxs-lookup"><span data-stu-id="874b3-462">Use explicit host names or IP addresses rather than wildcards.</span></span> <span data-ttu-id="874b3-463">Associações de curinga de subdomínio (por exemplo, `*.mysub.com`) não serão um risco à segurança se você controlar todo o domínio pai (ao contrário de `*.com`, o qual é vulnerável).</span><span class="sxs-lookup"><span data-stu-id="874b3-463">Subdomain wildcard binding (for example, `*.mysub.com`) isn't a security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="874b3-464">Para obter mais informações, consulte [RFC 7230: Section 5,4: host](https://tools.ietf.org/html/rfc7230#section-5.4).</span><span class="sxs-lookup"><span data-stu-id="874b3-464">For more information, see [RFC 7230: Section 5.4: Host](https://tools.ietf.org/html/rfc7230#section-5.4).</span></span>

1. <span data-ttu-id="874b3-465">Pré-registre os prefixos de URL no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-465">Preregister URL prefixes on the server.</span></span>

   <span data-ttu-id="874b3-466">O *netsh.exe* é a ferramenta interna destinada a configurar o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-466">The built-in tool for configuring HTTP.sys is *netsh.exe*.</span></span> <span data-ttu-id="874b3-467">Com o *netsh.exe*, é possível reservar prefixos de URL e atribuir certificados X.509.</span><span class="sxs-lookup"><span data-stu-id="874b3-467">*netsh.exe* is used to reserve URL prefixes and assign X.509 certificates.</span></span> <span data-ttu-id="874b3-468">A ferramenta exige privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-468">The tool requires administrator privileges.</span></span>

   <span data-ttu-id="874b3-469">Use a ferramenta *netsh.exe* para registrar as URLs do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-469">Use the *netsh.exe* tool to register URLs for the app:</span></span>

   ```console
   netsh http add urlacl url=<URL> user=<USER>
   ```

   * <span data-ttu-id="874b3-470">`<URL>`: O Uniform Resource Locator (URL) totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="874b3-470">`<URL>`: The fully qualified Uniform Resource Locator (URL).</span></span> <span data-ttu-id="874b3-471">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-471">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-472">Use um nome de host válido ou o endereço IP local.</span><span class="sxs-lookup"><span data-stu-id="874b3-472">Use a valid hostname or local IP address.</span></span> <span data-ttu-id="874b3-473">*A URL deve incluir uma barra à direita.*</span><span class="sxs-lookup"><span data-stu-id="874b3-473">*The URL must include a trailing slash.*</span></span>
   * <span data-ttu-id="874b3-474">`<USER>`: Especifica o nome do usuário ou do grupo de usuários.</span><span class="sxs-lookup"><span data-stu-id="874b3-474">`<USER>`: Specifies the user or user-group name.</span></span>

   <span data-ttu-id="874b3-475">No exemplo a seguir, o endereço IP local do servidor é `10.0.0.4`:</span><span class="sxs-lookup"><span data-stu-id="874b3-475">In the following example, the local IP address of the server is `10.0.0.4`:</span></span>

   ```console
   netsh http add urlacl url=https://10.0.0.4:443/ user=Users
   ```

   <span data-ttu-id="874b3-476">Quando uma URL é registrada, a ferramenta responde com `URL reservation successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-476">When a URL is registered, the tool responds with `URL reservation successfully added`.</span></span>

   <span data-ttu-id="874b3-477">Para excluir uma URL registrada, use o comando `delete urlacl`:</span><span class="sxs-lookup"><span data-stu-id="874b3-477">To delete a registered URL, use the `delete urlacl` command:</span></span>

   ```console
   netsh http delete urlacl url=<URL>
   ```

1. <span data-ttu-id="874b3-478">Registre certificados X.509 no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-478">Register X.509 certificates on the server.</span></span>

   <span data-ttu-id="874b3-479">Use a ferramenta *netsh.exe* para registrar certificados do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-479">Use the *netsh.exe* tool to register certificates for the app:</span></span>

   ```console
   netsh http add sslcert ipport=<IP>:<PORT> certhash=<THUMBPRINT> appid="{<GUID>}"
   ```

   * <span data-ttu-id="874b3-480">`<IP>`: Especifica o endereço IP local para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-480">`<IP>`: Specifies the local IP address for the binding.</span></span> <span data-ttu-id="874b3-481">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-481">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-482">Use um endereço IP válido.</span><span class="sxs-lookup"><span data-stu-id="874b3-482">Use a valid IP address.</span></span>
   * <span data-ttu-id="874b3-483">`<PORT>`: Especifica a porta para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-483">`<PORT>`: Specifies the port for the binding.</span></span>
   * <span data-ttu-id="874b3-484">`<THUMBPRINT>`: A impressão digital do certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="874b3-484">`<THUMBPRINT>`: The X.509 certificate thumbprint.</span></span>
   * <span data-ttu-id="874b3-485">`<GUID>`: Um GUID gerado pelo desenvolvedor para representar o aplicativo para fins informativos.</span><span class="sxs-lookup"><span data-stu-id="874b3-485">`<GUID>`: A developer-generated GUID to represent the app for informational purposes.</span></span>

   <span data-ttu-id="874b3-486">Para fins de referência, armazene o GUID no aplicativo como uma marca de pacote:</span><span class="sxs-lookup"><span data-stu-id="874b3-486">For reference purposes, store the GUID in the app as a package tag:</span></span>

   * <span data-ttu-id="874b3-487">No Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-487">In Visual Studio:</span></span>
     * <span data-ttu-id="874b3-488">Abra as propriedades do projeto do aplicativo, clicando com o botão direito do mouse no aplicativo no **Gerenciador de Soluções** e selecionando **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="874b3-488">Open the app's project properties by right-clicking on the app in **Solution Explorer** and selecting **Properties**.</span></span>
     * <span data-ttu-id="874b3-489">Selecione a guia **Pacote**.</span><span class="sxs-lookup"><span data-stu-id="874b3-489">Select the **Package** tab.</span></span>
     * <span data-ttu-id="874b3-490">Insira o GUID que você criou no campo **Marcas**.</span><span class="sxs-lookup"><span data-stu-id="874b3-490">Enter the GUID that you created in the **Tags** field.</span></span>
   * <span data-ttu-id="874b3-491">Quando não estiver usando o Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-491">When not using Visual Studio:</span></span>
     * <span data-ttu-id="874b3-492">Abra o arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-492">Open the app's project file.</span></span>
     * <span data-ttu-id="874b3-493">Adicione uma propriedade `<PackageTags>` a um `<PropertyGroup>` novo ou existente com o GUID que você criou:</span><span class="sxs-lookup"><span data-stu-id="874b3-493">Add a `<PackageTags>` property to a new or existing `<PropertyGroup>` with the GUID that you created:</span></span>

       ```xml
       <PropertyGroup>
         <PackageTags>9412ee86-c21b-4eb8-bd89-f650fbf44931</PackageTags>
       </PropertyGroup>
       ```

   <span data-ttu-id="874b3-494">No exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-494">In the following example:</span></span>

   * <span data-ttu-id="874b3-495">O endereço IP local do servidor é `10.0.0.4`.</span><span class="sxs-lookup"><span data-stu-id="874b3-495">The local IP address of the server is `10.0.0.4`.</span></span>
   * <span data-ttu-id="874b3-496">Um gerador GUID aleatório online fornece o valor `appid`.</span><span class="sxs-lookup"><span data-stu-id="874b3-496">An online random GUID generator provides the `appid` value.</span></span>

   ```console
   netsh http add sslcert 
       ipport=10.0.0.4:443 
       certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
       appid="{9412ee86-c21b-4eb8-bd89-f650fbf44931}"
   ```

   <span data-ttu-id="874b3-497">Quando um certificado é registrado, a ferramenta responde com `SSL Certificate successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-497">When a certificate is registered, the tool responds with `SSL Certificate successfully added`.</span></span>

   <span data-ttu-id="874b3-498">Para excluir um registro de certificado, use o comando `delete sslcert`:</span><span class="sxs-lookup"><span data-stu-id="874b3-498">To delete a certificate registration, use the `delete sslcert` command:</span></span>

   ```console
   netsh http delete sslcert ipport=<IP>:<PORT>
   ```

   <span data-ttu-id="874b3-499">Documentação de referência do *netsh.exe*:</span><span class="sxs-lookup"><span data-stu-id="874b3-499">Reference documentation for *netsh.exe*:</span></span>

   * [<span data-ttu-id="874b3-500">Comandos Netsh para HTTP (Hypertext Transfer Protocol)</span><span class="sxs-lookup"><span data-stu-id="874b3-500">Netsh Commands for Hypertext Transfer Protocol (HTTP)</span></span>](https://technet.microsoft.com/library/cc725882.aspx)
   * [<span data-ttu-id="874b3-501">Cadeias de caracteres de UrlPrefix</span><span class="sxs-lookup"><span data-stu-id="874b3-501">UrlPrefix Strings</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx)

1. <span data-ttu-id="874b3-502">Execute o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-502">Run the app.</span></span>

   <span data-ttu-id="874b3-503">Não é necessário ter privilégios de administrador para executar o aplicativo ao associar ao localhost usando HTTP (não HTTPS) com um número de porta maior do que 1024.</span><span class="sxs-lookup"><span data-stu-id="874b3-503">Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024.</span></span> <span data-ttu-id="874b3-504">Para outras configurações (por exemplo, usar um endereço IP local ou associação à porta 443), execute o aplicativo com privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-504">For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</span></span>

   <span data-ttu-id="874b3-505">O aplicativo responde no endereço IP público do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-505">The app responds at the server's public IP address.</span></span> <span data-ttu-id="874b3-506">Neste exemplo, o servidor é acessado pela Internet como seu endereço IP público de `104.214.79.47`.</span><span class="sxs-lookup"><span data-stu-id="874b3-506">In this example, the server is reached from the Internet at its public IP address of `104.214.79.47`.</span></span>

   <span data-ttu-id="874b3-507">Um certificado de desenvolvimento é usado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="874b3-507">A development certificate is used in this example.</span></span> <span data-ttu-id="874b3-508">A página é carregada com segurança após ignorar o aviso de certificado não confiável do navegador.</span><span class="sxs-lookup"><span data-stu-id="874b3-508">The page loads securely after bypassing the browser's untrusted certificate warning.</span></span>

   ![Janela do navegador mostrando a página de Índice do aplicativo carregada](httpsys/_static/browser.png)

## <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="874b3-510">Servidor proxy e cenários de balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="874b3-510">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="874b3-511">Para aplicativos hospedados pelo HTTP.sys que interagem com solicitações da Internet ou de uma rede corporativa, podem ser necessárias configurações adicionais ao hospedar atrás de balanceadores de carga e de servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="874b3-511">For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers.</span></span> <span data-ttu-id="874b3-512">Para obter mais informações, veja [Configurar o ASP.NET Core para trabalhar com servidores proxy e balanceadores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="874b3-512">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="874b3-513">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="874b3-513">Additional resources</span></span>

* [<span data-ttu-id="874b3-514">Habilitar a autenticação do Windows com HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-514">Enable Windows Authentication with HTTP.sys</span></span>](xref:security/authentication/windowsauth#httpsys)
* [<span data-ttu-id="874b3-515">API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="874b3-515">HTTP Server API</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364510.aspx)
* [<span data-ttu-id="874b3-516">Repositório aspnet/HttpSysServer do GitHub (código-fonte)</span><span class="sxs-lookup"><span data-stu-id="874b3-516">aspnet/HttpSysServer GitHub repository (source code)</span></span>](https://github.com/aspnet/HttpSysServer/)
* [<span data-ttu-id="874b3-517">O host</span><span class="sxs-lookup"><span data-stu-id="874b3-517">The host</span></span>](xref:fundamentals/index#host)
* <xref:test/troubleshoot>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="874b3-518">O [HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) é um [servidor Web para ASP.NET Core](xref:fundamentals/servers/index) executado apenas no Windows.</span><span class="sxs-lookup"><span data-stu-id="874b3-518">[HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) is a [web server for ASP.NET Core](xref:fundamentals/servers/index) that only runs on Windows.</span></span> <span data-ttu-id="874b3-519">O HTTP.sys é uma alternativa ao servidor [Kestrel](xref:fundamentals/servers/kestrel) e oferece alguns recursos não disponibilizados pelo Kestrel.</span><span class="sxs-lookup"><span data-stu-id="874b3-519">HTTP.sys is an alternative to [Kestrel](xref:fundamentals/servers/kestrel) server and offers some features that Kestrel doesn't provide.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="874b3-520">O HTTP.sys não é compatível com o [Módulo do ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e não pode ser usado com IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-520">HTTP.sys isn't compatible with the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and can't be used with IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-521">O HTTP.sys dá suporte aos seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="874b3-521">HTTP.sys supports the following features:</span></span>

* [<span data-ttu-id="874b3-522">Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="874b3-522">Windows Authentication</span></span>](xref:security/authentication/windowsauth)
* <span data-ttu-id="874b3-523">Compartilhamento de porta</span><span class="sxs-lookup"><span data-stu-id="874b3-523">Port sharing</span></span>
* <span data-ttu-id="874b3-524">HTTPS com SNI</span><span class="sxs-lookup"><span data-stu-id="874b3-524">HTTPS with SNI</span></span>
* <span data-ttu-id="874b3-525">HTTP/2 sobre TLS (Windows 10 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-525">HTTP/2 over TLS (Windows 10 or later)</span></span>
* <span data-ttu-id="874b3-526">Transmissão direta de arquivo</span><span class="sxs-lookup"><span data-stu-id="874b3-526">Direct file transmission</span></span>
* <span data-ttu-id="874b3-527">Cache de resposta</span><span class="sxs-lookup"><span data-stu-id="874b3-527">Response caching</span></span>
* <span data-ttu-id="874b3-528">WebSockets (Windows 8 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-528">WebSockets (Windows 8 or later)</span></span>

<span data-ttu-id="874b3-529">Versões do Windows com suporte:</span><span class="sxs-lookup"><span data-stu-id="874b3-529">Supported Windows versions:</span></span>

* <span data-ttu-id="874b3-530">Windows 7 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-530">Windows 7 or later</span></span>
* <span data-ttu-id="874b3-531">Windows Server 2008 R2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-531">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="874b3-532">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="874b3-532">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="when-to-use-httpsys"></a><span data-ttu-id="874b3-533">Quando usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-533">When to use HTTP.sys</span></span>

<span data-ttu-id="874b3-534">O HTTP.sys é útil nas implantações em que:</span><span class="sxs-lookup"><span data-stu-id="874b3-534">HTTP.sys is useful for deployments where:</span></span>

* <span data-ttu-id="874b3-535">É necessário expor o servidor diretamente à Internet sem usar o IIS.</span><span class="sxs-lookup"><span data-stu-id="874b3-535">There's a need to expose the server directly to the Internet without using IIS.</span></span>

  ![O HTTP.sys se comunica diretamente com a Internet](httpsys/_static/httpsys-to-internet.png)

* <span data-ttu-id="874b3-537">As implantações internas exigem um recurso que não está disponível no Kestrel, como a [Autenticação do Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="874b3-537">An internal deployment requires a feature not available in Kestrel, such as [Windows Authentication](xref:security/authentication/windowsauth).</span></span>

  ![O HTTP.sys se comunica diretamente com a rede interna](httpsys/_static/httpsys-to-internal.png)

<span data-ttu-id="874b3-539">O HTTP.sys é uma tecnologia madura que protege contra vários tipos de ataques e proporciona as propriedades de robustez, segurança e escalabilidade de um servidor Web completo.</span><span class="sxs-lookup"><span data-stu-id="874b3-539">HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server.</span></span> <span data-ttu-id="874b3-540">O próprio IIS é executado como um ouvinte HTTP sobre o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-540">IIS itself runs as an HTTP listener on top of HTTP.sys.</span></span>

## <a name="http2-support"></a><span data-ttu-id="874b3-541">Suporte do HTTP/2</span><span class="sxs-lookup"><span data-stu-id="874b3-541">HTTP/2 support</span></span>

<span data-ttu-id="874b3-542">O [HTTP/2](https://httpwg.org/specs/rfc7540.html) estará habilitado para aplicativos ASP.NET Core se os seguintes requisitos básicos forem atendidos:</span><span class="sxs-lookup"><span data-stu-id="874b3-542">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is enabled for ASP.NET Core apps if the following base requirements are met:</span></span>

* <span data-ttu-id="874b3-543">Windows Server 2016/Windows 10 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-543">Windows Server 2016/Windows 10 or later</span></span>
* <span data-ttu-id="874b3-544">Conexão [ALPN (Negociação de protocolo de camada de aplicativo)](https://tools.ietf.org/html/rfc7301#section-3)</span><span class="sxs-lookup"><span data-stu-id="874b3-544">[Application-Layer Protocol Negotiation (ALPN)](https://tools.ietf.org/html/rfc7301#section-3) connection</span></span>
* <span data-ttu-id="874b3-545">Conexão TLS 1.2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-545">TLS 1.2 or later connection</span></span>

<span data-ttu-id="874b3-546">Se uma conexão HTTP/2 for estabelecida, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) relatará `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="874b3-546">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span>

<span data-ttu-id="874b3-547">O HTTP/2 está habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="874b3-547">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="874b3-548">Se uma conexão HTTP/2 não tiver sido estabelecida, a conexão retornará para HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="874b3-548">If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1.</span></span> <span data-ttu-id="874b3-549">Em uma versão futura do Windows, os sinalizadores de configuração de HTTP/2 estarão disponíveis e contarão com a capacidade de desabilitar o HTTP/2 com HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-549">In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</span></span>

## <a name="kernel-mode-authentication-with-kerberos"></a><span data-ttu-id="874b3-550">Autenticação de modo kernel com Kerberos</span><span class="sxs-lookup"><span data-stu-id="874b3-550">Kernel mode authentication with Kerberos</span></span>

<span data-ttu-id="874b3-551">O HTTP.sys delega à autenticação de modo kernel com o protocolo de autenticação Kerberos.</span><span class="sxs-lookup"><span data-stu-id="874b3-551">HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol.</span></span> <span data-ttu-id="874b3-552">Não há suporte para autenticação de modo de usuário com o Kerberos e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-552">User mode authentication isn't supported with Kerberos and HTTP.sys.</span></span> <span data-ttu-id="874b3-553">A conta do computador precisa ser usada para descriptografar o token/tíquete do Kerberos que é obtido do Active Directory e encaminhado pelo cliente ao servidor para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="874b3-553">The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user.</span></span> <span data-ttu-id="874b3-554">Registre o SPN (nome da entidade de serviço) do host, não do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-554">Register the Service Principal Name (SPN) for the host, not the user of the app.</span></span>

## <a name="how-to-use-httpsys"></a><span data-ttu-id="874b3-555">Como usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-555">How to use HTTP.sys</span></span>

### <a name="configure-the-aspnet-core-app-to-use-httpsys"></a><span data-ttu-id="874b3-556">Configurar o aplicativo ASP.NET Core para usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-556">Configure the ASP.NET Core app to use HTTP.sys</span></span>

<span data-ttu-id="874b3-557">Uma referência de pacote no arquivo de projeto não é necessária ao usar o [metapacote Microsoft. AspNetCore. app](xref:fundamentals/metapackage-app) ([NuGet.org](https://www.nuget.org/packages/Microsoft.AspNetCore.App/)).</span><span class="sxs-lookup"><span data-stu-id="874b3-557">A package reference in the project file isn't required when using the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) ([nuget.org](https://www.nuget.org/packages/Microsoft.AspNetCore.App/)).</span></span> <span data-ttu-id="874b3-558">Se não estiver usando o metapacote `Microsoft.AspNetCore.App`, adicione uma referência do pacote a [Microsoft.AspNetCore.Server.HttpSys](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.HttpSys/).</span><span class="sxs-lookup"><span data-stu-id="874b3-558">When not using the `Microsoft.AspNetCore.App` metapackage, add a package reference to [Microsoft.AspNetCore.Server.HttpSys](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.HttpSys/).</span></span>

<span data-ttu-id="874b3-559">Chame o método de extensão <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> ao compilar o host, especificando qualquer <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions> necessária.</span><span class="sxs-lookup"><span data-stu-id="874b3-559">Call the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> extension method when building the host, specifying any required <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions>.</span></span> <span data-ttu-id="874b3-560">O exemplo a seguir define as opções para seus valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-560">The following example sets options to their default values:</span></span>

[!code-csharp[](httpsys/samples/2.x/SampleApp/Program.cs?name=snippet1&highlight=4-12)]

<span data-ttu-id="874b3-561">A configuração adicional do HTTP.sys é tratada por meio das [configurações do registro](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span><span class="sxs-lookup"><span data-stu-id="874b3-561">Additional HTTP.sys configuration is handled through [registry settings](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span></span>

<span data-ttu-id="874b3-562">**Opções do HTTP.sys**</span><span class="sxs-lookup"><span data-stu-id="874b3-562">**HTTP.sys options**</span></span>

| <span data-ttu-id="874b3-563">Propriedade</span><span class="sxs-lookup"><span data-stu-id="874b3-563">Property</span></span> | <span data-ttu-id="874b3-564">Descrição</span><span class="sxs-lookup"><span data-stu-id="874b3-564">Description</span></span> | <span data-ttu-id="874b3-565">Padrão</span><span class="sxs-lookup"><span data-stu-id="874b3-565">Default</span></span> |
| ---
<span data-ttu-id="874b3-566">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-566">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-567">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-567">'Blazor'</span></span>
- <span data-ttu-id="874b3-568">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-568">'Identity'</span></span>
- <span data-ttu-id="874b3-569">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-569">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-570">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-570">'Razor'</span></span>
- <span data-ttu-id="874b3-571">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-571">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-572">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-572">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-573">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-573">'Blazor'</span></span>
- <span data-ttu-id="874b3-574">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-574">'Identity'</span></span>
- <span data-ttu-id="874b3-575">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-575">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-576">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-576">'Razor'</span></span>
- <span data-ttu-id="874b3-577">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-577">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-578">---- | título do---: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-578">---- | --- title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-579">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-579">'Blazor'</span></span>
- <span data-ttu-id="874b3-580">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-580">'Identity'</span></span>
- <span data-ttu-id="874b3-581">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-581">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-582">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-582">'Razor'</span></span>
- <span data-ttu-id="874b3-583">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-583">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-584">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-584">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-585">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-585">'Blazor'</span></span>
- <span data-ttu-id="874b3-586">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-586">'Identity'</span></span>
- <span data-ttu-id="874b3-587">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-587">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-588">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-588">'Razor'</span></span>
- <span data-ttu-id="874b3-589">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-589">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-590">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-590">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-591">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-591">'Blazor'</span></span>
- <span data-ttu-id="874b3-592">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-592">'Identity'</span></span>
- <span data-ttu-id="874b3-593">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-593">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-594">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-594">'Razor'</span></span>
- <span data-ttu-id="874b3-595">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-595">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-596">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Controlar se a entrada/saída síncrona é permitida para o `HttpContext.Request.Body` e o `HttpContext.Response.Body` .</span><span class="sxs-lookup"><span data-stu-id="874b3-596">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Control whether synchronous input/output is allowed for the `HttpContext.Request.Body` and `HttpContext.Response.Body`.</span></span><span data-ttu-id="874b3-597"> | `true`| | [Authentication. AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Permitir solicitações anônimas.</span><span class="sxs-lookup"><span data-stu-id="874b3-597"> | `true` | | [Authentication.AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Allow anonymous requests.</span></span><span data-ttu-id="874b3-598"> | `true`| | [Autenticação. esquemas](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Especifique os esquemas de autenticação permitidos.</span><span class="sxs-lookup"><span data-stu-id="874b3-598"> | `true` | | [Authentication.Schemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Specify the allowed authentication schemes.</span></span> <span data-ttu-id="874b3-599">É possível modificar a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-599">May be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-600">Os valores são fornecidos pela [Enumeração AuthenticationSchemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic` , `Kerberos` , `Negotiate` , `None` e `NTLM` .</span><span class="sxs-lookup"><span data-stu-id="874b3-600">Values are provided by the [AuthenticationSchemes enum](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic`, `Kerberos`, `Negotiate`, `None`, and `NTLM`.</span></span><span data-ttu-id="874b3-601"> | `None`| | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Tente o cache do [modo kernel](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) para obter respostas com cabeçalhos qualificados.</span><span class="sxs-lookup"><span data-stu-id="874b3-601"> | `None` | | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Attempt [kernel-mode](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) caching for responses with eligible headers.</span></span> <span data-ttu-id="874b3-602">A resposta pode não incluir `Set-Cookie`, `Vary` ou cabeçalhos `Pragma`.</span><span class="sxs-lookup"><span data-stu-id="874b3-602">The response may not include `Set-Cookie`, `Vary`, or `Pragma` headers.</span></span> <span data-ttu-id="874b3-603">Ela deve incluir um cabeçalho `Cache-Control` que seja `public` e um valor `shared-max-age` ou `max-age`, ou um cabeçalho `Expires`.</span><span class="sxs-lookup"><span data-stu-id="874b3-603">It must include a `Cache-Control` header that's `public` and either a `shared-max-age` or `max-age` value, or an `Expires` header.</span></span><span data-ttu-id="874b3-604"> | `true`| | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | O número máximo de aceitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="874b3-604"> | `true` | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | The maximum number of concurrent accepts.</span></span> <span data-ttu-id="874b3-605">| 5 &times; [ambiente. <br> ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | O número máximo de conexões simultâneas a serem aceitas.</span><span class="sxs-lookup"><span data-stu-id="874b3-605">| 5 &times; [Environment.<br>ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | The maximum number of concurrent connections to accept.</span></span> <span data-ttu-id="874b3-606">Usar `-1` como infinito.</span><span class="sxs-lookup"><span data-stu-id="874b3-606">Use `-1` for infinite.</span></span> <span data-ttu-id="874b3-607">Usar `null` a fim de usar a configuração que abranja toda máquina do registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-607">Use `null` to use the registry's machine-wide setting.</span></span> | `null`<br><span data-ttu-id="874b3-608">(em todo o computador</span><span class="sxs-lookup"><span data-stu-id="874b3-608">(machine-wide</span></span><br><span data-ttu-id="874b3-609">configuração) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | Consulte a seção <a href="#maxrequestbodysize">MaxRequestBodySize</a> .</span><span class="sxs-lookup"><span data-stu-id="874b3-609">setting) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | See the <a href="#maxrequestbodysize">MaxRequestBodySize</a> section.</span></span> <span data-ttu-id="874b3-610">| 30 milhões bytes</span><span class="sxs-lookup"><span data-stu-id="874b3-610">| 30000000 bytes</span></span><br><span data-ttu-id="874b3-611">(~ 28,6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | O número máximo de solicitações que podem ser enfileiradas.</span><span class="sxs-lookup"><span data-stu-id="874b3-611">(~28.6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | The maximum number of requests that can be queued.</span></span> <span data-ttu-id="874b3-612">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indique se as gravações do corpo da resposta que falham devido a desconexões do cliente devem lançar exceções ou concluídas normalmente.</span><span class="sxs-lookup"><span data-stu-id="874b3-612">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indicate if response body writes that fail due to client disconnects should throw exceptions or complete normally.</span></span> | `false`<br><span data-ttu-id="874b3-613">(concluído normalmente) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expor a configuração de HTTP. sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> , que também pode ser configurada no registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-613">(complete normally) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expose the HTTP.sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> configuration, which may also be configured in the registry.</span></span> <span data-ttu-id="874b3-614">Siga os links de API para saber mais sobre cada configuração, inclusive os valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-614">Follow the API links to learn more about each setting, including default values:</span></span><ul><li><span data-ttu-id="874b3-615">[Timeoutmanager. DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): tempo permitido para a API do servidor http drenar o corpo da entidade em uma conexão Keep-Alive.</span><span class="sxs-lookup"><span data-stu-id="874b3-615">[TimeoutManager.DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): Time allowed for the HTTP Server API to drain the entity body on a Keep-Alive connection.</span></span></li><li><span data-ttu-id="874b3-616">[Timeoutmanager. EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): tempo permitido para o corpo da entidade de solicitação chegar.</span><span class="sxs-lookup"><span data-stu-id="874b3-616">[TimeoutManager.EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): Time allowed for the request entity body to arrive.</span></span></li><li><span data-ttu-id="874b3-617">[Timeoutmanager. HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): tempo permitido para a API do servidor http analisar o cabeçalho da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-617">[TimeoutManager.HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): Time allowed for the HTTP Server API to parse the request header.</span></span></li><li><span data-ttu-id="874b3-618">[Timeoutmanager. IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): tempo permitido para uma conexão ociosa.</span><span class="sxs-lookup"><span data-stu-id="874b3-618">[TimeoutManager.IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): Time allowed for an idle connection.</span></span></li><li><span data-ttu-id="874b3-619">[Timeoutmanager. MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): a taxa mínima de envio para a resposta.</span><span class="sxs-lookup"><span data-stu-id="874b3-619">[TimeoutManager.MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): The minimum send rate for the response.</span></span></li><li><span data-ttu-id="874b3-620">[Timeoutmanager. RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): tempo permitido para a solicitação permanecer na fila de solicitações antes que o aplicativo a pegue.</span><span class="sxs-lookup"><span data-stu-id="874b3-620">[TimeoutManager.RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): Time allowed for the request to remain in the request queue before the app picks it up.</span></span></li></ul> <span data-ttu-id="874b3-621">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Especifique o <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> a ser registrado com http. sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-621">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Specify the <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> to register with HTTP.sys.</span></span> <span data-ttu-id="874b3-622">A mais útil é [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), que é usada para adicionar um prefixo à coleção.</span><span class="sxs-lookup"><span data-stu-id="874b3-622">The most useful is [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), which is used to add a prefix to the collection.</span></span> <span data-ttu-id="874b3-623">É possível modificá-las a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-623">These may be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-624">|  |</span><span class="sxs-lookup"><span data-stu-id="874b3-624">|  |</span></span>

<a name="maxrequestbodysize"></a>

<span data-ttu-id="874b3-625">**MaxRequestBodySize**</span><span class="sxs-lookup"><span data-stu-id="874b3-625">**MaxRequestBodySize**</span></span>

<span data-ttu-id="874b3-626">O tamanho máximo permitido em bytes para todos os corpos de solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-626">The maximum allowed size of any request body in bytes.</span></span> <span data-ttu-id="874b3-627">Quando é definido como `null`, o tamanho máximo do corpo da solicitação é ilimitado.</span><span class="sxs-lookup"><span data-stu-id="874b3-627">When set to `null`, the maximum request body size is unlimited.</span></span> <span data-ttu-id="874b3-628">Esse limite não afeta as conexões atualizadas que são sempre ilimitadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-628">This limit has no effect on upgraded connections, which are always unlimited.</span></span>

<span data-ttu-id="874b3-629">O método recomendado para substituir o limite em um aplicativo ASP.NET Core MVC para um único `IActionResult` é usar o atributo <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> em um método de ação:</span><span class="sxs-lookup"><span data-stu-id="874b3-629">The recommended method to override the limit in an ASP.NET Core MVC app for a single `IActionResult` is to use the <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> attribute on an action method:</span></span>

```csharp
[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
```

<span data-ttu-id="874b3-630">Uma exceção é gerada quando o aplicativo tenta configurar o limite de uma solicitação, depois que o aplicativo inicia a leitura da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-630">An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request.</span></span> <span data-ttu-id="874b3-631">É possível usar uma propriedade `IsReadOnly` para indicar se a propriedade `MaxRequestBodySize` está no estado somente leitura, o que significa que é tarde demais para configurar o limite.</span><span class="sxs-lookup"><span data-stu-id="874b3-631">An `IsReadOnly` property can be used to indicate if the `MaxRequestBodySize` property is in a read-only state, meaning it's too late to configure the limit.</span></span>

<span data-ttu-id="874b3-632">Se o aplicativo precisar substituir <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> mediante solicitação, use o <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span><span class="sxs-lookup"><span data-stu-id="874b3-632">If the app should override <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> per-request, use the <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span></span>

[!code-csharp[](httpsys/samples/2.x/SampleApp/Startup.cs?name=snippet1&highlight=6-7)]

<span data-ttu-id="874b3-633">Quando usar o Visual Studio, verifique se que o aplicativo está configurado para executar o IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-633">If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-634">No Visual Studio, o perfil de inicialização padrão destina-se ao IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-634">In Visual Studio, the default launch profile is for IIS Express.</span></span> <span data-ttu-id="874b3-635">Para executar o projeto como um aplicativo de console, altere manualmente o perfil selecionado, conforme mostrado na captura de tela a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-635">To run the project as a console app, manually change the selected profile, as shown in the following screen shot:</span></span>

![Selecionar o perfil do aplicativo de console](httpsys/_static/vs-choose-profile.png)

### <a name="configure-windows-server"></a><span data-ttu-id="874b3-637">Configurar o Windows Server</span><span class="sxs-lookup"><span data-stu-id="874b3-637">Configure Windows Server</span></span>

1. <span data-ttu-id="874b3-638">Determine as portas que serão abertas para o aplicativo e use o [Firewall do Windows](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) ou o cmdlet do PowerShell [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) para abrir as portas de firewall e permitir que o tráfego chegue até o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-638">Determine the ports to open for the app and use [Windows Firewall](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) or the [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys.</span></span> <span data-ttu-id="874b3-639">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-639">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-640">Ao implantar em uma VM do Azure, abra as portas no [Grupo de Segurança de Rede](/azure/virtual-machines/windows/nsg-quickstart-portal).</span><span class="sxs-lookup"><span data-stu-id="874b3-640">When deploying to an Azure VM, open the ports in the [Network Security Group](/azure/virtual-machines/windows/nsg-quickstart-portal).</span></span> <span data-ttu-id="874b3-641">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-641">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-642">Obtenha e instale os certificados X.509, se precisar.</span><span class="sxs-lookup"><span data-stu-id="874b3-642">Obtain and install X.509 certificates, if required.</span></span>

   <span data-ttu-id="874b3-643">No Windows, crie certificados autoassinados, usando o [cmdlet do PowerShell New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate).</span><span class="sxs-lookup"><span data-stu-id="874b3-643">On Windows, create self-signed certificates using the [New-SelfSignedCertificate PowerShell cmdlet](/powershell/module/pkiclient/new-selfsignedcertificate).</span></span> <span data-ttu-id="874b3-644">Para ver um exemplo sem suporte, confira [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span><span class="sxs-lookup"><span data-stu-id="874b3-644">For an unsupported example, see [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span></span>

   <span data-ttu-id="874b3-645">Instale certificados autoassinados ou assinados pela AC no repositório **Computador Local** > **Pessoal** do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-645">Install either self-signed or CA-signed certificates in the server's **Local Machine** > **Personal** store.</span></span>

1. <span data-ttu-id="874b3-646">Se o aplicativo for uma [implantação dependente de estrutura](/dotnet/core/deploying/#framework-dependent-deployments-fdd), instale o .NET Core, o .NET Framework ou ambos (caso o aplicativo .NET Core seja direcionado ao .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="874b3-646">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), install .NET Core, .NET Framework, or both (if the app is a .NET Core app targeting the .NET Framework).</span></span>

   * <span data-ttu-id="874b3-647">**.NET Core**: se o aplicativo exigir o .NET Core, obtenha e execute o instalador do **.NET Core Runtime** de [downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-647">**.NET Core**: If the app requires .NET Core, obtain and run the **.NET Core Runtime** installer from [.NET Core Downloads](https://dotnet.microsoft.com/download).</span></span> <span data-ttu-id="874b3-648">Não instale o SDK completo no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-648">Don't install the full SDK on the server.</span></span>
   * <span data-ttu-id="874b3-649">**.NET Framework**: se o aplicativo exigir .NET Framework, consulte o [Guia de instalação do .NET Framework](/dotnet/framework/install/).</span><span class="sxs-lookup"><span data-stu-id="874b3-649">**.NET Framework**: If the app requires .NET Framework, see the [.NET Framework installation guide](/dotnet/framework/install/).</span></span> <span data-ttu-id="874b3-650">Instale o .NET Framework necessário.</span><span class="sxs-lookup"><span data-stu-id="874b3-650">Install the required .NET Framework.</span></span> <span data-ttu-id="874b3-651">O instalador do .NET Framework mais recente está disponível na página [Downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-651">The installer for the latest .NET Framework is available from the [.NET Core Downloads](https://dotnet.microsoft.com/download) page.</span></span>

   <span data-ttu-id="874b3-652">Se o aplicativo for uma [implantação autocontida](/dotnet/core/deploying/#self-contained-deployments-scd), ele incluirá o runtime em sua implantação.</span><span class="sxs-lookup"><span data-stu-id="874b3-652">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), the app includes the runtime in its deployment.</span></span> <span data-ttu-id="874b3-653">Nenhuma instalação do framework é necessária no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-653">No framework installation is required on the server.</span></span>

1. <span data-ttu-id="874b3-654">Configure URLs e portas no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-654">Configure URLs and ports in the app.</span></span>

   <span data-ttu-id="874b3-655">Por padrão, o ASP.NET Core é associado a `http://localhost:5000`.</span><span class="sxs-lookup"><span data-stu-id="874b3-655">By default, ASP.NET Core binds to `http://localhost:5000`.</span></span> <span data-ttu-id="874b3-656">Para configurar portas e prefixos de URL, as opções incluem:</span><span class="sxs-lookup"><span data-stu-id="874b3-656">To configure URL prefixes and ports, options include:</span></span>

   * <xref:Microsoft.AspNetCore.Hosting.HostingAbstractionsWebHostBuilderExtensions.UseUrls*>
   * <span data-ttu-id="874b3-657">O argumento de linha de comando `urls`</span><span class="sxs-lookup"><span data-stu-id="874b3-657">`urls` command-line argument</span></span>
   * <span data-ttu-id="874b3-658">A variável de ambiente `ASPNETCORE_URLS`</span><span class="sxs-lookup"><span data-stu-id="874b3-658">`ASPNETCORE_URLS` environment variable</span></span>
   * <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes>

   <span data-ttu-id="874b3-659">O exemplo de código a seguir mostra como usar <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> com o endereço IP local do servidor `10.0.0.4` na porta 443:</span><span class="sxs-lookup"><span data-stu-id="874b3-659">The following code example shows how to use <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> with the server's local IP address `10.0.0.4` on port 443:</span></span>

   [!code-csharp[](httpsys/samples_snapshot/2.x/Program.cs?highlight=6)]

   <span data-ttu-id="874b3-660">Uma vantagem de usar `UrlPrefixes` é que uma mensagem de erro é gerada imediatamente no caso de prefixos formatados de forma incorreta.</span><span class="sxs-lookup"><span data-stu-id="874b3-660">An advantage of `UrlPrefixes` is that an error message is generated immediately for improperly formatted prefixes.</span></span>

   <span data-ttu-id="874b3-661">As configurações de `UrlPrefixes` substituem as configurações `UseUrls`/`urls`/`ASPNETCORE_URLS`.</span><span class="sxs-lookup"><span data-stu-id="874b3-661">The settings in `UrlPrefixes` override `UseUrls`/`urls`/`ASPNETCORE_URLS` settings.</span></span> <span data-ttu-id="874b3-662">Portanto, uma vantagem de usar `UseUrls`, `urls` e a variável de ambiente `ASPNETCORE_URLS` é que fica mais fácil alternar entre o Kestrel e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-662">Therefore, an advantage of `UseUrls`, `urls`, and the `ASPNETCORE_URLS` environment variable is that it's easier to switch between Kestrel and HTTP.sys.</span></span>

   <span data-ttu-id="874b3-663">O HTTP.sys usa os [formatos de cadeia de caracteres UrlPrefix da API do Servidor HTTP](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span><span class="sxs-lookup"><span data-stu-id="874b3-663">HTTP.sys uses the [HTTP Server API UrlPrefix string formats](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span></span>

   > [!WARNING]
   > <span data-ttu-id="874b3-664">Associações de curinga de nível superior (`http://*:80/` e `http://+:80`) **não** devem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-664">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="874b3-665">Associações de curinga de nível superior criam vulnerabilidades de segurança no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-665">Top-level wildcard bindings create app security vulnerabilities.</span></span> <span data-ttu-id="874b3-666">Isso se aplica a curingas fortes e fracos.</span><span class="sxs-lookup"><span data-stu-id="874b3-666">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="874b3-667">Use nomes de host explícitos ou endereços IP em vez de curingas.</span><span class="sxs-lookup"><span data-stu-id="874b3-667">Use explicit host names or IP addresses rather than wildcards.</span></span> <span data-ttu-id="874b3-668">Associações de curinga de subdomínio (por exemplo, `*.mysub.com`) não serão um risco à segurança se você controlar todo o domínio pai (ao contrário de `*.com`, o qual é vulnerável).</span><span class="sxs-lookup"><span data-stu-id="874b3-668">Subdomain wildcard binding (for example, `*.mysub.com`) isn't a security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="874b3-669">Para obter mais informações, consulte [RFC 7230: Section 5,4: host](https://tools.ietf.org/html/rfc7230#section-5.4).</span><span class="sxs-lookup"><span data-stu-id="874b3-669">For more information, see [RFC 7230: Section 5.4: Host](https://tools.ietf.org/html/rfc7230#section-5.4).</span></span>

1. <span data-ttu-id="874b3-670">Pré-registre os prefixos de URL no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-670">Preregister URL prefixes on the server.</span></span>

   <span data-ttu-id="874b3-671">O *netsh.exe* é a ferramenta interna destinada a configurar o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-671">The built-in tool for configuring HTTP.sys is *netsh.exe*.</span></span> <span data-ttu-id="874b3-672">Com o *netsh.exe*, é possível reservar prefixos de URL e atribuir certificados X.509.</span><span class="sxs-lookup"><span data-stu-id="874b3-672">*netsh.exe* is used to reserve URL prefixes and assign X.509 certificates.</span></span> <span data-ttu-id="874b3-673">A ferramenta exige privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-673">The tool requires administrator privileges.</span></span>

   <span data-ttu-id="874b3-674">Use a ferramenta *netsh.exe* para registrar as URLs do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-674">Use the *netsh.exe* tool to register URLs for the app:</span></span>

   ```console
   netsh http add urlacl url=<URL> user=<USER>
   ```

   * <span data-ttu-id="874b3-675">`<URL>`: O Uniform Resource Locator (URL) totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="874b3-675">`<URL>`: The fully qualified Uniform Resource Locator (URL).</span></span> <span data-ttu-id="874b3-676">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-676">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-677">Use um nome de host válido ou o endereço IP local.</span><span class="sxs-lookup"><span data-stu-id="874b3-677">Use a valid hostname or local IP address.</span></span> <span data-ttu-id="874b3-678">*A URL deve incluir uma barra à direita.*</span><span class="sxs-lookup"><span data-stu-id="874b3-678">*The URL must include a trailing slash.*</span></span>
   * <span data-ttu-id="874b3-679">`<USER>`: Especifica o nome do usuário ou do grupo de usuários.</span><span class="sxs-lookup"><span data-stu-id="874b3-679">`<USER>`: Specifies the user or user-group name.</span></span>

   <span data-ttu-id="874b3-680">No exemplo a seguir, o endereço IP local do servidor é `10.0.0.4`:</span><span class="sxs-lookup"><span data-stu-id="874b3-680">In the following example, the local IP address of the server is `10.0.0.4`:</span></span>

   ```console
   netsh http add urlacl url=https://10.0.0.4:443/ user=Users
   ```

   <span data-ttu-id="874b3-681">Quando uma URL é registrada, a ferramenta responde com `URL reservation successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-681">When a URL is registered, the tool responds with `URL reservation successfully added`.</span></span>

   <span data-ttu-id="874b3-682">Para excluir uma URL registrada, use o comando `delete urlacl`:</span><span class="sxs-lookup"><span data-stu-id="874b3-682">To delete a registered URL, use the `delete urlacl` command:</span></span>

   ```console
   netsh http delete urlacl url=<URL>
   ```

1. <span data-ttu-id="874b3-683">Registre certificados X.509 no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-683">Register X.509 certificates on the server.</span></span>

   <span data-ttu-id="874b3-684">Use a ferramenta *netsh.exe* para registrar certificados do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-684">Use the *netsh.exe* tool to register certificates for the app:</span></span>

   ```console
   netsh http add sslcert ipport=<IP>:<PORT> certhash=<THUMBPRINT> appid="{<GUID>}"
   ```

   * <span data-ttu-id="874b3-685">`<IP>`: Especifica o endereço IP local para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-685">`<IP>`: Specifies the local IP address for the binding.</span></span> <span data-ttu-id="874b3-686">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-686">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-687">Use um endereço IP válido.</span><span class="sxs-lookup"><span data-stu-id="874b3-687">Use a valid IP address.</span></span>
   * <span data-ttu-id="874b3-688">`<PORT>`: Especifica a porta para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-688">`<PORT>`: Specifies the port for the binding.</span></span>
   * <span data-ttu-id="874b3-689">`<THUMBPRINT>`: A impressão digital do certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="874b3-689">`<THUMBPRINT>`: The X.509 certificate thumbprint.</span></span>
   * <span data-ttu-id="874b3-690">`<GUID>`: Um GUID gerado pelo desenvolvedor para representar o aplicativo para fins informativos.</span><span class="sxs-lookup"><span data-stu-id="874b3-690">`<GUID>`: A developer-generated GUID to represent the app for informational purposes.</span></span>

   <span data-ttu-id="874b3-691">Para fins de referência, armazene o GUID no aplicativo como uma marca de pacote:</span><span class="sxs-lookup"><span data-stu-id="874b3-691">For reference purposes, store the GUID in the app as a package tag:</span></span>

   * <span data-ttu-id="874b3-692">No Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-692">In Visual Studio:</span></span>
     * <span data-ttu-id="874b3-693">Abra as propriedades do projeto do aplicativo, clicando com o botão direito do mouse no aplicativo no **Gerenciador de Soluções** e selecionando **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="874b3-693">Open the app's project properties by right-clicking on the app in **Solution Explorer** and selecting **Properties**.</span></span>
     * <span data-ttu-id="874b3-694">Selecione a guia **Pacote**.</span><span class="sxs-lookup"><span data-stu-id="874b3-694">Select the **Package** tab.</span></span>
     * <span data-ttu-id="874b3-695">Insira o GUID que você criou no campo **Marcas**.</span><span class="sxs-lookup"><span data-stu-id="874b3-695">Enter the GUID that you created in the **Tags** field.</span></span>
   * <span data-ttu-id="874b3-696">Quando não estiver usando o Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-696">When not using Visual Studio:</span></span>
     * <span data-ttu-id="874b3-697">Abra o arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-697">Open the app's project file.</span></span>
     * <span data-ttu-id="874b3-698">Adicione uma propriedade `<PackageTags>` a um `<PropertyGroup>` novo ou existente com o GUID que você criou:</span><span class="sxs-lookup"><span data-stu-id="874b3-698">Add a `<PackageTags>` property to a new or existing `<PropertyGroup>` with the GUID that you created:</span></span>

       ```xml
       <PropertyGroup>
         <PackageTags>9412ee86-c21b-4eb8-bd89-f650fbf44931</PackageTags>
       </PropertyGroup>
       ```

   <span data-ttu-id="874b3-699">No exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-699">In the following example:</span></span>

   * <span data-ttu-id="874b3-700">O endereço IP local do servidor é `10.0.0.4`.</span><span class="sxs-lookup"><span data-stu-id="874b3-700">The local IP address of the server is `10.0.0.4`.</span></span>
   * <span data-ttu-id="874b3-701">Um gerador GUID aleatório online fornece o valor `appid`.</span><span class="sxs-lookup"><span data-stu-id="874b3-701">An online random GUID generator provides the `appid` value.</span></span>

   ```console
   netsh http add sslcert 
       ipport=10.0.0.4:443 
       certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
       appid="{9412ee86-c21b-4eb8-bd89-f650fbf44931}"
   ```

   <span data-ttu-id="874b3-702">Quando um certificado é registrado, a ferramenta responde com `SSL Certificate successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-702">When a certificate is registered, the tool responds with `SSL Certificate successfully added`.</span></span>

   <span data-ttu-id="874b3-703">Para excluir um registro de certificado, use o comando `delete sslcert`:</span><span class="sxs-lookup"><span data-stu-id="874b3-703">To delete a certificate registration, use the `delete sslcert` command:</span></span>

   ```console
   netsh http delete sslcert ipport=<IP>:<PORT>
   ```

   <span data-ttu-id="874b3-704">Documentação de referência do *netsh.exe*:</span><span class="sxs-lookup"><span data-stu-id="874b3-704">Reference documentation for *netsh.exe*:</span></span>

   * [<span data-ttu-id="874b3-705">Comandos Netsh para HTTP (Hypertext Transfer Protocol)</span><span class="sxs-lookup"><span data-stu-id="874b3-705">Netsh Commands for Hypertext Transfer Protocol (HTTP)</span></span>](https://technet.microsoft.com/library/cc725882.aspx)
   * [<span data-ttu-id="874b3-706">Cadeias de caracteres de UrlPrefix</span><span class="sxs-lookup"><span data-stu-id="874b3-706">UrlPrefix Strings</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx)

1. <span data-ttu-id="874b3-707">Execute o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-707">Run the app.</span></span>

   <span data-ttu-id="874b3-708">Não é necessário ter privilégios de administrador para executar o aplicativo ao associar ao localhost usando HTTP (não HTTPS) com um número de porta maior do que 1024.</span><span class="sxs-lookup"><span data-stu-id="874b3-708">Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024.</span></span> <span data-ttu-id="874b3-709">Para outras configurações (por exemplo, usar um endereço IP local ou associação à porta 443), execute o aplicativo com privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-709">For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</span></span>

   <span data-ttu-id="874b3-710">O aplicativo responde no endereço IP público do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-710">The app responds at the server's public IP address.</span></span> <span data-ttu-id="874b3-711">Neste exemplo, o servidor é acessado pela Internet como seu endereço IP público de `104.214.79.47`.</span><span class="sxs-lookup"><span data-stu-id="874b3-711">In this example, the server is reached from the Internet at its public IP address of `104.214.79.47`.</span></span>

   <span data-ttu-id="874b3-712">Um certificado de desenvolvimento é usado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="874b3-712">A development certificate is used in this example.</span></span> <span data-ttu-id="874b3-713">A página é carregada com segurança após ignorar o aviso de certificado não confiável do navegador.</span><span class="sxs-lookup"><span data-stu-id="874b3-713">The page loads securely after bypassing the browser's untrusted certificate warning.</span></span>

   ![Janela do navegador mostrando a página de Índice do aplicativo carregada](httpsys/_static/browser.png)

## <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="874b3-715">Servidor proxy e cenários de balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="874b3-715">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="874b3-716">Para aplicativos hospedados pelo HTTP.sys que interagem com solicitações da Internet ou de uma rede corporativa, podem ser necessárias configurações adicionais ao hospedar atrás de balanceadores de carga e de servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="874b3-716">For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers.</span></span> <span data-ttu-id="874b3-717">Para obter mais informações, veja [Configurar o ASP.NET Core para trabalhar com servidores proxy e balanceadores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="874b3-717">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="874b3-718">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="874b3-718">Additional resources</span></span>

* [<span data-ttu-id="874b3-719">Habilitar a autenticação do Windows com HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-719">Enable Windows Authentication with HTTP.sys</span></span>](xref:security/authentication/windowsauth#httpsys)
* [<span data-ttu-id="874b3-720">API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="874b3-720">HTTP Server API</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364510.aspx)
* [<span data-ttu-id="874b3-721">Repositório aspnet/HttpSysServer do GitHub (código-fonte)</span><span class="sxs-lookup"><span data-stu-id="874b3-721">aspnet/HttpSysServer GitHub repository (source code)</span></span>](https://github.com/aspnet/HttpSysServer/)
* [<span data-ttu-id="874b3-722">O host</span><span class="sxs-lookup"><span data-stu-id="874b3-722">The host</span></span>](xref:fundamentals/index#host)
* <xref:test/troubleshoot>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="874b3-723">O [HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) é um [servidor Web para ASP.NET Core](xref:fundamentals/servers/index) executado apenas no Windows.</span><span class="sxs-lookup"><span data-stu-id="874b3-723">[HTTP.sys](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys) is a [web server for ASP.NET Core](xref:fundamentals/servers/index) that only runs on Windows.</span></span> <span data-ttu-id="874b3-724">O HTTP.sys é uma alternativa ao servidor [Kestrel](xref:fundamentals/servers/kestrel) e oferece alguns recursos não disponibilizados pelo Kestrel.</span><span class="sxs-lookup"><span data-stu-id="874b3-724">HTTP.sys is an alternative to [Kestrel](xref:fundamentals/servers/kestrel) server and offers some features that Kestrel doesn't provide.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="874b3-725">O HTTP.sys não é compatível com o [Módulo do ASP.NET Core](xref:host-and-deploy/aspnet-core-module) e não pode ser usado com IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-725">HTTP.sys isn't compatible with the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) and can't be used with IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-726">O HTTP.sys dá suporte aos seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="874b3-726">HTTP.sys supports the following features:</span></span>

* [<span data-ttu-id="874b3-727">Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="874b3-727">Windows Authentication</span></span>](xref:security/authentication/windowsauth)
* <span data-ttu-id="874b3-728">Compartilhamento de porta</span><span class="sxs-lookup"><span data-stu-id="874b3-728">Port sharing</span></span>
* <span data-ttu-id="874b3-729">HTTPS com SNI</span><span class="sxs-lookup"><span data-stu-id="874b3-729">HTTPS with SNI</span></span>
* <span data-ttu-id="874b3-730">HTTP/2 sobre TLS (Windows 10 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-730">HTTP/2 over TLS (Windows 10 or later)</span></span>
* <span data-ttu-id="874b3-731">Transmissão direta de arquivo</span><span class="sxs-lookup"><span data-stu-id="874b3-731">Direct file transmission</span></span>
* <span data-ttu-id="874b3-732">Cache de resposta</span><span class="sxs-lookup"><span data-stu-id="874b3-732">Response caching</span></span>
* <span data-ttu-id="874b3-733">WebSockets (Windows 8 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="874b3-733">WebSockets (Windows 8 or later)</span></span>

<span data-ttu-id="874b3-734">Versões do Windows com suporte:</span><span class="sxs-lookup"><span data-stu-id="874b3-734">Supported Windows versions:</span></span>

* <span data-ttu-id="874b3-735">Windows 7 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-735">Windows 7 or later</span></span>
* <span data-ttu-id="874b3-736">Windows Server 2008 R2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-736">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="874b3-737">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="874b3-737">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/servers/httpsys/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="when-to-use-httpsys"></a><span data-ttu-id="874b3-738">Quando usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-738">When to use HTTP.sys</span></span>

<span data-ttu-id="874b3-739">O HTTP.sys é útil nas implantações em que:</span><span class="sxs-lookup"><span data-stu-id="874b3-739">HTTP.sys is useful for deployments where:</span></span>

* <span data-ttu-id="874b3-740">É necessário expor o servidor diretamente à Internet sem usar o IIS.</span><span class="sxs-lookup"><span data-stu-id="874b3-740">There's a need to expose the server directly to the Internet without using IIS.</span></span>

  ![O HTTP.sys se comunica diretamente com a Internet](httpsys/_static/httpsys-to-internet.png)

* <span data-ttu-id="874b3-742">As implantações internas exigem um recurso que não está disponível no Kestrel, como a [Autenticação do Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="874b3-742">An internal deployment requires a feature not available in Kestrel, such as [Windows Authentication](xref:security/authentication/windowsauth).</span></span>

  ![O HTTP.sys se comunica diretamente com a rede interna](httpsys/_static/httpsys-to-internal.png)

<span data-ttu-id="874b3-744">O HTTP.sys é uma tecnologia madura que protege contra vários tipos de ataques e proporciona as propriedades de robustez, segurança e escalabilidade de um servidor Web completo.</span><span class="sxs-lookup"><span data-stu-id="874b3-744">HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server.</span></span> <span data-ttu-id="874b3-745">O próprio IIS é executado como um ouvinte HTTP sobre o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-745">IIS itself runs as an HTTP listener on top of HTTP.sys.</span></span>

## <a name="http2-support"></a><span data-ttu-id="874b3-746">Suporte do HTTP/2</span><span class="sxs-lookup"><span data-stu-id="874b3-746">HTTP/2 support</span></span>

<span data-ttu-id="874b3-747">O [HTTP/2](https://httpwg.org/specs/rfc7540.html) estará habilitado para aplicativos ASP.NET Core se os seguintes requisitos básicos forem atendidos:</span><span class="sxs-lookup"><span data-stu-id="874b3-747">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is enabled for ASP.NET Core apps if the following base requirements are met:</span></span>

* <span data-ttu-id="874b3-748">Windows Server 2016/Windows 10 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-748">Windows Server 2016/Windows 10 or later</span></span>
* <span data-ttu-id="874b3-749">Conexão [ALPN (Negociação de protocolo de camada de aplicativo)](https://tools.ietf.org/html/rfc7301#section-3)</span><span class="sxs-lookup"><span data-stu-id="874b3-749">[Application-Layer Protocol Negotiation (ALPN)](https://tools.ietf.org/html/rfc7301#section-3) connection</span></span>
* <span data-ttu-id="874b3-750">Conexão TLS 1.2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="874b3-750">TLS 1.2 or later connection</span></span>

<span data-ttu-id="874b3-751">Se uma conexão HTTP/2 for estabelecida, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) relatará `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="874b3-751">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="874b3-752">O HTTP/2 está habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="874b3-752">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="874b3-753">Se uma conexão HTTP/2 não tiver sido estabelecida, a conexão retornará para HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="874b3-753">If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1.</span></span> <span data-ttu-id="874b3-754">Em uma versão futura do Windows, os sinalizadores de configuração de HTTP/2 estarão disponíveis e contarão com a capacidade de desabilitar o HTTP/2 com HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-754">In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</span></span>

## <a name="kernel-mode-authentication-with-kerberos"></a><span data-ttu-id="874b3-755">Autenticação de modo kernel com Kerberos</span><span class="sxs-lookup"><span data-stu-id="874b3-755">Kernel mode authentication with Kerberos</span></span>

<span data-ttu-id="874b3-756">O HTTP.sys delega à autenticação de modo kernel com o protocolo de autenticação Kerberos.</span><span class="sxs-lookup"><span data-stu-id="874b3-756">HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol.</span></span> <span data-ttu-id="874b3-757">Não há suporte para autenticação de modo de usuário com o Kerberos e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-757">User mode authentication isn't supported with Kerberos and HTTP.sys.</span></span> <span data-ttu-id="874b3-758">A conta do computador precisa ser usada para descriptografar o token/tíquete do Kerberos que é obtido do Active Directory e encaminhado pelo cliente ao servidor para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="874b3-758">The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user.</span></span> <span data-ttu-id="874b3-759">Registre o SPN (nome da entidade de serviço) do host, não do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-759">Register the Service Principal Name (SPN) for the host, not the user of the app.</span></span>

## <a name="how-to-use-httpsys"></a><span data-ttu-id="874b3-760">Como usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-760">How to use HTTP.sys</span></span>

### <a name="configure-the-aspnet-core-app-to-use-httpsys"></a><span data-ttu-id="874b3-761">Configurar o aplicativo ASP.NET Core para usar o HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-761">Configure the ASP.NET Core app to use HTTP.sys</span></span>

<span data-ttu-id="874b3-762">Uma referência de pacote no arquivo de projeto não é necessária ao usar o [metapacote Microsoft. AspNetCore. app](xref:fundamentals/metapackage-app) ([NuGet.org](https://www.nuget.org/packages/Microsoft.AspNetCore.App/)).</span><span class="sxs-lookup"><span data-stu-id="874b3-762">A package reference in the project file isn't required when using the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) ([nuget.org](https://www.nuget.org/packages/Microsoft.AspNetCore.App/)).</span></span> <span data-ttu-id="874b3-763">Se não estiver usando o metapacote `Microsoft.AspNetCore.App`, adicione uma referência do pacote a [Microsoft.AspNetCore.Server.HttpSys](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.HttpSys/).</span><span class="sxs-lookup"><span data-stu-id="874b3-763">When not using the `Microsoft.AspNetCore.App` metapackage, add a package reference to [Microsoft.AspNetCore.Server.HttpSys](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.HttpSys/).</span></span>

<span data-ttu-id="874b3-764">Chame o método de extensão <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> ao compilar o host, especificando qualquer <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions> necessária.</span><span class="sxs-lookup"><span data-stu-id="874b3-764">Call the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderHttpSysExtensions.UseHttpSys*> extension method when building the host, specifying any required <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions>.</span></span> <span data-ttu-id="874b3-765">O exemplo a seguir define as opções para seus valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-765">The following example sets options to their default values:</span></span>

[!code-csharp[](httpsys/samples/2.x/SampleApp/Program.cs?name=snippet1&highlight=4-12)]

<span data-ttu-id="874b3-766">A configuração adicional do HTTP.sys é tratada por meio das [configurações do registro](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span><span class="sxs-lookup"><span data-stu-id="874b3-766">Additional HTTP.sys configuration is handled through [registry settings](https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows).</span></span>

<span data-ttu-id="874b3-767">**Opções do HTTP.sys**</span><span class="sxs-lookup"><span data-stu-id="874b3-767">**HTTP.sys options**</span></span>

| <span data-ttu-id="874b3-768">Propriedade</span><span class="sxs-lookup"><span data-stu-id="874b3-768">Property</span></span> | <span data-ttu-id="874b3-769">Descrição</span><span class="sxs-lookup"><span data-stu-id="874b3-769">Description</span></span> | <span data-ttu-id="874b3-770">Padrão</span><span class="sxs-lookup"><span data-stu-id="874b3-770">Default</span></span> |
| ---
<span data-ttu-id="874b3-771">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-771">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-772">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-772">'Blazor'</span></span>
- <span data-ttu-id="874b3-773">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-773">'Identity'</span></span>
- <span data-ttu-id="874b3-774">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-774">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-775">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-775">'Razor'</span></span>
- <span data-ttu-id="874b3-776">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-776">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-777">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-777">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-778">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-778">'Blazor'</span></span>
- <span data-ttu-id="874b3-779">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-779">'Identity'</span></span>
- <span data-ttu-id="874b3-780">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-780">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-781">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-781">'Razor'</span></span>
- <span data-ttu-id="874b3-782">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-782">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-783">---- | título do---: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-783">---- | --- title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-784">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-784">'Blazor'</span></span>
- <span data-ttu-id="874b3-785">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-785">'Identity'</span></span>
- <span data-ttu-id="874b3-786">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-786">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-787">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-787">'Razor'</span></span>
- <span data-ttu-id="874b3-788">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-788">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-789">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-789">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-790">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-790">'Blazor'</span></span>
- <span data-ttu-id="874b3-791">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-791">'Identity'</span></span>
- <span data-ttu-id="874b3-792">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-792">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-793">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-793">'Razor'</span></span>
- <span data-ttu-id="874b3-794">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-794">'SignalR' uid:</span></span> 

-
<span data-ttu-id="874b3-795">Título: autor: Descrição: monikerRange: MS. autor: MS. Custom: MS. Date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="874b3-795">title: author: description: monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="874b3-796">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="874b3-796">'Blazor'</span></span>
- <span data-ttu-id="874b3-797">'Identity'</span><span class="sxs-lookup"><span data-stu-id="874b3-797">'Identity'</span></span>
- <span data-ttu-id="874b3-798">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="874b3-798">'Let's Encrypt'</span></span>
- <span data-ttu-id="874b3-799">'Razor'</span><span class="sxs-lookup"><span data-stu-id="874b3-799">'Razor'</span></span>
- <span data-ttu-id="874b3-800">SignalRuid ' ':</span><span class="sxs-lookup"><span data-stu-id="874b3-800">'SignalR' uid:</span></span> 

<span data-ttu-id="874b3-801">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Controlar se a entrada/saída síncrona é permitida para o `HttpContext.Request.Body` e o `HttpContext.Response.Body` .</span><span class="sxs-lookup"><span data-stu-id="874b3-801">------ | :-----: | | [AllowSynchronousIO](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.AllowSynchronousIO) | Control whether synchronous input/output is allowed for the `HttpContext.Request.Body` and `HttpContext.Response.Body`.</span></span><span data-ttu-id="874b3-802"> | `true`| | [Authentication. AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Permitir solicitações anônimas.</span><span class="sxs-lookup"><span data-stu-id="874b3-802"> | `true` | | [Authentication.AllowAnonymous](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.AllowAnonymous) | Allow anonymous requests.</span></span><span data-ttu-id="874b3-803"> | `true`| | [Autenticação. esquemas](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Especifique os esquemas de autenticação permitidos.</span><span class="sxs-lookup"><span data-stu-id="874b3-803"> | `true` | | [Authentication.Schemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationManager.Schemes) | Specify the allowed authentication schemes.</span></span> <span data-ttu-id="874b3-804">É possível modificar a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-804">May be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-805">Os valores são fornecidos pela [Enumeração AuthenticationSchemes](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic` , `Kerberos` , `Negotiate` , `None` e `NTLM` .</span><span class="sxs-lookup"><span data-stu-id="874b3-805">Values are provided by the [AuthenticationSchemes enum](xref:Microsoft.AspNetCore.Server.HttpSys.AuthenticationSchemes): `Basic`, `Kerberos`, `Negotiate`, `None`, and `NTLM`.</span></span><span data-ttu-id="874b3-806"> | `None`| | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Tente o cache do [modo kernel](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) para obter respostas com cabeçalhos qualificados.</span><span class="sxs-lookup"><span data-stu-id="874b3-806"> | `None` | | [EnableResponseCaching](xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.EnableResponseCaching) | Attempt [kernel-mode](/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode) caching for responses with eligible headers.</span></span> <span data-ttu-id="874b3-807">A resposta pode não incluir `Set-Cookie`, `Vary` ou cabeçalhos `Pragma`.</span><span class="sxs-lookup"><span data-stu-id="874b3-807">The response may not include `Set-Cookie`, `Vary`, or `Pragma` headers.</span></span> <span data-ttu-id="874b3-808">Ela deve incluir um cabeçalho `Cache-Control` que seja `public` e um valor `shared-max-age` ou `max-age`, ou um cabeçalho `Expires`.</span><span class="sxs-lookup"><span data-stu-id="874b3-808">It must include a `Cache-Control` header that's `public` and either a `shared-max-age` or `max-age` value, or an `Expires` header.</span></span><span data-ttu-id="874b3-809"> | `true`| | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | O número máximo de aceitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="874b3-809"> | `true` | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxAccepts> | The maximum number of concurrent accepts.</span></span> <span data-ttu-id="874b3-810">| 5 &times; [ambiente. <br> ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | O número máximo de conexões simultâneas a serem aceitas.</span><span class="sxs-lookup"><span data-stu-id="874b3-810">| 5 &times; [Environment.<br>ProcessorCount](xref:System.Environment.ProcessorCount) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxConnections> | The maximum number of concurrent connections to accept.</span></span> <span data-ttu-id="874b3-811">Usar `-1` como infinito.</span><span class="sxs-lookup"><span data-stu-id="874b3-811">Use `-1` for infinite.</span></span> <span data-ttu-id="874b3-812">Usar `null` a fim de usar a configuração que abranja toda máquina do registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-812">Use `null` to use the registry's machine-wide setting.</span></span> | `null`<br><span data-ttu-id="874b3-813">(em todo o computador</span><span class="sxs-lookup"><span data-stu-id="874b3-813">(machine-wide</span></span><br><span data-ttu-id="874b3-814">configuração) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | Consulte a seção <a href="#maxrequestbodysize">MaxRequestBodySize</a> .</span><span class="sxs-lookup"><span data-stu-id="874b3-814">setting) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> | See the <a href="#maxrequestbodysize">MaxRequestBodySize</a> section.</span></span> <span data-ttu-id="874b3-815">| 30 milhões bytes</span><span class="sxs-lookup"><span data-stu-id="874b3-815">| 30000000 bytes</span></span><br><span data-ttu-id="874b3-816">(~ 28,6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | O número máximo de solicitações que podem ser enfileiradas.</span><span class="sxs-lookup"><span data-stu-id="874b3-816">(~28.6 MB) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.RequestQueueLimit> | The maximum number of requests that can be queued.</span></span> <span data-ttu-id="874b3-817">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indique se as gravações do corpo da resposta que falham devido a desconexões do cliente devem lançar exceções ou concluídas normalmente.</span><span class="sxs-lookup"><span data-stu-id="874b3-817">| 1000 | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.ThrowWriteExceptions> | Indicate if response body writes that fail due to client disconnects should throw exceptions or complete normally.</span></span> | `false`<br><span data-ttu-id="874b3-818">(concluído normalmente) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expor a configuração de HTTP. sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> , que também pode ser configurada no registro.</span><span class="sxs-lookup"><span data-stu-id="874b3-818">(complete normally) | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.Timeouts> | Expose the HTTP.sys <xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager> configuration, which may also be configured in the registry.</span></span> <span data-ttu-id="874b3-819">Siga os links de API para saber mais sobre cada configuração, inclusive os valores padrão:</span><span class="sxs-lookup"><span data-stu-id="874b3-819">Follow the API links to learn more about each setting, including default values:</span></span><ul><li><span data-ttu-id="874b3-820">[Timeoutmanager. DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): tempo permitido para a API do servidor http drenar o corpo da entidade em uma conexão Keep-Alive.</span><span class="sxs-lookup"><span data-stu-id="874b3-820">[TimeoutManager.DrainEntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.DrainEntityBody): Time allowed for the HTTP Server API to drain the entity body on a Keep-Alive connection.</span></span></li><li><span data-ttu-id="874b3-821">[Timeoutmanager. EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): tempo permitido para o corpo da entidade de solicitação chegar.</span><span class="sxs-lookup"><span data-stu-id="874b3-821">[TimeoutManager.EntityBody](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.EntityBody): Time allowed for the request entity body to arrive.</span></span></li><li><span data-ttu-id="874b3-822">[Timeoutmanager. HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): tempo permitido para a API do servidor http analisar o cabeçalho da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-822">[TimeoutManager.HeaderWait](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.HeaderWait): Time allowed for the HTTP Server API to parse the request header.</span></span></li><li><span data-ttu-id="874b3-823">[Timeoutmanager. IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): tempo permitido para uma conexão ociosa.</span><span class="sxs-lookup"><span data-stu-id="874b3-823">[TimeoutManager.IdleConnection](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.IdleConnection): Time allowed for an idle connection.</span></span></li><li><span data-ttu-id="874b3-824">[Timeoutmanager. MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): a taxa mínima de envio para a resposta.</span><span class="sxs-lookup"><span data-stu-id="874b3-824">[TimeoutManager.MinSendBytesPerSecond](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.MinSendBytesPerSecond): The minimum send rate for the response.</span></span></li><li><span data-ttu-id="874b3-825">[Timeoutmanager. RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): tempo permitido para a solicitação permanecer na fila de solicitações antes que o aplicativo a pegue.</span><span class="sxs-lookup"><span data-stu-id="874b3-825">[TimeoutManager.RequestQueue](xref:Microsoft.AspNetCore.Server.HttpSys.TimeoutManager.RequestQueue): Time allowed for the request to remain in the request queue before the app picks it up.</span></span></li></ul> <span data-ttu-id="874b3-826">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Especifique o <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> a ser registrado com http. sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-826">|  | | <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> | Specify the <xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection> to register with HTTP.sys.</span></span> <span data-ttu-id="874b3-827">A mais útil é [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), que é usada para adicionar um prefixo à coleção.</span><span class="sxs-lookup"><span data-stu-id="874b3-827">The most useful is [UrlPrefixCollection.Add](xref:Microsoft.AspNetCore.Server.HttpSys.UrlPrefixCollection.Add*), which is used to add a prefix to the collection.</span></span> <span data-ttu-id="874b3-828">É possível modificá-las a qualquer momento antes de descartar o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="874b3-828">These may be modified at any time prior to disposing the listener.</span></span> <span data-ttu-id="874b3-829">|  |</span><span class="sxs-lookup"><span data-stu-id="874b3-829">|  |</span></span>

<a name="maxrequestbodysize"></a>

<span data-ttu-id="874b3-830">**MaxRequestBodySize**</span><span class="sxs-lookup"><span data-stu-id="874b3-830">**MaxRequestBodySize**</span></span>

<span data-ttu-id="874b3-831">O tamanho máximo permitido em bytes para todos os corpos de solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-831">The maximum allowed size of any request body in bytes.</span></span> <span data-ttu-id="874b3-832">Quando é definido como `null`, o tamanho máximo do corpo da solicitação é ilimitado.</span><span class="sxs-lookup"><span data-stu-id="874b3-832">When set to `null`, the maximum request body size is unlimited.</span></span> <span data-ttu-id="874b3-833">Esse limite não afeta as conexões atualizadas que são sempre ilimitadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-833">This limit has no effect on upgraded connections, which are always unlimited.</span></span>

<span data-ttu-id="874b3-834">O método recomendado para substituir o limite em um aplicativo ASP.NET Core MVC para um único `IActionResult` é usar o atributo <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> em um método de ação:</span><span class="sxs-lookup"><span data-stu-id="874b3-834">The recommended method to override the limit in an ASP.NET Core MVC app for a single `IActionResult` is to use the <xref:Microsoft.AspNetCore.Mvc.RequestSizeLimitAttribute> attribute on an action method:</span></span>

```csharp
[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
```

<span data-ttu-id="874b3-835">Uma exceção é gerada quando o aplicativo tenta configurar o limite de uma solicitação, depois que o aplicativo inicia a leitura da solicitação.</span><span class="sxs-lookup"><span data-stu-id="874b3-835">An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request.</span></span> <span data-ttu-id="874b3-836">É possível usar uma propriedade `IsReadOnly` para indicar se a propriedade `MaxRequestBodySize` está no estado somente leitura, o que significa que é tarde demais para configurar o limite.</span><span class="sxs-lookup"><span data-stu-id="874b3-836">An `IsReadOnly` property can be used to indicate if the `MaxRequestBodySize` property is in a read-only state, meaning it's too late to configure the limit.</span></span>

<span data-ttu-id="874b3-837">Se o aplicativo precisar substituir <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> mediante solicitação, use o <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span><span class="sxs-lookup"><span data-stu-id="874b3-837">If the app should override <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.MaxRequestBodySize> per-request, use the <xref:Microsoft.AspNetCore.Http.Features.IHttpMaxRequestBodySizeFeature>:</span></span>

[!code-csharp[](httpsys/samples/2.x/SampleApp/Startup.cs?name=snippet1&highlight=6-7)]

<span data-ttu-id="874b3-838">Quando usar o Visual Studio, verifique se que o aplicativo está configurado para executar o IIS ou IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-838">If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</span></span>

<span data-ttu-id="874b3-839">No Visual Studio, o perfil de inicialização padrão destina-se ao IIS Express.</span><span class="sxs-lookup"><span data-stu-id="874b3-839">In Visual Studio, the default launch profile is for IIS Express.</span></span> <span data-ttu-id="874b3-840">Para executar o projeto como um aplicativo de console, altere manualmente o perfil selecionado, conforme mostrado na captura de tela a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-840">To run the project as a console app, manually change the selected profile, as shown in the following screen shot:</span></span>

![Selecionar o perfil do aplicativo de console](httpsys/_static/vs-choose-profile.png)

### <a name="configure-windows-server"></a><span data-ttu-id="874b3-842">Configurar o Windows Server</span><span class="sxs-lookup"><span data-stu-id="874b3-842">Configure Windows Server</span></span>

1. <span data-ttu-id="874b3-843">Determine as portas que serão abertas para o aplicativo e use o [Firewall do Windows](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) ou o cmdlet do PowerShell [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) para abrir as portas de firewall e permitir que o tráfego chegue até o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-843">Determine the ports to open for the app and use [Windows Firewall](/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule) or the [New-NetFirewallRule](/powershell/module/netsecurity/new-netfirewallrule) PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys.</span></span> <span data-ttu-id="874b3-844">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-844">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-845">Ao implantar em uma VM do Azure, abra as portas no [Grupo de Segurança de Rede](/azure/virtual-machines/windows/nsg-quickstart-portal).</span><span class="sxs-lookup"><span data-stu-id="874b3-845">When deploying to an Azure VM, open the ports in the [Network Security Group](/azure/virtual-machines/windows/nsg-quickstart-portal).</span></span> <span data-ttu-id="874b3-846">Nos seguintes comandos e configuração de aplicativo, a porta 443 é usada.</span><span class="sxs-lookup"><span data-stu-id="874b3-846">In the following commands and app configuration, port 443 is used.</span></span>

1. <span data-ttu-id="874b3-847">Obtenha e instale os certificados X.509, se precisar.</span><span class="sxs-lookup"><span data-stu-id="874b3-847">Obtain and install X.509 certificates, if required.</span></span>

   <span data-ttu-id="874b3-848">No Windows, crie certificados autoassinados, usando o [cmdlet do PowerShell New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate).</span><span class="sxs-lookup"><span data-stu-id="874b3-848">On Windows, create self-signed certificates using the [New-SelfSignedCertificate PowerShell cmdlet](/powershell/module/pkiclient/new-selfsignedcertificate).</span></span> <span data-ttu-id="874b3-849">Para ver um exemplo sem suporte, confira [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span><span class="sxs-lookup"><span data-stu-id="874b3-849">For an unsupported example, see [UpdateIISExpressSSLForChrome.ps1](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1).</span></span>

   <span data-ttu-id="874b3-850">Instale certificados autoassinados ou assinados pela AC no repositório **Computador Local** > **Pessoal** do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-850">Install either self-signed or CA-signed certificates in the server's **Local Machine** > **Personal** store.</span></span>

1. <span data-ttu-id="874b3-851">Se o aplicativo for uma [implantação dependente de estrutura](/dotnet/core/deploying/#framework-dependent-deployments-fdd), instale o .NET Core, o .NET Framework ou ambos (caso o aplicativo .NET Core seja direcionado ao .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="874b3-851">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), install .NET Core, .NET Framework, or both (if the app is a .NET Core app targeting the .NET Framework).</span></span>

   * <span data-ttu-id="874b3-852">**.NET Core**: se o aplicativo exigir o .NET Core, obtenha e execute o instalador do **.NET Core Runtime** de [downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-852">**.NET Core**: If the app requires .NET Core, obtain and run the **.NET Core Runtime** installer from [.NET Core Downloads](https://dotnet.microsoft.com/download).</span></span> <span data-ttu-id="874b3-853">Não instale o SDK completo no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-853">Don't install the full SDK on the server.</span></span>
   * <span data-ttu-id="874b3-854">**.NET Framework**: se o aplicativo exigir .NET Framework, consulte o [Guia de instalação do .NET Framework](/dotnet/framework/install/).</span><span class="sxs-lookup"><span data-stu-id="874b3-854">**.NET Framework**: If the app requires .NET Framework, see the [.NET Framework installation guide](/dotnet/framework/install/).</span></span> <span data-ttu-id="874b3-855">Instale o .NET Framework necessário.</span><span class="sxs-lookup"><span data-stu-id="874b3-855">Install the required .NET Framework.</span></span> <span data-ttu-id="874b3-856">O instalador do .NET Framework mais recente está disponível na página [Downloads do .NET Core](https://dotnet.microsoft.com/download).</span><span class="sxs-lookup"><span data-stu-id="874b3-856">The installer for the latest .NET Framework is available from the [.NET Core Downloads](https://dotnet.microsoft.com/download) page.</span></span>

   <span data-ttu-id="874b3-857">Se o aplicativo for uma [implantação autocontida](/dotnet/core/deploying/#self-contained-deployments-scd), ele incluirá o runtime em sua implantação.</span><span class="sxs-lookup"><span data-stu-id="874b3-857">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), the app includes the runtime in its deployment.</span></span> <span data-ttu-id="874b3-858">Nenhuma instalação do framework é necessária no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-858">No framework installation is required on the server.</span></span>

1. <span data-ttu-id="874b3-859">Configure URLs e portas no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-859">Configure URLs and ports in the app.</span></span>

   <span data-ttu-id="874b3-860">Por padrão, o ASP.NET Core é associado a `http://localhost:5000`.</span><span class="sxs-lookup"><span data-stu-id="874b3-860">By default, ASP.NET Core binds to `http://localhost:5000`.</span></span> <span data-ttu-id="874b3-861">Para configurar portas e prefixos de URL, as opções incluem:</span><span class="sxs-lookup"><span data-stu-id="874b3-861">To configure URL prefixes and ports, options include:</span></span>

   * <xref:Microsoft.AspNetCore.Hosting.HostingAbstractionsWebHostBuilderExtensions.UseUrls*>
   * <span data-ttu-id="874b3-862">O argumento de linha de comando `urls`</span><span class="sxs-lookup"><span data-stu-id="874b3-862">`urls` command-line argument</span></span>
   * <span data-ttu-id="874b3-863">A variável de ambiente `ASPNETCORE_URLS`</span><span class="sxs-lookup"><span data-stu-id="874b3-863">`ASPNETCORE_URLS` environment variable</span></span>
   * <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes>

   <span data-ttu-id="874b3-864">O exemplo de código a seguir mostra como usar <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> com o endereço IP local do servidor `10.0.0.4` na porta 443:</span><span class="sxs-lookup"><span data-stu-id="874b3-864">The following code example shows how to use <xref:Microsoft.AspNetCore.Server.HttpSys.HttpSysOptions.UrlPrefixes> with the server's local IP address `10.0.0.4` on port 443:</span></span>

   [!code-csharp[](httpsys/samples_snapshot/2.x/Program.cs?highlight=6)]

   <span data-ttu-id="874b3-865">Uma vantagem de usar `UrlPrefixes` é que uma mensagem de erro é gerada imediatamente no caso de prefixos formatados de forma incorreta.</span><span class="sxs-lookup"><span data-stu-id="874b3-865">An advantage of `UrlPrefixes` is that an error message is generated immediately for improperly formatted prefixes.</span></span>

   <span data-ttu-id="874b3-866">As configurações de `UrlPrefixes` substituem as configurações `UseUrls`/`urls`/`ASPNETCORE_URLS`.</span><span class="sxs-lookup"><span data-stu-id="874b3-866">The settings in `UrlPrefixes` override `UseUrls`/`urls`/`ASPNETCORE_URLS` settings.</span></span> <span data-ttu-id="874b3-867">Portanto, uma vantagem de usar `UseUrls`, `urls` e a variável de ambiente `ASPNETCORE_URLS` é que fica mais fácil alternar entre o Kestrel e o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-867">Therefore, an advantage of `UseUrls`, `urls`, and the `ASPNETCORE_URLS` environment variable is that it's easier to switch between Kestrel and HTTP.sys.</span></span>

   <span data-ttu-id="874b3-868">O HTTP.sys usa os [formatos de cadeia de caracteres UrlPrefix da API do Servidor HTTP](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span><span class="sxs-lookup"><span data-stu-id="874b3-868">HTTP.sys uses the [HTTP Server API UrlPrefix string formats](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx).</span></span>

   > [!WARNING]
   > <span data-ttu-id="874b3-869">Associações de curinga de nível superior (`http://*:80/` e `http://+:80`) **não** devem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="874b3-869">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="874b3-870">Associações de curinga de nível superior criam vulnerabilidades de segurança no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-870">Top-level wildcard bindings create app security vulnerabilities.</span></span> <span data-ttu-id="874b3-871">Isso se aplica a curingas fortes e fracos.</span><span class="sxs-lookup"><span data-stu-id="874b3-871">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="874b3-872">Use nomes de host explícitos ou endereços IP em vez de curingas.</span><span class="sxs-lookup"><span data-stu-id="874b3-872">Use explicit host names or IP addresses rather than wildcards.</span></span> <span data-ttu-id="874b3-873">Associações de curinga de subdomínio (por exemplo, `*.mysub.com`) não serão um risco à segurança se você controlar todo o domínio pai (ao contrário de `*.com`, o qual é vulnerável).</span><span class="sxs-lookup"><span data-stu-id="874b3-873">Subdomain wildcard binding (for example, `*.mysub.com`) isn't a security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="874b3-874">Para obter mais informações, consulte [RFC 7230: Section 5,4: host](https://tools.ietf.org/html/rfc7230#section-5.4).</span><span class="sxs-lookup"><span data-stu-id="874b3-874">For more information, see [RFC 7230: Section 5.4: Host](https://tools.ietf.org/html/rfc7230#section-5.4).</span></span>

1. <span data-ttu-id="874b3-875">Pré-registre os prefixos de URL no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-875">Preregister URL prefixes on the server.</span></span>

   <span data-ttu-id="874b3-876">O *netsh.exe* é a ferramenta interna destinada a configurar o HTTP.sys.</span><span class="sxs-lookup"><span data-stu-id="874b3-876">The built-in tool for configuring HTTP.sys is *netsh.exe*.</span></span> <span data-ttu-id="874b3-877">Com o *netsh.exe*, é possível reservar prefixos de URL e atribuir certificados X.509.</span><span class="sxs-lookup"><span data-stu-id="874b3-877">*netsh.exe* is used to reserve URL prefixes and assign X.509 certificates.</span></span> <span data-ttu-id="874b3-878">A ferramenta exige privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-878">The tool requires administrator privileges.</span></span>

   <span data-ttu-id="874b3-879">Use a ferramenta *netsh.exe* para registrar as URLs do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-879">Use the *netsh.exe* tool to register URLs for the app:</span></span>

   ```console
   netsh http add urlacl url=<URL> user=<USER>
   ```

   * <span data-ttu-id="874b3-880">`<URL>`: O Uniform Resource Locator (URL) totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="874b3-880">`<URL>`: The fully qualified Uniform Resource Locator (URL).</span></span> <span data-ttu-id="874b3-881">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-881">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-882">Use um nome de host válido ou o endereço IP local.</span><span class="sxs-lookup"><span data-stu-id="874b3-882">Use a valid hostname or local IP address.</span></span> <span data-ttu-id="874b3-883">*A URL deve incluir uma barra à direita.*</span><span class="sxs-lookup"><span data-stu-id="874b3-883">*The URL must include a trailing slash.*</span></span>
   * <span data-ttu-id="874b3-884">`<USER>`: Especifica o nome do usuário ou do grupo de usuários.</span><span class="sxs-lookup"><span data-stu-id="874b3-884">`<USER>`: Specifies the user or user-group name.</span></span>

   <span data-ttu-id="874b3-885">No exemplo a seguir, o endereço IP local do servidor é `10.0.0.4`:</span><span class="sxs-lookup"><span data-stu-id="874b3-885">In the following example, the local IP address of the server is `10.0.0.4`:</span></span>

   ```console
   netsh http add urlacl url=https://10.0.0.4:443/ user=Users
   ```

   <span data-ttu-id="874b3-886">Quando uma URL é registrada, a ferramenta responde com `URL reservation successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-886">When a URL is registered, the tool responds with `URL reservation successfully added`.</span></span>

   <span data-ttu-id="874b3-887">Para excluir uma URL registrada, use o comando `delete urlacl`:</span><span class="sxs-lookup"><span data-stu-id="874b3-887">To delete a registered URL, use the `delete urlacl` command:</span></span>

   ```console
   netsh http delete urlacl url=<URL>
   ```

1. <span data-ttu-id="874b3-888">Registre certificados X.509 no servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-888">Register X.509 certificates on the server.</span></span>

   <span data-ttu-id="874b3-889">Use a ferramenta *netsh.exe* para registrar certificados do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="874b3-889">Use the *netsh.exe* tool to register certificates for the app:</span></span>

   ```console
   netsh http add sslcert ipport=<IP>:<PORT> certhash=<THUMBPRINT> appid="{<GUID>}"
   ```

   * <span data-ttu-id="874b3-890">`<IP>`: Especifica o endereço IP local para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-890">`<IP>`: Specifies the local IP address for the binding.</span></span> <span data-ttu-id="874b3-891">Não use uma associação de curinga.</span><span class="sxs-lookup"><span data-stu-id="874b3-891">Don't use a wildcard binding.</span></span> <span data-ttu-id="874b3-892">Use um endereço IP válido.</span><span class="sxs-lookup"><span data-stu-id="874b3-892">Use a valid IP address.</span></span>
   * <span data-ttu-id="874b3-893">`<PORT>`: Especifica a porta para a associação.</span><span class="sxs-lookup"><span data-stu-id="874b3-893">`<PORT>`: Specifies the port for the binding.</span></span>
   * <span data-ttu-id="874b3-894">`<THUMBPRINT>`: A impressão digital do certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="874b3-894">`<THUMBPRINT>`: The X.509 certificate thumbprint.</span></span>
   * <span data-ttu-id="874b3-895">`<GUID>`: Um GUID gerado pelo desenvolvedor para representar o aplicativo para fins informativos.</span><span class="sxs-lookup"><span data-stu-id="874b3-895">`<GUID>`: A developer-generated GUID to represent the app for informational purposes.</span></span>

   <span data-ttu-id="874b3-896">Para fins de referência, armazene o GUID no aplicativo como uma marca de pacote:</span><span class="sxs-lookup"><span data-stu-id="874b3-896">For reference purposes, store the GUID in the app as a package tag:</span></span>

   * <span data-ttu-id="874b3-897">No Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-897">In Visual Studio:</span></span>
     * <span data-ttu-id="874b3-898">Abra as propriedades do projeto do aplicativo, clicando com o botão direito do mouse no aplicativo no **Gerenciador de Soluções** e selecionando **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="874b3-898">Open the app's project properties by right-clicking on the app in **Solution Explorer** and selecting **Properties**.</span></span>
     * <span data-ttu-id="874b3-899">Selecione a guia **Pacote**.</span><span class="sxs-lookup"><span data-stu-id="874b3-899">Select the **Package** tab.</span></span>
     * <span data-ttu-id="874b3-900">Insira o GUID que você criou no campo **Marcas**.</span><span class="sxs-lookup"><span data-stu-id="874b3-900">Enter the GUID that you created in the **Tags** field.</span></span>
   * <span data-ttu-id="874b3-901">Quando não estiver usando o Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="874b3-901">When not using Visual Studio:</span></span>
     * <span data-ttu-id="874b3-902">Abra o arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-902">Open the app's project file.</span></span>
     * <span data-ttu-id="874b3-903">Adicione uma propriedade `<PackageTags>` a um `<PropertyGroup>` novo ou existente com o GUID que você criou:</span><span class="sxs-lookup"><span data-stu-id="874b3-903">Add a `<PackageTags>` property to a new or existing `<PropertyGroup>` with the GUID that you created:</span></span>

       ```xml
       <PropertyGroup>
         <PackageTags>9412ee86-c21b-4eb8-bd89-f650fbf44931</PackageTags>
       </PropertyGroup>
       ```

   <span data-ttu-id="874b3-904">No exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="874b3-904">In the following example:</span></span>

   * <span data-ttu-id="874b3-905">O endereço IP local do servidor é `10.0.0.4`.</span><span class="sxs-lookup"><span data-stu-id="874b3-905">The local IP address of the server is `10.0.0.4`.</span></span>
   * <span data-ttu-id="874b3-906">Um gerador GUID aleatório online fornece o valor `appid`.</span><span class="sxs-lookup"><span data-stu-id="874b3-906">An online random GUID generator provides the `appid` value.</span></span>

   ```console
   netsh http add sslcert 
       ipport=10.0.0.4:443 
       certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
       appid="{9412ee86-c21b-4eb8-bd89-f650fbf44931}"
   ```

   <span data-ttu-id="874b3-907">Quando um certificado é registrado, a ferramenta responde com `SSL Certificate successfully added`.</span><span class="sxs-lookup"><span data-stu-id="874b3-907">When a certificate is registered, the tool responds with `SSL Certificate successfully added`.</span></span>

   <span data-ttu-id="874b3-908">Para excluir um registro de certificado, use o comando `delete sslcert`:</span><span class="sxs-lookup"><span data-stu-id="874b3-908">To delete a certificate registration, use the `delete sslcert` command:</span></span>

   ```console
   netsh http delete sslcert ipport=<IP>:<PORT>
   ```

   <span data-ttu-id="874b3-909">Documentação de referência do *netsh.exe*:</span><span class="sxs-lookup"><span data-stu-id="874b3-909">Reference documentation for *netsh.exe*:</span></span>

   * [<span data-ttu-id="874b3-910">Comandos Netsh para HTTP (Hypertext Transfer Protocol)</span><span class="sxs-lookup"><span data-stu-id="874b3-910">Netsh Commands for Hypertext Transfer Protocol (HTTP)</span></span>](https://technet.microsoft.com/library/cc725882.aspx)
   * [<span data-ttu-id="874b3-911">Cadeias de caracteres de UrlPrefix</span><span class="sxs-lookup"><span data-stu-id="874b3-911">UrlPrefix Strings</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364698.aspx)

1. <span data-ttu-id="874b3-912">Execute o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="874b3-912">Run the app.</span></span>

   <span data-ttu-id="874b3-913">Não é necessário ter privilégios de administrador para executar o aplicativo ao associar ao localhost usando HTTP (não HTTPS) com um número de porta maior do que 1024.</span><span class="sxs-lookup"><span data-stu-id="874b3-913">Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024.</span></span> <span data-ttu-id="874b3-914">Para outras configurações (por exemplo, usar um endereço IP local ou associação à porta 443), execute o aplicativo com privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="874b3-914">For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</span></span>

   <span data-ttu-id="874b3-915">O aplicativo responde no endereço IP público do servidor.</span><span class="sxs-lookup"><span data-stu-id="874b3-915">The app responds at the server's public IP address.</span></span> <span data-ttu-id="874b3-916">Neste exemplo, o servidor é acessado pela Internet como seu endereço IP público de `104.214.79.47`.</span><span class="sxs-lookup"><span data-stu-id="874b3-916">In this example, the server is reached from the Internet at its public IP address of `104.214.79.47`.</span></span>

   <span data-ttu-id="874b3-917">Um certificado de desenvolvimento é usado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="874b3-917">A development certificate is used in this example.</span></span> <span data-ttu-id="874b3-918">A página é carregada com segurança após ignorar o aviso de certificado não confiável do navegador.</span><span class="sxs-lookup"><span data-stu-id="874b3-918">The page loads securely after bypassing the browser's untrusted certificate warning.</span></span>

   ![Janela do navegador mostrando a página de Índice do aplicativo carregada](httpsys/_static/browser.png)

## <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="874b3-920">Servidor proxy e cenários de balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="874b3-920">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="874b3-921">Para aplicativos hospedados pelo HTTP.sys que interagem com solicitações da Internet ou de uma rede corporativa, podem ser necessárias configurações adicionais ao hospedar atrás de balanceadores de carga e de servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="874b3-921">For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers.</span></span> <span data-ttu-id="874b3-922">Para obter mais informações, veja [Configurar o ASP.NET Core para trabalhar com servidores proxy e balanceadores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="874b3-922">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="874b3-923">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="874b3-923">Additional resources</span></span>

* [<span data-ttu-id="874b3-924">Habilitar a autenticação do Windows com HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="874b3-924">Enable Windows Authentication with HTTP.sys</span></span>](xref:security/authentication/windowsauth#httpsys)
* [<span data-ttu-id="874b3-925">API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="874b3-925">HTTP Server API</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa364510.aspx)
* [<span data-ttu-id="874b3-926">Repositório aspnet/HttpSysServer do GitHub (código-fonte)</span><span class="sxs-lookup"><span data-stu-id="874b3-926">aspnet/HttpSysServer GitHub repository (source code)</span></span>](https://github.com/aspnet/HttpSysServer/)
* [<span data-ttu-id="874b3-927">O host</span><span class="sxs-lookup"><span data-stu-id="874b3-927">The host</span></span>](xref:fundamentals/index#host)
* <xref:test/troubleshoot>

::: moniker-end
