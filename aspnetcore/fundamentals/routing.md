---
title: Roteamento no ASP.NET Core
author: rick-anderson
description: Descubra como o roteamento do ASP.NET Core é responsável por mapear URIs de solicitação para seletores de ponto de extremidade e expedir solicitações de entrada para pontos de extremidade.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 12/13/2019
uid: fundamentals/routing
ms.openlocfilehash: 113bb79318283e814c0e64ad4dc9d193282f0c52
ms.sourcegitcommit: 9a129f5f3e31cc449742b164d5004894bfca90aa
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78664923"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="f621e-103">Roteamento no ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="f621e-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="f621e-104">Por [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/) e [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="f621e-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="f621e-105">O roteamento é responsável por mapear URIs de solicitação para pontos de extremidade e expedir solicitações de entrada para esses pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-105">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="f621e-106">As rotas são definidas no aplicativo e configuradas quando o aplicativo é iniciado.</span><span class="sxs-lookup"><span data-stu-id="f621e-106">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f621e-107">Uma rota pode opcionalmente extrair os valores da URL contida na solicitação e esses valores podem então ser usados para o processamento da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f621e-108">Usando informações de rota do aplicativo, o roteamento também é capaz de gerar URLs que são mapeadas para pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-108">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span> <span data-ttu-id="f621e-109">Muitos aplicativos não precisam adicionar rotas além do que os modelos fornecem.</span><span class="sxs-lookup"><span data-stu-id="f621e-109">Many apps don't need to add routes beyond what the templates provide.</span></span> <span data-ttu-id="f621e-110">Os modelos de ASP.NET Core para controladores e páginas Razor configuram pontos de extremidade de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-110">The ASP.NET Core templates for controllers and Razor pages configure route endpoints.</span></span> <span data-ttu-id="f621e-111">Se você precisar adicionar pontos de extremidade de rota personalizados, os pontos de extremidade personalizados poderão ser configurados juntamente com os pontos de extremidade de rota gerados pelo modelo.</span><span class="sxs-lookup"><span data-stu-id="f621e-111">If you need to add custom route endpoints, the custom endpoints can be configured alongside template generated route endpoints.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f621e-112">Este documento aborda o roteamento de nível inferior do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="f621e-112">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f621e-113">Para obter informações sobre o roteamento do ASP.NET Core MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-113">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f621e-114">Para obter informações sobre convenções de roteamento no Razor Pages, confira <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-114">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-115">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f621e-115">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f621e-116">Conceitos básicos sobre roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-116">Routing basics</span></span>

<span data-ttu-id="f621e-117">A maioria dos aplicativos deve escolher um esquema de roteamento básico e descritivo para que as URLs sejam legíveis e significativas.</span><span class="sxs-lookup"><span data-stu-id="f621e-117">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f621e-118">A rota convencional padrão `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f621e-118">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f621e-119">Dá suporte a um esquema de roteamento básico e descritivo.</span><span class="sxs-lookup"><span data-stu-id="f621e-119">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f621e-120">É um ponto de partida útil para aplicativos baseados em interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f621e-120">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f621e-121">Os desenvolvedores geralmente adicionam outras rotas concisas às áreas de alto tráfego de um aplicativo em situações especiais (por exemplo, pontos de extremidade de blog e comércio eletrônico) usando o [roteamento de atributo](xref:mvc/controllers/routing#attribute-routing) ou rotas convencionais dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-121">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f621e-122">As APIs da Web devem usar o roteamento de atributo para modelar a funcionalidade do aplicativo como um conjunto de recursos em que as operações são representadas por verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-122">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f621e-123">Isso significa que muitas operações (por exemplo, GET, POST) no mesmo recurso lógico usarão a mesma URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-123">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f621e-124">O roteamento de atributo fornece um nível de controle necessário para projetar cuidadosamente o layout de ponto de extremidade público de uma API.</span><span class="sxs-lookup"><span data-stu-id="f621e-124">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f621e-125">Os aplicativos do Razor Pages usam o roteamento convencional padrão para fornecer recursos nomeados na pasta *Pages* de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-125">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f621e-126">Estão disponíveis convenções adicionais que permitem a personalização do comportamento de roteamento do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-126">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f621e-127">Para obter mais informações, consulte <xref:razor-pages/index> e <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-127">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-128">O suporte à geração de URL permite que o aplicativo seja desenvolvido sem hard-coding das URLs para vincular o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-128">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f621e-129">Esse suporte permite começar com uma configuração de roteamento básica e modificar as rotas, depois que o layout de recurso do aplicativo é determinado.</span><span class="sxs-lookup"><span data-stu-id="f621e-129">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f621e-130">O roteamento usa *pontos de extremidade* (`Endpoint`) para representar os pontos de extremidade lógicos em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-130">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="f621e-131">Um ponto de extremidade define um delegado para processar solicitações e uma coleção de metadados arbitrários.</span><span class="sxs-lookup"><span data-stu-id="f621e-131">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="f621e-132">Os metadados são usados para implementar preocupações abrangentes com base em políticas e configurações anexadas a cada ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-132">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="f621e-133">O sistema de roteamento tem as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="f621e-133">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f621e-134">A sintaxe do modelo de rota é usada para definir rotas com os parâmetros de rota com tokens criados.</span><span class="sxs-lookup"><span data-stu-id="f621e-134">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f621e-135">A configuração de ponto de extremidade de estilo convencional e de estilo de atributo é permitida.</span><span class="sxs-lookup"><span data-stu-id="f621e-135">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f621e-136"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> é usado para determinar se um parâmetro de URL contém um valor válido para determinada restrição de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-136"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f621e-137">Modelos de aplicativo, como MVC/Razor Pages, registram todos os seus pontos de extremidade, que têm uma implementação previsível de cenários de roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-137">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f621e-138">A implementação de roteamento toma decisões de roteamento, sempre que desejado no pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-138">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="f621e-139">O Middleware que aparece após um Middleware de Roteamento pode inspecionar o resultado da decisão de ponto de extremidade do Middleware de Roteamento para determinado URI de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-139">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="f621e-140">É possível enumerar todos os pontos de extremidade no aplicativo em qualquer lugar do pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-140">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="f621e-141">Um aplicativo pode usar o roteamento para gerar URLs (por exemplo, para redirecionamento ou links) com base nas informações de ponto de extremidade e evitar URLs embutidas em código, o que ajuda na facilidade de manutenção.</span><span class="sxs-lookup"><span data-stu-id="f621e-141">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f621e-142">A geração de URL baseia-se em endereços, que dá suporte à extensibilidade arbitrária:</span><span class="sxs-lookup"><span data-stu-id="f621e-142">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="f621e-143">A API de Gerador de Link (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) pode ser resolvida em qualquer lugar usando a [DI (Injeção de Dependência)](xref:fundamentals/dependency-injection) para gerar URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-143">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="f621e-144">Quando a API de Gerador de Link não está disponível por meio da DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> oferece métodos para criar URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-144">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="f621e-145">A vinculação de ponto de extremidade é limitada a ações e páginas do MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-145">Endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="f621e-146">As expansões de funcionalidades de vinculação de ponto de extremidade estão planejadas para versões futuras.</span><span class="sxs-lookup"><span data-stu-id="f621e-146">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="f621e-147">O roteamento está conectado ao pipeline do [middleware](xref:fundamentals/middleware/index) pela classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="f621e-147">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f621e-148">O [ASP.NET Core MVC](xref:mvc/overview) adiciona o roteamento ao pipeline de middleware como parte de sua configuração e manipula o roteamento nos aplicativos do MVC e do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-148">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f621e-149">Para saber como usar o roteamento como um componente autônomo, confira a seção [Usar o Middleware de Roteamento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f621e-149">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f621e-150">Correspondência de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-150">URL matching</span></span>

<span data-ttu-id="f621e-151">A correspondência de URL é o processo pelo qual o roteamento expede uma solicitação de entrada para um *ponto de extremidade*.</span><span class="sxs-lookup"><span data-stu-id="f621e-151">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="f621e-152">Esse processo se baseia nos dados do caminho da URL, mas pode ser estendido para considerar qualquer dado na solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-152">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f621e-153">A capacidade de expedir solicitações para manipuladores separados é fundamental para dimensionar o tamanho e a complexidade de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-153">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f621e-154">Quando um Middleware de Roteamento é executado, ele define um ponto de extremidade (`Endpoint`) e valores de rota para um recurso no <xref:Microsoft.AspNetCore.Http.HttpContext>.</span><span class="sxs-lookup"><span data-stu-id="f621e-154">When a Routing Middleware executes, it sets an endpoint (`Endpoint`) and route values to a feature on the <xref:Microsoft.AspNetCore.Http.HttpContext>.</span></span> <span data-ttu-id="f621e-155">Para a solicitação atual:</span><span class="sxs-lookup"><span data-stu-id="f621e-155">For the current request:</span></span>

* <span data-ttu-id="f621e-156">Chamar `HttpContext.GetEndpoint` obtém o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-156">Calling `HttpContext.GetEndpoint` gets the endpoint.</span></span>
* <span data-ttu-id="f621e-157">`HttpRequest.RouteValues` obtém a coleção de valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-157">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="f621e-158">O Middleware que é executado após o Middleware de Roteamento pode ver o ponto de extremidade e executar uma ação.</span><span class="sxs-lookup"><span data-stu-id="f621e-158">Middleware running after the Routing Middleware can see the endpoint and take action.</span></span> <span data-ttu-id="f621e-159">Por exemplo, um Middleware de Autorização pode interrogar a coleção de metadados do ponto de extremidade para uma política de autorização.</span><span class="sxs-lookup"><span data-stu-id="f621e-159">For example, an Authorization Middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="f621e-160">Depois que todos os middlewares no pipeline de processamento da solicitação forem executados, o representante do ponto de extremidade selecionado será invocado.</span><span class="sxs-lookup"><span data-stu-id="f621e-160">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="f621e-161">O sistema de roteamento no roteamento de ponto de extremidade é responsável por todas as decisões de expedição.</span><span class="sxs-lookup"><span data-stu-id="f621e-161">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="f621e-162">Como o middleware aplica políticas com base no ponto de extremidade selecionado, é importante que qualquer decisão que possa afetar a expedição ou a aplicação de políticas de segurança seja feita dentro do sistema de roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-162">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="f621e-163">Quando o delegado do ponto de extremidade é executado, as propriedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) são definidas com valores apropriados com base no processamento da solicitação executado até o momento.</span><span class="sxs-lookup"><span data-stu-id="f621e-163">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f621e-164">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) é um dicionário de *valores de rota* produzido por meio da rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-164">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f621e-165">Esses valores geralmente são determinados pela criação de token da URL e podem ser usados para aceitar a entrada do usuário ou tomar outras decisões de expedição dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-165">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f621e-166">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) é um recipiente de propriedades de dados adicionais relacionados à rota correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-166">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f621e-167"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> são fornecidos para dar suporte à associação de dados de estado com cada rota para que o aplicativo possa tomar decisões com base em qual rota teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-167"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f621e-168">Esses valores são definidos pelo desenvolvedor e **não** afetam de forma alguma o comportamento do roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-168">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f621e-169">Além disso, os valores em stash em [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) podem ser de qualquer tipo, ao contrário de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que devem ser conversíveis de/para cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-169">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f621e-170">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) é uma lista das rotas que participaram da correspondência bem-sucedida da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-170">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f621e-171">As rotas podem ser aninhadas uma dentro da outra.</span><span class="sxs-lookup"><span data-stu-id="f621e-171">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f621e-172">A propriedade <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> reflete o caminho pela árvore lógica de rotas que resultou em uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-172">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f621e-173">Em geral, o primeiro item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é a coleção de rotas e deve ser usado para a geração de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-173">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f621e-174">O último item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é o manipulador de rotas que teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-174">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="f621e-175">Geração de URL com o LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="f621e-175">URL generation with LinkGenerator</span></span>

<span data-ttu-id="f621e-176">Geração de URL é o processo pelo qual o roteamento pode criar um caminho de URL de acordo com um conjunto de valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-176">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f621e-177">Isso permite uma separação lógica entre os pontos de extremidade e as URLs que os acessam.</span><span class="sxs-lookup"><span data-stu-id="f621e-177">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="f621e-178">O roteamento de ponto de extremidade inclui a API de Gerador de Link (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="f621e-178">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="f621e-179"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> é um serviço singleton que pode ser recuperado por meio da DI.</span><span class="sxs-lookup"><span data-stu-id="f621e-179"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="f621e-180">A API pode ser usada fora do contexto de uma solicitação em execução.</span><span class="sxs-lookup"><span data-stu-id="f621e-180">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="f621e-181"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> do MVC e cenários que dependem de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como [Auxiliares de Marcação](xref:mvc/views/tag-helpers/intro), Auxiliares de HTML e [Resultados da Ação](xref:mvc/controllers/actions), usam o gerador de link para fornecer funcionalidades de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-181">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="f621e-182">O gerador de link é respaldado pelo conceito de um *endereço* e *esquemas de endereço*.</span><span class="sxs-lookup"><span data-stu-id="f621e-182">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="f621e-183">Um esquema de endereço é uma maneira de determinar os pontos de extremidade que devem ser considerados para a geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-183">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="f621e-184">Por exemplo, os cenários de nome de rota e valores de rota com os quais muitos usuários estão familiarizados no MVC/Razor Pages são implementados como um esquema de endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-184">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="f621e-185">O gerador de link pode ser vinculado a ações e páginas do MVC/Razor Pages por meio dos seguintes métodos de extensão:</span><span class="sxs-lookup"><span data-stu-id="f621e-185">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="f621e-186">Uma sobrecarga desses métodos aceita argumentos que incluem o `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="f621e-186">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="f621e-187">Esses métodos são funcionalmente equivalentes a `Url.Action` e `Url.Page`, mas oferecem mais flexibilidade e opções.</span><span class="sxs-lookup"><span data-stu-id="f621e-187">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="f621e-188">Os métodos `GetPath*` são mais semelhantes a `Url.Action` e `Url.Page`, pois geram um URI que contém um caminho absoluto.</span><span class="sxs-lookup"><span data-stu-id="f621e-188">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="f621e-189">Os métodos `GetUri*` sempre geram um URI absoluto que contém um esquema e um host.</span><span class="sxs-lookup"><span data-stu-id="f621e-189">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="f621e-190">Os métodos que aceitam um `HttpContext` geram um URI no contexto da solicitação em execução.</span><span class="sxs-lookup"><span data-stu-id="f621e-190">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="f621e-191">Os valores de rota de ambiente, o caminho base da URL, o esquema e o host da solicitação em execução são usados, a menos que sejam substituídos.</span><span class="sxs-lookup"><span data-stu-id="f621e-191">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="f621e-192"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> é chamado com um endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-192"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="f621e-193">A geração de um URI ocorre em duas etapas:</span><span class="sxs-lookup"><span data-stu-id="f621e-193">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="f621e-194">Um endereço é associado a uma lista de pontos de extremidade que correspondem ao endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-194">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="f621e-195">O `RoutePattern` de cada ponto de extremidade é avaliado até que seja encontrado um padrão de rota correspondente aos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-195">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="f621e-196">A saída resultante é combinada com as outras partes de URI fornecidas ao gerador de link e é retornada.</span><span class="sxs-lookup"><span data-stu-id="f621e-196">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="f621e-197">Os métodos fornecidos pelo <xref:Microsoft.AspNetCore.Routing.LinkGenerator> dão suporte a funcionalidades de geração de link padrão para qualquer tipo de endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-197">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="f621e-198">A maneira mais conveniente usar o gerador de link é por meio de métodos de extensão que executam operações para um tipo de endereço específico.</span><span class="sxs-lookup"><span data-stu-id="f621e-198">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="f621e-199">Método de extensão</span><span class="sxs-lookup"><span data-stu-id="f621e-199">Extension Method</span></span> | <span data-ttu-id="f621e-200">Descrição</span><span class="sxs-lookup"><span data-stu-id="f621e-200">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="f621e-201">Gera um URI com um caminho absoluto com base nos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-201">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="f621e-202">Gera um URI absoluto com base nos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-202">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="f621e-203">Preste atenção às seguintes implicações da chamada de métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="f621e-203">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="f621e-204">Use métodos de extensão de `GetUri*` com cuidado em uma configuração de aplicativo que não valide o cabeçalho `Host` das solicitações de entrada.</span><span class="sxs-lookup"><span data-stu-id="f621e-204">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="f621e-205">Se o cabeçalho `Host` das solicitações de entrada não é validado, uma entrada de solicitação não confiável pode ser enviada novamente ao cliente em URIs em uma exibição/página.</span><span class="sxs-lookup"><span data-stu-id="f621e-205">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="f621e-206">Recomendamos que todos os aplicativos de produção configurem seu servidor para validar o cabeçalho `Host` com os valores válidos conhecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-206">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="f621e-207">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> com cuidado no middleware em combinação com `Map` ou `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="f621e-207">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="f621e-208">`Map*` altera o caminho base da solicitação em execução, o que afeta a saída da geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-208">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="f621e-209">Todas as APIs de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permitem a especificação de um caminho base.</span><span class="sxs-lookup"><span data-stu-id="f621e-209">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="f621e-210">Sempre especifique um caminho base vazio para desfazer o efeito de `Map*` na geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-210">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="endpoint-routing"></a><span data-ttu-id="f621e-211">Roteamento de ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="f621e-211">Endpoint routing</span></span>

* <span data-ttu-id="f621e-212">Um ponto de extremidade de rota tem um modelo, metadados e um delegado de solicitação que atendem à resposta do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-212">A route endpoint has a template, metadata, and a request delegate that serves the endpoint's response.</span></span> <span data-ttu-id="f621e-213">Os metadados são usados para implementar preocupações abrangentes com base em políticas e configurações anexadas a cada ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-213">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span> <span data-ttu-id="f621e-214">Por exemplo, um middleware de autorização pode interrogar a coleção de metadados do ponto de extremidade para uma [política de autorização](xref:security/authorization/policies#applying-policies-to-mvc-controllers).</span><span class="sxs-lookup"><span data-stu-id="f621e-214">For example, an authorization middleware can interrogate the endpoint's metadata collection for an [authorization policy](xref:security/authorization/policies#applying-policies-to-mvc-controllers).</span></span>
* <span data-ttu-id="f621e-215">O roteamento de ponto de extremidade integra-se com o middleware usando dois métodos de extensão:</span><span class="sxs-lookup"><span data-stu-id="f621e-215">Endpoint routing integrates with middleware using two extension methods:</span></span>
  * <span data-ttu-id="f621e-216">[UseRouting](xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*) adiciona correspondência de rota ao pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-216">[UseRouting](xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*) adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="f621e-217">Ele deve vir antes de qualquer middleware com reconhecimento de rota, como autorização, execução de ponto de extremidade, etc.</span><span class="sxs-lookup"><span data-stu-id="f621e-217">It must come before any route-aware middleware such as authorization, endpoint execution, etc.</span></span>
  * <span data-ttu-id="f621e-218">[UseEndpoints](xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*) adiciona a execução de ponto de extremidade ao pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-218">[UseEndpoints](xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*) adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="f621e-219">Ele executa o delegado de solicitação que atende à resposta do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-219">It runs the request delegate that serves the endpoint's response.</span></span>
  <span data-ttu-id="f621e-220">`UseEndpoints` também é onde os pontos de extremidade de rota são configurados que podem ser correspondidos e executados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-220">`UseEndpoints` is also where route endpoints are configured that can be matched and executed by the app.</span></span> <span data-ttu-id="f621e-221">Por exemplo, <xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*>, <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>e <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-221">For example, <xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*>, <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, and <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>.</span></span>
* <span data-ttu-id="f621e-222">Os aplicativos usam os métodos auxiliares do ASP.NET Core para configurar suas rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-222">Apps use ASP.NET Core's helper methods to configure their routes.</span></span> <span data-ttu-id="f621e-223">ASP.NET Core frameworks fornecem métodos auxiliares como <xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*>, <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*> e `MapHub<THub>`.</span><span class="sxs-lookup"><span data-stu-id="f621e-223">ASP.NET Core frameworks provide helper methods like <xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*>, <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*> and `MapHub<THub>`.</span></span> <span data-ttu-id="f621e-224">Também há métodos auxiliares para configurar seus próprios pontos de extremidade de rota personalizados: <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>e [MapVerb](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions).</span><span class="sxs-lookup"><span data-stu-id="f621e-224">There are also helper methods for configuring your own custom route endpoints: <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [MapVerb](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions).</span></span> 
* <span data-ttu-id="f621e-225">O roteamento de ponto de extremidade também dá suporte à alteração de pontos de extremidades após a inicialização de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-225">Endpoint routing also supports endpoints changing after an application has started up.</span></span> <span data-ttu-id="f621e-226">Para dar suporte a isso em seu aplicativo ou ASP.NET Core Framework, uma <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> personalizada deve ser criada e registrada.</span><span class="sxs-lookup"><span data-stu-id="f621e-226">To support this in your app or ASP.NET Core framework, a custom <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> must be created and registered.</span></span> <span data-ttu-id="f621e-227">Esse é um recurso avançado e, normalmente, não é necessário.</span><span class="sxs-lookup"><span data-stu-id="f621e-227">This is an advanced feature, and usually not needed.</span></span> <span data-ttu-id="f621e-228">Os pontos de extremidade normalmente são configurados na inicialização e são estáticos durante o tempo de vida do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-228">Endpoints are typically configured at startup and are static for the lifetime of the app.</span></span> <span data-ttu-id="f621e-229">Carregar a configuração de rota de um arquivo ou banco de dados na inicialização não é dinâmico.</span><span class="sxs-lookup"><span data-stu-id="f621e-229">Loading route configuration from a file or database at startup is not dynamic.</span></span>

<span data-ttu-id="f621e-230">O código a seguir mostra um exemplo básico de roteamento de ponto de extremidade:</span><span class="sxs-lookup"><span data-stu-id="f621e-230">The following code shows a basic example of endpoint routing:</span></span>

[!code-csharp[](routing/samples/3.x/Startup.cs?name=snippet)]

<span data-ttu-id="f621e-231">Consulte [correspondência de URL](#url-matching) neste documento para obter mais informações sobre roteamento de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-231">See [URL matching](#url-matching) in this document for more information on endpoint routing.</span></span>

## <a name="endpoint-routing-differences-from-earlier-versions-of-routing"></a><span data-ttu-id="f621e-232">Diferenças de roteamento de ponto de extremidade de versões anteriores do roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-232">Endpoint routing differences from earlier versions of routing</span></span>

<span data-ttu-id="f621e-233">Existem algumas diferenças entre o roteamento do ponto de extremidade e as versões de roteamento anteriores ao ASP.NET Core 2,2:</span><span class="sxs-lookup"><span data-stu-id="f621e-233">A few differences exist between endpoint routing and versions of routing earlier than in ASP.NET Core 2.2:</span></span>

* <span data-ttu-id="f621e-234">O sistema de roteamento do ponto de extremidade não dá suporte à extensibilidade baseada em <xref:Microsoft.AspNetCore.Routing.IRouter>, incluindo a herança de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-234">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="f621e-235">O roteamento de ponto de extremidade não dá suporte a [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="f621e-235">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="f621e-236">Use a [versão de compatibilidade](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) para continuar usando o shim de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-236">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="f621e-237">O Roteamento de Ponto de Extremidade tem um comportamento diferente para o uso de maiúsculas dos URIs gerados ao usar rotas convencionais.</span><span class="sxs-lookup"><span data-stu-id="f621e-237">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="f621e-238">Considere o seguinte modelo de rota padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-238">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f621e-239">Suponha que você gere um link para uma ação usando a seguinte rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-239">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="f621e-240">Com o roteamento baseado em <xref:Microsoft.AspNetCore.Routing.IRouter>, esse código gera um URI igual a `/blog/ReadPost/17`, que respeita o uso de maiúsculas do valor de rota fornecido.</span><span class="sxs-lookup"><span data-stu-id="f621e-240">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="f621e-241">O roteamento de ponto de extremidade no ASP.NET Core 2.2 ou posterior produz `/Blog/ReadPost/17` ("Blog" está em letras maiúsculas).</span><span class="sxs-lookup"><span data-stu-id="f621e-241">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="f621e-242">O roteamento de ponto de extremidade fornece a interface `IOutboundParameterTransformer` que pode ser usada para personalizar esse comportamento globalmente ou para aplicar diferentes convenções ao mapeamento de URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-242">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="f621e-243">Para obter mais informações, confira a seção [Referência de transformador de parâmetro](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-243">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="f621e-244">A Geração de Link usada pelo MVC/Razor Pages com rotas convencionais tem um comportamento diferente ao tentar estabelecer um vínculo com um controlador/uma ação ou uma página não existente.</span><span class="sxs-lookup"><span data-stu-id="f621e-244">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="f621e-245">Considere o seguinte modelo de rota padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-245">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f621e-246">Suponha que você gere um link para uma ação usando o modelo padrão com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f621e-246">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="f621e-247">Com o roteamento baseado em `IRouter`, o resultado é sempre `/Blog/ReadPost/17`, mesmo se o `BlogController` não existe ou não tem um método de ação `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="f621e-247">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="f621e-248">Conforme esperado, o roteamento de ponto de extremidade no ASP.NET Core 2.2 ou posterior produz `/Blog/ReadPost/17` se o método de ação existe.</span><span class="sxs-lookup"><span data-stu-id="f621e-248">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="f621e-249">*No entanto, o roteamento de ponto de extremidade produz uma cadeia de caracteres vazia se a ação não existe.*</span><span class="sxs-lookup"><span data-stu-id="f621e-249">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="f621e-250">Conceitualmente, o roteamento de ponto de extremidade não pressupõe a existência do ponto de extremidade, caso a ação não exista.</span><span class="sxs-lookup"><span data-stu-id="f621e-250">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="f621e-251">O *algoritmo de invalidação de valor de ambiente* da geração de link tem um comportamento diferente quando usado com o roteamento de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-251">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="f621e-252">A *invalidação de valor de ambiente* é o algoritmo que decide quais valores de rota da solicitação em execução no momento (os valores de ambiente) podem ser usados em operações de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-252">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="f621e-253">O roteamento convencional sempre invalidava valores de rota extras ao estabelecer o vínculo com uma ação diferente.</span><span class="sxs-lookup"><span data-stu-id="f621e-253">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="f621e-254">O roteamento de atributo não tinha esse comportamento antes do lançamento do ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="f621e-254">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="f621e-255">Em versões anteriores do ASP.NET Core, os links para outra ação que usam os mesmos nomes de parâmetro de rota resultavam em erros de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-255">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="f621e-256">No ASP.NET Core 2.2 ou posterior, as duas formas de roteamento invalidam os valores ao estabelecer o vínculo com outra ação.</span><span class="sxs-lookup"><span data-stu-id="f621e-256">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="f621e-257">Considere o exemplo a seguir no ASP.NET Core 2.1 ou anterior.</span><span class="sxs-lookup"><span data-stu-id="f621e-257">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f621e-258">Ao estabelecer o vínculo com outra ação (ou outra página), os valores de rota podem ser reutilizados de maneiras indesejadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-258">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="f621e-259">Em */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f621e-259">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="f621e-260">Em */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f621e-260">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="f621e-261">Se o URI é `/Store/Product/18` no ASP.NET Core 2.1 ou anterior, o link gerado na página Store/Info por `@Url.Page("/Login")` é `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="f621e-261">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="f621e-262">O valor de `id` igual a 18 é reutilizado, mesmo que o destino do link seja uma parte totalmente diferente do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-262">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="f621e-263">O valor de rota de `id` no contexto da página `/Login` provavelmente é um valor de ID de usuário, e não um valor de ID do produto (product ID) da loja.</span><span class="sxs-lookup"><span data-stu-id="f621e-263">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="f621e-264">No roteamento de ponto de extremidade com o ASP.NET Core 2.2 ou posterior, o resultado é `/Login`.</span><span class="sxs-lookup"><span data-stu-id="f621e-264">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="f621e-265">Os valores de ambiente não são reutilizados quando o destino vinculado é uma ação ou uma página diferente.</span><span class="sxs-lookup"><span data-stu-id="f621e-265">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="f621e-266">Sintaxe do parâmetro de rota de viagem de ida e volta: as barras "/" não são codificadas ao usar uma sintaxe do parâmetro catch-all de asterisco duplo (`**`).</span><span class="sxs-lookup"><span data-stu-id="f621e-266">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="f621e-267">Durante a geração de link, o sistema de roteamento codifica o valor capturado em um parâmetro catch-all de asterisco duplo (`**`) (por exemplo, `{**myparametername}`), exceto as barras "/".</span><span class="sxs-lookup"><span data-stu-id="f621e-267">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="f621e-268">O catch-all de asterisco duplo é compatível com o roteamento baseado em `IRouter` no ASP.NET Core 2.2 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="f621e-268">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="f621e-269">A sintaxe do parâmetro catch-all de asterisco único em versões anteriores do ASP.NET Core (`{*myparametername}`) permanece com suporte e as barras "/" são codificadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-269">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="f621e-270">Rota</span><span class="sxs-lookup"><span data-stu-id="f621e-270">Route</span></span>              | <span data-ttu-id="f621e-271">Link gerado com</span><span class="sxs-lookup"><span data-stu-id="f621e-271">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="f621e-272">`/search/admin%2Fproducts` (a barra "/" é codificada)</span><span class="sxs-lookup"><span data-stu-id="f621e-272">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="f621e-273">Exemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="f621e-273">Middleware example</span></span>

<span data-ttu-id="f621e-274">No exemplo a seguir, um middleware usa a API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para criar um link para um método de ação que lista os produtos da loja.</span><span class="sxs-lookup"><span data-stu-id="f621e-274">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="f621e-275">O uso do gerador de link com sua injeção em uma classe e uma chamada a `GenerateLink` está disponível para qualquer classe em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-275">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="f621e-276">Criar rotas</span><span class="sxs-lookup"><span data-stu-id="f621e-276">Create routes</span></span>

<span data-ttu-id="f621e-277">A maioria dos aplicativos cria rotas chamando <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou um dos métodos de extensão semelhantes definidos em <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f621e-277">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f621e-278">Qualquer um dos métodos de extensão de <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> cria uma instância de <xref:Microsoft.AspNetCore.Routing.Route> e a adicionam à coleção de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-278">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f621e-279"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> não aceita um parâmetro de manipulador de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-279"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f621e-280"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> apenas adiciona rotas que são manipuladas pelo <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-280"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f621e-281">Para saber mais sobre o roteamento no MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-281">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f621e-282">O exemplo de código a seguir é um exemplo de uma chamada <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por uma definição de rota típica do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-282">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-283">Esse modelo corresponde a um caminho de URL e extrai os valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-283">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f621e-284">Por exemplo, o caminho `/Products/Details/17` gera os seguintes valores de rota: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-284">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f621e-285">Os valores de rota são determinados pela divisão do caminho da URL em segmentos e pela correspondência de cada segmento com o nome do *parâmetro de rota* no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-285">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f621e-286">Os parâmetros de rota são nomeados.</span><span class="sxs-lookup"><span data-stu-id="f621e-286">Route parameters are named.</span></span> <span data-ttu-id="f621e-287">Os parâmetros são definidos com a colocação do nome do parâmetro em chaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-287">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f621e-288">O modelo anterior também pode corresponder ao caminho da URL `/` e produzir os valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-288">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f621e-289">Isso ocorre porque os parâmetros de rota `{controller}` e `{action}` têm valores padrão e o parâmetro de rota `id` é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-289">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f621e-290">Um sinal de igual (`=`) seguido de um valor após o nome do parâmetro de rota define um valor padrão para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-290">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f621e-291">Um ponto de interrogação (`?`) após o nome do parâmetro de rota define o parâmetro como opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-291">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f621e-292">Os parâmetros de rota com um valor padrão *sempre* produzem um valor de rota quando a rota corresponde.</span><span class="sxs-lookup"><span data-stu-id="f621e-292">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f621e-293">Os parâmetros opcionais não produzem um valor de rota quando não há nenhum segmento de caminho de URL correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-293">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f621e-294">Confira a seção [Referência de modelo de rota](#route-template-reference) para obter uma descrição completa dos recursos e da sintaxe de modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-294">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f621e-295">No seguinte exemplo, a definição do parâmetro de rota `{id:int}` define uma [restrição de rota](#route-constraint-reference) para o parâmetro de rota `id`:</span><span class="sxs-lookup"><span data-stu-id="f621e-295">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f621e-296">Esse modelo corresponde a um caminho de URL, como `/Products/Details/17`, mas não como `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f621e-296">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f621e-297">As restrições de rota implementam <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspecionam valores de rota para verificá-los.</span><span class="sxs-lookup"><span data-stu-id="f621e-297">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f621e-298">Neste exemplo, o valor de rota `id` precisa ser conversível em um inteiro.</span><span class="sxs-lookup"><span data-stu-id="f621e-298">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f621e-299">Confira [route-constraint-reference](#route-constraint-reference) para obter uma explicação das restrições de rota fornecidas pela estrutura.</span><span class="sxs-lookup"><span data-stu-id="f621e-299">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f621e-300">Sobrecargas adicionais de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceitam valores para `constraints`, `dataTokens` e `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f621e-300">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f621e-301">O uso típico desses parâmetros é passar um objeto de tipo anônimo, no qual os nomes da propriedade do tipo anônimo correspondem aos nomes do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-301">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f621e-302">Os seguintes exemplos de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> criam rotas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f621e-302">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f621e-303">A sintaxe embutida para a definição de restrições e padrões pode ser interessante para rotas simples.</span><span class="sxs-lookup"><span data-stu-id="f621e-303">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f621e-304">No entanto, há cenários, como tokens de dados, que não dão suporte à sintaxe embutida.</span><span class="sxs-lookup"><span data-stu-id="f621e-304">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f621e-305">O seguinte exemplo demonstra mais alguns cenários:</span><span class="sxs-lookup"><span data-stu-id="f621e-305">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f621e-306">O modelo anterior corresponde a um caminho de URL, como `/Blog/All-About-Routing/Introduction`, e extrai os valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-306">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f621e-307">Os valores de rota padrão para `controller` e `action` são produzidos pela rota, mesmo que não haja nenhum parâmetro de rota correspondente no modelo.</span><span class="sxs-lookup"><span data-stu-id="f621e-307">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f621e-308">Os valores padrão podem ser especificados no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-308">Default values can be specified in the route template.</span></span> <span data-ttu-id="f621e-309">O parâmetro de rota `article` é definido como um *catch-all* pela aparência de um asterisco duplo (`**`) antes do nome do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-309">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="f621e-310">Os parâmetros de rota catch-all capturam o restante do caminho de URL e também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-310">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f621e-311">O seguinte exemplo adiciona restrições de rota e tokens de dados:</span><span class="sxs-lookup"><span data-stu-id="f621e-311">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f621e-312">O modelo anterior corresponde a um caminho de URL como `/en-US/Products/5` e extrai os valores de `{ controller = Products, action = Details, id = 5 }` e os tokens de dados `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-312">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens locais do Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f621e-314">Geração de URL da classe de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-314">Route class URL generation</span></span>

<span data-ttu-id="f621e-315">A classe <xref:Microsoft.AspNetCore.Routing.Route> também pode executar a geração de URL pela combinação de um conjunto de valores de rota com seu modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-315">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f621e-316">Logicamente, este é o processo inverso de correspondência do caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-316">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-317">Para entender melhor a geração de URL, imagine qual URL você deseja gerar e, em seguida, pense em como um modelo de rota corresponderia a essa URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-317">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f621e-318">Quais valores serão produzidos?</span><span class="sxs-lookup"><span data-stu-id="f621e-318">What values would be produced?</span></span> <span data-ttu-id="f621e-319">Este é o equivalente aproximado de como funciona a geração de URL na classe <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-319">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f621e-320">O seguinte exemplo usa uma rota padrão geral do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-320">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-321">Com os valores de rota `{ controller = Products, action = List }`, a URL `/Products/List` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-321">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f621e-322">Os valores de rota são substituídos pelos parâmetros de rota correspondentes para formar o caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-322">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f621e-323">Como `id` é um parâmetro de rota opcional, a URL é gerada com êxito sem um valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f621e-323">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f621e-324">Com os valores de rota `{ controller = Home, action = Index }`, a URL `/` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-324">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f621e-325">Os valores de rota fornecidos correspondem aos valores padrão, sendo que os segmentos correspondentes aos valores padrão são omitidos com segurança.</span><span class="sxs-lookup"><span data-stu-id="f621e-325">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f621e-326">A viagem de ida e volta gerada pelas duas URLs com a definição de rota a seguir (`/Home/Index` e `/`) produz os mesmos valores de rota que foram usados para gerar a URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-326">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f621e-327">Um aplicativo que usa o ASP.NET Core MVC deve usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para gerar URLs, em vez de chamar o roteamento diretamente.</span><span class="sxs-lookup"><span data-stu-id="f621e-327">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f621e-328">Para obter mais informações sobre a geração de URL, confira a seção [Referência de geração de URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-328">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f621e-329">Usar o middleware de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-329">Use Routing Middleware</span></span>

<span data-ttu-id="f621e-330">Referencie o [metapacote Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) no arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-330">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f621e-331">Adicione o roteamento ao contêiner de serviço em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-331">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f621e-332">As rotas precisam ser configuradas no método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f621e-332">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f621e-333">O aplicativo de exemplo usa as seguintes APIs:</span><span class="sxs-lookup"><span data-stu-id="f621e-333">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f621e-334"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; corresponde apenas a solicitações HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-334"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f621e-335">A tabela a seguir mostra as respostas com os URIs fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-335">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f621e-336">URI</span><span class="sxs-lookup"><span data-stu-id="f621e-336">URI</span></span>                    | <span data-ttu-id="f621e-337">Resposta</span><span class="sxs-lookup"><span data-stu-id="f621e-337">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f621e-338">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-338">Hello!</span></span> <span data-ttu-id="f621e-339">Valores de rota: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f621e-339">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f621e-340">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-340">Hello!</span></span> <span data-ttu-id="f621e-341">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-341">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f621e-342">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-342">Hello!</span></span> <span data-ttu-id="f621e-343">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-343">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f621e-344">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-344">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f621e-345">Olá, Joe!</span><span class="sxs-lookup"><span data-stu-id="f621e-345">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f621e-346">A solicitação é ignorada; corresponde apenas a HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-346">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f621e-347">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-347">The request falls through, no match.</span></span>              |

<span data-ttu-id="f621e-348">A estrutura fornece um conjunto de métodos de extensão para a criação de rotas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f621e-348">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f621e-349">Os métodos `Map[Verb]` usam restrições para limitar a rota ao Verbo HTTP no nome do método.</span><span class="sxs-lookup"><span data-stu-id="f621e-349">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f621e-350">Por exemplo, veja <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> e <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-350">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f621e-351">Referência de modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-351">Route template reference</span></span>

<span data-ttu-id="f621e-352">Os tokens entre chaves (`{ ... }`) definem os *parâmetros de rota* que serão associados se a rota for correspondida.</span><span class="sxs-lookup"><span data-stu-id="f621e-352">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f621e-353">Você pode definir mais de um parâmetro de rota em um segmento de rota, mas eles precisam ser separados por um valor literal.</span><span class="sxs-lookup"><span data-stu-id="f621e-353">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f621e-354">Por exemplo, `{controller=Home}{action=Index}` não é uma rota válida, já que não há nenhum valor literal entre `{controller}` e `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-354">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f621e-355">Esses parâmetros de rota precisam ter um nome e podem ter atributos adicionais especificados.</span><span class="sxs-lookup"><span data-stu-id="f621e-355">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f621e-356">Um texto literal diferente dos parâmetros de rota (por exemplo, `{id}`) e do separador de caminho `/` precisa corresponder ao texto na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-356">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f621e-357">A correspondência de texto não diferencia maiúsculas de minúsculas e se baseia na representação decodificada do caminho de URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-357">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f621e-358">Para encontrar a correspondência de um delimitador de parâmetro de rota literal (`{` ou `}`), faça o escape do delimitador repetindo o caractere (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="f621e-358">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f621e-359">Padrões de URL que tentam capturar um nome de arquivo com uma extensão de arquivo opcional apresentam considerações adicionais.</span><span class="sxs-lookup"><span data-stu-id="f621e-359">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f621e-360">Por exemplo, considere o modelo `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-360">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f621e-361">Quando existem valores para `filename` e `ext`, ambos os valores são populados.</span><span class="sxs-lookup"><span data-stu-id="f621e-361">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f621e-362">Se apenas existir um valor para `filename` na URL, a rota encontrará uma correspondência, pois o ponto à direita (`.`) é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-362">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f621e-363">As URLs a seguir correspondem a essa rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-363">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f621e-364">Você pode usar um asterisco (`*`) ou um asterisco duplo (`**`) como um prefixo para um parâmetro de rota para associá-lo ao restante do URI.</span><span class="sxs-lookup"><span data-stu-id="f621e-364">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f621e-365">Eles são chamados de parâmetros *catch-all*.</span><span class="sxs-lookup"><span data-stu-id="f621e-365">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="f621e-366">Por exemplo, `blog/{**slug}` corresponde a qualquer URI que começa com `/blog` e tem qualquer valor depois dele, que é atribuído ao valor de rota `slug`.</span><span class="sxs-lookup"><span data-stu-id="f621e-366">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f621e-367">Os parâmetros catch-all também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-367">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f621e-368">O parâmetro catch-all faz o escape dos caracteres corretos quando a rota é usada para gerar uma URL, incluindo os caracteres separadores de caminho (`/`).</span><span class="sxs-lookup"><span data-stu-id="f621e-368">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f621e-369">Por exemplo, a rota `foo/{*path}` com valores de rota `{ path = "my/path" }` gera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f621e-369">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f621e-370">Observe o escape da barra invertida.</span><span class="sxs-lookup"><span data-stu-id="f621e-370">Note the escaped forward slash.</span></span> <span data-ttu-id="f621e-371">Para fazer a viagem de ida e volta dos caracteres separadores de caminho, use o prefixo do parâmetro da rota `**`.</span><span class="sxs-lookup"><span data-stu-id="f621e-371">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="f621e-372">A rota `foo/{**path}` com `{ path = "my/path" }` gera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="f621e-372">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="f621e-373">Os parâmetros de rota podem ter *valores padrão*, designados pela especificação do valor padrão após o nome do parâmetro separado por um sinal de igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f621e-373">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f621e-374">Por exemplo, `{controller=Home}` define `Home` como o valor padrão de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f621e-374">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f621e-375">O valor padrão é usado se nenhum valor está presente na URL para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-375">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f621e-376">Os parâmetros de rota se tornam opcionais com o acréscimo de um ponto de interrogação (`?`) ao final do nome do parâmetro, como em `id?`.</span><span class="sxs-lookup"><span data-stu-id="f621e-376">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f621e-377">A diferença entre valores opcionais e parâmetros de rota padrão é que um parâmetro de rota com um valor padrão sempre produz um valor – um parâmetro opcional tem um valor somente quando um valor é fornecido pela URL de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-377">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f621e-378">Os parâmetros de rota podem ter restrições que precisam corresponder ao valor de rota associado da URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-378">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f621e-379">A adição de dois-pontos (`:`) e do nome da restrição após o nome do parâmetro de rota especifica uma *restrição embutida* em um parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-379">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f621e-380">Se a restrição exigir argumentos, eles ficarão entre parênteses (`(...)`) após o nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-380">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f621e-381">Várias restrições embutidas podem ser especificadas por meio do acréscimo de outros dois-pontos (`:`) e do nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-381">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f621e-382">O nome da restrição e os argumentos são passados para o serviço <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para criar uma instância de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a ser usada no processamento de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-382">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f621e-383">Por exemplo, o modelo de rota `blog/{article:minlength(10)}` especifica uma restrição `minlength` com o argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f621e-383">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f621e-384">Para obter mais informações sobre as restrições de rota e uma lista das restrições fornecidas pela estrutura, confira a seção [Referência de restrição de rota](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-384">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f621e-385">Os parâmetros de rota também podem ter transformadores de parâmetro, que transformam o valor de um parâmetro ao gerar links e fazer a correspondência de ações e páginas com URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-385">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="f621e-386">Assim como as restrições, os transformadores de parâmetro podem ser adicionados embutidos a um parâmetro de rota colocando dois-pontos (`:`) e o nome do transformador após o nome do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-386">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="f621e-387">Por exemplo, o modelo de rota `blog/{article:slugify}` especifica um transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="f621e-387">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="f621e-388">Para obter mais informações sobre transformadores de parâmetro, confira a seção [Referência de transformador de parâmetro](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-388">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="f621e-389">A tabela a seguir demonstra modelos de rota de exemplo e seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-389">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f621e-390">Modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-390">Route Template</span></span>                           | <span data-ttu-id="f621e-391">URI de correspondência de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-391">Example Matching URI</span></span>    | <span data-ttu-id="f621e-392">O URI de solicitação&hellip;</span><span class="sxs-lookup"><span data-stu-id="f621e-392">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f621e-393">Somente corresponde ao caminho único `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f621e-393">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f621e-394">Faz a correspondência e define `Page` como `Home`.</span><span class="sxs-lookup"><span data-stu-id="f621e-394">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f621e-395">Faz a correspondência e define `Page` como `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f621e-395">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f621e-396">É mapeado para o controlador `Products` e a ação `List`.</span><span class="sxs-lookup"><span data-stu-id="f621e-396">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f621e-397">É mapeado para o controlador `Products` e a ação `Details` (`id` definido como 123).</span><span class="sxs-lookup"><span data-stu-id="f621e-397">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f621e-398">É mapeado para o controlador `Home` e o método `Index` (`id` é ignorado).</span><span class="sxs-lookup"><span data-stu-id="f621e-398">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f621e-399">Em geral, o uso de um modelo é a abordagem mais simples para o roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-399">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f621e-400">Restrições e padrões também podem ser especificados fora do modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-400">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-401">Habilite o [Log](xref:fundamentals/logging/index) para ver como as implementações de roteamento internas, como <xref:Microsoft.AspNetCore.Routing.Route>, correspondem às solicitações.</span><span class="sxs-lookup"><span data-stu-id="f621e-401">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f621e-402">Nomes reservados de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-402">Reserved routing names</span></span>

<span data-ttu-id="f621e-403">As seguintes palavras-chave são nomes reservados e não podem ser usadas como nomes de rota ou parâmetros:</span><span class="sxs-lookup"><span data-stu-id="f621e-403">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f621e-404">Referência de restrição de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-404">Route constraint reference</span></span>

<span data-ttu-id="f621e-405">As restrições de rota são executadas quando ocorre uma correspondência com a URL de entrada e é criado um token do caminho da URL em valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-405">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f621e-406">Em geral, as restrições da rota inspecionam o valor de rota associado por meio do modelo de rota e tomam uma decisão do tipo "sim/não" sobre se o valor é aceitável ou não.</span><span class="sxs-lookup"><span data-stu-id="f621e-406">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f621e-407">Algumas restrições da rota usam dados fora do valor de rota para considerar se a solicitação pode ser encaminhada.</span><span class="sxs-lookup"><span data-stu-id="f621e-407">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f621e-408">Por exemplo, a <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> pode aceitar ou rejeitar uma solicitação de acordo com o verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-408">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f621e-409">As restrições são usadas em solicitações de roteamento e na geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-409">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f621e-410">Não use restrições para a **validação de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f621e-410">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f621e-411">Se as restrições forem usadas para a **validação de entrada**, uma entrada inválida resultará em uma resposta *404 – Não Encontrado*, em vez de *400 – Solicitação Inválida* com uma mensagem de erro apropriada.</span><span class="sxs-lookup"><span data-stu-id="f621e-411">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f621e-412">As restrições de rota são usadas para **desfazer a ambiguidade** entre rotas semelhantes, não para validar as entradas de uma rota específica.</span><span class="sxs-lookup"><span data-stu-id="f621e-412">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f621e-413">A tabela a seguir demonstra restrições de rota de exemplo e seu comportamento esperado.</span><span class="sxs-lookup"><span data-stu-id="f621e-413">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f621e-414">restrição</span><span class="sxs-lookup"><span data-stu-id="f621e-414">constraint</span></span> | <span data-ttu-id="f621e-415">{1&gt;Exemplo&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-415">Example</span></span> | <span data-ttu-id="f621e-416">Correspondências de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-416">Example Matches</span></span> | <span data-ttu-id="f621e-417">{1&gt;Observações&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-417">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f621e-418">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-418">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-419">Corresponde a qualquer inteiro</span><span class="sxs-lookup"><span data-stu-id="f621e-419">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f621e-420">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f621e-420">`true`, `FALSE`</span></span> | <span data-ttu-id="f621e-421">Corresponde a `true` ou `false` (não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-421">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f621e-422">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f621e-422">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f621e-423">Corresponde a um valor `DateTime` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-423">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f621e-424">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f621e-424">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f621e-425">Corresponde a um valor `decimal` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-425">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f621e-426">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-426">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-427">Corresponde a um valor `double` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-427">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f621e-428">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-428">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-429">Corresponde a um valor `float` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-429">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f621e-430">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f621e-430">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f621e-431">Corresponde a um valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-431">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f621e-432">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-432">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-433">Corresponde a um valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-433">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f621e-434">A cadeia de caracteres deve ter, no mínimo, 4 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-434">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f621e-435">A cadeia de caracteres não pode ser maior que 8 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-435">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f621e-436">A cadeia de caracteres deve ter exatamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-436">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f621e-437">A cadeia de caracteres deve ter, pelo menos, 8 e não mais de 16 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-437">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f621e-438">O valor inteiro deve ser, pelo menos, 18</span><span class="sxs-lookup"><span data-stu-id="f621e-438">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f621e-439">O valor inteiro não deve ser maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-439">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f621e-440">O valor inteiro deve ser, pelo menos, 18, mas não maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-440">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f621e-441">A cadeia de caracteres deve consistir em um ou mais caracteres alfabéticos (`a`-`z`, não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-441">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f621e-442">A cadeia de caracteres deve corresponder à expressão regular (veja as dicas sobre como definir uma expressão regular)</span><span class="sxs-lookup"><span data-stu-id="f621e-442">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f621e-443">Usado para impor que um valor não parâmetro está presente durante a geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-443">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f621e-444">Várias restrições delimitadas por dois-pontos podem ser aplicadas a um único parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-444">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f621e-445">Por exemplo, a restrição a seguir restringe um parâmetro para um valor inteiro de 1 ou maior:</span><span class="sxs-lookup"><span data-stu-id="f621e-445">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f621e-446">As restrições de rota que verificam a URL e são convertidas em um tipo CLR (como `int` ou `DateTime`) sempre usam a cultura invariável.</span><span class="sxs-lookup"><span data-stu-id="f621e-446">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f621e-447">Essas restrições consideram que a URL não é localizável.</span><span class="sxs-lookup"><span data-stu-id="f621e-447">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f621e-448">As restrições de rota fornecidas pela estrutura não modificam os valores armazenados nos valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-448">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f621e-449">Todos os valores de rota analisados com base na URL são armazenados como cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-449">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f621e-450">Por exemplo, a restrição `float` tenta converter o valor de rota em um float, mas o valor convertido é usado somente para verificar se ele pode ser convertido em um float.</span><span class="sxs-lookup"><span data-stu-id="f621e-450">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f621e-451">Expressões regulares</span><span class="sxs-lookup"><span data-stu-id="f621e-451">Regular expressions</span></span>

<span data-ttu-id="f621e-452">A estrutura do ASP.NET Core adiciona `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` ao construtor de expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-452">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f621e-453">Confira <xref:System.Text.RegularExpressions.RegexOptions> para obter uma descrição desses membros.</span><span class="sxs-lookup"><span data-stu-id="f621e-453">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f621e-454">As expressões regulares usam delimitadores e tokens semelhantes aos usados pelo Roteamento e pela linguagem C#.</span><span class="sxs-lookup"><span data-stu-id="f621e-454">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f621e-455">Os tokens de expressão regular precisam ter escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-455">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f621e-456">Para usar a expressão regular `^\d`\\`-\d`\`-\d`\`$` no roteamento, a expressão precisa ter os caracteres `\` (barra invertida) fornecidos na cadeia de caracteres como caracteres `\\` (barra invertida dupla) no arquivo de origem C# para fazer o escape do caractere de escape da cadeia de caracteres `\` (a menos que estejam sendo usados [literais de cadeia de caracteres textuais](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f621e-456">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f621e-457">Para fazer o escape dos caracteres de delimitador de parâmetro de roteamento (`{`, `}`, `[`, `]`), duplique os caracteres na expressão (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="f621e-457">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f621e-458">A tabela a seguir mostra uma expressão regular e a versão com escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-458">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f621e-459">Expressão Regular</span><span class="sxs-lookup"><span data-stu-id="f621e-459">Regular Expression</span></span>    | <span data-ttu-id="f621e-460">Expressão regular com escape</span><span class="sxs-lookup"><span data-stu-id="f621e-460">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f621e-461">As expressões regulares usadas no roteamento geralmente começam com o caractere de acento circunflexo (`^`) e correspondem à posição inicial da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-461">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f621e-462">As expressões geralmente terminam com o caractere de cifrão (`$`) e correspondem ao final da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-462">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f621e-463">Os caracteres `^` e `$` garantem que a expressão regular corresponde a todo o valor do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-463">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f621e-464">Sem os caracteres `^` e `$`, a expressão regular corresponde a qualquer subcadeia de caracteres na cadeia de caracteres, o que geralmente não é o desejado.</span><span class="sxs-lookup"><span data-stu-id="f621e-464">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f621e-465">A tabela a seguir fornece exemplos e explica por que eles encontram ou não uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-465">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f621e-466">Expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-466">Expression</span></span>   | <span data-ttu-id="f621e-467">String</span><span class="sxs-lookup"><span data-stu-id="f621e-467">String</span></span>    | <span data-ttu-id="f621e-468">Corresponder a</span><span class="sxs-lookup"><span data-stu-id="f621e-468">Match</span></span> | <span data-ttu-id="f621e-469">Comentário</span><span class="sxs-lookup"><span data-stu-id="f621e-469">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f621e-470">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-470">hello</span></span>     | <span data-ttu-id="f621e-471">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-471">Yes</span></span>   | <span data-ttu-id="f621e-472">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-472">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-473">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-473">123abc456</span></span> | <span data-ttu-id="f621e-474">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-474">Yes</span></span>   | <span data-ttu-id="f621e-475">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-475">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-476">mz</span><span class="sxs-lookup"><span data-stu-id="f621e-476">mz</span></span>        | <span data-ttu-id="f621e-477">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-477">Yes</span></span>   | <span data-ttu-id="f621e-478">Corresponde à expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-478">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f621e-479">MZ</span><span class="sxs-lookup"><span data-stu-id="f621e-479">MZ</span></span>        | <span data-ttu-id="f621e-480">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-480">Yes</span></span>   | <span data-ttu-id="f621e-481">Não diferencia maiúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f621e-481">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-482">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-482">hello</span></span>     | <span data-ttu-id="f621e-483">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-483">No</span></span>    | <span data-ttu-id="f621e-484">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-484">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-485">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-485">123abc456</span></span> | <span data-ttu-id="f621e-486">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-486">No</span></span>    | <span data-ttu-id="f621e-487">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-487">See `^` and `$` above</span></span> |

<span data-ttu-id="f621e-488">Para saber mais sobre a sintaxe de expressões regulares, confira [Expressões regulares do .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-488">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f621e-489">Para restringir um parâmetro a um conjunto conhecido de valores possíveis, use uma expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-489">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f621e-490">Por exemplo, `{action:regex(^(list|get|create)$)}` apenas corresponde o valor da rota `action` a `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="f621e-490">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f621e-491">Se passada para o dicionário de restrições, a cadeia de caracteres `^(list|get|create)$` é equivalente.</span><span class="sxs-lookup"><span data-stu-id="f621e-491">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f621e-492">As restrições passadas para o dicionário de restrições (não embutidas em um modelo) que não correspondem a uma das restrições conhecidas também são tratadas como expressões regulares.</span><span class="sxs-lookup"><span data-stu-id="f621e-492">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f621e-493">Restrições de rota personalizadas</span><span class="sxs-lookup"><span data-stu-id="f621e-493">Custom Route Constraints</span></span>

<span data-ttu-id="f621e-494">Além das restrições de rota internas, é possível criar restrições de rota personalizadas com a implementação da interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f621e-494">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f621e-495">A interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contém um único método, `Match`, que retorna `true` quando a restrição é satisfeita. Caso contrário, retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="f621e-495">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f621e-496">Para usar uma <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, o tipo de restrição de rota deve ser registrado com o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo, no contêiner de serviço do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-496">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f621e-497">O <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> é um dicionário que mapeia as chaves de restrição de rota para implementações de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validam essas restrições.</span><span class="sxs-lookup"><span data-stu-id="f621e-497">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f621e-498">É possível atualizar o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo no `Startup.ConfigureServices` como parte de uma chamada [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> diretamente com `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f621e-498">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f621e-499">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-499">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f621e-500">a restrição pode então ser aplicada às rotas da maneira usual, usando o nome especificado ao registrar o tipo de restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-500">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f621e-501">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-501">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="f621e-502">Referência de parâmetro de transformador</span><span class="sxs-lookup"><span data-stu-id="f621e-502">Parameter transformer reference</span></span>

<span data-ttu-id="f621e-503">Transformadores de parâmetro:</span><span class="sxs-lookup"><span data-stu-id="f621e-503">Parameter transformers:</span></span>

* <span data-ttu-id="f621e-504">Executar ao gerar um link para um <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-504">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="f621e-505">Implementar `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="f621e-505">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="f621e-506">São configurados usando <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="f621e-506">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="f621e-507">Usam o valor de rota do parâmetro e o transformam em um novo valor de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-507">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="f621e-508">Resultam no uso do valor transformado no link gerado.</span><span class="sxs-lookup"><span data-stu-id="f621e-508">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="f621e-509">Por exemplo, um transformador de parâmetro `slugify` personalizado em padrão de rota `blog\{article:slugify}` com `Url.Action(new { article = "MyTestArticle" })` gera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="f621e-509">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="f621e-510">Para usar um transformador de parâmetro em um padrão de rota, configure-o primeiro usando <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-510">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="f621e-511">Os transformadores de parâmetro são usados pela estrutura para transformar o URI no qual um ponto de extremidade é resolvido.</span><span class="sxs-lookup"><span data-stu-id="f621e-511">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="f621e-512">Por exemplo, o ASP.NET Core MVC usa os transformadores de parâmetro para transformar o valor de rota usado para corresponder a um `area`, `controller`, `action` e `page`.</span><span class="sxs-lookup"><span data-stu-id="f621e-512">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="f621e-513">Com a rota anterior, a ação `SubscriptionManagementController.GetAll()` é combinada com o URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f621e-513">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="f621e-514">Um transformador de parâmetro não altera os valores de rota usados para gerar um link.</span><span class="sxs-lookup"><span data-stu-id="f621e-514">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="f621e-515">Por exemplo, `Url.Action("GetAll", "SubscriptionManagement")` gera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f621e-515">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="f621e-516">ASP.NET Core fornece convenções de API para usar transformadores de parâmetro com as rotas geradas:</span><span class="sxs-lookup"><span data-stu-id="f621e-516">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="f621e-517">ASP.NET Core MVC tem a convenção de API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f621e-517">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="f621e-518">Essa convenção aplica um transformador de parâmetro especificado a todas as rotas de atributo no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-518">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="f621e-519">O transformador de parâmetro transforma os tokens de rota do atributo conforme elas são substituídas.</span><span class="sxs-lookup"><span data-stu-id="f621e-519">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="f621e-520">Para obter mais informações, confira [Usar um transformador de parâmetro para personalizar a substituição de token](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="f621e-520">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="f621e-521">O Razor Pages tem a convenção de API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f621e-521">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="f621e-522">Essa convenção aplica um transformador de parâmetro especificado a todas as Razor Pages descobertas automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f621e-522">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="f621e-523">O transformador de parâmetro transforma os segmentos de nome de arquivo e pasta de rotas do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-523">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="f621e-524">Para obter mais informações, confira [Usar um transformador de parâmetros para personalizar rotas de página](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="f621e-524">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="f621e-525">Referência de geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-525">URL generation reference</span></span>

<span data-ttu-id="f621e-526">O exemplo a seguir mostra como gerar um link para uma rota com base em um dicionário de valores de rota e em um <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f621e-526">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f621e-527">O <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> gerado no final do exemplo anterior é `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f621e-527">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f621e-528">O dicionário fornece os valores de rota `operation` e `id` do modelo "Rastrear rota do pacote", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-528">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f621e-529">Para obter detalhes, consulte o código de exemplo na seção [Usar o middleware de roteamento](#use-routing-middleware) ou no [aplicativo de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f621e-529">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f621e-530">O segundo parâmetro para o construtor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> é uma coleção de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f621e-530">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f621e-531">Os valores de ambiente são convenientes de serem usados porque limitam o número de valores que um desenvolvedor precisa especificar em um contexto de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-531">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f621e-532">Os valores de rota atuais da solicitação atual são considerados valores de ambiente para a geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-532">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f621e-533">Na ação `About` de um aplicativo ASP.NET Core MVC do `HomeController`, não é necessário especificar o valor de rota do controlador a ser vinculado à ação `Index` – o valor de ambiente &mdash; é usado.</span><span class="sxs-lookup"><span data-stu-id="f621e-533">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f621e-534">Os valores de ambiente que não correspondem a um parâmetro são ignorados.</span><span class="sxs-lookup"><span data-stu-id="f621e-534">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f621e-535">Os valores de ambiente também são ignorados quando um valor fornecido explicitamente substitui o valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f621e-535">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f621e-536">A correspondência ocorre da esquerda para a direita na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-536">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f621e-537">Valores fornecidos explicitamente, mas que não correspondem a um segmento da rota, são adicionados à cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="f621e-537">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f621e-538">A tabela a seguir mostra o resultado do uso do modelo de rota `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-538">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f621e-539">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f621e-539">Ambient Values</span></span>                     | <span data-ttu-id="f621e-540">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f621e-540">Explicit Values</span></span>                        | <span data-ttu-id="f621e-541">Resultado</span><span class="sxs-lookup"><span data-stu-id="f621e-541">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f621e-542">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-542">controller = "Home"</span></span>                | <span data-ttu-id="f621e-543">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-543">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-544">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-544">controller = "Home"</span></span>                | <span data-ttu-id="f621e-545">controlador = "Order", ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-545">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f621e-546">controlador = "Home", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-546">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f621e-547">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-547">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-548">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-548">controller = "Home"</span></span>                | <span data-ttu-id="f621e-549">ação = "About", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-549">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f621e-550">Se uma rota tem um valor padrão que não corresponde a um parâmetro e esse valor é fornecido de forma explícita, ele precisa corresponder ao valor padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-550">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f621e-551">A geração de link somente gera um link para essa rota quando os valores correspondentes de `controller` e `action` são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-551">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f621e-552">Segmentos complexos</span><span class="sxs-lookup"><span data-stu-id="f621e-552">Complex segments</span></span>

<span data-ttu-id="f621e-553">Segmentos complexos (por exemplo, `[Route("/x{token}y")]`) são processados por meio da combinação de literais da direita para a esquerda, de uma maneira diferente de Greedy.</span><span class="sxs-lookup"><span data-stu-id="f621e-553">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f621e-554">Confira [este código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para ver uma explicação detalhada de como os segmentos complexos são combinados.</span><span class="sxs-lookup"><span data-stu-id="f621e-554">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f621e-555">O [exemplo de código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) não é usado pelo ASP.NET Core, mas fornece uma explicação adequada sobre segmentos complexos.</span><span class="sxs-lookup"><span data-stu-id="f621e-555">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="f621e-556">Configurando metadados de ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="f621e-556">Configuring endpoint metadata</span></span>

<span data-ttu-id="f621e-557">Os links a seguir fornecem informações sobre como configurar metadados de ponto de extremidade:</span><span class="sxs-lookup"><span data-stu-id="f621e-557">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="f621e-558">Habilitar CORS com roteamento de ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="f621e-558">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="f621e-559">[Exemplo de IAuthorizationPolicyProvider](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) usando um atributo de `[MinimumAgeAuthorize]` personalizado</span><span class="sxs-lookup"><span data-stu-id="f621e-559">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="f621e-560">[Testar a autenticação com o atributo [autorizar]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="f621e-560">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="f621e-561">[Selecionando o esquema com o atributo [autorizar]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="f621e-561">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="f621e-562">[Aplicando políticas usando o atributo [autorizar]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="f621e-562">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="f621e-563">Correspondência de host em rotas com RequireHost</span><span class="sxs-lookup"><span data-stu-id="f621e-563">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="f621e-564">`RequireHost` aplica uma restrição à rota que requer o host especificado.</span><span class="sxs-lookup"><span data-stu-id="f621e-564">`RequireHost` applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="f621e-565">O parâmetro `RequireHost` ou `[Host]` pode ser:</span><span class="sxs-lookup"><span data-stu-id="f621e-565">The `RequireHost` or `[Host]` parameter can be:</span></span>

* <span data-ttu-id="f621e-566">Host: `www.domain.com` (corresponde a `www.domain.com` com qualquer porta)</span><span class="sxs-lookup"><span data-stu-id="f621e-566">Host: `www.domain.com` (matches `www.domain.com` with any port)</span></span>
* <span data-ttu-id="f621e-567">Host com curinga: `*.domain.com` (corresponde a `www.domain.com`, `subdomain.domain.com`ou `www.subdomain.domain.com` em qualquer porta)</span><span class="sxs-lookup"><span data-stu-id="f621e-567">Host with wildcard: `*.domain.com` (matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port)</span></span>
* <span data-ttu-id="f621e-568">Porta: `*:5000` (corresponde à porta 5000 com qualquer host)</span><span class="sxs-lookup"><span data-stu-id="f621e-568">Port: `*:5000` (matches port 5000 with any host)</span></span>
* <span data-ttu-id="f621e-569">Host e porta: `www.domain.com:5000`, `*.domain.com:5000` (corresponde ao host e à porta)</span><span class="sxs-lookup"><span data-stu-id="f621e-569">Host and port: `www.domain.com:5000`, `*.domain.com:5000` (matches host and port)</span></span>

<span data-ttu-id="f621e-570">Vários parâmetros podem ser especificados usando `RequireHost` ou `[Host]`.</span><span class="sxs-lookup"><span data-stu-id="f621e-570">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="f621e-571">A restrição corresponderá aos hosts válidos para qualquer um dos parâmetros.</span><span class="sxs-lookup"><span data-stu-id="f621e-571">The constraint will match hosts valid for any of the parameters.</span></span> <span data-ttu-id="f621e-572">Por exemplo, `[Host("domain.com", "*.domain.com")]` corresponderá `domain.com`, `www.domain.com`ou `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="f621e-572">For example, `[Host("domain.com", "*.domain.com")]` will match `domain.com`, `www.domain.com`, or `subdomain.domain.com`.</span></span>

<span data-ttu-id="f621e-573">O código a seguir usa `RequireHost` para exigir o host especificado na rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-573">The following code uses `RequireHost` to require the specified host on the route:</span></span>

```csharp
public void Configure(IApplicationBuilder app)
{
    app.UseRouting();

    app.UseEndpoints(endpoints =>
    {
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi Contoso!"))
            .RequireHost("contoso.com");
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi AdventureWorks!"))
            .RequireHost("adventure-works.com");
        endpoints.MapHealthChecks("/healthz").RequireHost("*:8080");
    });
}
```

<span data-ttu-id="f621e-574">O código a seguir usa o atributo `[Host]` para exigir o host especificado no controlador:</span><span class="sxs-lookup"><span data-stu-id="f621e-574">The following code uses the `[Host]` attribute to require the specified host on the controller:</span></span>

```csharp
[Host("contoso.com", "adventure-works.com")]
public class HomeController : Controller
{
    private readonly ILogger<HomeController> _logger;

    public HomeController(ILogger<HomeController> logger)
    {
        _logger = logger;
    }

    public IActionResult Index()
    {
        return View();
    }

    [Host("example.com:8080")]
    public IActionResult Privacy()
    {
        return View();
    }

}
```

<span data-ttu-id="f621e-575">Quando o atributo `[Host]` é aplicado ao controlador e ao método de ação:</span><span class="sxs-lookup"><span data-stu-id="f621e-575">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="f621e-576">O atributo na ação é usado.</span><span class="sxs-lookup"><span data-stu-id="f621e-576">The attribute on the action is used.</span></span>
* <span data-ttu-id="f621e-577">O atributo do controlador é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f621e-577">The controller attribute is ignored.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="f621e-578">O roteamento é responsável por mapear URIs de solicitação para pontos de extremidade e expedir solicitações de entrada para esses pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-578">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="f621e-579">As rotas são definidas no aplicativo e configuradas quando o aplicativo é iniciado.</span><span class="sxs-lookup"><span data-stu-id="f621e-579">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f621e-580">Uma rota pode opcionalmente extrair os valores da URL contida na solicitação e esses valores podem então ser usados para o processamento da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-580">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f621e-581">Usando informações de rota do aplicativo, o roteamento também é capaz de gerar URLs que são mapeadas para pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-581">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="f621e-582">Para usar os últimos cenários de roteamento no ASP.NET Core 2.2, especifique a [versão de compatibilidade](xref:mvc/compatibility-version) com o registro de serviços MVC em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-582">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="f621e-583">A opção <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> determina se o roteamento deve usar internamente a lógica baseada em ponto de extremidade ou a lógica baseada em <xref:Microsoft.AspNetCore.Routing.IRouter> do ASP.NET Core 2.1 ou anterior.</span><span class="sxs-lookup"><span data-stu-id="f621e-583">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f621e-584">Quando a versão de compatibilidade é definida como 2.2 ou posterior, o valor padrão é `true`.</span><span class="sxs-lookup"><span data-stu-id="f621e-584">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="f621e-585">Defina o valor como `false` para usar a lógica de roteamento anterior:</span><span class="sxs-lookup"><span data-stu-id="f621e-585">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="f621e-586">Para obter mais informações sobre o roteamento baseado em <xref:Microsoft.AspNetCore.Routing.IRouter>, confira a [versão do ASP.NET Core 2.1 deste tópico](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="f621e-586">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f621e-587">Este documento aborda o roteamento de nível inferior do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="f621e-587">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f621e-588">Para obter informações sobre o roteamento do ASP.NET Core MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-588">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f621e-589">Para obter informações sobre convenções de roteamento no Razor Pages, confira <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-589">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-590">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f621e-590">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f621e-591">Conceitos básicos sobre roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-591">Routing basics</span></span>

<span data-ttu-id="f621e-592">A maioria dos aplicativos deve escolher um esquema de roteamento básico e descritivo para que as URLs sejam legíveis e significativas.</span><span class="sxs-lookup"><span data-stu-id="f621e-592">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f621e-593">A rota convencional padrão `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f621e-593">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f621e-594">Dá suporte a um esquema de roteamento básico e descritivo.</span><span class="sxs-lookup"><span data-stu-id="f621e-594">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f621e-595">É um ponto de partida útil para aplicativos baseados em interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f621e-595">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f621e-596">Os desenvolvedores geralmente adicionam outras rotas concisas às áreas de alto tráfego de um aplicativo em situações especiais (por exemplo, pontos de extremidade de blog e comércio eletrônico) usando o [roteamento de atributo](xref:mvc/controllers/routing#attribute-routing) ou rotas convencionais dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-596">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f621e-597">As APIs da Web devem usar o roteamento de atributo para modelar a funcionalidade do aplicativo como um conjunto de recursos em que as operações são representadas por verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-597">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f621e-598">Isso significa que muitas operações (por exemplo, GET, POST) no mesmo recurso lógico usarão a mesma URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-598">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f621e-599">O roteamento de atributo fornece um nível de controle necessário para projetar cuidadosamente o layout de ponto de extremidade público de uma API.</span><span class="sxs-lookup"><span data-stu-id="f621e-599">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f621e-600">Os aplicativos do Razor Pages usam o roteamento convencional padrão para fornecer recursos nomeados na pasta *Pages* de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-600">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f621e-601">Estão disponíveis convenções adicionais que permitem a personalização do comportamento de roteamento do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-601">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f621e-602">Para obter mais informações, consulte <xref:razor-pages/index> e <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-602">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-603">O suporte à geração de URL permite que o aplicativo seja desenvolvido sem hard-coding das URLs para vincular o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-603">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f621e-604">Esse suporte permite começar com uma configuração de roteamento básica e modificar as rotas, depois que o layout de recurso do aplicativo é determinado.</span><span class="sxs-lookup"><span data-stu-id="f621e-604">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f621e-605">O roteamento usa *pontos de extremidade* (`Endpoint`) para representar os pontos de extremidade lógicos em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-605">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="f621e-606">Um ponto de extremidade define um delegado para processar solicitações e uma coleção de metadados arbitrários.</span><span class="sxs-lookup"><span data-stu-id="f621e-606">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="f621e-607">Os metadados usados implementam interesses paralelos com base em políticas e na configuração anexada a cada ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-607">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="f621e-608">O sistema de roteamento tem as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="f621e-608">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f621e-609">A sintaxe do modelo de rota é usada para definir rotas com os parâmetros de rota com tokens criados.</span><span class="sxs-lookup"><span data-stu-id="f621e-609">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f621e-610">A configuração de ponto de extremidade de estilo convencional e de estilo de atributo é permitida.</span><span class="sxs-lookup"><span data-stu-id="f621e-610">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f621e-611"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> é usado para determinar se um parâmetro de URL contém um valor válido para determinada restrição de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-611"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f621e-612">Modelos de aplicativo, como MVC/Razor Pages, registram todos os seus pontos de extremidade, que têm uma implementação previsível de cenários de roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-612">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f621e-613">A implementação de roteamento toma decisões de roteamento, sempre que desejado no pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-613">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="f621e-614">O Middleware que aparece após um Middleware de Roteamento pode inspecionar o resultado da decisão de ponto de extremidade do Middleware de Roteamento para determinado URI de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-614">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="f621e-615">É possível enumerar todos os pontos de extremidade no aplicativo em qualquer lugar do pipeline de middleware.</span><span class="sxs-lookup"><span data-stu-id="f621e-615">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="f621e-616">Um aplicativo pode usar o roteamento para gerar URLs (por exemplo, para redirecionamento ou links) com base nas informações de ponto de extremidade e evitar URLs embutidas em código, o que ajuda na facilidade de manutenção.</span><span class="sxs-lookup"><span data-stu-id="f621e-616">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f621e-617">A geração de URL baseia-se em endereços, que dá suporte à extensibilidade arbitrária:</span><span class="sxs-lookup"><span data-stu-id="f621e-617">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="f621e-618">A API de Gerador de Link (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) pode ser resolvida em qualquer lugar usando a [DI (Injeção de Dependência)](xref:fundamentals/dependency-injection) para gerar URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-618">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="f621e-619">Quando a API de Gerador de Link não está disponível por meio da DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> oferece métodos para criar URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-619">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="f621e-620">Com o lançamento do roteamento de ponto de extremidade no ASP.NET Core 2.2, a vinculação de ponto de extremidade fica limitada às ações e às páginas do MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-620">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="f621e-621">As expansões de funcionalidades de vinculação de ponto de extremidade estão planejadas para versões futuras.</span><span class="sxs-lookup"><span data-stu-id="f621e-621">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="f621e-622">O roteamento está conectado ao pipeline do [middleware](xref:fundamentals/middleware/index) pela classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="f621e-622">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f621e-623">O [ASP.NET Core MVC](xref:mvc/overview) adiciona o roteamento ao pipeline de middleware como parte de sua configuração e manipula o roteamento nos aplicativos do MVC e do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-623">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f621e-624">Para saber como usar o roteamento como um componente autônomo, confira a seção [Usar o Middleware de Roteamento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f621e-624">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f621e-625">Correspondência de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-625">URL matching</span></span>

<span data-ttu-id="f621e-626">A correspondência de URL é o processo pelo qual o roteamento expede uma solicitação de entrada para um *ponto de extremidade*.</span><span class="sxs-lookup"><span data-stu-id="f621e-626">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="f621e-627">Esse processo se baseia nos dados do caminho da URL, mas pode ser estendido para considerar qualquer dado na solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-627">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f621e-628">A capacidade de expedir solicitações para manipuladores separados é fundamental para dimensionar o tamanho e a complexidade de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-628">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f621e-629">O sistema de roteamento no roteamento de ponto de extremidade é responsável por todas as decisões de expedição.</span><span class="sxs-lookup"><span data-stu-id="f621e-629">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="f621e-630">Como o middleware aplica políticas com base no ponto de extremidade selecionado, é importante que qualquer decisão que possa afetar a expedição ou a aplicação de políticas de segurança seja feita dentro do sistema de roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-630">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="f621e-631">Quando o delegado do ponto de extremidade é executado, as propriedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) são definidas com valores apropriados com base no processamento da solicitação executado até o momento.</span><span class="sxs-lookup"><span data-stu-id="f621e-631">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f621e-632">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) é um dicionário de *valores de rota* produzido por meio da rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-632">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f621e-633">Esses valores geralmente são determinados pela criação de token da URL e podem ser usados para aceitar a entrada do usuário ou tomar outras decisões de expedição dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-633">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f621e-634">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) é um recipiente de propriedades de dados adicionais relacionados à rota correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-634">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f621e-635"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> são fornecidos para dar suporte à associação de dados de estado com cada rota para que o aplicativo possa tomar decisões com base em qual rota teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-635"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f621e-636">Esses valores são definidos pelo desenvolvedor e **não** afetam de forma alguma o comportamento do roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-636">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f621e-637">Além disso, os valores em stash em [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) podem ser de qualquer tipo, ao contrário de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que devem ser conversíveis de/para cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-637">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f621e-638">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) é uma lista das rotas que participaram da correspondência bem-sucedida da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-638">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f621e-639">As rotas podem ser aninhadas uma dentro da outra.</span><span class="sxs-lookup"><span data-stu-id="f621e-639">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f621e-640">A propriedade <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> reflete o caminho pela árvore lógica de rotas que resultou em uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-640">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f621e-641">Em geral, o primeiro item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é a coleção de rotas e deve ser usado para a geração de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-641">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f621e-642">O último item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é o manipulador de rotas que teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-642">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="f621e-643">Geração de URL com o LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="f621e-643">URL generation with LinkGenerator</span></span>

<span data-ttu-id="f621e-644">Geração de URL é o processo pelo qual o roteamento pode criar um caminho de URL de acordo com um conjunto de valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-644">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f621e-645">Isso permite uma separação lógica entre os pontos de extremidade e as URLs que os acessam.</span><span class="sxs-lookup"><span data-stu-id="f621e-645">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="f621e-646">O roteamento de ponto de extremidade inclui a API de Gerador de Link (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="f621e-646">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="f621e-647"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> é um serviço singleton que pode ser recuperado por meio da DI.</span><span class="sxs-lookup"><span data-stu-id="f621e-647"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="f621e-648">A API pode ser usada fora do contexto de uma solicitação em execução.</span><span class="sxs-lookup"><span data-stu-id="f621e-648">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="f621e-649"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> do MVC e cenários que dependem de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como [Auxiliares de Marcação](xref:mvc/views/tag-helpers/intro), Auxiliares de HTML e [Resultados da Ação](xref:mvc/controllers/actions), usam o gerador de link para fornecer funcionalidades de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-649">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="f621e-650">O gerador de link é respaldado pelo conceito de um *endereço* e *esquemas de endereço*.</span><span class="sxs-lookup"><span data-stu-id="f621e-650">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="f621e-651">Um esquema de endereço é uma maneira de determinar os pontos de extremidade que devem ser considerados para a geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-651">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="f621e-652">Por exemplo, os cenários de nome de rota e valores de rota com os quais muitos usuários estão familiarizados no MVC/Razor Pages são implementados como um esquema de endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-652">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="f621e-653">O gerador de link pode ser vinculado a ações e páginas do MVC/Razor Pages por meio dos seguintes métodos de extensão:</span><span class="sxs-lookup"><span data-stu-id="f621e-653">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="f621e-654">Uma sobrecarga desses métodos aceita argumentos que incluem o `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="f621e-654">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="f621e-655">Esses métodos são funcionalmente equivalentes a `Url.Action` e `Url.Page`, mas oferecem mais flexibilidade e opções.</span><span class="sxs-lookup"><span data-stu-id="f621e-655">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="f621e-656">Os métodos `GetPath*` são mais semelhantes a `Url.Action` e `Url.Page`, pois geram um URI que contém um caminho absoluto.</span><span class="sxs-lookup"><span data-stu-id="f621e-656">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="f621e-657">Os métodos `GetUri*` sempre geram um URI absoluto que contém um esquema e um host.</span><span class="sxs-lookup"><span data-stu-id="f621e-657">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="f621e-658">Os métodos que aceitam um `HttpContext` geram um URI no contexto da solicitação em execução.</span><span class="sxs-lookup"><span data-stu-id="f621e-658">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="f621e-659">Os valores de rota de ambiente, o caminho base da URL, o esquema e o host da solicitação em execução são usados, a menos que sejam substituídos.</span><span class="sxs-lookup"><span data-stu-id="f621e-659">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="f621e-660"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> é chamado com um endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-660"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="f621e-661">A geração de um URI ocorre em duas etapas:</span><span class="sxs-lookup"><span data-stu-id="f621e-661">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="f621e-662">Um endereço é associado a uma lista de pontos de extremidade que correspondem ao endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-662">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="f621e-663">O `RoutePattern` de cada ponto de extremidade é avaliado até que seja encontrado um padrão de rota correspondente aos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-663">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="f621e-664">A saída resultante é combinada com as outras partes de URI fornecidas ao gerador de link e é retornada.</span><span class="sxs-lookup"><span data-stu-id="f621e-664">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="f621e-665">Os métodos fornecidos pelo <xref:Microsoft.AspNetCore.Routing.LinkGenerator> dão suporte a funcionalidades de geração de link padrão para qualquer tipo de endereço.</span><span class="sxs-lookup"><span data-stu-id="f621e-665">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="f621e-666">A maneira mais conveniente usar o gerador de link é por meio de métodos de extensão que executam operações para um tipo de endereço específico.</span><span class="sxs-lookup"><span data-stu-id="f621e-666">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="f621e-667">Método de extensão</span><span class="sxs-lookup"><span data-stu-id="f621e-667">Extension Method</span></span>   | <span data-ttu-id="f621e-668">Descrição</span><span class="sxs-lookup"><span data-stu-id="f621e-668">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="f621e-669">Gera um URI com um caminho absoluto com base nos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-669">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="f621e-670">Gera um URI absoluto com base nos valores fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-670">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="f621e-671">Preste atenção às seguintes implicações da chamada de métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="f621e-671">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="f621e-672">Use métodos de extensão de `GetUri*` com cuidado em uma configuração de aplicativo que não valide o cabeçalho `Host` das solicitações de entrada.</span><span class="sxs-lookup"><span data-stu-id="f621e-672">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="f621e-673">Se o cabeçalho `Host` das solicitações de entrada não é validado, uma entrada de solicitação não confiável pode ser enviada novamente ao cliente em URIs em uma exibição/página.</span><span class="sxs-lookup"><span data-stu-id="f621e-673">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="f621e-674">Recomendamos que todos os aplicativos de produção configurem seu servidor para validar o cabeçalho `Host` com os valores válidos conhecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-674">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="f621e-675">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> com cuidado no middleware em combinação com `Map` ou `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="f621e-675">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="f621e-676">`Map*` altera o caminho base da solicitação em execução, o que afeta a saída da geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-676">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="f621e-677">Todas as APIs de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permitem a especificação de um caminho base.</span><span class="sxs-lookup"><span data-stu-id="f621e-677">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="f621e-678">Sempre especifique um caminho base vazio para desfazer o efeito de `Map*` na geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-678">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="f621e-679">Diferenças das versões anteriores de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-679">Differences from earlier versions of routing</span></span>

<span data-ttu-id="f621e-680">Existem algumas diferenças entre o roteamento de ponto de extremidade no ASP.NET Core 2.2 ou posterior e nas versões anteriores de roteamento no ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="f621e-680">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="f621e-681">O sistema de roteamento do ponto de extremidade não dá suporte à extensibilidade baseada em <xref:Microsoft.AspNetCore.Routing.IRouter>, incluindo a herança de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-681">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="f621e-682">O roteamento de ponto de extremidade não dá suporte a [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="f621e-682">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="f621e-683">Use a [versão de compatibilidade](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) para continuar usando o shim de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-683">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="f621e-684">O Roteamento de Ponto de Extremidade tem um comportamento diferente para o uso de maiúsculas dos URIs gerados ao usar rotas convencionais.</span><span class="sxs-lookup"><span data-stu-id="f621e-684">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="f621e-685">Considere o seguinte modelo de rota padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-685">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f621e-686">Suponha que você gere um link para uma ação usando a seguinte rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-686">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="f621e-687">Com o roteamento baseado em <xref:Microsoft.AspNetCore.Routing.IRouter>, esse código gera um URI igual a `/blog/ReadPost/17`, que respeita o uso de maiúsculas do valor de rota fornecido.</span><span class="sxs-lookup"><span data-stu-id="f621e-687">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="f621e-688">O roteamento de ponto de extremidade no ASP.NET Core 2.2 ou posterior produz `/Blog/ReadPost/17` ("Blog" está em letras maiúsculas).</span><span class="sxs-lookup"><span data-stu-id="f621e-688">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="f621e-689">O roteamento de ponto de extremidade fornece a interface `IOutboundParameterTransformer` que pode ser usada para personalizar esse comportamento globalmente ou para aplicar diferentes convenções ao mapeamento de URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-689">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="f621e-690">Para obter mais informações, confira a seção [Referência de transformador de parâmetro](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-690">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="f621e-691">A Geração de Link usada pelo MVC/Razor Pages com rotas convencionais tem um comportamento diferente ao tentar estabelecer um vínculo com um controlador/uma ação ou uma página não existente.</span><span class="sxs-lookup"><span data-stu-id="f621e-691">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="f621e-692">Considere o seguinte modelo de rota padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-692">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f621e-693">Suponha que você gere um link para uma ação usando o modelo padrão com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f621e-693">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="f621e-694">Com o roteamento baseado em `IRouter`, o resultado é sempre `/Blog/ReadPost/17`, mesmo se o `BlogController` não existe ou não tem um método de ação `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="f621e-694">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="f621e-695">Conforme esperado, o roteamento de ponto de extremidade no ASP.NET Core 2.2 ou posterior produz `/Blog/ReadPost/17` se o método de ação existe.</span><span class="sxs-lookup"><span data-stu-id="f621e-695">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="f621e-696">*No entanto, o roteamento de ponto de extremidade produz uma cadeia de caracteres vazia se a ação não existe.*</span><span class="sxs-lookup"><span data-stu-id="f621e-696">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="f621e-697">Conceitualmente, o roteamento de ponto de extremidade não pressupõe a existência do ponto de extremidade, caso a ação não exista.</span><span class="sxs-lookup"><span data-stu-id="f621e-697">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="f621e-698">O *algoritmo de invalidação de valor de ambiente* da geração de link tem um comportamento diferente quando usado com o roteamento de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-698">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="f621e-699">A *invalidação de valor de ambiente* é o algoritmo que decide quais valores de rota da solicitação em execução no momento (os valores de ambiente) podem ser usados em operações de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-699">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="f621e-700">O roteamento convencional sempre invalidava valores de rota extras ao estabelecer o vínculo com uma ação diferente.</span><span class="sxs-lookup"><span data-stu-id="f621e-700">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="f621e-701">O roteamento de atributo não tinha esse comportamento antes do lançamento do ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="f621e-701">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="f621e-702">Em versões anteriores do ASP.NET Core, os links para outra ação que usam os mesmos nomes de parâmetro de rota resultavam em erros de geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-702">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="f621e-703">No ASP.NET Core 2.2 ou posterior, as duas formas de roteamento invalidam os valores ao estabelecer o vínculo com outra ação.</span><span class="sxs-lookup"><span data-stu-id="f621e-703">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="f621e-704">Considere o exemplo a seguir no ASP.NET Core 2.1 ou anterior.</span><span class="sxs-lookup"><span data-stu-id="f621e-704">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f621e-705">Ao estabelecer o vínculo com outra ação (ou outra página), os valores de rota podem ser reutilizados de maneiras indesejadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-705">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="f621e-706">Em */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f621e-706">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="f621e-707">Em */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f621e-707">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="f621e-708">Se o URI é `/Store/Product/18` no ASP.NET Core 2.1 ou anterior, o link gerado na página Store/Info por `@Url.Page("/Login")` é `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="f621e-708">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="f621e-709">O valor de `id` igual a 18 é reutilizado, mesmo que o destino do link seja uma parte totalmente diferente do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-709">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="f621e-710">O valor de rota de `id` no contexto da página `/Login` provavelmente é um valor de ID de usuário, e não um valor de ID do produto (product ID) da loja.</span><span class="sxs-lookup"><span data-stu-id="f621e-710">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="f621e-711">No roteamento de ponto de extremidade com o ASP.NET Core 2.2 ou posterior, o resultado é `/Login`.</span><span class="sxs-lookup"><span data-stu-id="f621e-711">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="f621e-712">Os valores de ambiente não são reutilizados quando o destino vinculado é uma ação ou uma página diferente.</span><span class="sxs-lookup"><span data-stu-id="f621e-712">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="f621e-713">Sintaxe do parâmetro de rota de viagem de ida e volta: as barras "/" não são codificadas ao usar uma sintaxe do parâmetro catch-all de asterisco duplo (`**`).</span><span class="sxs-lookup"><span data-stu-id="f621e-713">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="f621e-714">Durante a geração de link, o sistema de roteamento codifica o valor capturado em um parâmetro catch-all de asterisco duplo (`**`) (por exemplo, `{**myparametername}`), exceto as barras "/".</span><span class="sxs-lookup"><span data-stu-id="f621e-714">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="f621e-715">O catch-all de asterisco duplo é compatível com o roteamento baseado em `IRouter` no ASP.NET Core 2.2 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="f621e-715">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="f621e-716">A sintaxe do parâmetro catch-all de asterisco único em versões anteriores do ASP.NET Core (`{*myparametername}`) permanece com suporte e as barras "/" são codificadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-716">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="f621e-717">Rota</span><span class="sxs-lookup"><span data-stu-id="f621e-717">Route</span></span>              | <span data-ttu-id="f621e-718">Link gerado com</span><span class="sxs-lookup"><span data-stu-id="f621e-718">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="f621e-719">`/search/admin%2Fproducts` (a barra "/" é codificada)</span><span class="sxs-lookup"><span data-stu-id="f621e-719">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="f621e-720">Exemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="f621e-720">Middleware example</span></span>

<span data-ttu-id="f621e-721">No exemplo a seguir, um middleware usa a API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para criar um link para um método de ação que lista os produtos da loja.</span><span class="sxs-lookup"><span data-stu-id="f621e-721">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="f621e-722">O uso do gerador de link com sua injeção em uma classe e uma chamada a `GenerateLink` está disponível para qualquer classe em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-722">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="f621e-723">Criar rotas</span><span class="sxs-lookup"><span data-stu-id="f621e-723">Create routes</span></span>

<span data-ttu-id="f621e-724">A maioria dos aplicativos cria rotas chamando <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou um dos métodos de extensão semelhantes definidos em <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f621e-724">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f621e-725">Qualquer um dos métodos de extensão de <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> cria uma instância de <xref:Microsoft.AspNetCore.Routing.Route> e a adicionam à coleção de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-725">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f621e-726"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> não aceita um parâmetro de manipulador de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-726"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f621e-727"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> apenas adiciona rotas que são manipuladas pelo <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-727"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f621e-728">Para saber mais sobre o roteamento no MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-728">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f621e-729">O exemplo de código a seguir é um exemplo de uma chamada <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por uma definição de rota típica do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-729">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-730">Esse modelo corresponde a um caminho de URL e extrai os valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-730">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f621e-731">Por exemplo, o caminho `/Products/Details/17` gera os seguintes valores de rota: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-731">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f621e-732">Os valores de rota são determinados pela divisão do caminho da URL em segmentos e pela correspondência de cada segmento com o nome do *parâmetro de rota* no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-732">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f621e-733">Os parâmetros de rota são nomeados.</span><span class="sxs-lookup"><span data-stu-id="f621e-733">Route parameters are named.</span></span> <span data-ttu-id="f621e-734">Os parâmetros são definidos com a colocação do nome do parâmetro em chaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-734">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f621e-735">O modelo anterior também pode corresponder ao caminho da URL `/` e produzir os valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-735">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f621e-736">Isso ocorre porque os parâmetros de rota `{controller}` e `{action}` têm valores padrão e o parâmetro de rota `id` é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-736">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f621e-737">Um sinal de igual (`=`) seguido de um valor após o nome do parâmetro de rota define um valor padrão para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-737">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f621e-738">Um ponto de interrogação (`?`) após o nome do parâmetro de rota define o parâmetro como opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-738">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f621e-739">Os parâmetros de rota com um valor padrão *sempre* produzem um valor de rota quando a rota corresponde.</span><span class="sxs-lookup"><span data-stu-id="f621e-739">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f621e-740">Os parâmetros opcionais não produzem um valor de rota quando não há nenhum segmento de caminho de URL correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-740">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f621e-741">Confira a seção [Referência de modelo de rota](#route-template-reference) para obter uma descrição completa dos recursos e da sintaxe de modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-741">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f621e-742">No seguinte exemplo, a definição do parâmetro de rota `{id:int}` define uma [restrição de rota](#route-constraint-reference) para o parâmetro de rota `id`:</span><span class="sxs-lookup"><span data-stu-id="f621e-742">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f621e-743">Esse modelo corresponde a um caminho de URL, como `/Products/Details/17`, mas não como `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f621e-743">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f621e-744">As restrições de rota implementam <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspecionam valores de rota para verificá-los.</span><span class="sxs-lookup"><span data-stu-id="f621e-744">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f621e-745">Neste exemplo, o valor de rota `id` precisa ser conversível em um inteiro.</span><span class="sxs-lookup"><span data-stu-id="f621e-745">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f621e-746">Confira [route-constraint-reference](#route-constraint-reference) para obter uma explicação das restrições de rota fornecidas pela estrutura.</span><span class="sxs-lookup"><span data-stu-id="f621e-746">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f621e-747">Sobrecargas adicionais de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceitam valores para `constraints`, `dataTokens` e `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f621e-747">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f621e-748">O uso típico desses parâmetros é passar um objeto de tipo anônimo, no qual os nomes da propriedade do tipo anônimo correspondem aos nomes do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-748">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f621e-749">Os seguintes exemplos de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> criam rotas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f621e-749">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f621e-750">A sintaxe embutida para a definição de restrições e padrões pode ser interessante para rotas simples.</span><span class="sxs-lookup"><span data-stu-id="f621e-750">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f621e-751">No entanto, há cenários, como tokens de dados, que não dão suporte à sintaxe embutida.</span><span class="sxs-lookup"><span data-stu-id="f621e-751">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f621e-752">O seguinte exemplo demonstra mais alguns cenários:</span><span class="sxs-lookup"><span data-stu-id="f621e-752">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f621e-753">O modelo anterior corresponde a um caminho de URL, como `/Blog/All-About-Routing/Introduction`, e extrai os valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-753">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f621e-754">Os valores de rota padrão para `controller` e `action` são produzidos pela rota, mesmo que não haja nenhum parâmetro de rota correspondente no modelo.</span><span class="sxs-lookup"><span data-stu-id="f621e-754">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f621e-755">Os valores padrão podem ser especificados no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-755">Default values can be specified in the route template.</span></span> <span data-ttu-id="f621e-756">O parâmetro de rota `article` é definido como um *catch-all* pela aparência de um asterisco duplo (`**`) antes do nome do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-756">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="f621e-757">Os parâmetros de rota catch-all capturam o restante do caminho de URL e também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-757">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f621e-758">O seguinte exemplo adiciona restrições de rota e tokens de dados:</span><span class="sxs-lookup"><span data-stu-id="f621e-758">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f621e-759">O modelo anterior corresponde a um caminho de URL como `/en-US/Products/5` e extrai os valores de `{ controller = Products, action = Details, id = 5 }` e os tokens de dados `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-759">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens locais do Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f621e-761">Geração de URL da classe de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-761">Route class URL generation</span></span>

<span data-ttu-id="f621e-762">A classe <xref:Microsoft.AspNetCore.Routing.Route> também pode executar a geração de URL pela combinação de um conjunto de valores de rota com seu modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-762">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f621e-763">Logicamente, este é o processo inverso de correspondência do caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-763">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-764">Para entender melhor a geração de URL, imagine qual URL você deseja gerar e, em seguida, pense em como um modelo de rota corresponderia a essa URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-764">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f621e-765">Quais valores serão produzidos?</span><span class="sxs-lookup"><span data-stu-id="f621e-765">What values would be produced?</span></span> <span data-ttu-id="f621e-766">Este é o equivalente aproximado de como funciona a geração de URL na classe <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-766">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f621e-767">O seguinte exemplo usa uma rota padrão geral do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-767">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-768">Com os valores de rota `{ controller = Products, action = List }`, a URL `/Products/List` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-768">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f621e-769">Os valores de rota são substituídos pelos parâmetros de rota correspondentes para formar o caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-769">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f621e-770">Como `id` é um parâmetro de rota opcional, a URL é gerada com êxito sem um valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f621e-770">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f621e-771">Com os valores de rota `{ controller = Home, action = Index }`, a URL `/` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-771">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f621e-772">Os valores de rota fornecidos correspondem aos valores padrão, sendo que os segmentos correspondentes aos valores padrão são omitidos com segurança.</span><span class="sxs-lookup"><span data-stu-id="f621e-772">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f621e-773">A viagem de ida e volta gerada pelas duas URLs com a definição de rota a seguir (`/Home/Index` e `/`) produz os mesmos valores de rota que foram usados para gerar a URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-773">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f621e-774">Um aplicativo que usa o ASP.NET Core MVC deve usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para gerar URLs, em vez de chamar o roteamento diretamente.</span><span class="sxs-lookup"><span data-stu-id="f621e-774">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f621e-775">Para obter mais informações sobre a geração de URL, confira a seção [Referência de geração de URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-775">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f621e-776">Usar o middleware de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-776">Use Routing Middleware</span></span>

<span data-ttu-id="f621e-777">Referencie o [metapacote Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) no arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-777">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f621e-778">Adicione o roteamento ao contêiner de serviço em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-778">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f621e-779">As rotas precisam ser configuradas no método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f621e-779">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f621e-780">O aplicativo de exemplo usa as seguintes APIs:</span><span class="sxs-lookup"><span data-stu-id="f621e-780">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f621e-781"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; corresponde apenas a solicitações HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-781"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f621e-782">A tabela a seguir mostra as respostas com os URIs fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-782">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f621e-783">URI</span><span class="sxs-lookup"><span data-stu-id="f621e-783">URI</span></span>                    | <span data-ttu-id="f621e-784">Resposta</span><span class="sxs-lookup"><span data-stu-id="f621e-784">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f621e-785">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-785">Hello!</span></span> <span data-ttu-id="f621e-786">Valores de rota: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f621e-786">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f621e-787">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-787">Hello!</span></span> <span data-ttu-id="f621e-788">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-788">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f621e-789">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-789">Hello!</span></span> <span data-ttu-id="f621e-790">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-790">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f621e-791">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-791">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f621e-792">Olá, Joe!</span><span class="sxs-lookup"><span data-stu-id="f621e-792">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f621e-793">A solicitação é ignorada; corresponde apenas a HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-793">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f621e-794">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-794">The request falls through, no match.</span></span>              |

<span data-ttu-id="f621e-795">A estrutura fornece um conjunto de métodos de extensão para a criação de rotas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f621e-795">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f621e-796">Os métodos `Map[Verb]` usam restrições para limitar a rota ao Verbo HTTP no nome do método.</span><span class="sxs-lookup"><span data-stu-id="f621e-796">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f621e-797">Por exemplo, veja <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> e <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-797">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f621e-798">Referência de modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-798">Route template reference</span></span>

<span data-ttu-id="f621e-799">Os tokens entre chaves (`{ ... }`) definem os *parâmetros de rota* que serão associados se a rota for correspondida.</span><span class="sxs-lookup"><span data-stu-id="f621e-799">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f621e-800">Você pode definir mais de um parâmetro de rota em um segmento de rota, mas eles precisam ser separados por um valor literal.</span><span class="sxs-lookup"><span data-stu-id="f621e-800">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f621e-801">Por exemplo, `{controller=Home}{action=Index}` não é uma rota válida, já que não há nenhum valor literal entre `{controller}` e `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-801">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f621e-802">Esses parâmetros de rota precisam ter um nome e podem ter atributos adicionais especificados.</span><span class="sxs-lookup"><span data-stu-id="f621e-802">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f621e-803">Um texto literal diferente dos parâmetros de rota (por exemplo, `{id}`) e do separador de caminho `/` precisa corresponder ao texto na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-803">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f621e-804">A correspondência de texto não diferencia maiúsculas de minúsculas e se baseia na representação decodificada do caminho de URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-804">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f621e-805">Para encontrar a correspondência de um delimitador de parâmetro de rota literal (`{` ou `}`), faça o escape do delimitador repetindo o caractere (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="f621e-805">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f621e-806">Padrões de URL que tentam capturar um nome de arquivo com uma extensão de arquivo opcional apresentam considerações adicionais.</span><span class="sxs-lookup"><span data-stu-id="f621e-806">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f621e-807">Por exemplo, considere o modelo `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-807">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f621e-808">Quando existem valores para `filename` e `ext`, ambos os valores são populados.</span><span class="sxs-lookup"><span data-stu-id="f621e-808">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f621e-809">Se apenas existir um valor para `filename` na URL, a rota encontrará uma correspondência, pois o ponto à direita (`.`) é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-809">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f621e-810">As URLs a seguir correspondem a essa rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-810">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f621e-811">Você pode usar um asterisco (`*`) ou um asterisco duplo (`**`) como um prefixo para um parâmetro de rota para associá-lo ao restante do URI.</span><span class="sxs-lookup"><span data-stu-id="f621e-811">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f621e-812">Eles são chamados de parâmetros *catch-all*.</span><span class="sxs-lookup"><span data-stu-id="f621e-812">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="f621e-813">Por exemplo, `blog/{**slug}` corresponde a qualquer URI que começa com `/blog` e tem qualquer valor depois dele, que é atribuído ao valor de rota `slug`.</span><span class="sxs-lookup"><span data-stu-id="f621e-813">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f621e-814">Os parâmetros catch-all também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-814">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f621e-815">O parâmetro catch-all faz o escape dos caracteres corretos quando a rota é usada para gerar uma URL, incluindo os caracteres separadores de caminho (`/`).</span><span class="sxs-lookup"><span data-stu-id="f621e-815">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f621e-816">Por exemplo, a rota `foo/{*path}` com valores de rota `{ path = "my/path" }` gera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f621e-816">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f621e-817">Observe o escape da barra invertida.</span><span class="sxs-lookup"><span data-stu-id="f621e-817">Note the escaped forward slash.</span></span> <span data-ttu-id="f621e-818">Para fazer a viagem de ida e volta dos caracteres separadores de caminho, use o prefixo do parâmetro da rota `**`.</span><span class="sxs-lookup"><span data-stu-id="f621e-818">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="f621e-819">A rota `foo/{**path}` com `{ path = "my/path" }` gera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="f621e-819">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="f621e-820">Os parâmetros de rota podem ter *valores padrão*, designados pela especificação do valor padrão após o nome do parâmetro separado por um sinal de igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f621e-820">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f621e-821">Por exemplo, `{controller=Home}` define `Home` como o valor padrão de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f621e-821">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f621e-822">O valor padrão é usado se nenhum valor está presente na URL para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-822">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f621e-823">Os parâmetros de rota se tornam opcionais com o acréscimo de um ponto de interrogação (`?`) ao final do nome do parâmetro, como em `id?`.</span><span class="sxs-lookup"><span data-stu-id="f621e-823">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f621e-824">A diferença entre valores opcionais e parâmetros de rota padrão é que um parâmetro de rota com um valor padrão sempre produz um valor – um parâmetro opcional tem um valor somente quando um valor é fornecido pela URL de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-824">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f621e-825">Os parâmetros de rota podem ter restrições que precisam corresponder ao valor de rota associado da URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-825">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f621e-826">A adição de dois-pontos (`:`) e do nome da restrição após o nome do parâmetro de rota especifica uma *restrição embutida* em um parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-826">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f621e-827">Se a restrição exigir argumentos, eles ficarão entre parênteses (`(...)`) após o nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-827">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f621e-828">Várias restrições embutidas podem ser especificadas por meio do acréscimo de outros dois-pontos (`:`) e do nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-828">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f621e-829">O nome da restrição e os argumentos são passados para o serviço <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para criar uma instância de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a ser usada no processamento de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-829">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f621e-830">Por exemplo, o modelo de rota `blog/{article:minlength(10)}` especifica uma restrição `minlength` com o argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f621e-830">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f621e-831">Para obter mais informações sobre as restrições de rota e uma lista das restrições fornecidas pela estrutura, confira a seção [Referência de restrição de rota](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-831">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f621e-832">Os parâmetros de rota também podem ter transformadores de parâmetro, que transformam o valor de um parâmetro ao gerar links e fazer a correspondência de ações e páginas com URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-832">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="f621e-833">Assim como as restrições, os transformadores de parâmetro podem ser adicionados embutidos a um parâmetro de rota colocando dois-pontos (`:`) e o nome do transformador após o nome do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-833">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="f621e-834">Por exemplo, o modelo de rota `blog/{article:slugify}` especifica um transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="f621e-834">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="f621e-835">Para obter mais informações sobre transformadores de parâmetro, confira a seção [Referência de transformador de parâmetro](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-835">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="f621e-836">A tabela a seguir demonstra modelos de rota de exemplo e seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-836">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f621e-837">Modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-837">Route Template</span></span>                           | <span data-ttu-id="f621e-838">URI de correspondência de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-838">Example Matching URI</span></span>    | <span data-ttu-id="f621e-839">O URI de solicitação&hellip;</span><span class="sxs-lookup"><span data-stu-id="f621e-839">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f621e-840">Somente corresponde ao caminho único `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f621e-840">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f621e-841">Faz a correspondência e define `Page` como `Home`.</span><span class="sxs-lookup"><span data-stu-id="f621e-841">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f621e-842">Faz a correspondência e define `Page` como `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f621e-842">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f621e-843">É mapeado para o controlador `Products` e a ação `List`.</span><span class="sxs-lookup"><span data-stu-id="f621e-843">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f621e-844">É mapeado para o controlador `Products` e a ação `Details` (`id` definido como 123).</span><span class="sxs-lookup"><span data-stu-id="f621e-844">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f621e-845">É mapeado para o controlador `Home` e o método `Index` (`id` é ignorado).</span><span class="sxs-lookup"><span data-stu-id="f621e-845">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f621e-846">Em geral, o uso de um modelo é a abordagem mais simples para o roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-846">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f621e-847">Restrições e padrões também podem ser especificados fora do modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-847">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-848">Habilite o [Log](xref:fundamentals/logging/index) para ver como as implementações de roteamento internas, como <xref:Microsoft.AspNetCore.Routing.Route>, correspondem às solicitações.</span><span class="sxs-lookup"><span data-stu-id="f621e-848">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f621e-849">Nomes reservados de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-849">Reserved routing names</span></span>

<span data-ttu-id="f621e-850">As seguintes palavras-chave são nomes reservados e não podem ser usadas como nomes de rota ou parâmetros:</span><span class="sxs-lookup"><span data-stu-id="f621e-850">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f621e-851">Referência de restrição de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-851">Route constraint reference</span></span>

<span data-ttu-id="f621e-852">As restrições de rota são executadas quando ocorre uma correspondência com a URL de entrada e é criado um token do caminho da URL em valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-852">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f621e-853">Em geral, as restrições da rota inspecionam o valor de rota associado por meio do modelo de rota e tomam uma decisão do tipo "sim/não" sobre se o valor é aceitável ou não.</span><span class="sxs-lookup"><span data-stu-id="f621e-853">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f621e-854">Algumas restrições da rota usam dados fora do valor de rota para considerar se a solicitação pode ser encaminhada.</span><span class="sxs-lookup"><span data-stu-id="f621e-854">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f621e-855">Por exemplo, a <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> pode aceitar ou rejeitar uma solicitação de acordo com o verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-855">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f621e-856">As restrições são usadas em solicitações de roteamento e na geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-856">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f621e-857">Não use restrições para a **validação de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f621e-857">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f621e-858">Se as restrições forem usadas para a **validação de entrada**, uma entrada inválida resultará em uma resposta *404 – Não Encontrado*, em vez de *400 – Solicitação Inválida* com uma mensagem de erro apropriada.</span><span class="sxs-lookup"><span data-stu-id="f621e-858">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f621e-859">As restrições de rota são usadas para **desfazer a ambiguidade** entre rotas semelhantes, não para validar as entradas de uma rota específica.</span><span class="sxs-lookup"><span data-stu-id="f621e-859">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f621e-860">A tabela a seguir demonstra restrições de rota de exemplo e seu comportamento esperado.</span><span class="sxs-lookup"><span data-stu-id="f621e-860">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f621e-861">restrição</span><span class="sxs-lookup"><span data-stu-id="f621e-861">constraint</span></span> | <span data-ttu-id="f621e-862">{1&gt;Exemplo&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-862">Example</span></span> | <span data-ttu-id="f621e-863">Correspondências de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-863">Example Matches</span></span> | <span data-ttu-id="f621e-864">{1&gt;Observações&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-864">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f621e-865">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-865">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-866">Corresponde a qualquer inteiro</span><span class="sxs-lookup"><span data-stu-id="f621e-866">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f621e-867">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f621e-867">`true`, `FALSE`</span></span> | <span data-ttu-id="f621e-868">Corresponde a `true` ou `false` (não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-868">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f621e-869">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f621e-869">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f621e-870">Corresponde a um valor `DateTime` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-870">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f621e-871">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f621e-871">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f621e-872">Corresponde a um valor `decimal` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-872">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f621e-873">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-873">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-874">Corresponde a um valor `double` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-874">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f621e-875">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-875">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-876">Corresponde a um valor `float` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-876">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f621e-877">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f621e-877">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f621e-878">Corresponde a um valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-878">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f621e-879">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-879">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-880">Corresponde a um valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-880">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f621e-881">A cadeia de caracteres deve ter, no mínimo, 4 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-881">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f621e-882">A cadeia de caracteres não pode ser maior que 8 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-882">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f621e-883">A cadeia de caracteres deve ter exatamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-883">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f621e-884">A cadeia de caracteres deve ter, pelo menos, 8 e não mais de 16 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-884">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f621e-885">O valor inteiro deve ser, pelo menos, 18</span><span class="sxs-lookup"><span data-stu-id="f621e-885">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f621e-886">O valor inteiro não deve ser maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-886">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f621e-887">O valor inteiro deve ser, pelo menos, 18, mas não maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-887">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f621e-888">A cadeia de caracteres deve consistir em um ou mais caracteres alfabéticos (`a`-`z`, não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-888">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f621e-889">A cadeia de caracteres deve corresponder à expressão regular (veja as dicas sobre como definir uma expressão regular)</span><span class="sxs-lookup"><span data-stu-id="f621e-889">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f621e-890">Usado para impor que um valor não parâmetro está presente durante a geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-890">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f621e-891">Várias restrições delimitadas por dois-pontos podem ser aplicadas a um único parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-891">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f621e-892">Por exemplo, a restrição a seguir restringe um parâmetro para um valor inteiro de 1 ou maior:</span><span class="sxs-lookup"><span data-stu-id="f621e-892">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f621e-893">As restrições de rota que verificam a URL e são convertidas em um tipo CLR (como `int` ou `DateTime`) sempre usam a cultura invariável.</span><span class="sxs-lookup"><span data-stu-id="f621e-893">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f621e-894">Essas restrições consideram que a URL não é localizável.</span><span class="sxs-lookup"><span data-stu-id="f621e-894">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f621e-895">As restrições de rota fornecidas pela estrutura não modificam os valores armazenados nos valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-895">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f621e-896">Todos os valores de rota analisados com base na URL são armazenados como cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-896">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f621e-897">Por exemplo, a restrição `float` tenta converter o valor de rota em um float, mas o valor convertido é usado somente para verificar se ele pode ser convertido em um float.</span><span class="sxs-lookup"><span data-stu-id="f621e-897">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f621e-898">Expressões regulares</span><span class="sxs-lookup"><span data-stu-id="f621e-898">Regular expressions</span></span>

<span data-ttu-id="f621e-899">A estrutura do ASP.NET Core adiciona `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` ao construtor de expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-899">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f621e-900">Confira <xref:System.Text.RegularExpressions.RegexOptions> para obter uma descrição desses membros.</span><span class="sxs-lookup"><span data-stu-id="f621e-900">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f621e-901">As expressões regulares usam delimitadores e tokens semelhantes aos usados pelo Roteamento e pela linguagem C#.</span><span class="sxs-lookup"><span data-stu-id="f621e-901">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f621e-902">Os tokens de expressão regular precisam ter escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-902">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f621e-903">Para usar a expressão regular `^\d`\\`-\d`\`-\d`\`$` no roteamento, a expressão precisa ter os caracteres `\` (barra invertida) fornecidos na cadeia de caracteres como caracteres `\\` (barra invertida dupla) no arquivo de origem C# para fazer o escape do caractere de escape da cadeia de caracteres `\` (a menos que estejam sendo usados [literais de cadeia de caracteres textuais](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f621e-903">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f621e-904">Para fazer o escape dos caracteres de delimitador de parâmetro de roteamento (`{`, `}`, `[`, `]`), duplique os caracteres na expressão (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="f621e-904">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f621e-905">A tabela a seguir mostra uma expressão regular e a versão com escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-905">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f621e-906">Expressão Regular</span><span class="sxs-lookup"><span data-stu-id="f621e-906">Regular Expression</span></span>    | <span data-ttu-id="f621e-907">Expressão regular com escape</span><span class="sxs-lookup"><span data-stu-id="f621e-907">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f621e-908">As expressões regulares usadas no roteamento geralmente começam com o caractere de acento circunflexo (`^`) e correspondem à posição inicial da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-908">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f621e-909">As expressões geralmente terminam com o caractere de cifrão (`$`) e correspondem ao final da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-909">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f621e-910">Os caracteres `^` e `$` garantem que a expressão regular corresponde a todo o valor do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-910">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f621e-911">Sem os caracteres `^` e `$`, a expressão regular corresponde a qualquer subcadeia de caracteres na cadeia de caracteres, o que geralmente não é o desejado.</span><span class="sxs-lookup"><span data-stu-id="f621e-911">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f621e-912">A tabela a seguir fornece exemplos e explica por que eles encontram ou não uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-912">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f621e-913">Expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-913">Expression</span></span>   | <span data-ttu-id="f621e-914">String</span><span class="sxs-lookup"><span data-stu-id="f621e-914">String</span></span>    | <span data-ttu-id="f621e-915">Corresponder a</span><span class="sxs-lookup"><span data-stu-id="f621e-915">Match</span></span> | <span data-ttu-id="f621e-916">Comentário</span><span class="sxs-lookup"><span data-stu-id="f621e-916">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f621e-917">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-917">hello</span></span>     | <span data-ttu-id="f621e-918">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-918">Yes</span></span>   | <span data-ttu-id="f621e-919">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-919">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-920">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-920">123abc456</span></span> | <span data-ttu-id="f621e-921">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-921">Yes</span></span>   | <span data-ttu-id="f621e-922">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-922">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-923">mz</span><span class="sxs-lookup"><span data-stu-id="f621e-923">mz</span></span>        | <span data-ttu-id="f621e-924">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-924">Yes</span></span>   | <span data-ttu-id="f621e-925">Corresponde à expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-925">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f621e-926">MZ</span><span class="sxs-lookup"><span data-stu-id="f621e-926">MZ</span></span>        | <span data-ttu-id="f621e-927">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-927">Yes</span></span>   | <span data-ttu-id="f621e-928">Não diferencia maiúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f621e-928">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-929">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-929">hello</span></span>     | <span data-ttu-id="f621e-930">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-930">No</span></span>    | <span data-ttu-id="f621e-931">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-931">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-932">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-932">123abc456</span></span> | <span data-ttu-id="f621e-933">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-933">No</span></span>    | <span data-ttu-id="f621e-934">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-934">See `^` and `$` above</span></span> |

<span data-ttu-id="f621e-935">Para saber mais sobre a sintaxe de expressões regulares, confira [Expressões regulares do .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-935">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f621e-936">Para restringir um parâmetro a um conjunto conhecido de valores possíveis, use uma expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-936">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f621e-937">Por exemplo, `{action:regex(^(list|get|create)$)}` apenas corresponde o valor da rota `action` a `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="f621e-937">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f621e-938">Se passada para o dicionário de restrições, a cadeia de caracteres `^(list|get|create)$` é equivalente.</span><span class="sxs-lookup"><span data-stu-id="f621e-938">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f621e-939">As restrições passadas para o dicionário de restrições (não embutidas em um modelo) que não correspondem a uma das restrições conhecidas também são tratadas como expressões regulares.</span><span class="sxs-lookup"><span data-stu-id="f621e-939">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f621e-940">Restrições de rota personalizadas</span><span class="sxs-lookup"><span data-stu-id="f621e-940">Custom Route Constraints</span></span>

<span data-ttu-id="f621e-941">Além das restrições de rota internas, é possível criar restrições de rota personalizadas com a implementação da interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f621e-941">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f621e-942">A interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contém um único método, `Match`, que retorna `true` quando a restrição é satisfeita. Caso contrário, retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="f621e-942">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f621e-943">Para usar uma <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, o tipo de restrição de rota deve ser registrado com o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo, no contêiner de serviço do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-943">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f621e-944">O <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> é um dicionário que mapeia as chaves de restrição de rota para implementações de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validam essas restrições.</span><span class="sxs-lookup"><span data-stu-id="f621e-944">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f621e-945">É possível atualizar o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo no `Startup.ConfigureServices` como parte de uma chamada [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> diretamente com `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f621e-945">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f621e-946">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-946">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f621e-947">a restrição pode então ser aplicada às rotas da maneira usual, usando o nome especificado ao registrar o tipo de restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-947">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f621e-948">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-948">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="f621e-949">Referência de parâmetro de transformador</span><span class="sxs-lookup"><span data-stu-id="f621e-949">Parameter transformer reference</span></span>

<span data-ttu-id="f621e-950">Transformadores de parâmetro:</span><span class="sxs-lookup"><span data-stu-id="f621e-950">Parameter transformers:</span></span>

* <span data-ttu-id="f621e-951">Executar ao gerar um link para um <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-951">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="f621e-952">Implementar `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="f621e-952">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="f621e-953">São configurados usando <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="f621e-953">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="f621e-954">Usam o valor de rota do parâmetro e o transformam em um novo valor de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-954">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="f621e-955">Resultam no uso do valor transformado no link gerado.</span><span class="sxs-lookup"><span data-stu-id="f621e-955">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="f621e-956">Por exemplo, um transformador de parâmetro `slugify` personalizado em padrão de rota `blog\{article:slugify}` com `Url.Action(new { article = "MyTestArticle" })` gera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="f621e-956">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="f621e-957">Para usar um transformador de parâmetro em um padrão de rota, configure-o primeiro usando <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-957">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="f621e-958">Os transformadores de parâmetro são usados pela estrutura para transformar o URI no qual um ponto de extremidade é resolvido.</span><span class="sxs-lookup"><span data-stu-id="f621e-958">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="f621e-959">Por exemplo, o ASP.NET Core MVC usa os transformadores de parâmetro para transformar o valor de rota usado para corresponder a um `area`, `controller`, `action` e `page`.</span><span class="sxs-lookup"><span data-stu-id="f621e-959">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="f621e-960">Com a rota anterior, a ação `SubscriptionManagementController.GetAll()` é combinada com o URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f621e-960">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="f621e-961">Um transformador de parâmetro não altera os valores de rota usados para gerar um link.</span><span class="sxs-lookup"><span data-stu-id="f621e-961">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="f621e-962">Por exemplo, `Url.Action("GetAll", "SubscriptionManagement")` gera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f621e-962">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="f621e-963">ASP.NET Core fornece convenções de API para usar transformadores de parâmetro com as rotas geradas:</span><span class="sxs-lookup"><span data-stu-id="f621e-963">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="f621e-964">ASP.NET Core MVC tem a convenção de API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f621e-964">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="f621e-965">Essa convenção aplica um transformador de parâmetro especificado a todas as rotas de atributo no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-965">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="f621e-966">O transformador de parâmetro transforma os tokens de rota do atributo conforme elas são substituídas.</span><span class="sxs-lookup"><span data-stu-id="f621e-966">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="f621e-967">Para obter mais informações, confira [Usar um transformador de parâmetro para personalizar a substituição de token](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="f621e-967">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="f621e-968">O Razor Pages tem a convenção de API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f621e-968">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="f621e-969">Essa convenção aplica um transformador de parâmetro especificado a todas as Razor Pages descobertas automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f621e-969">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="f621e-970">O transformador de parâmetro transforma os segmentos de nome de arquivo e pasta de rotas do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-970">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="f621e-971">Para obter mais informações, confira [Usar um transformador de parâmetros para personalizar rotas de página](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="f621e-971">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="f621e-972">Referência de geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-972">URL generation reference</span></span>

<span data-ttu-id="f621e-973">O exemplo a seguir mostra como gerar um link para uma rota com base em um dicionário de valores de rota e em um <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f621e-973">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f621e-974">O <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> gerado no final do exemplo anterior é `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f621e-974">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f621e-975">O dicionário fornece os valores de rota `operation` e `id` do modelo "Rastrear rota do pacote", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-975">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f621e-976">Para obter detalhes, consulte o código de exemplo na seção [Usar o middleware de roteamento](#use-routing-middleware) ou no [aplicativo de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f621e-976">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f621e-977">O segundo parâmetro para o construtor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> é uma coleção de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f621e-977">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f621e-978">Os valores de ambiente são convenientes de serem usados porque limitam o número de valores que um desenvolvedor precisa especificar em um contexto de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-978">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f621e-979">Os valores de rota atuais da solicitação atual são considerados valores de ambiente para a geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-979">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f621e-980">Na ação `About` de um aplicativo ASP.NET Core MVC do `HomeController`, não é necessário especificar o valor de rota do controlador a ser vinculado à ação `Index` – o valor de ambiente &mdash; é usado.</span><span class="sxs-lookup"><span data-stu-id="f621e-980">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f621e-981">Os valores de ambiente que não correspondem a um parâmetro são ignorados.</span><span class="sxs-lookup"><span data-stu-id="f621e-981">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f621e-982">Os valores de ambiente também são ignorados quando um valor fornecido explicitamente substitui o valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f621e-982">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f621e-983">A correspondência ocorre da esquerda para a direita na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-983">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f621e-984">Valores fornecidos explicitamente, mas que não correspondem a um segmento da rota, são adicionados à cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="f621e-984">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f621e-985">A tabela a seguir mostra o resultado do uso do modelo de rota `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-985">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f621e-986">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f621e-986">Ambient Values</span></span>                     | <span data-ttu-id="f621e-987">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f621e-987">Explicit Values</span></span>                        | <span data-ttu-id="f621e-988">Resultado</span><span class="sxs-lookup"><span data-stu-id="f621e-988">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f621e-989">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-989">controller = "Home"</span></span>                | <span data-ttu-id="f621e-990">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-990">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-991">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-991">controller = "Home"</span></span>                | <span data-ttu-id="f621e-992">controlador = "Order", ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-992">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f621e-993">controlador = "Home", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-993">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f621e-994">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-994">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-995">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-995">controller = "Home"</span></span>                | <span data-ttu-id="f621e-996">ação = "About", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-996">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f621e-997">Se uma rota tem um valor padrão que não corresponde a um parâmetro e esse valor é fornecido de forma explícita, ele precisa corresponder ao valor padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-997">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f621e-998">A geração de link somente gera um link para essa rota quando os valores correspondentes de `controller` e `action` são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-998">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f621e-999">Segmentos complexos</span><span class="sxs-lookup"><span data-stu-id="f621e-999">Complex segments</span></span>

<span data-ttu-id="f621e-1000">Segmentos complexos (por exemplo, `[Route("/x{token}y")]`) são processados por meio da combinação de literais da direita para a esquerda, de uma maneira diferente de Greedy.</span><span class="sxs-lookup"><span data-stu-id="f621e-1000">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f621e-1001">Confira [este código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para ver uma explicação detalhada de como os segmentos complexos são combinados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1001">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f621e-1002">O [exemplo de código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) não é usado pelo ASP.NET Core, mas fornece uma explicação adequada sobre segmentos complexos.</span><span class="sxs-lookup"><span data-stu-id="f621e-1002">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="f621e-1003">O roteamento é responsável por mapear URIs de solicitação para manipuladores de rotas e expedir as solicitações de entrada.</span><span class="sxs-lookup"><span data-stu-id="f621e-1003">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="f621e-1004">As rotas são definidas no aplicativo e configuradas quando o aplicativo é iniciado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1004">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f621e-1005">Uma rota pode opcionalmente extrair os valores da URL contida na solicitação e esses valores podem então ser usados para o processamento da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1005">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f621e-1006">Usando rotas configuradas no aplicativo, o roteamento pode gerar URLs que são mapeadas para manipuladores de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1006">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="f621e-1007">Para usar os últimos cenários de roteamento no ASP.NET Core 2.1, especifique a [versão de compatibilidade](xref:mvc/compatibility-version) com o registro de serviços MVC em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-1007">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="f621e-1008">Este documento aborda o roteamento de nível inferior do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="f621e-1008">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f621e-1009">Para obter informações sobre o roteamento do ASP.NET Core MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1009">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f621e-1010">Para obter informações sobre convenções de roteamento no Razor Pages, confira <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1010">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-1011">[Exibir ou baixar código de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([como baixar](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f621e-1011">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f621e-1012">Conceitos básicos sobre roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-1012">Routing basics</span></span>

<span data-ttu-id="f621e-1013">A maioria dos aplicativos deve escolher um esquema de roteamento básico e descritivo para que as URLs sejam legíveis e significativas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1013">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f621e-1014">A rota convencional padrão `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f621e-1014">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f621e-1015">Dá suporte a um esquema de roteamento básico e descritivo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1015">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f621e-1016">É um ponto de partida útil para aplicativos baseados em interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f621e-1016">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f621e-1017">Os desenvolvedores geralmente adicionam outras rotas concisas às áreas de alto tráfego de um aplicativo em situações especiais (por exemplo, pontos de extremidade de blog e comércio eletrônico) usando o [roteamento de atributo](xref:mvc/controllers/routing#attribute-routing) ou rotas convencionais dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1017">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f621e-1018">As APIs da Web devem usar o roteamento de atributo para modelar a funcionalidade do aplicativo como um conjunto de recursos em que as operações são representadas por verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-1018">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f621e-1019">Isso significa que muitas operações (por exemplo, GET, POST) no mesmo recurso lógico usarão a mesma URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1019">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f621e-1020">O roteamento de atributo fornece um nível de controle necessário para projetar cuidadosamente o layout de ponto de extremidade público de uma API.</span><span class="sxs-lookup"><span data-stu-id="f621e-1020">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f621e-1021">Os aplicativos do Razor Pages usam o roteamento convencional padrão para fornecer recursos nomeados na pasta *Pages* de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1021">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f621e-1022">Estão disponíveis convenções adicionais que permitem a personalização do comportamento de roteamento do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-1022">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f621e-1023">Para obter mais informações, consulte <xref:razor-pages/index> e <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1023">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f621e-1024">O suporte à geração de URL permite que o aplicativo seja desenvolvido sem hard-coding das URLs para vincular o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1024">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f621e-1025">Esse suporte permite começar com uma configuração de roteamento básica e modificar as rotas, depois que o layout de recurso do aplicativo é determinado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1025">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f621e-1026">O roteamento usa *rotas* (implementações de <xref:Microsoft.AspNetCore.Routing.IRouter>) para:</span><span class="sxs-lookup"><span data-stu-id="f621e-1026">Routing uses *routes* (implementations of <xref:Microsoft.AspNetCore.Routing.IRouter>) to:</span></span>

* <span data-ttu-id="f621e-1027">Mapear solicitações de entrada para *manipuladores de rotas*.</span><span class="sxs-lookup"><span data-stu-id="f621e-1027">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="f621e-1028">Gerar as URLs usadas nas respostas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1028">Generate the URLs used in responses.</span></span>

<span data-ttu-id="f621e-1029">Por padrão, um aplicativo tem uma única coleção de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1029">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="f621e-1030">Quando uma solicitação é recebida, as rotas na coleção são processadas na ordem em que existem na coleção.</span><span class="sxs-lookup"><span data-stu-id="f621e-1030">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="f621e-1031">A estrutura tenta corresponder uma URL de solicitação de entrada a uma rota na coleção chamando o método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> em cada rota da coleção.</span><span class="sxs-lookup"><span data-stu-id="f621e-1031">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="f621e-1032">Uma resposta pode usar o roteamento para gerar URLs (por exemplo, para redirecionamento ou links) com base nas informações de rotas e evitar URLs embutidas em código, o que ajuda na facilidade de manutenção.</span><span class="sxs-lookup"><span data-stu-id="f621e-1032">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="f621e-1033">O sistema de roteamento tem as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="f621e-1033">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f621e-1034">A sintaxe do modelo de rota é usada para definir rotas com os parâmetros de rota com tokens criados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1034">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f621e-1035">A configuração de ponto de extremidade de estilo convencional e de estilo de atributo é permitida.</span><span class="sxs-lookup"><span data-stu-id="f621e-1035">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f621e-1036"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> é usado para determinar se um parâmetro de URL contém um valor válido para determinada restrição de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="f621e-1036"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f621e-1037">Modelos de aplicativo, como MVC/Razor Pages, registram todas as suas rotas, que têm uma implementação previsível de cenários de roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-1037">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f621e-1038">Uma resposta pode usar o roteamento para gerar URLs (por exemplo, para redirecionamento ou links) com base nas informações de rotas e evitar URLs embutidas em código, o que ajuda na facilidade de manutenção.</span><span class="sxs-lookup"><span data-stu-id="f621e-1038">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f621e-1039">A geração de URL baseia-se em rotas, que dá suporte à extensibilidade arbitrária.</span><span class="sxs-lookup"><span data-stu-id="f621e-1039">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="f621e-1040"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> oferece métodos para criar URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-1040"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

<span data-ttu-id="f621e-1041">O roteamento está conectado ao pipeline do [middleware](xref:fundamentals/middleware/index) pela classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1041">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f621e-1042">O [ASP.NET Core MVC](xref:mvc/overview) adiciona o roteamento ao pipeline de middleware como parte de sua configuração e manipula o roteamento nos aplicativos do MVC e do Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f621e-1042">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f621e-1043">Para saber como usar o roteamento como um componente autônomo, confira a seção [Usar o Middleware de Roteamento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f621e-1043">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f621e-1044">Correspondência de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-1044">URL matching</span></span>

<span data-ttu-id="f621e-1045">Correspondência de URL é o processo pelo qual o roteamento expede uma solicitação de entrada para um *manipulador*.</span><span class="sxs-lookup"><span data-stu-id="f621e-1045">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="f621e-1046">Esse processo se baseia nos dados do caminho da URL, mas pode ser estendido para considerar qualquer dado na solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1046">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f621e-1047">A capacidade de expedir solicitações para manipuladores separados é fundamental para dimensionar o tamanho e a complexidade de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1047">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f621e-1048">As solicitações de entrada entram no <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, que chama o método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> em cada rota na sequência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1048">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="f621e-1049">A instância <xref:Microsoft.AspNetCore.Routing.IRouter> escolhe se deseja *manipular* a solicitação definindo o [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) como um <xref:Microsoft.AspNetCore.Http.RequestDelegate> não nulo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1049">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="f621e-1050">Se uma rota definir um manipulador para a solicitação, o processamento de rotas será interrompido e o manipulador será invocado para processar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1050">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="f621e-1051">Se nenhum manipulador de rotas é encontrado para processar a solicitação, o middleware transmite a solicitação para o próximo middleware no pipeline de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1051">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="f621e-1052">A entrada primária para <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> é o [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associado à solicitação atual.</span><span class="sxs-lookup"><span data-stu-id="f621e-1052">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="f621e-1053">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) e [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) são saídas definidas depois que é encontrada uma correspondência de uma rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1053">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="f621e-1054">Uma correspondência que chama <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> também define as propriedades do [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) com valores apropriados com base no processamento da solicitação executado até o momento.</span><span class="sxs-lookup"><span data-stu-id="f621e-1054">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f621e-1055">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) é um dicionário de *valores de rota* produzido por meio da rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1055">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f621e-1056">Esses valores geralmente são determinados pela criação de token da URL e podem ser usados para aceitar a entrada do usuário ou tomar outras decisões de expedição dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1056">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f621e-1057">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) é um recipiente de propriedades de dados adicionais relacionados à rota correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-1057">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f621e-1058"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> são fornecidos para dar suporte à associação de dados de estado com cada rota para que o aplicativo possa tomar decisões com base em qual rota teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1058"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f621e-1059">Esses valores são definidos pelo desenvolvedor e **não** afetam de forma alguma o comportamento do roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-1059">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f621e-1060">Além disso, os valores em stash em [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) podem ser de qualquer tipo, ao contrário de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que devem ser conversíveis de/para cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-1060">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f621e-1061">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) é uma lista das rotas que participaram da correspondência bem-sucedida da solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1061">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f621e-1062">As rotas podem ser aninhadas uma dentro da outra.</span><span class="sxs-lookup"><span data-stu-id="f621e-1062">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f621e-1063">A propriedade <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> reflete o caminho pela árvore lógica de rotas que resultou em uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1063">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f621e-1064">Em geral, o primeiro item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é a coleção de rotas e deve ser usado para a geração de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1064">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f621e-1065">O último item em <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> é o manipulador de rotas que teve uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1065">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="f621e-1066">Geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-1066">URL generation</span></span>

<span data-ttu-id="f621e-1067">Geração de URL é o processo pelo qual o roteamento pode criar um caminho de URL de acordo com um conjunto de valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1067">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f621e-1068">Isso permite uma separação lógica entre os manipuladores de rotas e as URLs que os acessam.</span><span class="sxs-lookup"><span data-stu-id="f621e-1068">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="f621e-1069">A geração de URL segue um processo iterativo semelhante, mas começa com o código da estrutura ou do usuário chamando o método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> da coleção de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1069">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="f621e-1070">Cada *rota* tem seu método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> chamado em sequência, até que um <xref:Microsoft.AspNetCore.Routing.VirtualPathData> não nulo seja retornado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1070">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="f621e-1071">As entradas primárias para <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> são:</span><span class="sxs-lookup"><span data-stu-id="f621e-1071">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="f621e-1072">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="f621e-1072">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="f621e-1073">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="f621e-1073">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="f621e-1074">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="f621e-1074">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="f621e-1075">As rotas usam principalmente os valores de rota fornecidos por <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> e <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> para decidir se é possível gerar uma URL e quais valores serão incluídos.</span><span class="sxs-lookup"><span data-stu-id="f621e-1075">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="f621e-1076">Os <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> são o conjunto de valores de rota produzidos pela correspondência da solicitação atual.</span><span class="sxs-lookup"><span data-stu-id="f621e-1076">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="f621e-1077">Por outro lado, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> são os valores de rota que especificam como gerar a URL desejada para a operação atual.</span><span class="sxs-lookup"><span data-stu-id="f621e-1077">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="f621e-1078">O <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> é fornecido para o caso de uma rota precisar obter serviços ou dados adicionais associados ao contexto atual.</span><span class="sxs-lookup"><span data-stu-id="f621e-1078">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-1079">Considere [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) como um conjunto de substituições de [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="f621e-1079">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="f621e-1080">A geração de URL tenta reutilizar os valores de rota da solicitação atual para gerar URLs para links usando a mesma rota ou os mesmos valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1080">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="f621e-1081">A saída de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> é um <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1081">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="f621e-1082"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> é um paralelo de <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1082"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="f621e-1083"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contém o <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> da URL de saída e algumas propriedades adicionais que devem ser definidas pela rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1083"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="f621e-1084">A propriedade [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) contém o *caminho virtual* produzido pela rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1084">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="f621e-1085">Dependendo das suas necessidades, talvez você precise processar ainda mais o caminho.</span><span class="sxs-lookup"><span data-stu-id="f621e-1085">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="f621e-1086">Se você desejar renderizar a URL gerada em HTML, preceda o caminho base do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1086">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="f621e-1087">O [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) é uma referência à rota que gerou a URL com êxito.</span><span class="sxs-lookup"><span data-stu-id="f621e-1087">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="f621e-1088">As propriedades de [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) são um dicionário de dados adicionais relacionados à rota que gerou a URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1088">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="f621e-1089">Isso é o paralelo de [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="f621e-1089">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="f621e-1090">Criar rotas</span><span class="sxs-lookup"><span data-stu-id="f621e-1090">Create routes</span></span>

<span data-ttu-id="f621e-1091">O roteamento fornece a classe <xref:Microsoft.AspNetCore.Routing.Route> como a implementação padrão de <xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1091">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="f621e-1092"><xref:Microsoft.AspNetCore.Routing.Route> usa a sintaxe de *modelo de rota* para definir padrões que corresponderão ao caminho da URL quando <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> for chamado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1092"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="f621e-1093"><xref:Microsoft.AspNetCore.Routing.Route> usa o mesmo modelo de rota para gerar uma URL quando <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> é chamado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1093"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="f621e-1094">A maioria dos aplicativos cria rotas chamando <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou um dos métodos de extensão semelhantes definidos em <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1094">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f621e-1095">Qualquer um dos métodos de extensão de <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> cria uma instância de <xref:Microsoft.AspNetCore.Routing.Route> e a adicionam à coleção de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1095">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f621e-1096"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> não aceita um parâmetro de manipulador de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1096"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f621e-1097"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> apenas adiciona rotas que são manipuladas pelo <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1097"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f621e-1098">O manipulador padrão é um `IRouter`, e o manipulador não pode manipular a solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1098">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="f621e-1099">Por exemplo, o ASP.NET Core MVC normalmente é configurado como um manipulador padrão que só manipula as solicitações que correspondem a um controlador e a uma ação disponíveis.</span><span class="sxs-lookup"><span data-stu-id="f621e-1099">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="f621e-1100">Para saber mais sobre o roteamento no MVC, confira <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1100">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f621e-1101">O exemplo de código a seguir é um exemplo de uma chamada <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por uma definição de rota típica do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-1101">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-1102">Esse modelo corresponde a um caminho de URL e extrai os valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1102">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f621e-1103">Por exemplo, o caminho `/Products/Details/17` gera os seguintes valores de rota: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1103">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f621e-1104">Os valores de rota são determinados pela divisão do caminho da URL em segmentos e pela correspondência de cada segmento com o nome do *parâmetro de rota* no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1104">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f621e-1105">Os parâmetros de rota são nomeados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1105">Route parameters are named.</span></span> <span data-ttu-id="f621e-1106">Os parâmetros são definidos com a colocação do nome do parâmetro em chaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1106">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f621e-1107">O modelo anterior também pode corresponder ao caminho da URL `/` e produzir os valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1107">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f621e-1108">Isso ocorre porque os parâmetros de rota `{controller}` e `{action}` têm valores padrão e o parâmetro de rota `id` é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-1108">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f621e-1109">Um sinal de igual (`=`) seguido de um valor após o nome do parâmetro de rota define um valor padrão para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-1109">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f621e-1110">Um ponto de interrogação (`?`) após o nome do parâmetro de rota define o parâmetro como opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-1110">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f621e-1111">Os parâmetros de rota com um valor padrão *sempre* produzem um valor de rota quando a rota corresponde.</span><span class="sxs-lookup"><span data-stu-id="f621e-1111">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f621e-1112">Os parâmetros opcionais não produzem um valor de rota quando não há nenhum segmento de caminho de URL correspondente.</span><span class="sxs-lookup"><span data-stu-id="f621e-1112">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f621e-1113">Confira a seção [Referência de modelo de rota](#route-template-reference) para obter uma descrição completa dos recursos e da sintaxe de modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1113">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f621e-1114">No seguinte exemplo, a definição do parâmetro de rota `{id:int}` define uma [restrição de rota](#route-constraint-reference) para o parâmetro de rota `id`:</span><span class="sxs-lookup"><span data-stu-id="f621e-1114">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f621e-1115">Esse modelo corresponde a um caminho de URL, como `/Products/Details/17`, mas não como `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1115">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f621e-1116">As restrições de rota implementam <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspecionam valores de rota para verificá-los.</span><span class="sxs-lookup"><span data-stu-id="f621e-1116">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f621e-1117">Neste exemplo, o valor de rota `id` precisa ser conversível em um inteiro.</span><span class="sxs-lookup"><span data-stu-id="f621e-1117">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f621e-1118">Confira [route-constraint-reference](#route-constraint-reference) para obter uma explicação das restrições de rota fornecidas pela estrutura.</span><span class="sxs-lookup"><span data-stu-id="f621e-1118">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f621e-1119">Sobrecargas adicionais de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceitam valores para `constraints`, `dataTokens` e `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1119">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f621e-1120">O uso típico desses parâmetros é passar um objeto de tipo anônimo, no qual os nomes da propriedade do tipo anônimo correspondem aos nomes do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1120">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f621e-1121">Os seguintes exemplos de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> criam rotas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f621e-1121">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f621e-1122">A sintaxe embutida para a definição de restrições e padrões pode ser interessante para rotas simples.</span><span class="sxs-lookup"><span data-stu-id="f621e-1122">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f621e-1123">No entanto, há cenários, como tokens de dados, que não dão suporte à sintaxe embutida.</span><span class="sxs-lookup"><span data-stu-id="f621e-1123">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f621e-1124">O seguinte exemplo demonstra mais alguns cenários:</span><span class="sxs-lookup"><span data-stu-id="f621e-1124">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f621e-1125">O modelo anterior corresponde a um caminho de URL, como `/Blog/All-About-Routing/Introduction`, e extrai os valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1125">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f621e-1126">Os valores de rota padrão para `controller` e `action` são produzidos pela rota, mesmo que não haja nenhum parâmetro de rota correspondente no modelo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1126">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f621e-1127">Os valores padrão podem ser especificados no modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1127">Default values can be specified in the route template.</span></span> <span data-ttu-id="f621e-1128">O parâmetro de rota `article` é definido como um *catch-all* pela aparência de um asterisco (`*`) antes do nome do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1128">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="f621e-1129">Os parâmetros de rota catch-all capturam o restante do caminho de URL e também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-1129">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f621e-1130">O seguinte exemplo adiciona restrições de rota e tokens de dados:</span><span class="sxs-lookup"><span data-stu-id="f621e-1130">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f621e-1131">O modelo anterior corresponde a um caminho de URL como `/en-US/Products/5` e extrai os valores de `{ controller = Products, action = Details, id = 5 }` e os tokens de dados `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1131">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens locais do Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f621e-1133">Geração de URL da classe de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-1133">Route class URL generation</span></span>

<span data-ttu-id="f621e-1134">A classe <xref:Microsoft.AspNetCore.Routing.Route> também pode executar a geração de URL pela combinação de um conjunto de valores de rota com seu modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1134">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f621e-1135">Logicamente, este é o processo inverso de correspondência do caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1135">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-1136">Para entender melhor a geração de URL, imagine qual URL você deseja gerar e, em seguida, pense em como um modelo de rota corresponderia a essa URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1136">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f621e-1137">Quais valores serão produzidos?</span><span class="sxs-lookup"><span data-stu-id="f621e-1137">What values would be produced?</span></span> <span data-ttu-id="f621e-1138">Este é o equivalente aproximado de como funciona a geração de URL na classe <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1138">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f621e-1139">O seguinte exemplo usa uma rota padrão geral do ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f621e-1139">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f621e-1140">Com os valores de rota `{ controller = Products, action = List }`, a URL `/Products/List` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-1140">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f621e-1141">Os valores de rota são substituídos pelos parâmetros de rota correspondentes para formar o caminho de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1141">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f621e-1142">Como `id` é um parâmetro de rota opcional, a URL é gerada com êxito sem um valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1142">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f621e-1143">Com os valores de rota `{ controller = Home, action = Index }`, a URL `/` é gerada.</span><span class="sxs-lookup"><span data-stu-id="f621e-1143">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f621e-1144">Os valores de rota fornecidos correspondem aos valores padrão, sendo que os segmentos correspondentes aos valores padrão são omitidos com segurança.</span><span class="sxs-lookup"><span data-stu-id="f621e-1144">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f621e-1145">A viagem de ida e volta gerada pelas duas URLs com a definição de rota a seguir (`/Home/Index` e `/`) produz os mesmos valores de rota que foram usados para gerar a URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1145">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f621e-1146">Um aplicativo que usa o ASP.NET Core MVC deve usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para gerar URLs, em vez de chamar o roteamento diretamente.</span><span class="sxs-lookup"><span data-stu-id="f621e-1146">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f621e-1147">Para obter mais informações sobre a geração de URL, confira a seção [Referência de geração de URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-1147">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f621e-1148">Usar o middleware de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-1148">Use Routing Middleware</span></span>

<span data-ttu-id="f621e-1149">Referencie o [metapacote Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) no arquivo de projeto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1149">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f621e-1150">Adicione o roteamento ao contêiner de serviço em `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f621e-1150">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f621e-1151">As rotas precisam ser configuradas no método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1151">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f621e-1152">O aplicativo de exemplo usa as seguintes APIs:</span><span class="sxs-lookup"><span data-stu-id="f621e-1152">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f621e-1153"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; corresponde apenas a solicitações HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-1153"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f621e-1154">A tabela a seguir mostra as respostas com os URIs fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-1154">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f621e-1155">URI</span><span class="sxs-lookup"><span data-stu-id="f621e-1155">URI</span></span>                    | <span data-ttu-id="f621e-1156">Resposta</span><span class="sxs-lookup"><span data-stu-id="f621e-1156">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f621e-1157">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-1157">Hello!</span></span> <span data-ttu-id="f621e-1158">Valores de rota: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f621e-1158">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f621e-1159">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-1159">Hello!</span></span> <span data-ttu-id="f621e-1160">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-1160">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f621e-1161">Olá!</span><span class="sxs-lookup"><span data-stu-id="f621e-1161">Hello!</span></span> <span data-ttu-id="f621e-1162">Valores de rota: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f621e-1162">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f621e-1163">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1163">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f621e-1164">Olá, Joe!</span><span class="sxs-lookup"><span data-stu-id="f621e-1164">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f621e-1165">A solicitação é ignorada; corresponde apenas a HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f621e-1165">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f621e-1166">A solicitação é ignorada; sem correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1166">The request falls through, no match.</span></span>              |

<span data-ttu-id="f621e-1167">Se você estiver configurando uma única rota, chame <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passando uma instância de `IRouter`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1167">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="f621e-1168">Você não precisa usar <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1168">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="f621e-1169">A estrutura fornece um conjunto de métodos de extensão para a criação de rotas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f621e-1169">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f621e-1170">Alguns dos métodos listados, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, exigem um <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1170">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="f621e-1171">O <xref:Microsoft.AspNetCore.Http.RequestDelegate> é usado como o *manipulador de rotas* quando a rota corresponde.</span><span class="sxs-lookup"><span data-stu-id="f621e-1171">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="f621e-1172">Outros métodos nesta família permitem configurar um pipeline de middleware a ser usado como o manipulador de rotas.</span><span class="sxs-lookup"><span data-stu-id="f621e-1172">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="f621e-1173">Se o método `Map*` não aceitar um manipulador, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, ele usará o <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1173">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="f621e-1174">Os métodos `Map[Verb]` usam restrições para limitar a rota ao Verbo HTTP no nome do método.</span><span class="sxs-lookup"><span data-stu-id="f621e-1174">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f621e-1175">Por exemplo, veja <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> e <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1175">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f621e-1176">Referência de modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-1176">Route template reference</span></span>

<span data-ttu-id="f621e-1177">Os tokens entre chaves (`{ ... }`) definem os *parâmetros de rota* que serão associados se a rota for correspondida.</span><span class="sxs-lookup"><span data-stu-id="f621e-1177">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f621e-1178">Você pode definir mais de um parâmetro de rota em um segmento de rota, mas eles precisam ser separados por um valor literal.</span><span class="sxs-lookup"><span data-stu-id="f621e-1178">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f621e-1179">Por exemplo, `{controller=Home}{action=Index}` não é uma rota válida, já que não há nenhum valor literal entre `{controller}` e `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1179">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f621e-1180">Esses parâmetros de rota precisam ter um nome e podem ter atributos adicionais especificados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1180">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f621e-1181">Um texto literal diferente dos parâmetros de rota (por exemplo, `{id}`) e do separador de caminho `/` precisa corresponder ao texto na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1181">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f621e-1182">A correspondência de texto não diferencia maiúsculas de minúsculas e se baseia na representação decodificada do caminho de URLs.</span><span class="sxs-lookup"><span data-stu-id="f621e-1182">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f621e-1183">Para encontrar a correspondência de um delimitador de parâmetro de rota literal (`{` ou `}`), faça o escape do delimitador repetindo o caractere (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="f621e-1183">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f621e-1184">Padrões de URL que tentam capturar um nome de arquivo com uma extensão de arquivo opcional apresentam considerações adicionais.</span><span class="sxs-lookup"><span data-stu-id="f621e-1184">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f621e-1185">Por exemplo, considere o modelo `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1185">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f621e-1186">Quando existem valores para `filename` e `ext`, ambos os valores são populados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1186">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f621e-1187">Se apenas existir um valor para `filename` na URL, a rota encontrará uma correspondência, pois o ponto à direita (`.`) é opcional.</span><span class="sxs-lookup"><span data-stu-id="f621e-1187">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f621e-1188">As URLs a seguir correspondem a essa rota:</span><span class="sxs-lookup"><span data-stu-id="f621e-1188">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f621e-1189">Você pode usar o asterisco (`*`) como um prefixo para um parâmetro de rota a ser associado ao restante do URI.</span><span class="sxs-lookup"><span data-stu-id="f621e-1189">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f621e-1190">Isso é chamado de parâmetro *catch-all*.</span><span class="sxs-lookup"><span data-stu-id="f621e-1190">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="f621e-1191">Por exemplo, `blog/{*slug}` corresponde a qualquer URI que começa com `/blog` e tem qualquer valor depois dele, que é atribuído ao valor de rota `slug`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1191">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f621e-1192">Os parâmetros catch-all também podem corresponder à cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="f621e-1192">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f621e-1193">O parâmetro catch-all faz o escape dos caracteres corretos quando a rota é usada para gerar uma URL, incluindo os caracteres separadores de caminho (`/`).</span><span class="sxs-lookup"><span data-stu-id="f621e-1193">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f621e-1194">Por exemplo, a rota `foo/{*path}` com valores de rota `{ path = "my/path" }` gera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1194">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f621e-1195">Observe o escape da barra invertida.</span><span class="sxs-lookup"><span data-stu-id="f621e-1195">Note the escaped forward slash.</span></span>

<span data-ttu-id="f621e-1196">Os parâmetros de rota podem ter *valores padrão*, designados pela especificação do valor padrão após o nome do parâmetro separado por um sinal de igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f621e-1196">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f621e-1197">Por exemplo, `{controller=Home}` define `Home` como o valor padrão de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1197">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f621e-1198">O valor padrão é usado se nenhum valor está presente na URL para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-1198">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f621e-1199">Os parâmetros de rota se tornam opcionais com o acréscimo de um ponto de interrogação (`?`) ao final do nome do parâmetro, como em `id?`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1199">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f621e-1200">A diferença entre valores opcionais e parâmetros de rota padrão é que um parâmetro de rota com um valor padrão sempre produz um valor – um parâmetro opcional tem um valor somente quando um valor é fornecido pela URL de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1200">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f621e-1201">Os parâmetros de rota podem ter restrições que precisam corresponder ao valor de rota associado da URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1201">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f621e-1202">A adição de dois-pontos (`:`) e do nome da restrição após o nome do parâmetro de rota especifica uma *restrição embutida* em um parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1202">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f621e-1203">Se a restrição exigir argumentos, eles ficarão entre parênteses (`(...)`) após o nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-1203">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f621e-1204">Várias restrições embutidas podem ser especificadas por meio do acréscimo de outros dois-pontos (`:`) e do nome da restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-1204">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f621e-1205">O nome da restrição e os argumentos são passados para o serviço <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para criar uma instância de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a ser usada no processamento de URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1205">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f621e-1206">Por exemplo, o modelo de rota `blog/{article:minlength(10)}` especifica uma restrição `minlength` com o argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1206">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f621e-1207">Para obter mais informações sobre as restrições de rota e uma lista das restrições fornecidas pela estrutura, confira a seção [Referência de restrição de rota](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-1207">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f621e-1208">A tabela a seguir demonstra modelos de rota de exemplo e seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-1208">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f621e-1209">Modelo de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-1209">Route Template</span></span>                           | <span data-ttu-id="f621e-1210">URI de correspondência de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-1210">Example Matching URI</span></span>    | <span data-ttu-id="f621e-1211">O URI de solicitação&hellip;</span><span class="sxs-lookup"><span data-stu-id="f621e-1211">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f621e-1212">Somente corresponde ao caminho único `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1212">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f621e-1213">Faz a correspondência e define `Page` como `Home`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1213">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f621e-1214">Faz a correspondência e define `Page` como `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1214">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f621e-1215">É mapeado para o controlador `Products` e a ação `List`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1215">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f621e-1216">É mapeado para o controlador `Products` e a ação `Details` (`id` definido como 123).</span><span class="sxs-lookup"><span data-stu-id="f621e-1216">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f621e-1217">É mapeado para o controlador `Home` e o método `Index` (`id` é ignorado).</span><span class="sxs-lookup"><span data-stu-id="f621e-1217">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f621e-1218">Em geral, o uso de um modelo é a abordagem mais simples para o roteamento.</span><span class="sxs-lookup"><span data-stu-id="f621e-1218">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f621e-1219">Restrições e padrões também podem ser especificados fora do modelo de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1219">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f621e-1220">Habilite o [Log](xref:fundamentals/logging/index) para ver como as implementações de roteamento internas, como <xref:Microsoft.AspNetCore.Routing.Route>, correspondem às solicitações.</span><span class="sxs-lookup"><span data-stu-id="f621e-1220">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f621e-1221">Nomes reservados de roteamento</span><span class="sxs-lookup"><span data-stu-id="f621e-1221">Reserved routing names</span></span>

<span data-ttu-id="f621e-1222">As seguintes palavras-chave são nomes reservados e não podem ser usadas como nomes de rota ou parâmetros:</span><span class="sxs-lookup"><span data-stu-id="f621e-1222">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f621e-1223">Referência de restrição de rota</span><span class="sxs-lookup"><span data-stu-id="f621e-1223">Route constraint reference</span></span>

<span data-ttu-id="f621e-1224">As restrições de rota são executadas quando ocorre uma correspondência com a URL de entrada e é criado um token do caminho da URL em valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1224">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f621e-1225">Em geral, as restrições da rota inspecionam o valor de rota associado por meio do modelo de rota e tomam uma decisão do tipo "sim/não" sobre se o valor é aceitável ou não.</span><span class="sxs-lookup"><span data-stu-id="f621e-1225">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f621e-1226">Algumas restrições da rota usam dados fora do valor de rota para considerar se a solicitação pode ser encaminhada.</span><span class="sxs-lookup"><span data-stu-id="f621e-1226">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f621e-1227">Por exemplo, a <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> pode aceitar ou rejeitar uma solicitação de acordo com o verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f621e-1227">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f621e-1228">As restrições são usadas em solicitações de roteamento e na geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-1228">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f621e-1229">Não use restrições para a **validação de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f621e-1229">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f621e-1230">Se as restrições forem usadas para a **validação de entrada**, uma entrada inválida resultará em uma resposta *404 – Não Encontrado*, em vez de *400 – Solicitação Inválida* com uma mensagem de erro apropriada.</span><span class="sxs-lookup"><span data-stu-id="f621e-1230">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f621e-1231">As restrições de rota são usadas para **desfazer a ambiguidade** entre rotas semelhantes, não para validar as entradas de uma rota específica.</span><span class="sxs-lookup"><span data-stu-id="f621e-1231">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f621e-1232">A tabela a seguir demonstra restrições de rota de exemplo e seu comportamento esperado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1232">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f621e-1233">restrição</span><span class="sxs-lookup"><span data-stu-id="f621e-1233">constraint</span></span> | <span data-ttu-id="f621e-1234">{1&gt;Exemplo&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-1234">Example</span></span> | <span data-ttu-id="f621e-1235">Correspondências de exemplo</span><span class="sxs-lookup"><span data-stu-id="f621e-1235">Example Matches</span></span> | <span data-ttu-id="f621e-1236">{1&gt;Observações&lt;1}</span><span class="sxs-lookup"><span data-stu-id="f621e-1236">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f621e-1237">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-1237">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-1238">Corresponde a qualquer inteiro</span><span class="sxs-lookup"><span data-stu-id="f621e-1238">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f621e-1239">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f621e-1239">`true`, `FALSE`</span></span> | <span data-ttu-id="f621e-1240">Corresponde a `true` ou `false` (não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-1240">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f621e-1241">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f621e-1241">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f621e-1242">Corresponde a um valor `DateTime` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-1242">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f621e-1243">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f621e-1243">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f621e-1244">Corresponde a um valor `decimal` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-1244">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f621e-1245">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-1245">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-1246">Corresponde a um valor `double` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-1246">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f621e-1247">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f621e-1247">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f621e-1248">Corresponde a um valor `float` válido (na cultura invariável – veja o aviso)</span><span class="sxs-lookup"><span data-stu-id="f621e-1248">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f621e-1249">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f621e-1249">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f621e-1250">Corresponde a um valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-1250">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f621e-1251">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f621e-1251">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f621e-1252">Corresponde a um valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f621e-1252">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f621e-1253">A cadeia de caracteres deve ter, no mínimo, 4 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-1253">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f621e-1254">A cadeia de caracteres não pode ser maior que 8 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-1254">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f621e-1255">A cadeia de caracteres deve ter exatamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-1255">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f621e-1256">A cadeia de caracteres deve ter, pelo menos, 8 e não mais de 16 caracteres</span><span class="sxs-lookup"><span data-stu-id="f621e-1256">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f621e-1257">O valor inteiro deve ser, pelo menos, 18</span><span class="sxs-lookup"><span data-stu-id="f621e-1257">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f621e-1258">O valor inteiro não deve ser maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-1258">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f621e-1259">O valor inteiro deve ser, pelo menos, 18, mas não maior que 120</span><span class="sxs-lookup"><span data-stu-id="f621e-1259">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f621e-1260">A cadeia de caracteres deve consistir em um ou mais caracteres alfabéticos (`a`-`z`, não diferencia maiúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f621e-1260">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f621e-1261">A cadeia de caracteres deve corresponder à expressão regular (veja as dicas sobre como definir uma expressão regular)</span><span class="sxs-lookup"><span data-stu-id="f621e-1261">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f621e-1262">Usado para impor que um valor não parâmetro está presente durante a geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-1262">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f621e-1263">Várias restrições delimitadas por dois-pontos podem ser aplicadas a um único parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f621e-1263">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f621e-1264">Por exemplo, a restrição a seguir restringe um parâmetro para um valor inteiro de 1 ou maior:</span><span class="sxs-lookup"><span data-stu-id="f621e-1264">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f621e-1265">As restrições de rota que verificam a URL e são convertidas em um tipo CLR (como `int` ou `DateTime`) sempre usam a cultura invariável.</span><span class="sxs-lookup"><span data-stu-id="f621e-1265">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f621e-1266">Essas restrições consideram que a URL não é localizável.</span><span class="sxs-lookup"><span data-stu-id="f621e-1266">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f621e-1267">As restrições de rota fornecidas pela estrutura não modificam os valores armazenados nos valores de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1267">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f621e-1268">Todos os valores de rota analisados com base na URL são armazenados como cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-1268">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f621e-1269">Por exemplo, a restrição `float` tenta converter o valor de rota em um float, mas o valor convertido é usado somente para verificar se ele pode ser convertido em um float.</span><span class="sxs-lookup"><span data-stu-id="f621e-1269">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f621e-1270">Expressões regulares</span><span class="sxs-lookup"><span data-stu-id="f621e-1270">Regular expressions</span></span>

<span data-ttu-id="f621e-1271">A estrutura do ASP.NET Core adiciona `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` ao construtor de expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-1271">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f621e-1272">Confira <xref:System.Text.RegularExpressions.RegexOptions> para obter uma descrição desses membros.</span><span class="sxs-lookup"><span data-stu-id="f621e-1272">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f621e-1273">As expressões regulares usam delimitadores e tokens semelhantes aos usados pelo Roteamento e pela linguagem C#.</span><span class="sxs-lookup"><span data-stu-id="f621e-1273">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f621e-1274">Os tokens de expressão regular precisam ter escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-1274">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f621e-1275">Para usar a expressão regular `^\d`\\`-\d`\`-\d`\`$` no roteamento, a expressão precisa ter os caracteres `\` (barra invertida) fornecidos na cadeia de caracteres como caracteres `\\` (barra invertida dupla) no arquivo de origem C# para fazer o escape do caractere de escape da cadeia de caracteres `\` (a menos que estejam sendo usados [literais de cadeia de caracteres textuais](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f621e-1275">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f621e-1276">Para fazer o escape dos caracteres de delimitador de parâmetro de roteamento (`{`, `}`, `[`, `]`), duplique os caracteres na expressão (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="f621e-1276">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f621e-1277">A tabela a seguir mostra uma expressão regular e a versão com escape.</span><span class="sxs-lookup"><span data-stu-id="f621e-1277">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f621e-1278">Expressão Regular</span><span class="sxs-lookup"><span data-stu-id="f621e-1278">Regular Expression</span></span>    | <span data-ttu-id="f621e-1279">Expressão regular com escape</span><span class="sxs-lookup"><span data-stu-id="f621e-1279">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f621e-1280">As expressões regulares usadas no roteamento geralmente começam com o caractere de acento circunflexo (`^`) e correspondem à posição inicial da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-1280">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f621e-1281">As expressões geralmente terminam com o caractere de cifrão (`$`) e correspondem ao final da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f621e-1281">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f621e-1282">Os caracteres `^` e `$` garantem que a expressão regular corresponde a todo o valor do parâmetro de rota.</span><span class="sxs-lookup"><span data-stu-id="f621e-1282">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f621e-1283">Sem os caracteres `^` e `$`, a expressão regular corresponde a qualquer subcadeia de caracteres na cadeia de caracteres, o que geralmente não é o desejado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1283">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f621e-1284">A tabela a seguir fornece exemplos e explica por que eles encontram ou não uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="f621e-1284">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f621e-1285">Expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-1285">Expression</span></span>   | <span data-ttu-id="f621e-1286">String</span><span class="sxs-lookup"><span data-stu-id="f621e-1286">String</span></span>    | <span data-ttu-id="f621e-1287">Corresponder a</span><span class="sxs-lookup"><span data-stu-id="f621e-1287">Match</span></span> | <span data-ttu-id="f621e-1288">Comentário</span><span class="sxs-lookup"><span data-stu-id="f621e-1288">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f621e-1289">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-1289">hello</span></span>     | <span data-ttu-id="f621e-1290">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-1290">Yes</span></span>   | <span data-ttu-id="f621e-1291">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-1291">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-1292">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-1292">123abc456</span></span> | <span data-ttu-id="f621e-1293">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-1293">Yes</span></span>   | <span data-ttu-id="f621e-1294">A subcadeia de caracteres corresponde</span><span class="sxs-lookup"><span data-stu-id="f621e-1294">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f621e-1295">mz</span><span class="sxs-lookup"><span data-stu-id="f621e-1295">mz</span></span>        | <span data-ttu-id="f621e-1296">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-1296">Yes</span></span>   | <span data-ttu-id="f621e-1297">Corresponde à expressão</span><span class="sxs-lookup"><span data-stu-id="f621e-1297">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f621e-1298">MZ</span><span class="sxs-lookup"><span data-stu-id="f621e-1298">MZ</span></span>        | <span data-ttu-id="f621e-1299">Sim</span><span class="sxs-lookup"><span data-stu-id="f621e-1299">Yes</span></span>   | <span data-ttu-id="f621e-1300">Não diferencia maiúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f621e-1300">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-1301">olá</span><span class="sxs-lookup"><span data-stu-id="f621e-1301">hello</span></span>     | <span data-ttu-id="f621e-1302">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-1302">No</span></span>    | <span data-ttu-id="f621e-1303">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-1303">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f621e-1304">123abc456</span><span class="sxs-lookup"><span data-stu-id="f621e-1304">123abc456</span></span> | <span data-ttu-id="f621e-1305">Não</span><span class="sxs-lookup"><span data-stu-id="f621e-1305">No</span></span>    | <span data-ttu-id="f621e-1306">Confira `^` e `$` acima</span><span class="sxs-lookup"><span data-stu-id="f621e-1306">See `^` and `$` above</span></span> |

<span data-ttu-id="f621e-1307">Para saber mais sobre a sintaxe de expressões regulares, confira [Expressões regulares do .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f621e-1307">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f621e-1308">Para restringir um parâmetro a um conjunto conhecido de valores possíveis, use uma expressão regular.</span><span class="sxs-lookup"><span data-stu-id="f621e-1308">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f621e-1309">Por exemplo, `{action:regex(^(list|get|create)$)}` apenas corresponde o valor da rota `action` a `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1309">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f621e-1310">Se passada para o dicionário de restrições, a cadeia de caracteres `^(list|get|create)$` é equivalente.</span><span class="sxs-lookup"><span data-stu-id="f621e-1310">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f621e-1311">As restrições passadas para o dicionário de restrições (não embutidas em um modelo) que não correspondem a uma das restrições conhecidas também são tratadas como expressões regulares.</span><span class="sxs-lookup"><span data-stu-id="f621e-1311">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f621e-1312">Restrições de rota personalizadas</span><span class="sxs-lookup"><span data-stu-id="f621e-1312">Custom Route Constraints</span></span>

<span data-ttu-id="f621e-1313">Além das restrições de rota internas, é possível criar restrições de rota personalizadas com a implementação da interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1313">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f621e-1314">A interface do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contém um único método, `Match`, que retorna `true` quando a restrição é satisfeita. Caso contrário, retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1314">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f621e-1315">Para usar uma <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, o tipo de restrição de rota deve ser registrado com o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo, no contêiner de serviço do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f621e-1315">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f621e-1316">O <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> é um dicionário que mapeia as chaves de restrição de rota para implementações de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validam essas restrições.</span><span class="sxs-lookup"><span data-stu-id="f621e-1316">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f621e-1317">É possível atualizar o <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> do aplicativo no `Startup.ConfigureServices` como parte de uma chamada [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) ou configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> diretamente com `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1317">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f621e-1318">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-1318">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f621e-1319">a restrição pode então ser aplicada às rotas da maneira usual, usando o nome especificado ao registrar o tipo de restrição.</span><span class="sxs-lookup"><span data-stu-id="f621e-1319">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f621e-1320">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f621e-1320">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="f621e-1321">Referência de geração de URL</span><span class="sxs-lookup"><span data-stu-id="f621e-1321">URL generation reference</span></span>

<span data-ttu-id="f621e-1322">O exemplo a seguir mostra como gerar um link para uma rota com base em um dicionário de valores de rota e em um <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f621e-1322">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f621e-1323">O <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> gerado no final do exemplo anterior é `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1323">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f621e-1324">O dicionário fornece os valores de rota `operation` e `id` do modelo "Rastrear rota do pacote", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1324">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f621e-1325">Para obter detalhes, consulte o código de exemplo na seção [Usar o middleware de roteamento](#use-routing-middleware) ou no [aplicativo de exemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f621e-1325">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f621e-1326">O segundo parâmetro para o construtor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> é uma coleção de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f621e-1326">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f621e-1327">Os valores de ambiente são convenientes de serem usados porque limitam o número de valores que um desenvolvedor precisa especificar em um contexto de solicitação.</span><span class="sxs-lookup"><span data-stu-id="f621e-1327">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f621e-1328">Os valores de rota atuais da solicitação atual são considerados valores de ambiente para a geração de link.</span><span class="sxs-lookup"><span data-stu-id="f621e-1328">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f621e-1329">Na ação `About` de um aplicativo ASP.NET Core MVC do `HomeController`, não é necessário especificar o valor de rota do controlador a ser vinculado à ação `Index` – o valor de ambiente &mdash; é usado.</span><span class="sxs-lookup"><span data-stu-id="f621e-1329">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f621e-1330">Os valores de ambiente que não correspondem a um parâmetro são ignorados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1330">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f621e-1331">Os valores de ambiente também são ignorados quando um valor fornecido explicitamente substitui o valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f621e-1331">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f621e-1332">A correspondência ocorre da esquerda para a direita na URL.</span><span class="sxs-lookup"><span data-stu-id="f621e-1332">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f621e-1333">Valores fornecidos explicitamente, mas que não correspondem a um segmento da rota, são adicionados à cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="f621e-1333">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f621e-1334">A tabela a seguir mostra o resultado do uso do modelo de rota `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f621e-1334">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f621e-1335">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f621e-1335">Ambient Values</span></span>                     | <span data-ttu-id="f621e-1336">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f621e-1336">Explicit Values</span></span>                        | <span data-ttu-id="f621e-1337">Resultado</span><span class="sxs-lookup"><span data-stu-id="f621e-1337">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f621e-1338">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-1338">controller = "Home"</span></span>                | <span data-ttu-id="f621e-1339">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-1339">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-1340">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-1340">controller = "Home"</span></span>                | <span data-ttu-id="f621e-1341">controlador = "Order", ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-1341">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f621e-1342">controlador = "Home", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-1342">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f621e-1343">ação = "About"</span><span class="sxs-lookup"><span data-stu-id="f621e-1343">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f621e-1344">controlador = "Home"</span><span class="sxs-lookup"><span data-stu-id="f621e-1344">controller = "Home"</span></span>                | <span data-ttu-id="f621e-1345">ação = "About", cor = "Red"</span><span class="sxs-lookup"><span data-stu-id="f621e-1345">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f621e-1346">Se uma rota tem um valor padrão que não corresponde a um parâmetro e esse valor é fornecido de forma explícita, ele precisa corresponder ao valor padrão:</span><span class="sxs-lookup"><span data-stu-id="f621e-1346">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f621e-1347">A geração de link somente gera um link para essa rota quando os valores correspondentes de `controller` e `action` são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="f621e-1347">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f621e-1348">Segmentos complexos</span><span class="sxs-lookup"><span data-stu-id="f621e-1348">Complex segments</span></span>

<span data-ttu-id="f621e-1349">Segmentos complexos (por exemplo, `[Route("/x{token}y")]`) são processados por meio da combinação de literais da direita para a esquerda, de uma maneira diferente de Greedy.</span><span class="sxs-lookup"><span data-stu-id="f621e-1349">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f621e-1350">Confira [este código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para ver uma explicação detalhada de como os segmentos complexos são combinados.</span><span class="sxs-lookup"><span data-stu-id="f621e-1350">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f621e-1351">O [exemplo de código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) não é usado pelo ASP.NET Core, mas fornece uma explicação adequada sobre segmentos complexos.</span><span class="sxs-lookup"><span data-stu-id="f621e-1351">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end
