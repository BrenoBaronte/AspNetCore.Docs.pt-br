## <a name="call-the-web-api-with-jquery"></a><span data-ttu-id="76c03-101">Chamar a API Web com o jQuery</span><span class="sxs-lookup"><span data-stu-id="76c03-101">Call the Web API with jQuery</span></span>

<span data-ttu-id="76c03-102">Nesta seção, é adicionada uma página HTML que usa o jQuery para chamar a API Web.</span><span class="sxs-lookup"><span data-stu-id="76c03-102">In this section, an HTML page is added that uses jQuery to call the Web API.</span></span> <span data-ttu-id="76c03-103">O jQuery inicia a solicitação e atualiza a página com os detalhes da resposta da API.</span><span class="sxs-lookup"><span data-stu-id="76c03-103">jQuery initiates the request and updates the page with the details from the API's response.</span></span>

<span data-ttu-id="76c03-104">Configure o projeto para atender arquivos estáticos e habilitar o mapeamento de arquivo padrão.</span><span class="sxs-lookup"><span data-stu-id="76c03-104">Configure the project to serve static files and to enable default file mapping.</span></span> <span data-ttu-id="76c03-105">Isso é feito chamando os métodos de extensão [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) e [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) em *Startup.Configure*.</span><span class="sxs-lookup"><span data-stu-id="76c03-105">This is accomplished by invoking the [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) and [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) extension methods in *Startup.Configure*.</span></span> <span data-ttu-id="76c03-106">Para obter mais informações, veja [Arquivos estáticos](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="76c03-106">For more information, see [Static files](xref:fundamentals/static-files).</span></span>

[!code-csharp[](../../tutorials/first-web-api/samples/2.0/TodoApi/Startup2.cs?name=snippet_Configure&highlight=3-4)]

<span data-ttu-id="76c03-107">Adicione um arquivo HTML, chamado *index.html*, ao diretório *wwwroot* do projeto.</span><span class="sxs-lookup"><span data-stu-id="76c03-107">Add an HTML file, named *index.html*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="76c03-108">Substitua seu conteúdo pela seguinte marcação:</span><span class="sxs-lookup"><span data-stu-id="76c03-108">Replace its contents with the following markup:</span></span>

[!code-html[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/index.html)]

<span data-ttu-id="76c03-109">Adicione um arquivo JavaScript, chamado *site.js*, ao diretório *wwwroot* do projeto.</span><span class="sxs-lookup"><span data-stu-id="76c03-109">Add a JavaScript file, named *site.js*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="76c03-110">Substitua seu conteúdo pelo código a seguir:</span><span class="sxs-lookup"><span data-stu-id="76c03-110">Replace its contents with the following code:</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_SiteJs)]

<span data-ttu-id="76c03-111">Pode ser necessário realizar uma alteração nas configurações de inicialização do projeto do ASP.NET Core para testar a página HTML localmente.</span><span class="sxs-lookup"><span data-stu-id="76c03-111">A change to the ASP.NET Core project's launch settings may be required to test the HTML page locally.</span></span> <span data-ttu-id="76c03-112">Abra *launchSettings.json* no diretório *Propriedades* do projeto.</span><span class="sxs-lookup"><span data-stu-id="76c03-112">Open *launchSettings.json* in the *Properties* directory of the project.</span></span> <span data-ttu-id="76c03-113">Remova a propriedade `launchUrl` para forçar o aplicativo a ser aberto em *index.html*, o arquivo padrão do projeto.</span><span class="sxs-lookup"><span data-stu-id="76c03-113">Remove the `launchUrl` property to force the app to open at *index.html*&mdash;the project's default file.</span></span>

<span data-ttu-id="76c03-114">Há várias maneiras de obter o jQuery.</span><span class="sxs-lookup"><span data-stu-id="76c03-114">There are several ways to get jQuery.</span></span> <span data-ttu-id="76c03-115">No trecho de código anterior, a biblioteca é carregada de uma CDN.</span><span class="sxs-lookup"><span data-stu-id="76c03-115">In the preceding snippet, the library is loaded from a CDN.</span></span> <span data-ttu-id="76c03-116">Este é um exemplo completo de CRUD ao chamar a API com o jQuery.</span><span class="sxs-lookup"><span data-stu-id="76c03-116">This sample is a complete CRUD example of calling the API with jQuery.</span></span> <span data-ttu-id="76c03-117">Existem recursos adicionais neste exemplo para enriquecer a experiência.</span><span class="sxs-lookup"><span data-stu-id="76c03-117">There are additional features in this sample to make the experience richer.</span></span> <span data-ttu-id="76c03-118">Abaixo estão as explicações relacionadas às chamadas à API.</span><span class="sxs-lookup"><span data-stu-id="76c03-118">Below are explanations around the calls to the API.</span></span>

### <a name="get-a-list-of-to-do-items"></a><span data-ttu-id="76c03-119">Obter uma lista de itens pendentes</span><span class="sxs-lookup"><span data-stu-id="76c03-119">Get a list of to-do items</span></span>

<span data-ttu-id="76c03-120">Para obter uma lista de itens pendentes, envie uma solicitação HTTP GET para */api/todo*.</span><span class="sxs-lookup"><span data-stu-id="76c03-120">To get a list of to-do items, send an HTTP GET request to */api/todo*.</span></span>

<span data-ttu-id="76c03-121">A função [ajax](https://api.jquery.com/jquery.ajax/) do jQuery envia uma solicitação AJAX para a API, que retorna o JSON que representa um objeto ou uma matriz.</span><span class="sxs-lookup"><span data-stu-id="76c03-121">The jQuery [ajax](https://api.jquery.com/jquery.ajax/) function sends an AJAX request to the API, which returns JSON representing an object or array.</span></span> <span data-ttu-id="76c03-122">Essa função pode lidar com todas as formas de interação de HTTP, enviando uma solicitação HTTP à `url` especificada.</span><span class="sxs-lookup"><span data-stu-id="76c03-122">This function can handle all forms of HTTP interaction, sending an HTTP request to the specified `url`.</span></span> <span data-ttu-id="76c03-123">`GET` é usado como o `type`.</span><span class="sxs-lookup"><span data-stu-id="76c03-123">`GET` is used as the `type`.</span></span> <span data-ttu-id="76c03-124">A função de retorno de chamada `success` será invocada se a solicitação for bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="76c03-124">The `success` callback function is invoked if the request succeeds.</span></span> <span data-ttu-id="76c03-125">No retorno de chamada, o DOM é atualizado com as informações do item pendente.</span><span class="sxs-lookup"><span data-stu-id="76c03-125">In the callback, the DOM is updated with the to-do information.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_GetData)]

### <a name="add-a-to-do-item"></a><span data-ttu-id="76c03-126">Adicionar um item pendente</span><span class="sxs-lookup"><span data-stu-id="76c03-126">Add a to-do item</span></span>

<span data-ttu-id="76c03-127">Para adicionar um item pendente, envie uma solicitação HTTP POST para */api/todo/*.</span><span class="sxs-lookup"><span data-stu-id="76c03-127">To add a to-do item, send an HTTP POST request to */api/todo/*.</span></span> <span data-ttu-id="76c03-128">O corpo da solicitação deve conter um objeto pendente.</span><span class="sxs-lookup"><span data-stu-id="76c03-128">The request body should contain a to-do object.</span></span> <span data-ttu-id="76c03-129">A função [ajax](https://api.jquery.com/jquery.ajax/) está usando o `POST` para chamar a API.</span><span class="sxs-lookup"><span data-stu-id="76c03-129">The [ajax](https://api.jquery.com/jquery.ajax/) function is using `POST` to call the API.</span></span> <span data-ttu-id="76c03-130">Para as solicitações `POST` e `PUT`, o corpo da solicitação representa os dados enviados para a API.</span><span class="sxs-lookup"><span data-stu-id="76c03-130">For `POST` and `PUT` requests, the request body represents the data sent to the API.</span></span> <span data-ttu-id="76c03-131">A API está esperando um corpo de solicitação JSON.</span><span class="sxs-lookup"><span data-stu-id="76c03-131">The API is expecting a JSON request body.</span></span> <span data-ttu-id="76c03-132">As opções `accepts` e `contentType` são definidas como `application/json` para classificar o tipo de mídia que está sendo recebido e enviado, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="76c03-132">The `accepts` and `contentType` options are set to `application/json` to classify the media type being received and sent, respectively.</span></span> <span data-ttu-id="76c03-133">Os dados são convertidos em um objeto JSON usando [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span><span class="sxs-lookup"><span data-stu-id="76c03-133">The data is converted to a JSON object using [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span></span> <span data-ttu-id="76c03-134">Quando a API retorna um código de status de êxito, a função `getData` é invocada para atualizar a tabela HTML.</span><span class="sxs-lookup"><span data-stu-id="76c03-134">When the API returns a successful status code, the `getData` function is invoked to update the HTML table.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AddItem)]

### <a name="update-a-to-do-item"></a><span data-ttu-id="76c03-135">Atualizar um item pendente</span><span class="sxs-lookup"><span data-stu-id="76c03-135">Update a to-do item</span></span>

<span data-ttu-id="76c03-136">Atualizar um item pendente é muito semelhante a adicionar um item pendente, pois ambas as ações contam com um corpo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="76c03-136">Updating a to-do item is very similar to adding one, since both rely on a request body.</span></span> <span data-ttu-id="76c03-137">Nesse caso, a única diferença real entre as duas é que a `url` é alterada para adicionar o identificador exclusivo do item e o `type` é `PUT`.</span><span class="sxs-lookup"><span data-stu-id="76c03-137">The only real difference between the two in this case is that the `url` changes to add the unique identifier of the item, and the `type` is `PUT`.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxPut)]

### <a name="delete-a-to-do-item"></a><span data-ttu-id="76c03-138">Excluir um item pendente</span><span class="sxs-lookup"><span data-stu-id="76c03-138">Delete a to-do item</span></span>

<span data-ttu-id="76c03-139">A exclusão de um item pendente é feita definindo o `type` na chamada do AJAX como `DELETE` e especificando o identificador exclusivo do item na URL.</span><span class="sxs-lookup"><span data-stu-id="76c03-139">Deleting a to-do item is accomplished by setting the `type` on the AJAX call to `DELETE` and specifing the item's unique identifier in the URL.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxDelete)]
