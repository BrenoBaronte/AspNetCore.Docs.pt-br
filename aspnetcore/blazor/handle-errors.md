---
title: Tratar erros em aplicativos ASP.NET Core mais
author: guardrex
description: Descubra como ASP.NET Core mais incrivelmente o gerenciamento de exceções sem tratamento e como desenvolver aplicativos que detectem e lidem com erros.
monikerRange: '>= aspnetcore-3.0'
ms.author: riande
ms.custom: mvc
ms.date: 08/06/2019
uid: blazor/handle-errors
ms.openlocfilehash: d3e261e83f375574339a8ce3428e8bfb73df4307
ms.sourcegitcommit: 092061c4f6ef46ed2165fa84de6273d3786fb97e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/13/2019
ms.locfileid: "70963984"
---
# <a name="handle-errors-in-aspnet-core-blazor-apps"></a><span data-ttu-id="f07ec-103">Tratar erros em aplicativos ASP.NET Core mais</span><span class="sxs-lookup"><span data-stu-id="f07ec-103">Handle errors in ASP.NET Core Blazor apps</span></span>

<span data-ttu-id="f07ec-104">Por [Steve Sanderson](https://github.com/SteveSandersonMS)</span><span class="sxs-lookup"><span data-stu-id="f07ec-104">By [Steve Sanderson](https://github.com/SteveSandersonMS)</span></span>

<span data-ttu-id="f07ec-105">Este artigo descreve como o mais incrivelmente gerencia exceções sem tratamento e como desenvolver aplicativos que detectam e manipulam erros.</span><span class="sxs-lookup"><span data-stu-id="f07ec-105">This article describes how Blazor manages unhandled exceptions and how to develop apps that detect and handle errors.</span></span>

## <a name="how-the-blazor-framework-reacts-to-unhandled-exceptions"></a><span data-ttu-id="f07ec-106">Como a estrutura mais incrivelmente reage a exceções sem tratamento</span><span class="sxs-lookup"><span data-stu-id="f07ec-106">How the Blazor framework reacts to unhandled exceptions</span></span>

<span data-ttu-id="f07ec-107">O servidor mais incrivelmente é uma estrutura com estado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-107">Blazor Server is a stateful framework.</span></span> <span data-ttu-id="f07ec-108">Enquanto os usuários interagem com um aplicativo, eles mantêm uma conexão com o servidor conhecido como um *circuito*.</span><span class="sxs-lookup"><span data-stu-id="f07ec-108">While users interact with an app, they maintain a connection to the server known as a *circuit*.</span></span> <span data-ttu-id="f07ec-109">O circuito contém instâncias de componentes ativos, além de muitos outros aspectos do estado, como:</span><span class="sxs-lookup"><span data-stu-id="f07ec-109">The circuit holds active component instances, plus many other aspects of state, such as:</span></span>

* <span data-ttu-id="f07ec-110">A saída renderizada mais recente dos componentes.</span><span class="sxs-lookup"><span data-stu-id="f07ec-110">The most recent rendered output of components.</span></span>
* <span data-ttu-id="f07ec-111">O conjunto atual de delegados de manipulação de eventos que poderia ser disparado por eventos do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-111">The current set of event-handling delegates that could be triggered by client-side events.</span></span>

<span data-ttu-id="f07ec-112">Se um usuário abrir o aplicativo em várias guias do navegador, ele terá vários circuitos independentes.</span><span class="sxs-lookup"><span data-stu-id="f07ec-112">If a user opens the app in multiple browser tabs, they have multiple independent circuits.</span></span>

<span data-ttu-id="f07ec-113">O mais grande trata as exceções não tratadas como fatais ao circuito onde elas ocorrem.</span><span class="sxs-lookup"><span data-stu-id="f07ec-113">Blazor treats most unhandled exceptions as fatal to the circuit where they occur.</span></span> <span data-ttu-id="f07ec-114">Se um circuito for encerrado devido a uma exceção sem tratamento, o usuário só poderá continuar a interagir com o aplicativo recarregando a página para criar um novo circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-114">If a circuit is terminated due to an unhandled exception, the user can only continue to interact with the app by reloading the page to create a new circuit.</span></span> <span data-ttu-id="f07ec-115">Os circuitos fora do que foi encerrado, que são circuitos para outros usuários ou outras guias do navegador, não são afetados.</span><span class="sxs-lookup"><span data-stu-id="f07ec-115">Circuits outside of the one that's terminated, which are circuits for other users or other browser tabs, aren't affected.</span></span> <span data-ttu-id="f07ec-116">Esse cenário é semelhante a um aplicativo de área de&mdash;trabalho que falha no aplicativo com falha deve ser reiniciado, mas outros aplicativos não são afetados.</span><span class="sxs-lookup"><span data-stu-id="f07ec-116">This scenario is similar to a desktop app that crashes&mdash;the crashed app must be restarted, but other apps aren't affected.</span></span>

<span data-ttu-id="f07ec-117">Um circuito é encerrado quando ocorre uma exceção sem tratamento pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="f07ec-117">A circuit is terminated when an unhandled exception occurs for the following reasons:</span></span>

* <span data-ttu-id="f07ec-118">Uma exceção sem tratamento geralmente deixa o circuito em um estado indefinido.</span><span class="sxs-lookup"><span data-stu-id="f07ec-118">An unhandled exception often leaves the circuit in an undefined state.</span></span>
* <span data-ttu-id="f07ec-119">A operação normal do aplicativo não pode ser garantida após uma exceção sem tratamento.</span><span class="sxs-lookup"><span data-stu-id="f07ec-119">The app's normal operation can't be guaranteed after an unhandled exception.</span></span>
* <span data-ttu-id="f07ec-120">As vulnerabilidades de segurança podem aparecer no aplicativo se o circuito continuar.</span><span class="sxs-lookup"><span data-stu-id="f07ec-120">Security vulnerabilities may appear in the app if the circuit continues.</span></span>

## <a name="manage-unhandled-exceptions-in-developer-code"></a><span data-ttu-id="f07ec-121">Gerenciar exceções sem tratamento no código do desenvolvedor</span><span class="sxs-lookup"><span data-stu-id="f07ec-121">Manage unhandled exceptions in developer code</span></span>

<span data-ttu-id="f07ec-122">Para que um aplicativo continue após um erro, o aplicativo deve ter a lógica de tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="f07ec-122">For an app to continue after an error, the app must have error handling logic.</span></span> <span data-ttu-id="f07ec-123">As seções posteriores deste artigo descrevem possíveis fontes de exceções sem tratamento.</span><span class="sxs-lookup"><span data-stu-id="f07ec-123">Later sections of this article describe potential sources of unhandled exceptions.</span></span>

<span data-ttu-id="f07ec-124">Em produção, não processe mensagens de exceção de estrutura ou rastreamentos de pilha na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f07ec-124">In production, don't render framework exception messages or stack traces in the UI.</span></span> <span data-ttu-id="f07ec-125">O processamento de mensagens de exceção ou rastreamentos de pilha pode:</span><span class="sxs-lookup"><span data-stu-id="f07ec-125">Rendering exception messages or stack traces could:</span></span>

* <span data-ttu-id="f07ec-126">Divulgue informações confidenciais para os usuários finais.</span><span class="sxs-lookup"><span data-stu-id="f07ec-126">Disclose sensitive information to end users.</span></span>
* <span data-ttu-id="f07ec-127">Ajudar um usuário mal-intencionado a descobrir pontos fracos em um aplicativo que pode comprometer a segurança do aplicativo, do servidor ou da rede.</span><span class="sxs-lookup"><span data-stu-id="f07ec-127">Help a malicious user discover weaknesses in an app that can compromise the security of the app, server, or network.</span></span>

## <a name="log-errors-with-a-persistent-provider"></a><span data-ttu-id="f07ec-128">Registrar erros em log com um provedor persistente</span><span class="sxs-lookup"><span data-stu-id="f07ec-128">Log errors with a persistent provider</span></span>

<span data-ttu-id="f07ec-129">Se ocorrer uma exceção sem tratamento, a exceção será registrada em <xref:Microsoft.Extensions.Logging.ILogger> instâncias configuradas no contêiner de serviço.</span><span class="sxs-lookup"><span data-stu-id="f07ec-129">If an unhandled exception occurs, the exception is logged to <xref:Microsoft.Extensions.Logging.ILogger> instances configured in the service container.</span></span> <span data-ttu-id="f07ec-130">Por padrão, os aplicativos mais incrivelmente registram em log a saída do console com o provedor de log do console.</span><span class="sxs-lookup"><span data-stu-id="f07ec-130">By default, Blazor apps log to console output with the Console Logging Provider.</span></span> <span data-ttu-id="f07ec-131">Considere fazer logon em um local mais permanente com um provedor que gerencia o tamanho do log e a rotação do log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-131">Consider logging to a more permanent location with a provider that manages log size and log rotation.</span></span> <span data-ttu-id="f07ec-132">Para obter mais informações, consulte <xref:fundamentals/logging/index>.</span><span class="sxs-lookup"><span data-stu-id="f07ec-132">For more information, see <xref:fundamentals/logging/index>.</span></span>

<span data-ttu-id="f07ec-133">Durante o desenvolvimento, o mais claro geralmente envia os detalhes completos das exceções para o console do navegador para auxiliar na depuração.</span><span class="sxs-lookup"><span data-stu-id="f07ec-133">During development, Blazor usually sends the full details of exceptions to the browser's console to aid in debugging.</span></span> <span data-ttu-id="f07ec-134">Na produção, os erros detalhados no console do navegador são desabilitados por padrão, o que significa que os erros não são enviados aos clientes, mas os detalhes completos da exceção ainda são registrados no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="f07ec-134">In production, detailed errors in the browser's console are disabled by default, which means that errors aren't sent to clients but the exception's full details are still logged server-side.</span></span> <span data-ttu-id="f07ec-135">Para obter mais informações, consulte <xref:fundamentals/error-handling>.</span><span class="sxs-lookup"><span data-stu-id="f07ec-135">For more information, see <xref:fundamentals/error-handling>.</span></span>

<span data-ttu-id="f07ec-136">Você deve decidir quais incidentes registrar e o nível de gravidade dos incidentes registrados.</span><span class="sxs-lookup"><span data-stu-id="f07ec-136">You must decide which incidents to log and the level of severity of logged incidents.</span></span> <span data-ttu-id="f07ec-137">Usuários hostis podem ser capazes de disparar erros deliberadamente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-137">Hostile users might be able to trigger errors deliberately.</span></span> <span data-ttu-id="f07ec-138">Por exemplo, não registre um incidente de um erro em que um `ProductId` desconhecido é fornecido na URL de um componente que exibe detalhes do produto.</span><span class="sxs-lookup"><span data-stu-id="f07ec-138">For example, don't log an incident from an error where an unknown `ProductId` is supplied in the URL of a component that displays product details.</span></span> <span data-ttu-id="f07ec-139">Nem todos os erros devem ser tratados como incidentes de alta severidade para registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-139">Not all errors should be treated as high-severity incidents for logging.</span></span>

## <a name="places-where-errors-may-occur"></a><span data-ttu-id="f07ec-140">Locais onde podem ocorrer erros</span><span class="sxs-lookup"><span data-stu-id="f07ec-140">Places where errors may occur</span></span>

<span data-ttu-id="f07ec-141">O Framework e o código do aplicativo podem disparar exceções sem tratamento em qualquer um dos seguintes locais:</span><span class="sxs-lookup"><span data-stu-id="f07ec-141">Framework and app code may trigger unhandled exceptions in any of the following locations:</span></span>

* [<span data-ttu-id="f07ec-142">Instanciação de componente</span><span class="sxs-lookup"><span data-stu-id="f07ec-142">Component instantiation</span></span>](#component-instantiation)
* [<span data-ttu-id="f07ec-143">Métodos de ciclo de vida</span><span class="sxs-lookup"><span data-stu-id="f07ec-143">Lifecycle methods</span></span>](#lifecycle-methods)
* [<span data-ttu-id="f07ec-144">Lógica de renderização</span><span class="sxs-lookup"><span data-stu-id="f07ec-144">Rendering logic</span></span>](#rendering-logic)
* [<span data-ttu-id="f07ec-145">Manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="f07ec-145">Event handlers</span></span>](#event-handlers)
* [<span data-ttu-id="f07ec-146">Disposição do componente</span><span class="sxs-lookup"><span data-stu-id="f07ec-146">Component disposal</span></span>](#component-disposal)
* [<span data-ttu-id="f07ec-147">Interoperabilidade de JavaScript</span><span class="sxs-lookup"><span data-stu-id="f07ec-147">JavaScript interop</span></span>](#javascript-interop)
* [<span data-ttu-id="f07ec-148">Manipuladores de circuito</span><span class="sxs-lookup"><span data-stu-id="f07ec-148">Circuit handlers</span></span>](#circuit-handlers)
* [<span data-ttu-id="f07ec-149">Disposição do circuito</span><span class="sxs-lookup"><span data-stu-id="f07ec-149">Circuit disposal</span></span>](#circuit-disposal)
* [<span data-ttu-id="f07ec-150">Prerenderizando</span><span class="sxs-lookup"><span data-stu-id="f07ec-150">Prerendering</span></span>](#prerendering)

<span data-ttu-id="f07ec-151">As exceções sem tratamento anteriores são descritas nas seções a seguir deste artigo.</span><span class="sxs-lookup"><span data-stu-id="f07ec-151">The preceding unhandled exceptions are described in the following sections of this article.</span></span>

### <a name="component-instantiation"></a><span data-ttu-id="f07ec-152">Instanciação de componente</span><span class="sxs-lookup"><span data-stu-id="f07ec-152">Component instantiation</span></span>

<span data-ttu-id="f07ec-153">Quando o mais claro cria uma instância de um componente:</span><span class="sxs-lookup"><span data-stu-id="f07ec-153">When Blazor creates an instance of a component:</span></span>

* <span data-ttu-id="f07ec-154">O construtor do componente é invocado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-154">The component's constructor is invoked.</span></span>
* <span data-ttu-id="f07ec-155">Os construtores de quaisquer serviços não singleton de di fornecidos ao construtor do componente por meio da [@inject](xref:blazor/dependency-injection#request-a-service-in-a-component) diretiva ou do atributo [[injetar]](xref:blazor/dependency-injection#request-a-service-in-a-component) são invocados.</span><span class="sxs-lookup"><span data-stu-id="f07ec-155">The constructors of any non-singleton DI services supplied to the component's constructor via the [@inject](xref:blazor/dependency-injection#request-a-service-in-a-component) directive or the [[Inject]](xref:blazor/dependency-injection#request-a-service-in-a-component) attribute are invoked.</span></span> 

<span data-ttu-id="f07ec-156">Um circuito falha quando qualquer Construtor executado ou um setter para qualquer `[Inject]` propriedade gera uma exceção sem tratamento.</span><span class="sxs-lookup"><span data-stu-id="f07ec-156">A circuit fails when any executed constructor or a setter for any `[Inject]` property throws an unhandled exception.</span></span> <span data-ttu-id="f07ec-157">A exceção é fatal porque a estrutura não pode instanciar o componente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-157">The exception is fatal because the framework can't instantiate the component.</span></span> <span data-ttu-id="f07ec-158">Se a lógica do Construtor puder gerar exceções, o aplicativo deverá interceptar as exceções usando uma instrução [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com tratamento de erros e registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-158">If constructor logic may throw exceptions, the app should trap the exceptions using a [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statement with error handling and logging.</span></span>

### <a name="lifecycle-methods"></a><span data-ttu-id="f07ec-159">Métodos de ciclo de vida</span><span class="sxs-lookup"><span data-stu-id="f07ec-159">Lifecycle methods</span></span>

<span data-ttu-id="f07ec-160">Durante o tempo de vida de um componente, o mais claro invoca métodos de ciclo de vida:</span><span class="sxs-lookup"><span data-stu-id="f07ec-160">During the lifetime of a component, Blazor invokes lifecycle methods:</span></span>

* `OnInitialized` / `OnInitializedAsync`
* `OnParametersSet` / `OnParametersSetAsync`
* `ShouldRender` / `ShouldRenderAsync`
* `OnAfterRender` / `OnAfterRenderAsync`

<span data-ttu-id="f07ec-161">Se qualquer método de ciclo de vida lançar uma exceção, de forma síncrona ou assíncrona, a exceção será fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-161">If any lifecycle method throws an exception, synchronously or asynchronously, the exception is fatal to the circuit.</span></span> <span data-ttu-id="f07ec-162">Para componentes que lidam com erros em métodos de ciclo de vida, adicione a lógica de tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="f07ec-162">For components to deal with errors in lifecycle methods, add error handling logic.</span></span>

<span data-ttu-id="f07ec-163">No exemplo a seguir, `OnParametersSetAsync` onde chama um método para obter um produto:</span><span class="sxs-lookup"><span data-stu-id="f07ec-163">In the following example where `OnParametersSetAsync` calls a method to obtain a product:</span></span>

* <span data-ttu-id="f07ec-164">Uma exceção gerada no `ProductRepository.GetProductByIdAsync` método é manipulada por uma `try-catch` instrução.</span><span class="sxs-lookup"><span data-stu-id="f07ec-164">An exception thrown in the `ProductRepository.GetProductByIdAsync` method is handled by a `try-catch` statement.</span></span>
* <span data-ttu-id="f07ec-165">Quando o `catch` bloco é executado:</span><span class="sxs-lookup"><span data-stu-id="f07ec-165">When the `catch` block is executed:</span></span>
  * <span data-ttu-id="f07ec-166">`loadFailed`é definido como `true`, que é usado para exibir uma mensagem de erro para o usuário.</span><span class="sxs-lookup"><span data-stu-id="f07ec-166">`loadFailed` is set to `true`, which is used to display an error message to the user.</span></span>
  * <span data-ttu-id="f07ec-167">O erro é registrado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-167">The error is logged.</span></span>

[!code-cshtml[](handle-errors/samples_snapshot/3.x/product-details.razor?highlight=11,27-39)]

### <a name="rendering-logic"></a><span data-ttu-id="f07ec-168">Lógica de renderização</span><span class="sxs-lookup"><span data-stu-id="f07ec-168">Rendering logic</span></span>

<span data-ttu-id="f07ec-169">A marcação declarativa em um `.razor` arquivo de componente é compilada C# em um `BuildRenderTree`método chamado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-169">The declarative markup in a `.razor` component file is compiled into a C# method called `BuildRenderTree`.</span></span> <span data-ttu-id="f07ec-170">Quando um componente renderiza, `BuildRenderTree` o executa e cria uma estrutura de dados que descreve os elementos, o texto e os componentes filho do componente renderizado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-170">When a component renders, `BuildRenderTree` executes and builds up a data structure describing the elements, text, and child components of the rendered component.</span></span>

<span data-ttu-id="f07ec-171">A lógica de renderização pode gerar uma exceção.</span><span class="sxs-lookup"><span data-stu-id="f07ec-171">Rendering logic can throw an exception.</span></span> <span data-ttu-id="f07ec-172">Um exemplo desse cenário ocorre quando `@someObject.PropertyName` o é avaliado, mas `null` `@someObject` é.</span><span class="sxs-lookup"><span data-stu-id="f07ec-172">An example of this scenario occurs when `@someObject.PropertyName` is evaluated but `@someObject` is `null`.</span></span> <span data-ttu-id="f07ec-173">Uma exceção sem tratamento gerada pela lógica de renderização é fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-173">An unhandled exception thrown by rendering logic is fatal to the circuit.</span></span>

<span data-ttu-id="f07ec-174">Para evitar uma exceção de referência nula na lógica de renderização, verifique `null` se há um objeto antes de acessar seus membros.</span><span class="sxs-lookup"><span data-stu-id="f07ec-174">To prevent a null reference exception in rendering logic, check for a `null` object before accessing its members.</span></span> <span data-ttu-id="f07ec-175">No exemplo a seguir, `person.Address` as propriedades não são `person.Address` acessadas se for `null`:</span><span class="sxs-lookup"><span data-stu-id="f07ec-175">In the following example, `person.Address` properties aren't accessed if `person.Address` is `null`:</span></span>

[!code-cshtml[](handle-errors/samples_snapshot/3.x/person-example.razor?highlight=1)]

<span data-ttu-id="f07ec-176">O código anterior pressupõe que `person` não `null`é.</span><span class="sxs-lookup"><span data-stu-id="f07ec-176">The preceding code assumes that `person` isn't `null`.</span></span> <span data-ttu-id="f07ec-177">Geralmente, a estrutura do código garante que um objeto exista no momento em que o componente é renderizado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-177">Often, the structure of the code guarantees that an object exists at the time the component is rendered.</span></span> <span data-ttu-id="f07ec-178">Nesses casos, não é necessário verificar na lógica de `null` renderização.</span><span class="sxs-lookup"><span data-stu-id="f07ec-178">In those cases, it isn't necessary to check for `null` in rendering logic.</span></span> <span data-ttu-id="f07ec-179">No exemplo anterior, `person` talvez seja garantido que exista porque `person` é criado quando o componente é instanciado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-179">In the prior example, `person` might be guaranteed to exist because `person` is created when the component is instantiated.</span></span>

### <a name="event-handlers"></a><span data-ttu-id="f07ec-180">Manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="f07ec-180">Event handlers</span></span>

<span data-ttu-id="f07ec-181">O código do lado do cliente dispara invocações C# de código quando manipuladores de eventos são criados usando:</span><span class="sxs-lookup"><span data-stu-id="f07ec-181">Client-side code triggers invocations of C# code when event handlers are created using:</span></span>

* `@onclick`
* `@onchange`
* <span data-ttu-id="f07ec-182">Outros `@on...` atributos</span><span class="sxs-lookup"><span data-stu-id="f07ec-182">Other `@on...` attributes</span></span>
* `@bind`

<span data-ttu-id="f07ec-183">O código do manipulador de eventos pode gerar uma exceção sem tratamento nesses cenários.</span><span class="sxs-lookup"><span data-stu-id="f07ec-183">Event handler code might throw an unhandled exception in these scenarios.</span></span>

<span data-ttu-id="f07ec-184">Se um manipulador de eventos lançar uma exceção sem tratamento (por exemplo, uma consulta de banco de dados falhar), a exceção será fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-184">If an event handler throws an unhandled exception (for example, a database query fails), the exception is fatal to the circuit.</span></span> <span data-ttu-id="f07ec-185">Se o aplicativo chamar o código que poderia falhar por motivos externos, intercepte as exceções usando uma instrução [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com tratamento de erros e registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-185">If the app calls code that could fail for external reasons, trap exceptions using a [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statement with error handling and logging.</span></span>

<span data-ttu-id="f07ec-186">Se o código do usuário não interceptar e manipular a exceção, a estrutura registrará a exceção e encerrará o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-186">If user code doesn't trap and handle the exception, the framework logs the exception and terminates the circuit.</span></span>

### <a name="component-disposal"></a><span data-ttu-id="f07ec-187">Disposição do componente</span><span class="sxs-lookup"><span data-stu-id="f07ec-187">Component disposal</span></span>

<span data-ttu-id="f07ec-188">Um componente pode ser removido da interface do usuário, por exemplo, porque o usuário navegou para outra página.</span><span class="sxs-lookup"><span data-stu-id="f07ec-188">A component may be removed from the UI, for example, because the user has navigated to another page.</span></span> <span data-ttu-id="f07ec-189">Quando um componente que implementa <xref:System.IDisposable?displayProperty=fullName> o é removido da interface do usuário, a estrutura chama o <xref:System.IDisposable.Dispose*> método do componente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-189">When a component that implements <xref:System.IDisposable?displayProperty=fullName> is removed from the UI, the framework calls the component's <xref:System.IDisposable.Dispose*> method.</span></span> 

<span data-ttu-id="f07ec-190">Se o método do `Dispose` componente lançar uma exceção sem tratamento, a exceção será fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-190">If the component's `Dispose` method throws an unhandled exception, the exception is fatal to the circuit.</span></span> <span data-ttu-id="f07ec-191">Se a lógica de descarte puder gerar exceções, o aplicativo deverá interceptar as exceções usando uma instrução [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com o tratamento de erros e o registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-191">If disposal logic may throw exceptions, the app should trap the exceptions using a [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statement with error handling and logging.</span></span>

<span data-ttu-id="f07ec-192">Para obter mais informações sobre a disposição de <xref:blazor/components#component-disposal-with-idisposable>componentes, consulte.</span><span class="sxs-lookup"><span data-stu-id="f07ec-192">For more information on component disposal, see <xref:blazor/components#component-disposal-with-idisposable>.</span></span>

### <a name="javascript-interop"></a><span data-ttu-id="f07ec-193">Interoperabilidade do JavaScript</span><span class="sxs-lookup"><span data-stu-id="f07ec-193">JavaScript interop</span></span>

<span data-ttu-id="f07ec-194">`IJSRuntime.InvokeAsync<T>`permite que o código .NET faça chamadas assíncronas para o tempo de execução do JavaScript no navegador do usuário.</span><span class="sxs-lookup"><span data-stu-id="f07ec-194">`IJSRuntime.InvokeAsync<T>` allows .NET code to make asynchronous calls to the JavaScript runtime in the user's browser.</span></span>

<span data-ttu-id="f07ec-195">As seguintes condições se aplicam ao tratamento `InvokeAsync<T>`de erros com:</span><span class="sxs-lookup"><span data-stu-id="f07ec-195">The following conditions apply to error handling with `InvokeAsync<T>`:</span></span>

* <span data-ttu-id="f07ec-196">Se uma chamada para `InvokeAsync<T>` falhar de forma síncrona, ocorrerá uma exceção do .net.</span><span class="sxs-lookup"><span data-stu-id="f07ec-196">If a call to `InvokeAsync<T>` fails synchronously, a .NET exception occurs.</span></span> <span data-ttu-id="f07ec-197">Uma chamada para `InvokeAsync<T>` minha falha, por exemplo, porque os argumentos fornecidos não podem ser serializados.</span><span class="sxs-lookup"><span data-stu-id="f07ec-197">A call to `InvokeAsync<T>` my fail, for example, because the supplied arguments can't be serialized.</span></span> <span data-ttu-id="f07ec-198">O código do desenvolvedor deve capturar a exceção.</span><span class="sxs-lookup"><span data-stu-id="f07ec-198">Developer code must catch the exception.</span></span> <span data-ttu-id="f07ec-199">Se o código do aplicativo em um manipulador de eventos ou método de ciclo de vida do componente não tratar uma exceção, a exceção resultante será fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-199">If app code in an event handler or component lifecycle method doesn't handle an exception, the resulting exception is fatal to the circuit.</span></span>
* <span data-ttu-id="f07ec-200">Se uma chamada para `InvokeAsync<T>` falhar de forma assíncrona <xref:System.Threading.Tasks.Task> , o .net falhará.</span><span class="sxs-lookup"><span data-stu-id="f07ec-200">If a call to `InvokeAsync<T>` fails asynchronously, the .NET <xref:System.Threading.Tasks.Task> fails.</span></span> <span data-ttu-id="f07ec-201">Uma chamada para `InvokeAsync<T>` pode falhar, por exemplo, porque o código do lado do JavaScript gera uma exceção ou retorna `Promise` um que foi `rejected`concluído como.</span><span class="sxs-lookup"><span data-stu-id="f07ec-201">A call to `InvokeAsync<T>` may fail, for example, because the JavaScript-side code throws an exception or returns a `Promise` that completed as `rejected`.</span></span> <span data-ttu-id="f07ec-202">O código do desenvolvedor deve capturar a exceção.</span><span class="sxs-lookup"><span data-stu-id="f07ec-202">Developer code must catch the exception.</span></span> <span data-ttu-id="f07ec-203">Se estiver usando o operador [Await](/dotnet/csharp/language-reference/keywords/await) , considere encapsular a chamada de método em uma instrução [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com tratamento de erros e registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-203">If using the [await](/dotnet/csharp/language-reference/keywords/await) operator, consider wrapping the method call in a [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statement with error handling and logging.</span></span> <span data-ttu-id="f07ec-204">Caso contrário, o código com falha resultará em uma exceção sem tratamento que é fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-204">Otherwise, the failing code results in an unhandled exception that's fatal to the circuit.</span></span>
* <span data-ttu-id="f07ec-205">Por padrão, as chamadas `InvokeAsync<T>` para devem ser concluídas em um determinado período ou a chamada atinge o tempo limite. O período de tempo limite padrão é de um minuto.</span><span class="sxs-lookup"><span data-stu-id="f07ec-205">By default, calls to `InvokeAsync<T>` must complete within a certain period or else the call times out. The default timeout period is one minute.</span></span> <span data-ttu-id="f07ec-206">O tempo limite protege o código contra uma perda na conectividade de rede ou no código JavaScript que nunca envia uma mensagem de conclusão.</span><span class="sxs-lookup"><span data-stu-id="f07ec-206">The timeout protects the code against a loss in network connectivity or JavaScript code that never sends back a completion message.</span></span> <span data-ttu-id="f07ec-207">Se a chamada atingir o tempo limite, `Task` o resultado falhará com um. <xref:System.OperationCanceledException></span><span class="sxs-lookup"><span data-stu-id="f07ec-207">If the call times out, the resulting `Task` fails with an <xref:System.OperationCanceledException>.</span></span> <span data-ttu-id="f07ec-208">Interceptar e processar a exceção com registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-208">Trap and process the exception with logging.</span></span>

<span data-ttu-id="f07ec-209">Da mesma forma, o código JavaScript pode iniciar chamadas para métodos .NET indicados pelo [atributo [JSInvokable]](xref:blazor/javascript-interop#invoke-net-methods-from-javascript-functions).</span><span class="sxs-lookup"><span data-stu-id="f07ec-209">Similarly, JavaScript code may initiate calls to .NET methods indicated by the [[JSInvokable] attribute](xref:blazor/javascript-interop#invoke-net-methods-from-javascript-functions).</span></span> <span data-ttu-id="f07ec-210">Se esses métodos .NET lançarem uma exceção sem tratamento:</span><span class="sxs-lookup"><span data-stu-id="f07ec-210">If these .NET methods throw an unhandled exception:</span></span>

* <span data-ttu-id="f07ec-211">A exceção não é tratada como fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-211">The exception isn't treated as fatal to the circuit.</span></span>
* <span data-ttu-id="f07ec-212">O lado `Promise` do JavaScript é rejeitado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-212">The JavaScript-side `Promise` is rejected.</span></span>

<span data-ttu-id="f07ec-213">Você tem a opção de usar o código de tratamento de erros no lado do .NET ou no lado do JavaScript da chamada do método.</span><span class="sxs-lookup"><span data-stu-id="f07ec-213">You have the option of using error handling code on either the .NET side or the JavaScript side of the method call.</span></span>

<span data-ttu-id="f07ec-214">Para obter mais informações, consulte <xref:blazor/javascript-interop>.</span><span class="sxs-lookup"><span data-stu-id="f07ec-214">For more information, see <xref:blazor/javascript-interop>.</span></span>

### <a name="circuit-handlers"></a><span data-ttu-id="f07ec-215">Manipuladores de circuito</span><span class="sxs-lookup"><span data-stu-id="f07ec-215">Circuit handlers</span></span>

<span data-ttu-id="f07ec-216">O mais incrivelmente permite que o código defina um *manipulador de circuito*, que recebe notificações quando o estado do circuito de um usuário é alterado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-216">Blazor allows code to define a *circuit handler*, which receives notifications when the state of a user's circuit changes.</span></span> <span data-ttu-id="f07ec-217">Os seguintes Estados são usados:</span><span class="sxs-lookup"><span data-stu-id="f07ec-217">The following states are used:</span></span>

* `initialized`
* `connected`
* `disconnected`
* `disposed`

<span data-ttu-id="f07ec-218">As `CircuitHandler` notificações são gerenciadas pelo registro de um serviço di que herda da classe base abstrata.</span><span class="sxs-lookup"><span data-stu-id="f07ec-218">Notifications are managed by registering a DI service that inherits from the `CircuitHandler` abstract base class.</span></span>

<span data-ttu-id="f07ec-219">Se os métodos de um manipulador de circuitos personalizados lançarem uma exceção sem tratamento, a exceção será fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-219">If a custom circuit handler's methods throw an unhandled exception, the exception is fatal to the circuit.</span></span> <span data-ttu-id="f07ec-220">Para tolerar exceções no código de um manipulador ou em métodos chamados, empacote o código em uma ou mais instruções [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com o tratamento de erros e o registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-220">To tolerate exceptions in a handler's code or called methods, wrap the code in one or more [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statements with error handling and logging.</span></span>

### <a name="circuit-disposal"></a><span data-ttu-id="f07ec-221">Disposição do circuito</span><span class="sxs-lookup"><span data-stu-id="f07ec-221">Circuit disposal</span></span>

<span data-ttu-id="f07ec-222">Quando um circuito termina porque um usuário se desconectou e a estrutura está limpando o estado do circuito, a estrutura descarta o escopo de DI do circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-222">When a circuit ends because a user has disconnected and the framework is cleaning up the circuit state, the framework disposes of the circuit's DI scope.</span></span> <span data-ttu-id="f07ec-223">Descartar o escopo descarta todos os serviços de DI no escopo do <xref:System.IDisposable?displayProperty=fullName>circuito que implementam o.</span><span class="sxs-lookup"><span data-stu-id="f07ec-223">Disposing the scope disposes any circuit-scoped DI services that implement <xref:System.IDisposable?displayProperty=fullName>.</span></span> <span data-ttu-id="f07ec-224">Se qualquer serviço de DI lançar uma exceção sem tratamento durante a alienação, a estrutura registrará a exceção.</span><span class="sxs-lookup"><span data-stu-id="f07ec-224">If any DI service throws an unhandled exception during disposal, the framework logs the exception.</span></span>

### <a name="prerendering"></a><span data-ttu-id="f07ec-225">Prerenderizando</span><span class="sxs-lookup"><span data-stu-id="f07ec-225">Prerendering</span></span>

<span data-ttu-id="f07ec-226">Componentes mais flexíveis podem ser renderizados usando `Html.RenderComponentAsync` para que a marcação HTML renderizada seja retornada como parte da solicitação HTTP inicial do usuário.</span><span class="sxs-lookup"><span data-stu-id="f07ec-226">Blazor components can be prerendered using `Html.RenderComponentAsync` so that their rendered HTML markup is returned as part of the user's initial HTTP request.</span></span> <span data-ttu-id="f07ec-227">Isso funciona por:</span><span class="sxs-lookup"><span data-stu-id="f07ec-227">This works by:</span></span>

* <span data-ttu-id="f07ec-228">Criar um novo circuito que contém todos os componentes renderizados que fazem parte da mesma página.</span><span class="sxs-lookup"><span data-stu-id="f07ec-228">Creating a new circuit containing all of the prerendered components that are part of the same page.</span></span>
* <span data-ttu-id="f07ec-229">Gerando o HTML inicial.</span><span class="sxs-lookup"><span data-stu-id="f07ec-229">Generating the initial HTML.</span></span>
* <span data-ttu-id="f07ec-230">Tratar o circuito como `disconnected` até que o navegador do usuário estabeleça uma conexão de sinalização de volta ao mesmo servidor para retomar a interatividade no circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-230">Treating the circuit as `disconnected` until the user's browser establishes a SignalR connection back to the same server to resume interactivity on the circuit.</span></span>

<span data-ttu-id="f07ec-231">Se qualquer componente lançar uma exceção sem tratamento durante o pré-processamento, por exemplo, durante um método de ciclo de vida ou na lógica de renderização:</span><span class="sxs-lookup"><span data-stu-id="f07ec-231">If any component throws an unhandled exception during prerendering, for example, during a lifecycle method or in rendering logic:</span></span>

* <span data-ttu-id="f07ec-232">A exceção é fatal para o circuito.</span><span class="sxs-lookup"><span data-stu-id="f07ec-232">The exception is fatal to the circuit.</span></span>
* <span data-ttu-id="f07ec-233">A exceção é lançada na pilha de chamadas da `Html.RenderComponentAsync` chamada.</span><span class="sxs-lookup"><span data-stu-id="f07ec-233">The exception is thrown up the call stack from the `Html.RenderComponentAsync` call.</span></span> <span data-ttu-id="f07ec-234">Portanto, toda a solicitação HTTP falha, a menos que a exceção seja explicitamente detectada pelo código do desenvolvedor.</span><span class="sxs-lookup"><span data-stu-id="f07ec-234">Therefore, the entire HTTP request fails unless the exception is explicitly caught by developer code.</span></span>

<span data-ttu-id="f07ec-235">Em circunstâncias normais, quando o pré-processamento falha, continuar a criar e renderizar o componente não faz sentido porque um componente de trabalho não pode ser renderizado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-235">Under normal circumstances when prerendering fails, continuing to build and render the component doesn't make sense because a working component can't be rendered.</span></span>

<span data-ttu-id="f07ec-236">Para tolerar erros que podem ocorrer durante o pré-processamento, a lógica de tratamento de erro deve ser colocada dentro de um componente que pode gerar exceções.</span><span class="sxs-lookup"><span data-stu-id="f07ec-236">To tolerate errors that may occur during prerendering, error handling logic must be placed inside a component that may throw exceptions.</span></span> <span data-ttu-id="f07ec-237">Use instruções [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) com tratamento de erros e registro em log.</span><span class="sxs-lookup"><span data-stu-id="f07ec-237">Use [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statements with error handling and logging.</span></span> <span data-ttu-id="f07ec-238">Em vez de encapsular a `RenderComponentAsync` chamada para `try-catch` em uma instrução, coloque a lógica de tratamento de erros `RenderComponentAsync`no componente renderizado pelo.</span><span class="sxs-lookup"><span data-stu-id="f07ec-238">Instead of wrapping the call to `RenderComponentAsync` in a `try-catch` statement, place error handling logic in the component rendered by `RenderComponentAsync`.</span></span>

## <a name="advanced-scenarios"></a><span data-ttu-id="f07ec-239">Cenários avançados</span><span class="sxs-lookup"><span data-stu-id="f07ec-239">Advanced scenarios</span></span>

### <a name="recursive-rendering"></a><span data-ttu-id="f07ec-240">Renderização recursiva</span><span class="sxs-lookup"><span data-stu-id="f07ec-240">Recursive rendering</span></span>

<span data-ttu-id="f07ec-241">Os componentes podem ser aninhados recursivamente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-241">Components can be nested recursively.</span></span> <span data-ttu-id="f07ec-242">Isso é útil para representar estruturas de dados recursivas.</span><span class="sxs-lookup"><span data-stu-id="f07ec-242">This is useful for representing recursive data structures.</span></span> <span data-ttu-id="f07ec-243">Por exemplo, um `TreeNode` componente pode renderizar `TreeNode` mais componentes para cada um dos filhos do nó.</span><span class="sxs-lookup"><span data-stu-id="f07ec-243">For example, a `TreeNode` component can render more `TreeNode` components for each of the node's children.</span></span>

<span data-ttu-id="f07ec-244">Ao renderizar recursivamente, evite codificar padrões que resultam em recursão infinita:</span><span class="sxs-lookup"><span data-stu-id="f07ec-244">When rendering recursively, avoid coding patterns that result in infinite recursion:</span></span>

* <span data-ttu-id="f07ec-245">Não renderizar recursivamente uma estrutura de dados que contém um ciclo.</span><span class="sxs-lookup"><span data-stu-id="f07ec-245">Don't recursively render a data structure that contains a cycle.</span></span> <span data-ttu-id="f07ec-246">Por exemplo, não renderize um nó de árvore cujos filhos incluam a si mesmo.</span><span class="sxs-lookup"><span data-stu-id="f07ec-246">For example, don't render a tree node whose children includes itself.</span></span>
* <span data-ttu-id="f07ec-247">Não crie uma cadeia de layouts que contenham um ciclo.</span><span class="sxs-lookup"><span data-stu-id="f07ec-247">Don't create a chain of layouts that contain a cycle.</span></span> <span data-ttu-id="f07ec-248">Por exemplo, não crie um layout cujo layout seja próprio.</span><span class="sxs-lookup"><span data-stu-id="f07ec-248">For example, don't create a layout whose layout is itself.</span></span>
* <span data-ttu-id="f07ec-249">Não permita que um usuário final viole invariáveis de recursão (regras) por meio de entradas de dados mal-intencionados ou chamadas de interoperabilidade do JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f07ec-249">Don't allow an end user to violate recursion invariants (rules) through malicious data entry or JavaScript interop calls.</span></span>

<span data-ttu-id="f07ec-250">Loops infinitos durante a renderização:</span><span class="sxs-lookup"><span data-stu-id="f07ec-250">Infinite loops during rendering:</span></span>

* <span data-ttu-id="f07ec-251">Faz com que o processo de renderização continue para sempre.</span><span class="sxs-lookup"><span data-stu-id="f07ec-251">Causes the rendering process to continue forever.</span></span>
* <span data-ttu-id="f07ec-252">É equivalente a criar um loop não finalizado.</span><span class="sxs-lookup"><span data-stu-id="f07ec-252">Is equivalent to creating an unterminated loop.</span></span>

<span data-ttu-id="f07ec-253">Nesses cenários, o circuito afetado trava e o thread geralmente tenta:</span><span class="sxs-lookup"><span data-stu-id="f07ec-253">In these scenarios, the affected circuit hangs, and the thread usually attempts to:</span></span>

* <span data-ttu-id="f07ec-254">Consuma tanto tempo de CPU quanto permitido pelo sistema operacional, indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-254">Consume as much CPU time as permitted by the operating system, indefinitely.</span></span>
* <span data-ttu-id="f07ec-255">Consuma uma quantidade ilimitada de memória do servidor.</span><span class="sxs-lookup"><span data-stu-id="f07ec-255">Consume an unlimited amount of server memory.</span></span> <span data-ttu-id="f07ec-256">O consumo de memória ilimitada é equivalente ao cenário em que um loop não finalizado adiciona entradas a uma coleção em cada iteração.</span><span class="sxs-lookup"><span data-stu-id="f07ec-256">Consuming unlimited memory is equivalent to the scenario where an unterminated loop adds entries to a collection on every iteration.</span></span>

<span data-ttu-id="f07ec-257">Para evitar padrões de recursão infinitos, verifique se o código de renderização recursivo contém condições de parada adequadas.</span><span class="sxs-lookup"><span data-stu-id="f07ec-257">To avoid infinite recursion patterns, ensure that recursive rendering code contains suitable stopping conditions.</span></span>

### <a name="custom-render-tree-logic"></a><span data-ttu-id="f07ec-258">Lógica de árvore de renderização personalizada</span><span class="sxs-lookup"><span data-stu-id="f07ec-258">Custom render tree logic</span></span>

<span data-ttu-id="f07ec-259">A maioria dos componentes mais podestas são implementados como arquivos *. Razor* e são compilados para `RenderTreeBuilder` produzir lógica que opera em um para renderizar sua saída.</span><span class="sxs-lookup"><span data-stu-id="f07ec-259">Most Blazor components are implemented as *.razor* files and are compiled to produce logic that operates on a `RenderTreeBuilder` to render their output.</span></span> <span data-ttu-id="f07ec-260">Um desenvolvedor pode implementar `RenderTreeBuilder` A lógica manualmente usando o código de procedimento. C#</span><span class="sxs-lookup"><span data-stu-id="f07ec-260">A developer may manually implement `RenderTreeBuilder` logic using procedural C# code.</span></span> <span data-ttu-id="f07ec-261">Para obter mais informações, consulte <xref:blazor/components#manual-rendertreebuilder-logic>.</span><span class="sxs-lookup"><span data-stu-id="f07ec-261">For more information, see <xref:blazor/components#manual-rendertreebuilder-logic>.</span></span>

> [!WARNING]
> <span data-ttu-id="f07ec-262">O uso da lógica do construtor de árvore de renderização manual é considerado um cenário avançado e não seguro, não recomendado para o desenvolvimento geral de componentes.</span><span class="sxs-lookup"><span data-stu-id="f07ec-262">Use of manual render tree builder logic is considered an advanced and unsafe scenario, not recommended for general component development.</span></span>

<span data-ttu-id="f07ec-263">Se `RenderTreeBuilder` o código for escrito, o desenvolvedor deverá garantir a exatidão do código.</span><span class="sxs-lookup"><span data-stu-id="f07ec-263">If `RenderTreeBuilder` code is written, the developer must guarantee the correctness of the code.</span></span> <span data-ttu-id="f07ec-264">Por exemplo, o desenvolvedor deve garantir que:</span><span class="sxs-lookup"><span data-stu-id="f07ec-264">For example, the developer must ensure that:</span></span>

* <span data-ttu-id="f07ec-265">Chamadas para `OpenElement` e `CloseElement` são balanceadas corretamente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-265">Calls to `OpenElement` and `CloseElement` are correctly balanced.</span></span>
* <span data-ttu-id="f07ec-266">Os atributos são adicionados somente nos locais corretos.</span><span class="sxs-lookup"><span data-stu-id="f07ec-266">Attributes are only added in the correct places.</span></span>

<span data-ttu-id="f07ec-267">A lógica do construtor de árvore de renderização manual incorreta pode causar um comportamento indefinido arbitrário, incluindo falhas, travamentos do servidor e vulnerabilidades de segurança.</span><span class="sxs-lookup"><span data-stu-id="f07ec-267">Incorrect manual render tree builder logic can cause arbitrary undefined behavior, including crashes, server hangs, and security vulnerabilities.</span></span>

<span data-ttu-id="f07ec-268">Considere a lógica do construtor de árvore de renderização manual no mesmo nível de complexidade e com o mesmo nível de *perigo* de escrever código de assembly ou instruções MSIL manualmente.</span><span class="sxs-lookup"><span data-stu-id="f07ec-268">Consider manual render tree builder logic on the same level of complexity and with the same level of *danger* as writing assembly code or MSIL instructions by hand.</span></span>
