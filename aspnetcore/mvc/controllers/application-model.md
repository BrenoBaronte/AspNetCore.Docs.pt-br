---
title: Trabalhando com o modelo de aplicativo
author: ardalis
description: 
keywords: "Modelo de aplicativo do ASP.NET Core, ASP.NET MVC de núcleo,"
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.assetid: 4eb7e52f-5665-41a4-a3e3-e348d07337f2
ms.technology: aspnet
ms.prod: asp.net-core
uid: mvc/controllers/application-model
ms.openlocfilehash: 18046389becd17135ff831e71e700244d48552d3
ms.sourcegitcommit: 0b6c8e6d81d2b3c161cd375036eecbace46a9707
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/11/2017
---
# <a name="working-with-the-application-model"></a><span data-ttu-id="9584e-103">Trabalhando com o modelo de aplicativo</span><span class="sxs-lookup"><span data-stu-id="9584e-103">Working with the Application Model</span></span>

<span data-ttu-id="9584e-104">Por [Steve Smith](http://ardalis.com)</span><span class="sxs-lookup"><span data-stu-id="9584e-104">By [Steve Smith](http://ardalis.com)</span></span>

<span data-ttu-id="9584e-105">ASP.NET MVC de núcleo define uma *modelo de aplicativo* que representa os componentes de um aplicativo MVC.</span><span class="sxs-lookup"><span data-stu-id="9584e-105">ASP.NET Core MVC defines an *application model* representing the components of an MVC app.</span></span> <span data-ttu-id="9584e-106">Você pode ler e manipular esse modelo para modificar o comportam de elementos MVC.</span><span class="sxs-lookup"><span data-stu-id="9584e-106">You can read and manipulate this model to modify how MVC elements behave.</span></span> <span data-ttu-id="9584e-107">Por padrão, o MVC segue certas convenções para determinar quais classes são considerados controladores, quais métodos essas classes são ações e o comportamento de parâmetros e roteamento.</span><span class="sxs-lookup"><span data-stu-id="9584e-107">By default, MVC follows certain conventions to determine which classes are considered to be controllers, which methods on those classes are actions, and how parameters and routing behave.</span></span> <span data-ttu-id="9584e-108">Você pode personalizar esse comportamento para atender às necessidades do seu aplicativo criando suas próprias convenções e aplicá-las globalmente ou como atributos.</span><span class="sxs-lookup"><span data-stu-id="9584e-108">You can customize this behavior to suit your app's needs by creating your own conventions and applying them globally or as attributes.</span></span>

## <a name="models-and-providers"></a><span data-ttu-id="9584e-109">Modelos e os provedores</span><span class="sxs-lookup"><span data-stu-id="9584e-109">Models and Providers</span></span>

<span data-ttu-id="9584e-110">O modelo de aplicativo MVC do ASP.NET Core incluem abstratas interfaces e classes de implementação concreta que descrevem um aplicativo MVC.</span><span class="sxs-lookup"><span data-stu-id="9584e-110">The ASP.NET Core MVC application model include both abstract interfaces and concrete implementation classes that describe an MVC application.</span></span> <span data-ttu-id="9584e-111">Esse modelo é o resultado do MVC descobrir controladores, ações, parâmetros de ação, rotas e filtros de acordo com as convenções padrão do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-111">This model is the result of MVC discovering the app's controllers, actions, action parameters, routes, and filters according to default conventions.</span></span> <span data-ttu-id="9584e-112">Trabalhando com o modelo de aplicativo, você pode modificar seu aplicativo para seguir as convenções diferentes do comportamento padrão MVC.</span><span class="sxs-lookup"><span data-stu-id="9584e-112">By working with the application model, you can modify your app to follow different conventions from the default MVC behavior.</span></span> <span data-ttu-id="9584e-113">Os parâmetros, nomes, rotas e filtros são todos usados como dados de configuração para controladores e ações.</span><span class="sxs-lookup"><span data-stu-id="9584e-113">The parameters, names, routes, and filters are all used as configuration data for actions and controllers.</span></span>

<span data-ttu-id="9584e-114">O modelo de aplicativo do ASP.NET Core MVC tem a seguinte estrutura:</span><span class="sxs-lookup"><span data-stu-id="9584e-114">The ASP.NET Core MVC Application Model has the following structure:</span></span>

* <span data-ttu-id="9584e-115">ApplicationModel</span><span class="sxs-lookup"><span data-stu-id="9584e-115">ApplicationModel</span></span>
    * <span data-ttu-id="9584e-116">Controladores (ControllerModel)</span><span class="sxs-lookup"><span data-stu-id="9584e-116">Controllers (ControllerModel)</span></span>
        * <span data-ttu-id="9584e-117">Ações (ActionModel)</span><span class="sxs-lookup"><span data-stu-id="9584e-117">Actions (ActionModel)</span></span>
            * <span data-ttu-id="9584e-118">Parâmetros (ParameterModel)</span><span class="sxs-lookup"><span data-stu-id="9584e-118">Parameters (ParameterModel)</span></span>

<span data-ttu-id="9584e-119">Cada nível do modelo tem acesso a um comum `Properties` coleta e níveis inferiores podem acessar e substituir os valores de propriedade definidos por níveis mais altos na hierarquia.</span><span class="sxs-lookup"><span data-stu-id="9584e-119">Each level of the model has access to a common `Properties` collection, and lower levels can access and overwrite property values set by higher levels in the hierarchy.</span></span> <span data-ttu-id="9584e-120">As propriedades são mantidas para o `ActionDescriptor.Properties` quando as ações são criadas.</span><span class="sxs-lookup"><span data-stu-id="9584e-120">The properties are persisted to the `ActionDescriptor.Properties` when the actions are created.</span></span> <span data-ttu-id="9584e-121">Em seguida, quando uma solicitação está sendo tratada, todas as propriedades uma convenção adicionados ou modificados pode ser acessada por meio de `ActionContext.ActionDescriptor.Properties`.</span><span class="sxs-lookup"><span data-stu-id="9584e-121">Then when a request is being handled, any properties a convention added or modified can be accessed through `ActionContext.ActionDescriptor.Properties`.</span></span> <span data-ttu-id="9584e-122">Usando propriedades é uma ótima maneira de configurar seus filtros, associadores de modelo, etc. em uma base por ação.</span><span class="sxs-lookup"><span data-stu-id="9584e-122">Using properties is a great way to configure your filters, model binders, etc. on a per-action basis.</span></span>

> [!NOTE]
> <span data-ttu-id="9584e-123">O `ActionDescriptor.Properties` coleção não é thread-safe (para gravações) quando tiver terminado de inicialização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-123">The `ActionDescriptor.Properties` collection is not thread safe (for writes) once app startup has finished.</span></span> <span data-ttu-id="9584e-124">Convenções são a melhor maneira de adicionar com segurança os dados a esta coleção.</span><span class="sxs-lookup"><span data-stu-id="9584e-124">Conventions are the best way to safely add data to this collection.</span></span>

### <a name="iapplicationmodelprovider"></a><span data-ttu-id="9584e-125">IApplicationModelProvider</span><span class="sxs-lookup"><span data-stu-id="9584e-125">IApplicationModelProvider</span></span>

<span data-ttu-id="9584e-126">Núcleo do ASP.NET MVC carrega o modelo de aplicativo usando um provedor padrão, definido pelo [IApplicationModelProvider](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelprovider) interface.</span><span class="sxs-lookup"><span data-stu-id="9584e-126">ASP.NET Core MVC loads the application model using a provider pattern, defined by the [IApplicationModelProvider](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelprovider) interface.</span></span> <span data-ttu-id="9584e-127">Esta seção aborda alguns dos detalhes de implementação interna de como essas funções de provedor.</span><span class="sxs-lookup"><span data-stu-id="9584e-127">This section covers some of the internal implementation details of how this provider functions.</span></span> <span data-ttu-id="9584e-128">Este é um tópico avançado - a maioria dos aplicativos que aproveitam o modelo de aplicativo deve fazer isso ao trabalhar com as convenções.</span><span class="sxs-lookup"><span data-stu-id="9584e-128">This is an advanced topic - most apps that leverage the application model should do so by working with conventions.</span></span>

<span data-ttu-id="9584e-129">Implementações do `IApplicationModelProvider` interface "encapsular", com cada chamada de implementação `OnProvidersExecuting` em ordem crescente com base em seu `Order` propriedade.</span><span class="sxs-lookup"><span data-stu-id="9584e-129">Implementations of the `IApplicationModelProvider` interface "wrap" one another, with each implementation calling `OnProvidersExecuting` in ascending order based on its `Order` property.</span></span> <span data-ttu-id="9584e-130">O `OnProvidersExecuted` método é chamado em ordem inversa.</span><span class="sxs-lookup"><span data-stu-id="9584e-130">The `OnProvidersExecuted` method is then called in reverse order.</span></span> <span data-ttu-id="9584e-131">A estrutura define vários provedores:</span><span class="sxs-lookup"><span data-stu-id="9584e-131">The framework defines several providers:</span></span>

<span data-ttu-id="9584e-132">Primeiro (`Order=-1000`):</span><span class="sxs-lookup"><span data-stu-id="9584e-132">First (`Order=-1000`):</span></span>

* [`DefaultApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.internal.defaultapplicationmodelprovider)

<span data-ttu-id="9584e-133">Em seguida, (`Order=-990`):</span><span class="sxs-lookup"><span data-stu-id="9584e-133">Then (`Order=-990`):</span></span>

* [`AuthorizationApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.internal.authorizationapplicationmodelprovider)
* [`CorsApplicationModelProvider`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.cors.internal.corsapplicationmodelprovider)

> [!NOTE]
> <span data-ttu-id="9584e-134">A ordem na qual dois provedores com o mesmo valor para `Order` são chamados não está definida e, portanto, não deve ser considerado.</span><span class="sxs-lookup"><span data-stu-id="9584e-134">The order in which two providers with the same value for `Order` are called is undefined, and therefore should not be relied upon.</span></span>

> [!NOTE]
> <span data-ttu-id="9584e-135">`IApplicationModelProvider`é um conceito avançado para os autores do framework estender.</span><span class="sxs-lookup"><span data-stu-id="9584e-135">`IApplicationModelProvider` is an advanced concept for framework authors to extend.</span></span> <span data-ttu-id="9584e-136">Em geral, aplicativos devem usar as convenções e estruturas devem usar provedores.</span><span class="sxs-lookup"><span data-stu-id="9584e-136">In general, apps should use conventions and frameworks should use providers.</span></span> <span data-ttu-id="9584e-137">A principal diferença é que provedores sempre sejam executadas antes de convenções.</span><span class="sxs-lookup"><span data-stu-id="9584e-137">The key distinction is that providers always run before conventions.</span></span>

<span data-ttu-id="9584e-138">O `DefaultApplicationModelProvider` estabelece muitos dos comportamentos padrão usados pelo ASP.NET MVC de núcleo.</span><span class="sxs-lookup"><span data-stu-id="9584e-138">The `DefaultApplicationModelProvider` establishes many of the default behaviors used by ASP.NET Core MVC.</span></span> <span data-ttu-id="9584e-139">Suas responsabilidades incluem:</span><span class="sxs-lookup"><span data-stu-id="9584e-139">Its responsibilities include:</span></span>

* <span data-ttu-id="9584e-140">Adicionando filtros globais para o contexto</span><span class="sxs-lookup"><span data-stu-id="9584e-140">Adding global filters to the context</span></span>
* <span data-ttu-id="9584e-141">Adicionando controladores para o contexto</span><span class="sxs-lookup"><span data-stu-id="9584e-141">Adding controllers to the context</span></span>
* <span data-ttu-id="9584e-142">Adição de métodos públicos controlador como ações</span><span class="sxs-lookup"><span data-stu-id="9584e-142">Adding public controller methods as actions</span></span>
* <span data-ttu-id="9584e-143">Adicionando parâmetros de método de ação para o contexto</span><span class="sxs-lookup"><span data-stu-id="9584e-143">Adding action method parameters to the context</span></span>
* <span data-ttu-id="9584e-144">Aplicação de rota e outros atributos</span><span class="sxs-lookup"><span data-stu-id="9584e-144">Applying route and other attributes</span></span>

<span data-ttu-id="9584e-145">Alguns comportamentos internos são implementados pelo `DefaultApplicationModelProvider`.</span><span class="sxs-lookup"><span data-stu-id="9584e-145">Some built-in behaviors are implemented by the `DefaultApplicationModelProvider`.</span></span> <span data-ttu-id="9584e-146">Esse provedor é responsável pela construção de [ `ControllerModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.controllermodel), que por sua vez faz referência a [ `ActionModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.actionmodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ActionModel), [ `PropertyModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.propertymodel), e [ `ParameterModel` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.parametermodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ParameterModel) instâncias.</span><span class="sxs-lookup"><span data-stu-id="9584e-146">This provider is responsible for constructing the [`ControllerModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.controllermodel), which in turn references [`ActionModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.actionmodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ActionModel), [`PropertyModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.propertymodel), and [`ParameterModel`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.parametermodel#Microsoft_AspNetCore_Mvc_ApplicationModels_ParameterModel) instances.</span></span> <span data-ttu-id="9584e-147">O `DefaultApplicationModelProvider` classe é um detalhe de implementação de estrutura interna que pode e será alterado no futuro.</span><span class="sxs-lookup"><span data-stu-id="9584e-147">The `DefaultApplicationModelProvider` class is an internal framework implementation detail that can and will change in the future.</span></span> 

<span data-ttu-id="9584e-148">O `AuthorizationApplicationModelProvider` é responsável por aplicar o comportamento associado com o `AuthorizeFilter` e `AllowAnonymousFilter` atributos.</span><span class="sxs-lookup"><span data-stu-id="9584e-148">The `AuthorizationApplicationModelProvider` is responsible for applying the behavior associated with the `AuthorizeFilter` and `AllowAnonymousFilter` attributes.</span></span> <span data-ttu-id="9584e-149">[Saiba mais sobre esses atributos](https://docs.microsoft.com/aspnet/core/security/authorization/simple).</span><span class="sxs-lookup"><span data-stu-id="9584e-149">[Learn more about these attributes](https://docs.microsoft.com/aspnet/core/security/authorization/simple).</span></span>

<span data-ttu-id="9584e-150">O `CorsApplicationModelProvider` implementa o comportamento associado com o `IEnableCorsAttribute` e `IDisableCorsAttribute`e o `DisableCorsAuthorizationFilter`.</span><span class="sxs-lookup"><span data-stu-id="9584e-150">The `CorsApplicationModelProvider` implements behavior associated with the `IEnableCorsAttribute` and `IDisableCorsAttribute`, and the `DisableCorsAuthorizationFilter`.</span></span> <span data-ttu-id="9584e-151">[Saiba mais sobre CORS](https://docs.microsoft.com/aspnet/core/security/cors).</span><span class="sxs-lookup"><span data-stu-id="9584e-151">[Learn more about CORS](https://docs.microsoft.com/aspnet/core/security/cors).</span></span>

## <a name="conventions"></a><span data-ttu-id="9584e-152">Convenções</span><span class="sxs-lookup"><span data-stu-id="9584e-152">Conventions</span></span>

<span data-ttu-id="9584e-153">O modelo de aplicativo define abstrações de convenção que fornecem uma maneira simples de personalizar o comportamento dos modelos de substituir o modelo inteiro ou provedor.</span><span class="sxs-lookup"><span data-stu-id="9584e-153">The application model defines convention abstractions that provide a simpler way to customize the behavior of the models than overriding the entire model or provider.</span></span> <span data-ttu-id="9584e-154">Essas abstrações são a maneira recomendada para modificar o comportamento do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-154">These abstractions are the recommended way to modify your app's behavior.</span></span> <span data-ttu-id="9584e-155">Convenções fornecem uma maneira para escrever código que se aplicarão dinamicamente as personalizações.</span><span class="sxs-lookup"><span data-stu-id="9584e-155">Conventions provide a way for you to write code that will dynamically apply customizations.</span></span> <span data-ttu-id="9584e-156">Enquanto [filtros](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) fornecem um meio de modificar o comportamento da estrutura, personalizações permitem que você controle como o aplicativo inteiro está conectado em conjunto.</span><span class="sxs-lookup"><span data-stu-id="9584e-156">While [filters](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) provide a means of modifying the framework's behavior, customizations let you control how the whole app is wired together.</span></span>

<span data-ttu-id="9584e-157">As convenções a seguir estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="9584e-157">The following conventions are available:</span></span>

* [`IApplicationModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iapplicationmodelconvention)
* [`IControllerModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.icontrollermodelconvention)
* [`IActionModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iactionmodelconvention)
* [`IParameterModelConvention`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.iparametermodelconvention)

<span data-ttu-id="9584e-158">Convenções são aplicadas ao adicioná-los às opções do MVC ou implementando `Attribute`s e aplicá-las para controladores, ações ou parâmetros de ação (semelhante a [ `Filters` ](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters)).</span><span class="sxs-lookup"><span data-stu-id="9584e-158">Conventions are applied by adding them to MVC options or by implementing `Attribute`s and applying them to controllers, actions, or action parameters (similar to [`Filters`](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters)).</span></span> <span data-ttu-id="9584e-159">Ao contrário de filtros, convenções são executadas apenas quando o aplicativo é iniciado, não como parte de cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="9584e-159">Unlike filters, conventions are only executed when the app is starting, not as part of each request.</span></span>

### <a name="sample-modifying-the-applicationmodel"></a><span data-ttu-id="9584e-160">Exemplo: Modificando o ApplicationModel</span><span class="sxs-lookup"><span data-stu-id="9584e-160">Sample: Modifying the ApplicationModel</span></span>

<span data-ttu-id="9584e-161">A seguinte convenção é usada para adicionar uma propriedade para o modelo de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-161">The following convention is used to add a property to the application model.</span></span> 

<span data-ttu-id="9584e-162">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ApplicationDescription.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-162">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ApplicationDescription.cs)]</span></span>

<span data-ttu-id="9584e-163">Convenções de modelo de aplicativo são aplicadas como opções quando MVC é adicionado no `ConfigureServices` em `Startup`.</span><span class="sxs-lookup"><span data-stu-id="9584e-163">Application model conventions are applied as options when MVC is added in `ConfigureServices` in `Startup`.</span></span>

<span data-ttu-id="9584e-164">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="9584e-164">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=5)]</span></span>

<span data-ttu-id="9584e-165">Propriedades são acessíveis a partir de `ActionDescriptor` coleção properties em ações do controlador:</span><span class="sxs-lookup"><span data-stu-id="9584e-165">Properties are accessible from the `ActionDescriptor` properties collection within controller actions:</span></span>

<span data-ttu-id="9584e-166">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/AppModelController.cs?name=AppModelController)]</span><span class="sxs-lookup"><span data-stu-id="9584e-166">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/AppModelController.cs?name=AppModelController)]</span></span>

### <a name="sample-modifying-the-controllermodel-description"></a><span data-ttu-id="9584e-167">Exemplo: Modificar a descrição do ControllerModel</span><span class="sxs-lookup"><span data-stu-id="9584e-167">Sample: Modifying the ControllerModel Description</span></span>

<span data-ttu-id="9584e-168">Como no exemplo anterior, o modelo do controlador também pode ser modificado para incluir propriedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="9584e-168">As in the previous example, the controller model can also be modified to include custom properties.</span></span> <span data-ttu-id="9584e-169">Eles substituirão as propriedades existentes com o mesmo nome especificado no modelo de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-169">These will override existing properties with the same name specified in the application model.</span></span> <span data-ttu-id="9584e-170">O atributo de convenção a seguir adiciona uma descrição no nível do controlador:</span><span class="sxs-lookup"><span data-stu-id="9584e-170">The following convention attribute adds a description at the controller level:</span></span>

<span data-ttu-id="9584e-171">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ControllerDescriptionAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-171">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ControllerDescriptionAttribute.cs)]</span></span>

<span data-ttu-id="9584e-172">Essa convenção é aplicada como um atributo em um controlador.</span><span class="sxs-lookup"><span data-stu-id="9584e-172">This convention is applied as an attribute on a controller.</span></span>

<span data-ttu-id="9584e-173">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=ControllerDescription&highlight=1)]</span><span class="sxs-lookup"><span data-stu-id="9584e-173">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=ControllerDescription&highlight=1)]</span></span>

<span data-ttu-id="9584e-174">A propriedade "Descrição" é acessada da mesma maneira como nos exemplos anteriores.</span><span class="sxs-lookup"><span data-stu-id="9584e-174">The "description" property is accessed in the same manner as in previous examples.</span></span>

### <a name="sample-modifying-the-actionmodel-description"></a><span data-ttu-id="9584e-175">Exemplo: Modificar a descrição do ActionModel</span><span class="sxs-lookup"><span data-stu-id="9584e-175">Sample: Modifying the ActionModel Description</span></span>

<span data-ttu-id="9584e-176">Uma convenção de atributo separado pode ser aplicada a ações individuais, substituindo o comportamento já aplicado no nível do aplicativo ou controlador.</span><span class="sxs-lookup"><span data-stu-id="9584e-176">A separate attribute convention can be applied to individual actions, overriding behavior already applied at the application or controller level.</span></span>

<span data-ttu-id="9584e-177">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ActionDescriptionAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-177">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/ActionDescriptionAttribute.cs)]</span></span>

<span data-ttu-id="9584e-178">Aplicar isso a uma ação no controlador do exemplo anterior demonstra como ela substitui a convenção de nível de controlador:</span><span class="sxs-lookup"><span data-stu-id="9584e-178">Applying this to an action within the previous example's controller demonstrates how it overrides the controller-level convention:</span></span>

<span data-ttu-id="9584e-179">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=DescriptionAttributesController&highlight=9)]</span><span class="sxs-lookup"><span data-stu-id="9584e-179">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/DescriptionAttributesController.cs?name=DescriptionAttributesController&highlight=9)]</span></span>

### <a name="sample-modifying-the-parametermodel"></a><span data-ttu-id="9584e-180">Exemplo: Modificando o ParameterModel</span><span class="sxs-lookup"><span data-stu-id="9584e-180">Sample: Modifying the ParameterModel</span></span>

<span data-ttu-id="9584e-181">A seguinte convenção pode ser aplicada a parâmetros de ação para modificar seus `BindingInfo`.</span><span class="sxs-lookup"><span data-stu-id="9584e-181">The following convention can be applied to action parameters to modify their `BindingInfo`.</span></span> <span data-ttu-id="9584e-182">A seguinte convenção requer que o parâmetro ser um parâmetro de rota. outros possíveis origens de vinculação (como valores de cadeia de caracteres de consulta) são ignoradas.</span><span class="sxs-lookup"><span data-stu-id="9584e-182">The following convention requires that the parameter be a route parameter; other potential binding sources (such as query string values) are ignored.</span></span>

<span data-ttu-id="9584e-183">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/MustBeInRouteParameterModelConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-183">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/MustBeInRouteParameterModelConvention.cs)]</span></span>

<span data-ttu-id="9584e-184">O atributo pode ser aplicado a qualquer parâmetro de ação:</span><span class="sxs-lookup"><span data-stu-id="9584e-184">The attribute may be applied to any action parameter:</span></span>

<span data-ttu-id="9584e-185">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/ParameterModelController.cs?name=ParameterModelController&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="9584e-185">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/ParameterModelController.cs?name=ParameterModelController&highlight=5)]</span></span>

### <a name="sample-modifying-the-actionmodel-name"></a><span data-ttu-id="9584e-186">Exemplo: Modificando o nome de ActionModel</span><span class="sxs-lookup"><span data-stu-id="9584e-186">Sample: Modifying the ActionModel Name</span></span>

<span data-ttu-id="9584e-187">A convenção a seguir modifica o `ActionModel` para atualizar o *nome* da ação para o qual ela é aplicada.</span><span class="sxs-lookup"><span data-stu-id="9584e-187">The following convention modifies the `ActionModel` to update the *name* of the action to which it is applied.</span></span> <span data-ttu-id="9584e-188">O novo nome é fornecido como um parâmetro para o atributo.</span><span class="sxs-lookup"><span data-stu-id="9584e-188">The new name is provided as a parameter to the attribute.</span></span> <span data-ttu-id="9584e-189">Esse novo nome é usado pelo roteamento, para que isso afetará a rota usada para acessar este método de ação.</span><span class="sxs-lookup"><span data-stu-id="9584e-189">This new name is used by routing, so it will affect the route used to reach this action method.</span></span>

<span data-ttu-id="9584e-190">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/CustomActionNameAttribute.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-190">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/CustomActionNameAttribute.cs)]</span></span>

<span data-ttu-id="9584e-191">Esse atributo é aplicado a um método de ação de `HomeController`:</span><span class="sxs-lookup"><span data-stu-id="9584e-191">This attribute is applied to an action method in the `HomeController`:</span></span>

<span data-ttu-id="9584e-192">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/HomeController.cs?name=ActionModelConvention&highlight=2)]</span><span class="sxs-lookup"><span data-stu-id="9584e-192">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/HomeController.cs?name=ActionModelConvention&highlight=2)]</span></span>

<span data-ttu-id="9584e-193">Mesmo que o nome do método é `SomeName`, o atributo substitui a convenção MVC de usar o nome do método e substitui o nome da ação com `MyCoolAction`.</span><span class="sxs-lookup"><span data-stu-id="9584e-193">Even though the method name is `SomeName`, the attribute overrides the MVC convention of using the method name and replaces the action name with `MyCoolAction`.</span></span> <span data-ttu-id="9584e-194">Assim, a rota usada para alcançar essa ação é `/Home/MyCoolAction`.</span><span class="sxs-lookup"><span data-stu-id="9584e-194">Thus, the route used to reach this action is `/Home/MyCoolAction`.</span></span>

> [!NOTE]
> <span data-ttu-id="9584e-195">Este exemplo é essencialmente o mesmo que usar o interno [ActionName](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.actionnameattribute) atributo.</span><span class="sxs-lookup"><span data-stu-id="9584e-195">This example is essentially the same as using the built-in [ActionName](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.actionnameattribute) attribute.</span></span>

### <a name="sample-custom-routing-convention"></a><span data-ttu-id="9584e-196">Exemplo: A convenção de roteamento personalizado</span><span class="sxs-lookup"><span data-stu-id="9584e-196">Sample: Custom Routing Convention</span></span>

<span data-ttu-id="9584e-197">Você pode usar um `IApplicationModelConvention` para personalizar como roteamento funciona.</span><span class="sxs-lookup"><span data-stu-id="9584e-197">You can use an `IApplicationModelConvention` to customize how routing works.</span></span> <span data-ttu-id="9584e-198">Por exemplo, a seguinte convenção incorporará namespaces dos controladores em suas rotas, substituindo `.` no namespace com `/` na rota:</span><span class="sxs-lookup"><span data-stu-id="9584e-198">For example, the following convention will incorporate Controllers' namespaces into their routes, replacing `.` in the namespace with `/` in the route:</span></span>

<span data-ttu-id="9584e-199">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/NamespaceRoutingConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-199">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/NamespaceRoutingConvention.cs)]</span></span>

<span data-ttu-id="9584e-200">A convenção é adicionada como uma opção na inicialização.</span><span class="sxs-lookup"><span data-stu-id="9584e-200">The convention is added as an option in Startup.</span></span>

<span data-ttu-id="9584e-201">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=6)]</span><span class="sxs-lookup"><span data-stu-id="9584e-201">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Startup.cs?name=ConfigureServices&highlight=6)]</span></span>

> [!TIP]
> <span data-ttu-id="9584e-202">Você pode adicionar as convenções para sua [middleware](https://docs.microsoft.com/aspnet/core/fundamentals/middleware) acessando `MvcOptions` usando`services.Configure<MvcOptions>(c => c.Conventions.Add(YOURCONVENTION));`</span><span class="sxs-lookup"><span data-stu-id="9584e-202">You can add conventions to your [middleware](https://docs.microsoft.com/aspnet/core/fundamentals/middleware) by accessing `MvcOptions` using `services.Configure<MvcOptions>(c => c.Conventions.Add(YOURCONVENTION));`</span></span>

<span data-ttu-id="9584e-203">Este exemplo se aplica a esta convenção a rotas que não estiver usando o roteamento de atributo em que o controlador tem "Namespace" em seu nome.</span><span class="sxs-lookup"><span data-stu-id="9584e-203">This sample applies this convention to routes that are not using attribute routing where the controller has  "Namespace" in its name.</span></span> <span data-ttu-id="9584e-204">O controlador a seguir demonstra essa convenção:</span><span class="sxs-lookup"><span data-stu-id="9584e-204">The following controller demonstrates this convention:</span></span>

<span data-ttu-id="9584e-205">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/NamespaceRoutingController.cs?highlight=7-8)]</span><span class="sxs-lookup"><span data-stu-id="9584e-205">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Controllers/NamespaceRoutingController.cs?highlight=7-8)]</span></span>

## <a name="application-model-usage-in-webapicompatshim"></a><span data-ttu-id="9584e-206">Uso do modelo de aplicativo em WebApiCompatShim</span><span class="sxs-lookup"><span data-stu-id="9584e-206">Application Model Usage in WebApiCompatShim</span></span>

<span data-ttu-id="9584e-207">Núcleo do ASP.NET MVC usa um conjunto diferente de convenções do ASP.NET Web API 2.</span><span class="sxs-lookup"><span data-stu-id="9584e-207">ASP.NET Core MVC uses a different set of conventions from ASP.NET Web API 2.</span></span> <span data-ttu-id="9584e-208">Usando convenções personalizadas, você pode modificar o comportamento de um aplicativo ASP.NET MVC de núcleo para ser consistente com que um aplicativo de API da Web.</span><span class="sxs-lookup"><span data-stu-id="9584e-208">Using custom conventions, you can modify an ASP.NET Core MVC app's behavior to be consistent with that of a Web API app.</span></span> <span data-ttu-id="9584e-209">É fornecido Microsoft a [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim/) especificamente para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="9584e-209">Microsoft ships the [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim/) specifically for this purpose.</span></span>

> [!NOTE]
> <span data-ttu-id="9584e-210">Saiba mais sobre [Migrando do ASP.NET Web API](https://docs.microsoft.com/aspnet/core/migration/webapi)).</span><span class="sxs-lookup"><span data-stu-id="9584e-210">Learn more about [migrating from ASP.NET Web API](https://docs.microsoft.com/aspnet/core/migration/webapi)).</span></span>

<span data-ttu-id="9584e-211">Para usar a correção de compatibilidade de API da Web, você precisa adicionar o pacote ao seu projeto e, em seguida, adicione as convenções para MVC chamando `AddWebApiConventions` em `Startup`:</span><span class="sxs-lookup"><span data-stu-id="9584e-211">To use the Web API Compatibility Shim, you need to add the package to your project and then add the conventions to MVC by calling `AddWebApiConventions` in `Startup`:</span></span>

```c#
services.AddMvc().AddWebApiConventions();
```

<span data-ttu-id="9584e-212">As convenções de fornecido pelo shim são aplicadas apenas a partes do aplicativo que tiveram determinados atributos aplicados a eles.</span><span class="sxs-lookup"><span data-stu-id="9584e-212">The conventions provided by the shim are only applied to parts of the app that have had certain attributes applied to them.</span></span> <span data-ttu-id="9584e-213">Os seguintes quatro atributos são usados para controlar quais controladores devem ter seus convenções modificadas por convenções do shim:</span><span class="sxs-lookup"><span data-stu-id="9584e-213">The following four attributes are used to control which controllers should have their conventions modified by the shim's conventions:</span></span>

* [<span data-ttu-id="9584e-214">UseWebApiActionConventionsAttribute</span><span class="sxs-lookup"><span data-stu-id="9584e-214">UseWebApiActionConventionsAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiactionconventionsattribute)
* [<span data-ttu-id="9584e-215">UseWebApiOverloadingAttribute</span><span class="sxs-lookup"><span data-stu-id="9584e-215">UseWebApiOverloadingAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapioverloadingattribute)
* [<span data-ttu-id="9584e-216">UseWebApiParameterConventionsAttribute</span><span class="sxs-lookup"><span data-stu-id="9584e-216">UseWebApiParameterConventionsAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiparameterconventionsattribute)
* [<span data-ttu-id="9584e-217">UseWebApiRoutesAttribute</span><span class="sxs-lookup"><span data-stu-id="9584e-217">UseWebApiRoutesAttribute</span></span>](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.webapicompatshim.usewebapiroutesattribute)

### <a name="action-conventions"></a><span data-ttu-id="9584e-218">Convenções de ação</span><span class="sxs-lookup"><span data-stu-id="9584e-218">Action Conventions</span></span>

<span data-ttu-id="9584e-219">O `UseWebApiActionConventionsAttribute` é usado para mapear o método HTTP para ações com base em seu nome (por exemplo, `Get` seriam mapeados para `HttpGet`).</span><span class="sxs-lookup"><span data-stu-id="9584e-219">The `UseWebApiActionConventionsAttribute` is used to map the HTTP method to actions based on their name (for instance, `Get` would map to `HttpGet`).</span></span> <span data-ttu-id="9584e-220">Só se aplica a ações que não usa o roteamento de atributo.</span><span class="sxs-lookup"><span data-stu-id="9584e-220">It only applies to actions that do not use attribute routing.</span></span>

### <a name="overloading"></a><span data-ttu-id="9584e-221">Sobrecarga</span><span class="sxs-lookup"><span data-stu-id="9584e-221">Overloading</span></span>

<span data-ttu-id="9584e-222">O `UseWebApiOverloadingAttribute` é usado para aplicar o `WebApiOverloadingApplicationModelConvention` convenção.</span><span class="sxs-lookup"><span data-stu-id="9584e-222">The `UseWebApiOverloadingAttribute` is used to apply the `WebApiOverloadingApplicationModelConvention` convention.</span></span> <span data-ttu-id="9584e-223">Essa convenção adiciona um `OverloadActionConstraint` para o processo de seleção de ação, que limita as ações de candidato para aqueles para os quais a solicitação atenda a todos os parâmetros não opcionais.</span><span class="sxs-lookup"><span data-stu-id="9584e-223">This convention adds an `OverloadActionConstraint` to the action selection process, which limits candidate actions to those for which the request satisfies all non-optional parameters.</span></span>

### <a name="parameter-conventions"></a><span data-ttu-id="9584e-224">Convenções de parâmetro</span><span class="sxs-lookup"><span data-stu-id="9584e-224">Parameter Conventions</span></span>

<span data-ttu-id="9584e-225">O `UseWebApiParameterConventionsAttribute` é usado para aplicar o `WebApiParameterConventionsApplicationModelConvention` convenção de ação.</span><span class="sxs-lookup"><span data-stu-id="9584e-225">The `UseWebApiParameterConventionsAttribute` is used to apply the `WebApiParameterConventionsApplicationModelConvention` action convention.</span></span> <span data-ttu-id="9584e-226">Essa convenção Especifica que tipos simples usados como parâmetros de ação associados do URI por padrão, enquanto tipos complexos são associados do corpo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="9584e-226">This convention specifies that simple types used as action parameters are bound from the URI by default, while complex types are bound from the request body.</span></span>

### <a name="routes"></a><span data-ttu-id="9584e-227">Rotas</span><span class="sxs-lookup"><span data-stu-id="9584e-227">Routes</span></span>

<span data-ttu-id="9584e-228">O `UseWebApiRoutesAttribute` controla se o `WebApiApplicationModelConvention` convenção de controlador é aplicada.</span><span class="sxs-lookup"><span data-stu-id="9584e-228">The `UseWebApiRoutesAttribute` controls whether the `WebApiApplicationModelConvention` controller convention is applied.</span></span> <span data-ttu-id="9584e-229">Quando habilitada, essa convenção é usada para adicionar suporte para [áreas](https://docs.microsoft.com/aspnet/core/mvc/controllers/areas) para a rota.</span><span class="sxs-lookup"><span data-stu-id="9584e-229">When enabled, this convention is used to add support for [areas](https://docs.microsoft.com/aspnet/core/mvc/controllers/areas) to the route.</span></span>

<span data-ttu-id="9584e-230">Além de um conjunto de convenções, o pacote de compatibilidade inclui um `System.Web.Http.ApiController` classe base que substitui aquela fornecida pela API da Web.</span><span class="sxs-lookup"><span data-stu-id="9584e-230">In addition to a set of conventions, the compatibility package includes a `System.Web.Http.ApiController` base class that replaces the one provided by Web API.</span></span> <span data-ttu-id="9584e-231">Isso permite que os controladores gravados para a API da Web e herança de seu `ApiController` a funcionar como foram criados, durante a execução no ASP.NET MVC de núcleo.</span><span class="sxs-lookup"><span data-stu-id="9584e-231">This allows your controllers written for Web API and inheriting from its `ApiController` to work as they were designed, while running on ASP.NET Core MVC.</span></span> <span data-ttu-id="9584e-232">Essa classe de base do controlador está decorado com todos os `UseWebApi*` atributos listados acima.</span><span class="sxs-lookup"><span data-stu-id="9584e-232">This base controller class is decorated with all of the `UseWebApi*` attributes listed above.</span></span> <span data-ttu-id="9584e-233">O `ApiController` expõe as propriedades, métodos e tipos de resultados que são compatíveis com as que constam na API da Web.</span><span class="sxs-lookup"><span data-stu-id="9584e-233">The `ApiController` exposes properties, methods, and result types that are compatible with those found in Web API.</span></span>

## <a name="using-apiexplorer-to-document-your-app"></a><span data-ttu-id="9584e-234">Usando ApiExplorer para documentar seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="9584e-234">Using ApiExplorer to Document Your App</span></span>

<span data-ttu-id="9584e-235">O modelo de aplicativo expõe uma [ `ApiExplorer` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.apiexplorermodel) propriedade em cada nível que pode ser usado para percorrer a estrutura do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-235">The application model exposes an [`ApiExplorer`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.mvc.applicationmodels.apiexplorermodel) property at each level that can be used to traverse the app's structure.</span></span> <span data-ttu-id="9584e-236">Isso pode ser usado para [gerar páginas de ajuda para suas APIs da Web usando ferramentas como o Swagger](https://docs.microsoft.com/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="9584e-236">This can be used to [generate help pages for your Web APIs using tools like Swagger](https://docs.microsoft.com/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span> <span data-ttu-id="9584e-237">O `ApiExplorer` propriedade expõe um `IsVisible` propriedade que pode ser definida para especificar quais partes do modelo do aplicativo devem ser expostos.</span><span class="sxs-lookup"><span data-stu-id="9584e-237">The `ApiExplorer` property exposes an `IsVisible` property that can be set to specify which parts of your app's model should be exposed.</span></span> <span data-ttu-id="9584e-238">Você pode configurar essa configuração usando uma convenção de:</span><span class="sxs-lookup"><span data-stu-id="9584e-238">You can configure this setting using a convention:</span></span>

<span data-ttu-id="9584e-239">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/EnableApiExplorerApplicationConvention.cs)]</span><span class="sxs-lookup"><span data-stu-id="9584e-239">[!code-csharp[Main](./application-model/sample/src/AppModelSample/Conventions/EnableApiExplorerApplicationConvention.cs)]</span></span>

<span data-ttu-id="9584e-240">Usando essa abordagem (e convenções adicionais, se necessário), você pode habilitar ou desabilitar a visibilidade de API em qualquer nível dentro de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9584e-240">Using this approach (and additional conventions if required), you can enable or disable API visibility at any level within your app.</span></span> 
