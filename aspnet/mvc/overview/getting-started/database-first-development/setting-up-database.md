---
uid: mvc/overview/getting-started/database-first-development/setting-up-database
title: 'Tutorial: Introdução ao EF Database First usando MVC 5'
description: Este artigo mostra como começar com um existente de banco de dados e criar rapidamente um aplicativo web que permite aos usuários interagir com os dados.
author: Rick-Anderson
ms.author: riande
ms.date: 01/23/2019
ms.topic: tutorial
ms.assetid: 095abad4-3bfe-4f06-b092-ae6a735b7e49
msc.legacyurl: /mvc/overview/getting-started/database-first-development/setting-up-database
msc.type: authoredcontent
ms.openlocfilehash: 8b094b7c334eaad510c46b55a99ec727b9c381c2
ms.sourcegitcommit: d5223cf6a2cf80b4f5dc54169b0e376d493d2d3a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/24/2019
ms.locfileid: "54889919"
---
# <a name="tutorial-get-started-with-ef-database-first-using-mvc-5"></a><span data-ttu-id="cba60-103">Tutorial: Introdução ao EF Database First usando MVC 5</span><span class="sxs-lookup"><span data-stu-id="cba60-103">Tutorial: Get started with EF Database First using MVC 5</span></span>

<span data-ttu-id="cba60-104">Usando o MVC, Entity Framework e o Scaffolding do ASP.NET, você pode criar um aplicativo web que fornece uma interface para um banco de dados existente.</span><span class="sxs-lookup"><span data-stu-id="cba60-104">Using MVC, Entity Framework, and ASP.NET Scaffolding, you can create a web application that provides an interface to an existing database.</span></span> <span data-ttu-id="cba60-105">Esta série de tutoriais mostra como automaticamente gerar um código que permite aos usuários exibir, editar, criar e excluir dados que residem em uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-105">This tutorial series shows you how to automatically generate code that enables users to display, edit, create, and delete data that resides in a database table.</span></span> <span data-ttu-id="cba60-106">O código gerado corresponde às colunas na tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-106">The generated code corresponds to the columns in the database table.</span></span> <span data-ttu-id="cba60-107">A última parte da série, você implantará o site e o banco de dados no Azure.</span><span class="sxs-lookup"><span data-stu-id="cba60-107">In the last part of the series, you will deploy the site and database to Azure.</span></span>

<span data-ttu-id="cba60-108">Este artigo mostra como começar com um existente de banco de dados e criar rapidamente um aplicativo web que permite aos usuários interagir com os dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-108">This article shows how to start with an existing database and quickly create a web application that enables users to interact with the data.</span></span> <span data-ttu-id="cba60-109">Ele usa o Entity Framework 6 e ao MVC 5 para compilar o aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="cba60-109">It uses the Entity Framework 6 and MVC 5 to build the web application.</span></span> <span data-ttu-id="cba60-110">O recurso de Scaffolding do ASP.NET permite que você gerar automaticamente o código para exibir, atualizar, criar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-110">The ASP.NET Scaffolding feature enables you to automatically generate code for displaying, updating, creating and deleting data.</span></span> <span data-ttu-id="cba60-111">Usando as ferramentas de publicação no Visual Studio, você pode facilmente implantar o site e o banco de dados no Azure.</span><span class="sxs-lookup"><span data-stu-id="cba60-111">Using the publishing tools within Visual Studio, you can easily deploy the site and database to Azure.</span></span>

<span data-ttu-id="cba60-112">Esta parte da série se concentra na criação de um banco de dados e populá-lo com dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-112">This part of the series focuses on creating a database and populating it with data.</span></span>

<span data-ttu-id="cba60-113">Esta série foi gravada com contribuições de Tom Dykstra e Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="cba60-113">This series was written with contributions from Tom Dykstra and Rick Anderson.</span></span> <span data-ttu-id="cba60-114">Ele foi aprimorado com base nos comentários dos usuários na seção de comentários.</span><span class="sxs-lookup"><span data-stu-id="cba60-114">It was improved based on feedback from users in the comments section.</span></span>

<span data-ttu-id="cba60-115">Neste tutorial, você:</span><span class="sxs-lookup"><span data-stu-id="cba60-115">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="cba60-116">Configurar o banco de dados</span><span class="sxs-lookup"><span data-stu-id="cba60-116">Set up the database</span></span>

## <a name="prerequisites"></a><span data-ttu-id="cba60-117">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="cba60-117">Prerequisites</span></span>

* [<span data-ttu-id="cba60-118">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="cba60-118">Visual Studio 2017</span></span>](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

## <a name="introduction"></a><span data-ttu-id="cba60-119">Introdução</span><span class="sxs-lookup"><span data-stu-id="cba60-119">Introduction</span></span>

<span data-ttu-id="cba60-120">Este artigo aborda a situação em que você tenha um banco de dados e deseja gerar código para um aplicativo web com base nos campos do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-120">This article addresses the situation where you have a database and want to generate code for a web application based on the fields of that database.</span></span> <span data-ttu-id="cba60-121">Essa abordagem é chamada de desenvolvimento de banco de dados primeiro.</span><span class="sxs-lookup"><span data-stu-id="cba60-121">This approach is called Database First development.</span></span> <span data-ttu-id="cba60-122">Se você ainda não tiver um banco de dados existente, você pode usar uma abordagem denominada desenvolvimento Code First que envolve a definição de classes de dados e gerar o banco de dados das propriedades de classe.</span><span class="sxs-lookup"><span data-stu-id="cba60-122">If you do not already have an existing database, you can instead use an approach called Code First development which involves defining data classes and generating the database from the class properties.</span></span>

## <a name="set-up-the-database"></a><span data-ttu-id="cba60-123">Configurar o banco de dados</span><span class="sxs-lookup"><span data-stu-id="cba60-123">Set up the database</span></span>

<span data-ttu-id="cba60-124">Para imitar o ambiente de ter um banco de dados existente, você primeiro crie um banco de dados com alguns dados previamente preenchidos e, em seguida, crie seu aplicativo web que se conecta ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-124">To mimic the environment of having an existing database, you will first create a database with some pre-filled data, and then create your web application that connects to the database.</span></span>

<span data-ttu-id="cba60-125">Este tutorial foi desenvolvido usando o LocalDB.</span><span class="sxs-lookup"><span data-stu-id="cba60-125">This tutorial was developed using LocalDB.</span></span> <span data-ttu-id="cba60-126">Você pode usar um servidor de banco de dados existente em vez do LocalDB, mas dependendo da sua versão do Visual Studio e seu tipo de banco de dados, todas as ferramentas de dados no Visual Studio não podem ter suporte.</span><span class="sxs-lookup"><span data-stu-id="cba60-126">You can use an existing database server instead of LocalDB, but depending on your version of Visual Studio and your type of database, all of the data tools in Visual Studio might not be supported.</span></span> <span data-ttu-id="cba60-127">Se as ferramentas não estão disponíveis para seu banco de dados, você precisa executar algumas etapas específicas do banco de dados dentro do pacote de gerenciamento do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-127">If the tools are not available for your database, you may need to perform some of the database-specific steps within the management suite for your database.</span></span>

<span data-ttu-id="cba60-128">Se você tiver um problema com as ferramentas de banco de dados na sua versão do Visual Studio, verifique se que você instalou a versão mais recente das ferramentas de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-128">If you have a problem with the database tools in your version of Visual Studio, make sure you have installed the latest version of the database tools.</span></span> <span data-ttu-id="cba60-129">Para obter informações sobre como atualizar ou instalar as ferramentas de banco de dados, consulte [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span><span class="sxs-lookup"><span data-stu-id="cba60-129">For information about updating or installing the database tools, see [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span></span>

<span data-ttu-id="cba60-130">Inicie o Visual Studio e crie uma **projeto de banco de dados do SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="cba60-130">Launch Visual Studio and create a **SQL Server Database Project**.</span></span> <span data-ttu-id="cba60-131">Nomeie o projeto **ContosoUniversityData**.</span><span class="sxs-lookup"><span data-stu-id="cba60-131">Name the project **ContosoUniversityData**.</span></span>

![Criar projeto de banco de dados](setting-up-database/_static/image1.png)

<span data-ttu-id="cba60-133">Agora você tem um projeto de banco de dados vazio.</span><span class="sxs-lookup"><span data-stu-id="cba60-133">You now have an empty database project.</span></span> <span data-ttu-id="cba60-134">Você implantará este banco de dados para o Azure posteriormente no tutorial, portanto, você precisará definir o banco de dados SQL como a plataforma de destino para o projeto.</span><span class="sxs-lookup"><span data-stu-id="cba60-134">You will deploy this database to Azure later in this tutorial, so you'll need to set Azure SQL Database as the target platform for the project.</span></span> <span data-ttu-id="cba60-135">Definir a plataforma de destino não realmente implantar o banco de dados; Isso significa apenas que o projeto de banco de dados irá verificar se o design de banco de dados é compatível com a plataforma de destino.</span><span class="sxs-lookup"><span data-stu-id="cba60-135">Setting the target platform does not actually deploy the database; it only means that the database project will verify that the database design is compatible with the target platform.</span></span> <span data-ttu-id="cba60-136">Para definir a plataforma de destino, abra o **propriedades** para o projeto e selecione **banco de dados SQL do Microsoft Azure** para a plataforma de destino.</span><span class="sxs-lookup"><span data-stu-id="cba60-136">To set the target platform, open the **Properties** for the project and select **Microsoft Azure SQL Database** for the target platform.</span></span>

<span data-ttu-id="cba60-137">Você pode criar as tabelas necessárias para este tutorial, adicionando scripts SQL que definem as tabelas.</span><span class="sxs-lookup"><span data-stu-id="cba60-137">You can create the tables needed for this tutorial by adding SQL scripts that define the tables.</span></span> <span data-ttu-id="cba60-138">Clique em seu projeto e adicionar um novo item.</span><span class="sxs-lookup"><span data-stu-id="cba60-138">Right-click your project and add a new item.</span></span> <span data-ttu-id="cba60-139">Selecione **tabelas e exibições** > **tabela** e nomeie-a *aluno*.</span><span class="sxs-lookup"><span data-stu-id="cba60-139">Select **Tables and Views** > **Table** and name it *Student*.</span></span>

<span data-ttu-id="cba60-140">No arquivo de tabela, substitua o comando T-SQL com o código a seguir para criar a tabela.</span><span class="sxs-lookup"><span data-stu-id="cba60-140">In the table file, replace the T-SQL command with the following code to create the table.</span></span>

[!code-sql[Main](setting-up-database/samples/sample1.sql)]

<span data-ttu-id="cba60-141">Observe que a janela de design sincroniza automaticamente com o código.</span><span class="sxs-lookup"><span data-stu-id="cba60-141">Notice that the design window automatically synchronizes with the code.</span></span> <span data-ttu-id="cba60-142">Você pode trabalhar com o código ou o designer.</span><span class="sxs-lookup"><span data-stu-id="cba60-142">You can work with either the code or designer.</span></span>

![Mostrar código e design](setting-up-database/_static/image5.png)

<span data-ttu-id="cba60-144">Adicione outra tabela.</span><span class="sxs-lookup"><span data-stu-id="cba60-144">Add another table.</span></span> <span data-ttu-id="cba60-145">Desta vez Nomeie-o curso e use o seguinte comando T-SQL.</span><span class="sxs-lookup"><span data-stu-id="cba60-145">This time name it Course and use the following T-SQL command.</span></span>

[!code-sql[Main](setting-up-database/samples/sample2.sql)]

<span data-ttu-id="cba60-146">E, então, repetir mais uma vez para criar uma tabela chamada de registro.</span><span class="sxs-lookup"><span data-stu-id="cba60-146">And, repeat one more time to create a table named Enrollment.</span></span>

[!code-sql[Main](setting-up-database/samples/sample3.sql)]

<span data-ttu-id="cba60-147">Você pode preencher seu banco de dados com dados por meio de um script que é executado depois que o banco de dados é implantado.</span><span class="sxs-lookup"><span data-stu-id="cba60-147">You can populate your database with data through a script that is run after the database is deployed.</span></span> <span data-ttu-id="cba60-148">Adicione um Script de pós-implantação ao projeto.</span><span class="sxs-lookup"><span data-stu-id="cba60-148">Add a Post-Deployment Script to the project.</span></span> <span data-ttu-id="cba60-149">Clique em seu projeto e adicionar um novo item.</span><span class="sxs-lookup"><span data-stu-id="cba60-149">Right-click your project and add a new item.</span></span> <span data-ttu-id="cba60-150">Selecione **Scripts de usuário** > **Script pós-implantação**.</span><span class="sxs-lookup"><span data-stu-id="cba60-150">Select **User Scripts** > **Post-Deployment Script**.</span></span> <span data-ttu-id="cba60-151">Você pode usar o nome padrão.</span><span class="sxs-lookup"><span data-stu-id="cba60-151">You can use the default name.</span></span>

<span data-ttu-id="cba60-152">Adicione o seguinte código T-SQL para o script de pós-implantação.</span><span class="sxs-lookup"><span data-stu-id="cba60-152">Add the following T-SQL code to the post-deployment script.</span></span> <span data-ttu-id="cba60-153">Esse script simplesmente adiciona dados ao banco de dados quando nenhum registro correspondente for encontrado.</span><span class="sxs-lookup"><span data-stu-id="cba60-153">This script simply adds data to the database when no matching record is found.</span></span> <span data-ttu-id="cba60-154">Não substituir ou excluir quaisquer dados que talvez você tenha inserido no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-154">It does not overwrite or delete any data you may have entered into the database.</span></span>

[!code-sql[Main](setting-up-database/samples/sample4.sql)]

<span data-ttu-id="cba60-155">É importante observar que o script de pós-implantação é executado sempre que você implanta seu projeto de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-155">It is important to note that the post-deployment script is run every time you deploy your database project.</span></span> <span data-ttu-id="cba60-156">Portanto, você precisa considerar cuidadosamente suas necessidades ao escrever este script.</span><span class="sxs-lookup"><span data-stu-id="cba60-156">Therefore, you need to carefully consider your requirements when writing this script.</span></span> <span data-ttu-id="cba60-157">Em alguns casos, talvez seja conveniente iniciar a partir um conjunto conhecido de dados toda vez que o projeto é implantado.</span><span class="sxs-lookup"><span data-stu-id="cba60-157">In some cases, you may wish to start over from a known set of data every time the project is deployed.</span></span> <span data-ttu-id="cba60-158">Em outros casos, talvez não queira alterar os dados existentes de qualquer forma.</span><span class="sxs-lookup"><span data-stu-id="cba60-158">In other cases, you may not want to alter the existing data in any way.</span></span> <span data-ttu-id="cba60-159">De acordo com suas necessidades, você pode decidir se é necessário um script de pós-implantação ou o que você precisa incluir no script.</span><span class="sxs-lookup"><span data-stu-id="cba60-159">Based on your requirements, you can decide whether you need a post-deployment script or what you need to include in the script.</span></span> <span data-ttu-id="cba60-160">Para obter mais informações sobre a população de seu banco de dados com um script de pós-implantação, consulte [incluindo dados em um projeto de banco de dados do SQL Server](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span><span class="sxs-lookup"><span data-stu-id="cba60-160">For more information about populating your database with a post-deployment script, see [Including Data in a SQL Server Database Project](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span></span>

<span data-ttu-id="cba60-161">Agora você tem arquivos de script SQL 4, mas nenhuma tabela real.</span><span class="sxs-lookup"><span data-stu-id="cba60-161">You now have 4 SQL script files but no actual tables.</span></span> <span data-ttu-id="cba60-162">Você está pronto para implantar seu projeto de banco de dados localdb.</span><span class="sxs-lookup"><span data-stu-id="cba60-162">You are ready to deploy your database project to localdb.</span></span> <span data-ttu-id="cba60-163">No Visual Studio, clique no botão Iniciar (ou F5) para compilar e implantar seu projeto de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cba60-163">In Visual Studio, click the Start button (or F5) to build and deploy your database project.</span></span> <span data-ttu-id="cba60-164">Verifique as **saída** tab para verificar se a compilação e implantação foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="cba60-164">Check the **Output** tab to verify that the build and deployment succeeded.</span></span>

<span data-ttu-id="cba60-165">Para ver que o novo banco de dados foi criado, abra **Pesquisador de objetos do SQL Server** e procure o nome do projeto no servidor de banco de dados local correto (nesse caso **\ProjectsV13 (localdb)**).</span><span class="sxs-lookup"><span data-stu-id="cba60-165">To see that the new database has been created, open **SQL Server Object Explorer** and look for the name of the project in the correct local database server (in this case **(localdb)\ProjectsV13**).</span></span>

<span data-ttu-id="cba60-166">Para ver que as tabelas são populadas com dados, uma tabela com o botão direito e selecione **exibir dados**.</span><span class="sxs-lookup"><span data-stu-id="cba60-166">To see that the tables are populated with data, right-click a table, and select **View Data**.</span></span>

![Mostrar dados da tabela](setting-up-database/_static/image9.png)

<span data-ttu-id="cba60-168">Uma exibição editável dos dados da tabela é exibida.</span><span class="sxs-lookup"><span data-stu-id="cba60-168">An editable view of the table data is displayed.</span></span> <span data-ttu-id="cba60-169">Por exemplo, se você selecionar **tabelas** > **dbo.course** > **dados da exibição**, você verá uma tabela com três colunas (**curso**, **Title**, e **créditos**) e quatro linhas.</span><span class="sxs-lookup"><span data-stu-id="cba60-169">For example, if you select **Tables** > **dbo.course** > **View Data**, you see a table with three columns (**Course**, **Title**, and **Credits**) and four rows.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="cba60-170">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="cba60-170">Additional resources</span></span>

<span data-ttu-id="cba60-171">Para obter um exemplo introdutório de desenvolvimento Code First, consulte [Introdução ao ASP.NET MVC 5](../introduction/getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="cba60-171">For an introductory example of Code First development, see [Getting Started with ASP.NET MVC 5](../introduction/getting-started.md).</span></span> <span data-ttu-id="cba60-172">Para obter um exemplo mais avançado, consulte [criando um modelo de dados do Entity Framework para um aplicativo do ASP.NET MVC 4](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="cba60-172">For a more advanced example, see [Creating an Entity Framework Data Model for an ASP.NET MVC 4 App](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="cba60-173">Para obter orientação sobre como selecionar qual abordagem do Entity Framework para usar, consulte [abordagens de desenvolvimento do Entity Framework](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span><span class="sxs-lookup"><span data-stu-id="cba60-173">For guidance on selecting which Entity Framework approach to use, see [Entity Framework Development Approaches](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span></span>

## <a name="next-steps"></a><span data-ttu-id="cba60-174">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="cba60-174">Next steps</span></span>

<span data-ttu-id="cba60-175">Neste tutorial, você:</span><span class="sxs-lookup"><span data-stu-id="cba60-175">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="cba60-176">Configurar o banco de dados</span><span class="sxs-lookup"><span data-stu-id="cba60-176">Set up the database</span></span>

<span data-ttu-id="cba60-177">Avance para o próximo artigo para saber como criar modelos de dados e aplicativos de web.</span><span class="sxs-lookup"><span data-stu-id="cba60-177">Advance to the next article to learn how to create the web application and data models.</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="cba60-178">Criar a web application e modelos de dados</span><span class="sxs-lookup"><span data-stu-id="cba60-178">Create the web application and data models</span></span>](creating-the-web-application.md)