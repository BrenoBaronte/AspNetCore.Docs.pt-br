---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
title: Code First Migrations e implantação com o Entity Framework em um aplicativo ASP.NET MVC | Microsoft Docs
author: tdykstra
description: Aplicativo web de exemplo Contoso University demonstra como criar aplicativos ASP.NET MVC 5 usando o Entity Framework 6 Code First e o Visual Studio...
ms.author: aspnetcontent
ms.date: 11/07/2014
ms.assetid: d4dfc435-bda6-4621-9762-9ba270f8de4e
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 7c7092b770231b26fd666786af2e202acd70bc8a
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37838680"
---
<a name="code-first-migrations-and-deployment-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="5b7b7-103">Code First Migrations e implantação com o Entity Framework em um aplicativo ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="5b7b7-103">Code First Migrations and Deployment with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="5b7b7-104">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="5b7b7-105">[Baixe o projeto concluído](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) ou [baixar PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="5b7b7-106">Aplicativo web de exemplo Contoso University demonstra como criar aplicativos ASP.NET MVC 5 usando o Entity Framework 6 Code First e o Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="5b7b7-107">Para obter informações sobre a série de tutoriais, consulte [primeiro tutorial na série](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="5b7b7-108">Até agora o aplicativo tiver sido executado localmente no IIS Express no computador de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-108">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="5b7b7-109">Para disponibilizar um aplicativo real para que outras pessoas usem a Internet, você precisará implantá-lo em um provedor de hospedagem na web.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-109">To make a real application available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="5b7b7-110">Neste tutorial, você implantará o aplicativo Contoso University para a nuvem no Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-110">In this tutorial, you'll deploy the Contoso University application to the cloud in Azure.</span></span>

<span data-ttu-id="5b7b7-111">O tutorial contém as seções a seguir:</span><span class="sxs-lookup"><span data-stu-id="5b7b7-111">The tutorial contains the following sections:</span></span>

- <span data-ttu-id="5b7b7-112">Habilite migrações do Code First.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-112">Enable Code First Migrations.</span></span> <span data-ttu-id="5b7b7-113">O recurso de migrações permite que você altere o modelo de dados e implantar suas alterações para a produção atualizando o esquema de banco de dados sem precisar descartar e recriar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-113">The Migrations feature enables you to change the data model and deploy your changes to production by updating the database schema without having to drop and re-create the database.</span></span>
- <span data-ttu-id="5b7b7-114">Implante no Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-114">Deploy to Azure.</span></span> <span data-ttu-id="5b7b7-115">Esta etapa é opcional. Você pode continuar com os tutoriais restantes sem ter implantado o projeto.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-115">This step is optional; you can continue with the remaining tutorials without having deployed the project.</span></span>

<span data-ttu-id="5b7b7-116">É recomendável que você usar um processo de integração contínua com o controle do código-fonte para a implantação, mas este tutorial não aborda esses tópicos.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-116">We recommend that you use a continuous integration process with source control for deployment, but this tutorial does not cover those topics.</span></span> <span data-ttu-id="5b7b7-117">Para obter mais informações, consulte o [controle de origem](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) e [integração contínua](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) capítulos o [criando aplicativos de nuvem do mundo Real com o Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) livro eletrônico.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-117">For more information, see the [source control](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) and [continuous integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) chapters of the [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-book.</span></span>

## <a name="enable-code-first-migrations"></a><span data-ttu-id="5b7b7-118">Habilitar migrações do Code First</span><span class="sxs-lookup"><span data-stu-id="5b7b7-118">Enable Code First Migrations</span></span>

<span data-ttu-id="5b7b7-119">Quando você desenvolve um novo aplicativo, o modelo de dados é alterado com frequência e, sempre que o modelo é alterado, ele fica fora de sincronia com o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-119">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database.</span></span> <span data-ttu-id="5b7b7-120">Você configurou o Entity Framework para descartar e recriar o banco de dados sempre que você alterar o modelo de dados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-120">You have configured the Entity Framework to automatically drop and re-create the database each time you change the data model.</span></span> <span data-ttu-id="5b7b7-121">Quando você adicionar, remover, ou alterar as classes de entidade ou alterar seu `DbContext` de classe, na próxima vez que você executar o aplicativo automaticamente exclui o banco de dados existente, cria um novo que corresponde ao modelo e o propagará com dados de teste.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-121">When you add, remove, or change entity classes or change your `DbContext` class, the next time you run the application it automatically deletes your existing database, creates a new one that matches the model, and seeds it with test data.</span></span>

<span data-ttu-id="5b7b7-122">Esse método de manter o banco de dados em sincronia com o modelo de dados funciona bem até que você implante o aplicativo em produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-122">This method of keeping the database in sync with the data model works well until you deploy the application to production.</span></span> <span data-ttu-id="5b7b7-123">Quando o aplicativo está em execução na produção, ele normalmente armazena os dados que você deseja manter, e você não deseja perder tudo sempre que você fizer uma alteração, como adicionar uma nova coluna.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-123">When the application is running in production, it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column.</span></span> <span data-ttu-id="5b7b7-124">O [migrações do Code First](https://msdn.microsoft.com/data/jj591621) recurso resolve esse problema, permitindo que o Code First atualizar o esquema de banco de dados, em vez de descartar e recriar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-124">The [Code First Migrations](https://msdn.microsoft.com/data/jj591621) feature solves this problem by enabling Code First to update the database schema instead of dropping and re-creating the database.</span></span> <span data-ttu-id="5b7b7-125">Neste tutorial, você implantará o aplicativo e para se preparar para fazer isso, você vai habilitar migrações.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-125">In this tutorial, you'll deploy the application, and to prepare for that you'll enable Migrations.</span></span>

1. <span data-ttu-id="5b7b7-126">Desabilitar o inicializador que você configurou anteriormente comentando ou excluindo o `contexts` elemento que você adicionou ao arquivo de Web. config do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-126">Disable the initializer that you set up earlier by commenting out or deleting the `contexts` element that you added to the application Web.config file.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.xml?highlight=2,6)]
2. <span data-ttu-id="5b7b7-127">Também no aplicativo *Web. config* file, altere o nome do banco de dados na cadeia de conexão para ContosoUniversity2.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-127">Also in the application *Web.config* file, change the name of the database in the connection string to ContosoUniversity2.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.xml?highlight=2)]

    <span data-ttu-id="5b7b7-128">Essa alteração configura o projeto, de modo que a primeira migração crie um novo banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-128">This change sets up the project so that the first migration will create a new database.</span></span> <span data-ttu-id="5b7b7-129">Isso não é obrigatório, mas você verá posteriormente por que é uma boa ideia.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-129">This isn't required but you'll see later why it's a good idea.</span></span>
3. <span data-ttu-id="5b7b7-130">Dos **ferramentas** menu, clique em **Gerenciador de pacotes de biblioteca** e, em seguida, **Package Manager Console**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-130">From the **Tools** menu, click **Library Package Manager** and then **Package Manager Console**.</span></span>

    ![Selecting_Package_Manager_Console](https://asp.net/media/4336350/1pm.png)
4. <span data-ttu-id="5b7b7-132">No `PM>` prompt digite os seguintes comandos:</span><span class="sxs-lookup"><span data-stu-id="5b7b7-132">At the `PM>` prompt enter the following commands:</span></span>

    `enable-migrations`  
    `add-migration InitialCreate`

    ![comando enable-migrations](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

    <span data-ttu-id="5b7b7-134">O `enable-migrations` comando cria um *migrações* pasta no projeto ContosoUniversity e ele coloca nessa pasta um *Configuration.cs* arquivo que você pode editar para configurar migrações.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-134">The `enable-migrations` command creates a *Migrations* folder in the ContosoUniversity project, and it puts in that folder a *Configuration.cs* file that you can edit to configure Migrations.</span></span>

    <span data-ttu-id="5b7b7-135">(Se você perdeu a etapa acima que direciona você para alterar o nome do banco de dados, as migrações encontrará o banco de dados existente e fazer automaticamente o `add-migration` comando.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-135">(If you missed the step above that directs you to change the database name, Migrations will find the existing database and automatically do the `add-migration` command.</span></span> <span data-ttu-id="5b7b7-136">Okey, isso apenas significa que você não será executado um teste do código migrações antes de implantar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-136">That's OK, it just means you won't run a test of the migrations code before you deploy the database.</span></span> <span data-ttu-id="5b7b7-137">Posteriormente, quando você executar o `update-database` comando não acontece nada porque o banco de dados já existirão.)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-137">Later when you run the `update-database` command nothing will happen because the database will already exist.)</span></span>

    ![Pasta Migrations](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

    <span data-ttu-id="5b7b7-139">Como a classe de inicializador que vimos anteriormente, o `Configuration` classe inclui um `Seed` método.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-139">Like the initializer class that you saw earlier, the `Configuration` class includes a `Seed` method.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

    <span data-ttu-id="5b7b7-140">A finalidade de [semente](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) método é para que você possa inserir ou atualizar dados de teste depois que o Code First cria ou atualiza o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-140">The purpose of the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is to enable you to insert or update test data after Code First creates or updates the database.</span></span> <span data-ttu-id="5b7b7-141">O método é chamado quando o banco de dados é criado e sempre que o esquema de banco de dados é atualizado após a alteração de um modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-141">The method is called when the database is created and every time the database schema is updated after a data model change.</span></span>

### <a name="set-up-the-seed-method"></a><span data-ttu-id="5b7b7-142">Configurar o método de semente</span><span class="sxs-lookup"><span data-stu-id="5b7b7-142">Set up the Seed Method</span></span>

<span data-ttu-id="5b7b7-143">Quando você está descartando e recriar o banco de dados para cada alteração de modelo de dados, use a classe de inicializador `Seed` método para inserir dados de teste, porque após cada alteração de modelo de banco de dados é descartado e todos os dados de teste é perdido.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-143">When you are dropping and re-creating the database for every data model change, you use the initializer class's `Seed` method to insert test data, because after every model change the database is dropped and all the test data is lost.</span></span> <span data-ttu-id="5b7b7-144">Com migrações do Code First, teste os dados são mantidos após as alterações do banco de dados, portanto, incluindo dados de teste na [semente](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) método normalmente não é necessário.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-144">With Code First Migrations, test data is retained after database changes, so including test data in the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is typically not necessary.</span></span> <span data-ttu-id="5b7b7-145">Na verdade, você não deseja que o `Seed` método para inserir dados de teste se você usará as migrações para implantar o banco de dados em produção, pois o `Seed` método será executado na produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-145">In fact, you don't want the `Seed` method to insert test data if you'll be using Migrations to deploy the database to production, because the `Seed` method will run in production.</span></span> <span data-ttu-id="5b7b7-146">Nesse caso, você deseja que o `Seed` método a ser inserido no banco de dados somente os dados que você precisa em produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-146">In that case you want the `Seed` method to insert into the database only the data that you need in production.</span></span> <span data-ttu-id="5b7b7-147">Por exemplo, você pode querer o banco de dados para incluir nomes de departamento real no `Department` tabela quando o aplicativo está disponível em produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-147">For example, you might want the database to include actual department names in the `Department` table when the application becomes available in production.</span></span>

<span data-ttu-id="5b7b7-148">Para este tutorial, você usará as migrações para a implantação, mas seu `Seed` método vai inserir dados de teste de qualquer forma para torná-lo mais fácil de ver como a funcionalidade do aplicativo funciona sem precisar inserir manualmente o muitos dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-148">For this tutorial, you'll be using Migrations for deployment, but your `Seed` method will insert test data anyway in order to make it easier to see how application functionality works without having to manually insert a lot of data.</span></span>

1. <span data-ttu-id="5b7b7-149">Substitua o conteúdo do *Configuration.cs* arquivo pelo código a seguir, que irá carregar dados de teste no novo banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-149">Replace the contents of the *Configuration.cs* file with the following code, which will load test data into the new database.</span></span> 

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

    <span data-ttu-id="5b7b7-150">O [semente](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) método usa o objeto de contexto do banco de dados como um parâmetro de entrada e o código no método utiliza o objeto para adicionar novas entidades no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-150">The [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="5b7b7-151">Para cada tipo de entidade, o código cria uma coleção de novas entidades e os adiciona ao apropriado [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) propriedade e, em seguida, salva as alterações no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-151">For each entity type, the code creates a collection of new entities, adds them to the appropriate [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) property, and then saves the changes to the database.</span></span> <span data-ttu-id="5b7b7-152">Não é necessário chamar o [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) método depois de cada grupo de entidades, assim como é feito aqui, mas fazer isso ajuda a localizar a origem de um problema se ocorrer uma exceção enquanto o código é escrito para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-152">It isn't necessary to call the [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

    <span data-ttu-id="5b7b7-153">Algumas das instruções que inserem dados usam o [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) método para executar uma operação "upsert".</span><span class="sxs-lookup"><span data-stu-id="5b7b7-153">Some of the statements that insert data use the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method to perform an "upsert" operation.</span></span> <span data-ttu-id="5b7b7-154">Porque o `Seed` método é executado sempre que você executar o `update-database` de comando, normalmente após cada migração, você simplesmente não é possível inserir dados, porque as linhas que você está tentando adicionar já estará lá após a primeira migração que cria o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-154">Because the `Seed` method runs every time you execute the `update-database` command, typically after each migration, you can't just insert data, because the rows you are trying to add will already be there after the first migration that creates the database.</span></span> <span data-ttu-id="5b7b7-155">A operação "upsert" impede que os erros que acontecem se você tentar inserir uma linha que já existe, mas ***substituições*** as alterações nos dados feitas durante o teste o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-155">The "upsert" operation prevents errors that would happen if you try to insert a row that already exists, but it ***overrides*** any changes to data that you may have made while testing the application.</span></span> <span data-ttu-id="5b7b7-156">Com os dados de teste em algumas tabelas você talvez não queira que aconteça: em alguns casos quando você altera os dados durante o teste você deseja as suas alterações para permanecer após as atualizações do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-156">With test data in some tables you might not want that to happen: in some cases when you change data while testing you want your changes to remain after database updates.</span></span> <span data-ttu-id="5b7b7-157">Nesse caso, você deseja fazer uma operação de inserção condicional: inserir uma linha apenas se ele ainda não existir.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-157">In that case you want to do a conditional insert operation: insert a row only if it doesn't already exist.</span></span> <span data-ttu-id="5b7b7-158">O método de propagação usa as duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-158">The Seed method uses both approaches.</span></span>

    <span data-ttu-id="5b7b7-159">O primeiro parâmetro passado para o [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) método Especifica a propriedade a ser usada para verificar se já existe uma linha.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-159">The first parameter passed to the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method specifies the property to use to check if a row already exists.</span></span> <span data-ttu-id="5b7b7-160">Para os dados de aluno de teste que você fornecer, o `LastName` propriedade pode ser usada para essa finalidade, pois cada sobrenome na lista é exclusivo:</span><span class="sxs-lookup"><span data-stu-id="5b7b7-160">For the test student data that you are providing, the `LastName` property can be used for this purpose since each last name in the list is unique:</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

    <span data-ttu-id="5b7b7-161">Esse código supõe que o último nomes sejam exclusivos.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-161">This code assumes that last names are unique.</span></span> <span data-ttu-id="5b7b7-162">Se você adicionar manualmente um aluno com um sobrenome duplicado, você obterá a seguinte exceção na próxima vez que você executar uma migração.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-162">If you manually add a student with a duplicate last name, you'll get the following exception the next time you perform a migration.</span></span>

    <span data-ttu-id="5b7b7-163">Sequência contém mais de um elemento</span><span class="sxs-lookup"><span data-stu-id="5b7b7-163">Sequence contains more than one element</span></span>

    <span data-ttu-id="5b7b7-164">Para obter informações sobre como lidar com dados redundantes, como dois alunos denominados "Alexander Carson", consulte [Seeding e bancos de dados de depuração Entity Framework (EF)](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) no blog de Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-164">For information about how to handle redundant data such as two students named "Alexander Carson", see [Seeding and Debugging Entity Framework (EF) DBs](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="5b7b7-165">Para obter mais informações sobre o `AddOrUpdate` método, consulte [tome cuidado com o EF 4.3 AddOrUpdate método](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) no blog de Julie.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-165">For more information about the `AddOrUpdate` method, see [Take care with EF 4.3 AddOrUpdate Method](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) on Julie Lerman's blog.</span></span>

    <span data-ttu-id="5b7b7-166">O código que cria `Enrollment` entidades pressupõe que você tenha o `ID` valor em entidades no `students` coleção, embora você não definir essa propriedade no código que cria a coleção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-166">The code that creates `Enrollment` entities assumes you have the `ID` value in the entities in the `students` collection, although you didn't set that property in the code that creates the collection.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs?highlight=2)]

    <span data-ttu-id="5b7b7-167">Você pode usar o `ID` propriedade aqui porque o `ID` valor é definido quando você chama `SaveChanges` para o `students` coleção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-167">You can use the `ID` property here because the `ID` value is set when you call `SaveChanges` for the `students` collection.</span></span> <span data-ttu-id="5b7b7-168">O EF automaticamente obtém o valor de chave primária quando ele insere uma entidade no banco de dados e atualiza o `ID` propriedade da entidade na memória.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-168">EF automatically gets the primary key value when it inserts an entity into the database, and it updates the `ID` property of the entity in memory.</span></span>

    <span data-ttu-id="5b7b7-169">O código que adiciona cada `Enrollment` entidade para o `Enrollments` conjunto de entidades não usa o `AddOrUpdate` método.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-169">The code that adds each `Enrollment` entity to the `Enrollments` entity set doesn't use the `AddOrUpdate` method.</span></span> <span data-ttu-id="5b7b7-170">Ele verifica se uma entidade já existe e insere a entidade se ela não existir.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-170">It checks if an entity already exists and inserts the entity if it doesn't exist.</span></span> <span data-ttu-id="5b7b7-171">Essa abordagem preserva as alterações feitas para um nível de registro usando o interface do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-171">This approach will preserve changes you make to an enrollment grade by using the application UI.</span></span> <span data-ttu-id="5b7b7-172">O código executa um loop em cada membro do `Enrollment` [lista](https://msdn.microsoft.com/library/6sh2ey19.aspx) e se o registro não for encontrado no banco de dados, ele adiciona o registro no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-172">The code loops through each member of the `Enrollment`[List](https://msdn.microsoft.com/library/6sh2ey19.aspx) and if the enrollment is not found in the database, it adds the enrollment to the database.</span></span> <span data-ttu-id="5b7b7-173">Na primeira vez que você atualizar o banco de dados, o banco de dados estará vazio, portanto, ele adicionará cada registro.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-173">The first time you update the database, the database will be empty, so it will add each enrollment.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs)]
2. <span data-ttu-id="5b7b7-174">Compile o projeto.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-174">Build the project.</span></span>

### <a name="execute-the-first-migration"></a><span data-ttu-id="5b7b7-175">Execute a primeira migração</span><span class="sxs-lookup"><span data-stu-id="5b7b7-175">Execute the First Migration</span></span>

<span data-ttu-id="5b7b7-176">Quando você executou o `add-migration` de comando, as migrações gerou o código que cria o banco de dados do zero.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-176">When you executed the `add-migration` command, Migrations generated the code that would create the database from scratch.</span></span> <span data-ttu-id="5b7b7-177">Esse código também está na *migrações* pasta, no arquivo chamado  *&lt;timestamp&gt;\_InitialCreate.cs*.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-177">This code is also in the *Migrations* folder, in the file named *&lt;timestamp&gt;\_InitialCreate.cs*.</span></span> <span data-ttu-id="5b7b7-178">O `Up` método da `InitialCreate` classe cria as tabelas de banco de dados que correspondem aos conjuntos de entidade do modelo de dados, e o `Down` método exclui-los.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-178">The `Up` method of the `InitialCreate` class creates the database tables that correspond to the data model entity sets, and the `Down` method deletes them.</span></span>

[!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

<span data-ttu-id="5b7b7-179">As migrações chamam o método `Up` para implementar as alterações do modelo de dados para uma migração.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-179">Migrations calls the `Up` method to implement the data model changes for a migration.</span></span> <span data-ttu-id="5b7b7-180">Quando você insere um comando para reverter a atualização, as Migrações chamam o método `Down`.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-180">When you enter a command to roll back the update, Migrations calls the `Down` method.</span></span>

<span data-ttu-id="5b7b7-181">Essa é a migração inicial que foi criada quando você inseriu o `add-migration InitialCreate` comando.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-181">This is the initial migration that was created when you entered the `add-migration InitialCreate` command.</span></span> <span data-ttu-id="5b7b7-182">O parâmetro (`InitialCreate` no exemplo) é usado para o arquivo de nome e pode ser que você quiser; normalmente deve escolher uma palavra ou frase que resume o que está sendo feito na migração.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-182">The parameter (`InitialCreate` in the example) is used for the file name and can be whatever you want; you typically choose a word or phrase that summarizes what is being done in the migration.</span></span> <span data-ttu-id="5b7b7-183">Por exemplo, você pode nomear uma migração posterior &quot;AddDepartmentTable&quot;.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-183">For example, you might name a later migration &quot;AddDepartmentTable&quot;.</span></span>

<span data-ttu-id="5b7b7-184">Se você criou a migração inicial quando o banco de dados já existia, o código de criação de banco de dados é gerado, mas ele não precisa ser executado porque o banco de dados já corresponde ao modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-184">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model.</span></span> <span data-ttu-id="5b7b7-185">Quando você implantar o aplicativo em outro ambiente no qual o banco de dados ainda não existe, esse código será executado para criar o banco de dados; portanto, é uma boa ideia testá-lo primeiro.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-185">When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first.</span></span> <span data-ttu-id="5b7b7-186">É por isso que você alterou o nome do banco de dados na cadeia de conexão anteriormente – para que as migrações possam criar um novo do zero.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-186">That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.</span></span>

1. <span data-ttu-id="5b7b7-187">No **Package Manager Console** janela, digite o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="5b7b7-187">In the **Package Manager Console** window, enter the following command:</span></span>

    `update-database`

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

    <span data-ttu-id="5b7b7-188">O `update-database` comando executa o `Up` método para criar o banco de dados e, em seguida, ele é executado o `Seed` para popular o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-188">The `update-database` command runs the `Up` method to create the database and then it runs the `Seed` method to populate the database.</span></span> <span data-ttu-id="5b7b7-189">O mesmo processo será executado automaticamente em produção depois que você implantar o aplicativo, como você verá na seção a seguir.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-189">The same process will run automatically in production after you deploy the application, as you'll see in the following section.</span></span>
2. <span data-ttu-id="5b7b7-190">Use **Gerenciador de servidores** para inspecionar o banco de dados, como você fez no primeiro tutorial e executar o aplicativo para verificar que tudo ainda funciona como antes.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-190">Use **Server Explorer** to inspect the database as you did in the first tutorial, and run the application to verify that everything still works the same as before.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="5b7b7-191">Implantar no Azure</span><span class="sxs-lookup"><span data-stu-id="5b7b7-191">Deploy to Azure</span></span>

<span data-ttu-id="5b7b7-192">Até agora o aplicativo tiver sido executado localmente no IIS Express no computador de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-192">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="5b7b7-193">Para torná-lo disponível para que outras pessoas usem a Internet, você precisará implantá-lo em um provedor de hospedagem na web.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-193">To make it available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="5b7b7-194">Nesta seção do tutorial você o implantará no Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-194">In this section of the tutorial you'll deploy it to Azure.</span></span> <span data-ttu-id="5b7b7-195">Esta seção é opcional. Você pode ignorar essa etapa e continue com o tutorial a seguir, ou você pode adaptar as instruções nesta seção para um provedor de hospedagem diferente de sua escolha.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-195">This section is optional; you can skip this and continue with the following tutorial, or you can adapt the instructions in this section for a different hosting provider of your choice.</span></span>

### <a name="using-code-first-migrations-to-deploy-the-database"></a><span data-ttu-id="5b7b7-196">Usando o Code First Migrations para implantar o banco de dados</span><span class="sxs-lookup"><span data-stu-id="5b7b7-196">Using Code First Migrations to Deploy the Database</span></span>

<span data-ttu-id="5b7b7-197">Para implantar o banco de dados, você usará migrações do Code First.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-197">To deploy the database you'll use Code First Migrations.</span></span> <span data-ttu-id="5b7b7-198">Quando você cria o perfil de publicação que você usa para definir as configurações para a implantação do Visual Studio, você selecionará uma caixa de seleção rotulada **Atualizar banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-198">When you create the publish profile that you use to configure settings for deploying from Visual Studio, you'll select a check box labeled **Update Database**.</span></span> <span data-ttu-id="5b7b7-199">Essa configuração faz com que o processo de implantação configurar automaticamente o aplicativo *Web. config* arquivo no servidor de destino, para que o Code First usa o `MigrateDatabaseToLatestVersion` a classe do inicializador.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-199">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>

<span data-ttu-id="5b7b7-200">Visual Studio não faz nada com o banco de dados durante o processo de implantação enquanto ela está copiando o seu projeto para o servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-200">Visual Studio doesn't do anything with the database during the deployment process while it is copying your project to the destination server.</span></span> <span data-ttu-id="5b7b7-201">Quando você executar o aplicativo implantado e acessa o banco de dados pela primeira vez após a implantação, o Code First verifica de se o banco de dados corresponde ao modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-201">When you run the deployed application and it accesses the database for the first time after deployment, Code First checks if the database matches the data model.</span></span> <span data-ttu-id="5b7b7-202">Se houver uma incompatibilidade, Code First cria automaticamente o banco de dados (se ele ainda não exista) ou atualiza o esquema de banco de dados para a versão mais recente (se um banco de dados existe, mas não corresponde ao modelo).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-202">If there's a mismatch, Code First automatically creates the database (if it doesn't exist yet) or updates the database schema to the latest version (if a database exists but doesn't match the model).</span></span> <span data-ttu-id="5b7b7-203">Se o aplicativo implementar um migrações `Seed` método, o método é executado depois que o banco de dados é criado ou o esquema é atualizado.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-203">If the application implements a Migrations `Seed` method, the method runs after the database is created or the schema is updated.</span></span>

<span data-ttu-id="5b7b7-204">Suas migrações `Seed` método insere dados de teste.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-204">Your Migrations `Seed` method inserts test data.</span></span> <span data-ttu-id="5b7b7-205">Se você estivesse Implantando um ambiente de produção, você teria que alterar o `Seed` , de modo que ele insere apenas os dados que você deseja a ser inserido no seu banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-205">If you were deploying to a production environment, you would have to change the `Seed` method so that it only inserts data that you want to be inserted into your production database.</span></span> <span data-ttu-id="5b7b7-206">Por exemplo, no seu modelo de dados atual você talvez queira ter cursos real, mas os alunos fictícios no banco de dados de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-206">For example, in your current data model you might want to have real courses but fictional students in the development database.</span></span> <span data-ttu-id="5b7b7-207">Você pode escrever um `Seed` método para carregar no desenvolvimento e comente os alunos fictícios antes de implantar em produção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-207">You can write a `Seed` method to load both in development, and then comment out the fictional students before you deploy to production.</span></span> <span data-ttu-id="5b7b7-208">Ou você pode escrever um `Seed` método carregar somente os cursos e insira os alunos fictícios no banco de dados de teste manualmente usando a interface do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-208">Or you can write a `Seed` method to load only courses, and enter the fictional students in the test database manually by using the application's UI.</span></span>

### <a name="get-an-azure-account"></a><span data-ttu-id="5b7b7-209">Obter uma conta do Azure</span><span class="sxs-lookup"><span data-stu-id="5b7b7-209">Get an Azure account</span></span>

<span data-ttu-id="5b7b7-210">Você precisará de uma conta do Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-210">You'll need an Azure account.</span></span> <span data-ttu-id="5b7b7-211">Se você ainda não tiver um, mas você tem uma assinatura do Visual Studio, você pode [ativar os benefícios da assinatura](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-211">If you don't already have one, but you do have a Visual Studio subscription, you can [activate your subscription benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span></span> <span data-ttu-id="5b7b7-212">Caso contrário, você pode criar uma conta de avaliação gratuita em apenas alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-212">Otherwise, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="5b7b7-213">Para obter detalhes, consulte [avaliação gratuita do Azure](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-213">For details, see [Azure Free Trial](https://azure.microsoft.com/free/).</span></span>

### <a name="create-a-web-site-and-a-sql-database-in-azure"></a><span data-ttu-id="5b7b7-214">Criar um site da web e um banco de dados SQL no Azure</span><span class="sxs-lookup"><span data-stu-id="5b7b7-214">Create a web site and a SQL database in Azure</span></span>

<span data-ttu-id="5b7b7-215">Seu aplicativo web no Azure será executado em um ambiente de hospedagem compartilhado, o que significa que ele é executado em máquinas virtuais (VMs) que são compartilhadas com outros clientes do Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-215">Your web app in Azure will run in a shared hosting environment, which means it runs on virtual machines (VMs) that are shared with other Azure clients.</span></span> <span data-ttu-id="5b7b7-216">Um ambiente de hospedagem compartilhado é uma maneira de baixo custo para começar a usar na nuvem.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-216">A shared hosting environment is a low-cost way to get started in the cloud.</span></span> <span data-ttu-id="5b7b7-217">Posteriormente, se aumentar o tráfego da web, o aplicativo possa ser dimensionado para atender à necessidade executando em VMs dedicadas.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-217">Later, if your web traffic increases, the application can scale to meet the need by running on dedicated VMs.</span></span> <span data-ttu-id="5b7b7-218">Para saber mais sobre as opções de preço para o serviço de aplicativo do Azure, leia a documentação sobre [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-218">To learn more about Pricing Options for Azure App Service, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span></span>

<span data-ttu-id="5b7b7-219">Você implantará o banco de dados no banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-219">You'll deploy the database to Azure SQL Database.</span></span> <span data-ttu-id="5b7b7-220">Banco de dados SQL é um serviço de banco de dados relacional baseado em nuvem que se baseia em tecnologias do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-220">SQL Database is a cloud-based relational database service that is built on SQL Server technologies.</span></span> <span data-ttu-id="5b7b7-221">Ferramentas e aplicativos que funcionam com o SQL Server também funcionam com o banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-221">Tools and applications that work with SQL Server also work with SQL Database.</span></span>

1. <span data-ttu-id="5b7b7-222">No [Portal de gerenciamento](https://portal.azure.com), clique em **New** na guia à esquerda, clique em **ver todos** na nova folha e clique **Web App & SQL** no **Web** seção e, finalmente **criar**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-222">In the [Azure Management Portal](https://portal.azure.com), click **New** in the left tab, click **See all** in new blade, and then click **Web App & SQL** in the **Web** Section and finally **Create**.</span></span>

    ![Botão novo no Portal de gerenciamento](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/CreateWeb-Sql.png)

   <span data-ttu-id="5b7b7-224">O **novo aplicativo Web e SQL - criar** assistente é aberto.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-224">The **New Web App & SQL - Create** wizard opens.</span></span>

2. <span data-ttu-id="5b7b7-225">Na folha, insira uma cadeia de caracteres a **nome do aplicativo** caixa para usar como a URL exclusiva para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-225">In the blade, enter a string in the **App name** box to use as the unique URL for your application.</span></span> <span data-ttu-id="5b7b7-226">A URL completa consistirá em que você inserir aqui mais o domínio padrão dos serviços de aplicativo do Azure (. azurewebsites.net).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-226">The complete URL will consist of what you enter here plus the default domain of Azure App Services (.azurewebsites.net).</span></span> <span data-ttu-id="5b7b7-227">Se o **nome do aplicativo** já está em uso, o assistente irá notificá-lo com um vermelho *o nome do aplicativo não está disponível* mensagem.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-227">If the **App name** is already taken, the Wizard will notify you of this with a red *The app name is not available* message.</span></span> <span data-ttu-id="5b7b7-228">Se o **nome do aplicativo** está disponível, você obterá uma marca de seleção verde.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-228">If the **App name** is available, you will get a green checkmark.</span></span>

    ![Criar com o link do banco de dados no Portal de gerenciamento](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-WebApp.png)

3. <span data-ttu-id="5b7b7-230">No **assinatura** lista suspensa, escolha a assinatura do Azure no qual você deseja o **serviço de aplicativo** residir.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-230">In the **Subscription** Dropdown, please choose the Azure Subscription in which you want the **App Service** to reside.</span></span>

4. <span data-ttu-id="5b7b7-231">No **grupo de recursos** caixa de texto, escolha um grupo de recursos ou criar um novo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-231">In the **Resource Group** text box, choose a Resource Group or create a new one.</span></span> <span data-ttu-id="5b7b7-232">Essa configuração especifica qual Datacenter seu site da web será executado em.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-232">This setting specifies which data center your web site will run in.</span></span> <span data-ttu-id="5b7b7-233">Para obter mais informações sobre grupos de recursos, leia a documentação sobre [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-233">For more information about Resource Groups, read the documentation on [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span></span>
5. <span data-ttu-id="5b7b7-234">Criar um novo **plano do serviço de aplicativo** clicando o *seção de serviço de aplicativo*, **criar novo**e preencha **plano do serviço de aplicativo** (pode ser mesmo nome Serviço de aplicativo), **local**, e **tipo de preço** (há uma opção gratuita).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-234">Create a new **App Service Plan** by clicking the *App Service section*, **Create New**, and fill in **App Service plan** (can be same name as App Service), **Location**, and **Pricing tier** (there is a free option).</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-AppService.png)
6. <span data-ttu-id="5b7b7-235">Clique o **banco de dados SQL**e escolha *criar novo* ou selecione um banco de dados existente</span><span class="sxs-lookup"><span data-stu-id="5b7b7-235">Click the **SQL Database**, and choose *Create New* or select an existing database</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-Database.png)

7. <span data-ttu-id="5b7b7-236">No **nome** , digite um nome para seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-236">In the **Name** box, enter a name for your database.</span></span>
8. <span data-ttu-id="5b7b7-237">Clique o **servidor de destino** caixa, selecione **criar um novo servidor**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-237">Click the **Target Server** box, select **Create a new server**.</span></span> <span data-ttu-id="5b7b7-238">Como alternativa, se você tiver criado um servidor, você pode selecionar esse servidor na lista de servidores disponíveis.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-238">Alternatively, if you previously created a server, you can select that server from list of available servers.</span></span>
9. <span data-ttu-id="5b7b7-239">Escolher **tipo de preço** , escolha *gratuito*.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-239">Choose **Pricing tier** section, choose *Free*.</span></span> <span data-ttu-id="5b7b7-240">Se forem necessários recursos adicionais, o banco de dados pode ser escalado verticalmente a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-240">If additional resources are needed, the database can be scaled up at any time.</span></span> <span data-ttu-id="5b7b7-241">Para saber mais sobre os preços do SQL Azure, leia a documentação sobre [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-241">To learn more on Azure SQL Pricing, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
10. <span data-ttu-id="5b7b7-242">Modifique [agrupamento](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-242">Modify [collation](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) as needed.</span></span>
11. <span data-ttu-id="5b7b7-243">Insira um administrador **nome de usuário de administrador de SQL** e **senha de administrador do SQL**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-243">Enter an administrator **SQL Admin Username** and **SQL Admin Password**.</span></span> <span data-ttu-id="5b7b7-244">Se você selecionou **servidor do novo banco de dados SQL**, não digitará um nome e senha existentes aqui, você está inserindo um novo nome e senha que você está definindo agora para usar mais tarde, quando você acessa o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-244">If you selected **New SQL Database server**, you aren't entering an existing name and password here, you're entering a new name and password that you're defining now to use later when you access the database.</span></span> <span data-ttu-id="5b7b7-245">Se você tiver selecionado um servidor que você criou anteriormente, você vai inserir as credenciais para esse servidor.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-245">If you selected a server that you created previously, you'll enter credentials for that server.</span></span>
12. <span data-ttu-id="5b7b7-246">Coleta de telemetria pode ser habilitada para o serviço de aplicativo usando o Application Insights.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-246">Telemetry collection can be enabled for App Service using Application Insights.</span></span> <span data-ttu-id="5b7b7-247">Application Insights com pouca configuração coleta eventos importantes, exceção, dependência, solicitação e informações de rastreamento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-247">Application Insights with little configuration collects valuable event, exception, dependency, request, and trace information.</span></span> <span data-ttu-id="5b7b7-248">Para saber mais sobre o Application Insights, começar [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-248">To learn more about Application Insights, get started in [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span></span>
13. <span data-ttu-id="5b7b7-249">Clique em **criar** na parte inferior da folha para indicar que é concluído.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-249">Click **Create** at the bottom of the blade to indicate that you're finished.</span></span>
  
    <span data-ttu-id="5b7b7-250">O Portal de gerenciamento retorna para a página de painéis e o **notificações** folha na parte superior da página mostra que o site está sendo criado.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-250">The Management Portal returns to the Dashboards page, and the **Notifications** blade at the top of the page shows that the site is being created.</span></span> <span data-ttu-id="5b7b7-251">Depois de algum tempo (normalmente menos de um minuto), haverá uma notificação de que a implantação foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-251">After a while (typically less than a minute), there will be a notification that the Deployment succeeded.</span></span> <span data-ttu-id="5b7b7-252">Na barra de navegação à esquerda, a nova **serviço de aplicativo** aparece na *serviços de aplicativos* seção e a nova **banco de dados SQL** aparece no *bancos de dados SQL*  seção.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-252">In the navigation bar at the left, the new **App Service** appears in the *App Services* section and the new **SQL Database** appears in the *SQL Databases* section.</span></span>

### <a name="deploy-the-application-to-azure"></a><span data-ttu-id="5b7b7-253">Implantar o aplicativo no Azure</span><span class="sxs-lookup"><span data-stu-id="5b7b7-253">Deploy the application to Azure</span></span>

1. <span data-ttu-id="5b7b7-254">No Visual Studio, clique com botão direito no projeto no **Gerenciador de soluções** e selecione **publicar** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-254">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
  
    ![Publicar no menu de contexto do projeto](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image10.png)
2. <span data-ttu-id="5b7b7-256">No **perfil** guia o **publicar na Web** assistente, clique em **serviço de aplicativo do Microsoft Azure**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-256">In the **Profile** tab of the **Publish Web** wizard, click **Microsoft Azure App Service**.</span></span>
  
    ![Importar configurações de publicação](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-ChooseTarget.png)
3. <span data-ttu-id="5b7b7-258">Se você não adicionou anteriormente sua assinatura do Azure no Visual Studio, execute as etapas na tela.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-258">If you have not previously added your Azure subscription in Visual Studio, perform the steps on the screen.</span></span> <span data-ttu-id="5b7b7-259">Essas etapas habilitam o Visual Studio para se conectar à sua assinatura do Azure assim que a lista de **serviços de aplicativos** incluirá o seu site da web.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-259">These steps enable Visual Studio to connect to your Azure subscription so that the list of **App Services** will include your web site.</span></span>
 
4. <span data-ttu-id="5b7b7-260">Selecione o **assinatura** adicionado o serviço de aplicativo para, em seguida, o **plano do serviço de aplicativo** pasta de seu serviço de aplicativo é uma parte, e, finalmente, o **serviço de aplicativo** próprio seguido por **Okey**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-260">Select the **Subscription** you added the App Service to, then the **App Service Plan** folder your App Service is a part of, and finally the **App Service** itself followed by **Ok**.</span></span>

    ![Selecione o serviço de aplicativo](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-AppService.png)
5. <span data-ttu-id="5b7b7-262">Depois que o perfil tiver sido configurado, o **Conexão** guia será mostrada.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-262">After the Profile has been configured, the **Connection** tab will be shown.</span></span> <span data-ttu-id="5b7b7-263">Clique em **validar Conexão** para certificar-se de que as configurações estão corretas</span><span class="sxs-lookup"><span data-stu-id="5b7b7-263">Click **Validate Connection** to make sure that the settings are correct</span></span>

    ![Validar a conexão](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Connection.png)
6. <span data-ttu-id="5b7b7-265">Quando a conexão tiver sido validado, uma marca de seleção verde é mostrada ao lado de **validar Conexão** botão.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-265">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span> <span data-ttu-id="5b7b7-266">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-266">Click **Next**.</span></span>
  
    ![Conexão validada com êxito](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-SettingsValidated.png)
7. <span data-ttu-id="5b7b7-268">Abra o **cadeia de caracteres de conexão remota** lista suspensa sob **SchoolContext** e selecione a cadeia de caracteres de conexão para o banco de dados que você criou.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-268">Open the **Remote connection string** drop-down list under **SchoolContext** and select the connection string for the database you created.</span></span>
8. <span data-ttu-id="5b7b7-269">Selecione **Atualizar banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-269">Select **Update database**.</span></span>

    ![Guia Configurações](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Settings.png)

    <span data-ttu-id="5b7b7-271">Essa configuração faz com que o processo de implantação configurar automaticamente o aplicativo *Web. config* arquivo no servidor de destino, para que o Code First usa o `MigrateDatabaseToLatestVersion` a classe do inicializador.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-271">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>
9. <span data-ttu-id="5b7b7-272">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-272">Click **Next**.</span></span>
10. <span data-ttu-id="5b7b7-273">No **versão prévia** , clique em **iniciar visualização**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-273">In the **Preview** tab, click **Start Preview**.</span></span>
  
    ![Botão StartPreview na guia de visualização](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Preview.png)
  
    <span data-ttu-id="5b7b7-275">A guia exibe uma lista dos arquivos que serão copiados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-275">The tab displays a list of the files that will be copied to the server.</span></span> <span data-ttu-id="5b7b7-276">Exibir a visualização não é necessário para publicar o aplicativo, mas é uma função útil estar atento.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-276">Displaying the preview isn't required to publish the application but is a useful function to be aware of.</span></span> <span data-ttu-id="5b7b7-277">Nesse caso, você não precisa fazer nada com a lista de arquivos é exibida.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-277">In this case, you don't need to do anything with the list of files that is displayed.</span></span> <span data-ttu-id="5b7b7-278">Na próxima vez que você implantar esse aplicativo, somente os arquivos que foram alterados será nessa lista.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-278">The next time you deploy this application, only the files that have changed will be in this list.</span></span>
    <span data-ttu-id="5b7b7-279">![Saída do arquivo StartPreview](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-279">![StartPreview file output](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span></span>

11. <span data-ttu-id="5b7b7-280">Clique em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-280">Click **Publish**.</span></span>
    <span data-ttu-id="5b7b7-281">Visual Studio inicia o processo de copiar os arquivos para o servidor do Azure.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-281">Visual Studio begins the process of copying the files to the Azure server.</span></span>
12. <span data-ttu-id="5b7b7-282">O **saída** janela mostra quais ações de implantação foram executadas e relata a conclusão bem-sucedida da implantação.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-282">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span>
  
    ![Janela de saída do relatório de uma implantação bem-sucedida](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-BuildOutput.png)
13. <span data-ttu-id="5b7b7-284">Após a implantação bem-sucedida, o navegador padrão abre automaticamente a URL do site da web implantado.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-284">Upon successful deployment, the default browser automatically opens to the URL of the deployed web site.</span></span>
    <span data-ttu-id="5b7b7-285">O aplicativo que você criou agora está em execução na nuvem.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-285">The application you created is now running in the cloud.</span></span> 
  
    ![Students_index_page_with_paging](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Site.png)

<span data-ttu-id="5b7b7-287">Neste ponto seu *SchoolContext* banco de dados tenha sido criado no banco de dados SQL do Azure porque você selecionou **executar migrações do Code First (executado na inicialização do aplicativo)**.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-287">At this point your *SchoolContext* database has been created in the Azure SQL Database because you selected **Execute Code First Migrations (runs on app start)**.</span></span> <span data-ttu-id="5b7b7-288">O *Web. config* arquivo no site da web implantado foi alterado para que o [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) inicializador é executado na primeira vez em que seu código lê ou grava dados no banco de dados (o que aconteceu Quando você selecionou o **alunos** guia):</span><span class="sxs-lookup"><span data-stu-id="5b7b7-288">The *Web.config* file in the deployed web site has been changed so that the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer runs the first time your code reads or writes data in the database (which happened when you selected the **Students** tab):</span></span>

![](https://asp.net/media/4367421/mig.png)

<span data-ttu-id="5b7b7-289">Além disso, o processo de implantação criada uma nova cadeia de caracteres de conexão *(SchoolContext\_DatabasePublish*) para migrações do Code First a ser usado para atualizar o esquema de banco de dados e a propagação do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-289">The deployment process also created a new connection string *(SchoolContext\_DatabasePublish*) for Code First Migrations to use for updating the database schema and seeding the database.</span></span>

![Cadeia de caracteres de conexão Database_Publish](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image26.png)

<span data-ttu-id="5b7b7-291">Você pode encontrar a versão implantada do arquivo Web. config em seu próprio computador *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. Você pode acessar o implantado *Web. config* próprio arquivo por meio de FTP.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-291">You can find the deployed version of the Web.config file on your own computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. You can access the deployed *Web.config* file itself by using FTP.</span></span> <span data-ttu-id="5b7b7-292">Para obter instruções, consulte [implantação de Web do ASP.NET usando o Visual Studio: Implantando uma atualização de código](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-292">For instructions, see [ASP.NET Web Deployment using Visual Studio: Deploying a Code Update](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span></span> <span data-ttu-id="5b7b7-293">Siga as instruções que começam com "para usar uma ferramenta FTP, você precisa de três itens: a URL de FTP, o nome de usuário e a senha."</span><span class="sxs-lookup"><span data-stu-id="5b7b7-293">Follow the instructions that start with "To use an FTP tool, you need three things: the FTP URL, the user name, and the password."</span></span>

> [!NOTE]
> <span data-ttu-id="5b7b7-294">O aplicativo web não implementa a segurança, portanto, qualquer pessoa que encontre a URL pode alterar os dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-294">The web app doesn't implement security, so anyone who finds the URL can change the data.</span></span> <span data-ttu-id="5b7b7-295">Para obter instruções sobre como proteger o site da web, consulte [implantar um aplicativo ASP.NET MVC seguro com associação, OAuth e banco de dados SQL no Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-295">For instructions on how to secure the web site, see [Deploy a Secure ASP.NET MVC app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span> <span data-ttu-id="5b7b7-296">Você pode impedir que outras pessoas usando o site usando o Portal de gerenciamento ou **Gerenciador de servidores** no Visual Studio para parar o site.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-296">You can prevent other people from using the site by using the Azure Management Portal or **Server Explorer** in Visual Studio to stop the site.</span></span>


![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Stop-Service.png)

## <a name="advanced-migrations-scenarios"></a><span data-ttu-id="5b7b7-297">Cenários de migrações avançadas</span><span class="sxs-lookup"><span data-stu-id="5b7b7-297">Advanced Migrations Scenarios</span></span>

<span data-ttu-id="5b7b7-298">Se você implantar um banco de dados, executando migrações automaticamente, conforme mostrado neste tutorial, e você estiver implantando em um site da web que é executado em vários servidores, você poderia obter vários servidores tentando executar migrações ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-298">If you deploy a database by running migrations automatically as shown in this tutorial, and you are deploying to a web site that runs on multiple servers, you could get multiple servers trying to run migrations at the same time.</span></span> <span data-ttu-id="5b7b7-299">As migrações são atômicas, portanto, se dois servidores tentarem executar a migração do mesmo, um será bem-sucedida e o outro falhará (supondo que as operações não podem ser feitas de duas vezes).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-299">Migrations are atomic, so if two servers try to run the same migration, one will succeed and the other will fail (assuming the operations can't be done twice).</span></span> <span data-ttu-id="5b7b7-300">Nesse cenário para evitar esses problemas, você pode chamar migrações manualmente e definir seu próprio código para que ele ocorre apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-300">In that scenario if you want to avoid those issues, you can call migrations manually and set up your own code so that it only happens once.</span></span> <span data-ttu-id="5b7b7-301">Para obter mais informações, consulte [em execução e scripts de migrações de código](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) no blog de Rowan Miller e [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (para executar migrações a partir da linha de comando) no MSDN.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-301">For more information, see [Running and Scripting Migrations from Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) on Rowan Miller's blog and [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (for executing migrations from the command line) on MSDN.</span></span>

<span data-ttu-id="5b7b7-302">Para obter informações sobre outros cenários de migrações, consulte [a série Screencast migrações](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-302">For information about other migrations scenarios, see [Migrations Screencast Series](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span></span>

## <a name="code-first-initializers"></a><span data-ttu-id="5b7b7-303">Inicializadores de primeiro código</span><span class="sxs-lookup"><span data-stu-id="5b7b7-303">Code First Initializers</span></span>

<span data-ttu-id="5b7b7-304">Na seção de implantação que você viu a [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) inicializador que está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-304">In the deployment section you saw the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer being used.</span></span> <span data-ttu-id="5b7b7-305">Código pela primeira vez também fornece outros inicializadores, incluindo [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (o padrão), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (que você usou anteriormente) e [ DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-305">Code First also provides other initializers, including [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (the default), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (which you used earlier) and [DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span></span> <span data-ttu-id="5b7b7-306">O `DropCreateAlways` inicializador pode ser útil para configurar condições para testes de unidade.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-306">The `DropCreateAlways` initializer can be useful for setting up conditions for unit tests.</span></span> <span data-ttu-id="5b7b7-307">Você também pode escrever seus próprios inicializadores, e você pode chamar um inicializador explicitamente, se você não quiser esperar até que o aplicativo lê ou grava no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-307">You can also write your own initializers, and you can call an initializer explicitly if you don't want to wait until the application reads from or writes to the database.</span></span> <span data-ttu-id="5b7b7-308">No momento em que este tutorial está sendo gravado em novembro de 2013, você só pode usar os inicializadores de criar e DropCreate antes de habilitar as migrações.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-308">At the time this tutorial is being written in November, 2013, you can only use the Create and DropCreate initializers before you enable migrations.</span></span> <span data-ttu-id="5b7b7-309">Equipe do Entity Framework está trabalhando para tornar esses inicializadores utilizável com as migrações também.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-309">The Entity Framework team is working on making these initializers usable with migrations as well.</span></span>

<span data-ttu-id="5b7b7-310">Para obter mais informações sobre inicializadores, consulte [Noções básicas sobre inicializadores de banco de dados no Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) e o capítulo 6 do livro [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) de Julie Lerman e Rowan Miller.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-310">For more information about initializers, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) and chapter 6 of the book [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) by Julie Lerman and Rowan Miller.</span></span>

## <a name="summary"></a><span data-ttu-id="5b7b7-311">Resumo</span><span class="sxs-lookup"><span data-stu-id="5b7b7-311">Summary</span></span>

<span data-ttu-id="5b7b7-312">Neste tutorial, você viu como habilitar migrações e implantar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-312">In this tutorial you've seen how to enable migrations and deploy the application.</span></span> <span data-ttu-id="5b7b7-313">O próximo tutorial, você começará examinando tópicos mais avançados, expandindo o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-313">In the next tutorial you'll begin looking at more advanced topics by expanding the data model.</span></span>

<span data-ttu-id="5b7b7-314">Deixe comentários sobre como você gostou neste tutorial e o que poderíamos melhorar.</span><span class="sxs-lookup"><span data-stu-id="5b7b7-314">Please leave feedback on how you liked this tutorial and what we could improve.</span></span> <span data-ttu-id="5b7b7-315">Você também pode solicitar novos tópicos em [Mostrar-Me como com código](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-315">You can also request new topics at [Show Me How With Code](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span></span>

<span data-ttu-id="5b7b7-316">Links para outros recursos do Entity Framework pode ser encontrado na [acesso a dados ASP.NET – recursos recomendados](xref:whitepapers/aspnet-data-access-content-map).</span><span class="sxs-lookup"><span data-stu-id="5b7b7-316">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](xref:whitepapers/aspnet-data-access-content-map).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5b7b7-317">[Anterior](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
> [Próximo](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="5b7b7-317">[Previous](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Next](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span></span>
