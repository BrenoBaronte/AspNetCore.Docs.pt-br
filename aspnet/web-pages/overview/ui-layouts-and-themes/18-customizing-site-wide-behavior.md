---
uid: web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
title: Personalizar o comportamento de todo o Site para o ASP.NET Web Pages Sites (Razor) | Microsoft Docs
author: tfitzmac
description: "Este capítulo explica como fazer configurações para seu site inteiro ou uma pasta inteira, em vez de apenas uma página."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/17/2014
ms.topic: article
ms.assetid: e158bed7-226f-4275-b02e-7553bd58c669
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
msc.type: authoredcontent
ms.openlocfilehash: b1caa26a23517bd976addfefac89375ae965eb91
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/10/2017
---
<a name="customizing-site-wide-behavior-for-aspnet-web-pages-razor-sites"></a><span data-ttu-id="c56be-103">Personalizar o comportamento de todo o Site para Sites de páginas (Razor) da Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c56be-103">Customizing Site-Wide Behavior for ASP.NET Web Pages (Razor) Sites</span></span>
====================
<span data-ttu-id="c56be-104">por [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="c56be-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="c56be-105">Este artigo explica como fazer configurações de site para as páginas em um site de páginas da Web do ASP.NET (Razor).</span><span class="sxs-lookup"><span data-stu-id="c56be-105">This article explains how to make site-side settings for pages in an ASP.NET Web Pages (Razor) website.</span></span>
> 
> <span data-ttu-id="c56be-106">O que você aprenderá:</span><span class="sxs-lookup"><span data-stu-id="c56be-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="c56be-107">Como executar um código que lhe permite conjunto de valores (valores globais ou as configurações de auxiliar) para todas as páginas em um site.</span><span class="sxs-lookup"><span data-stu-id="c56be-107">How to run code that lets you set values (global values or helper settings) for all pages in a site.</span></span>
> - <span data-ttu-id="c56be-108">Como executar o código que permite que você defina valores para todas as páginas em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-108">How to run code that lets you set values for all pages in a folder.</span></span>
> - <span data-ttu-id="c56be-109">Como executar código antes e depois de uma página é carregado.</span><span class="sxs-lookup"><span data-stu-id="c56be-109">How to run code before and after a page loads.</span></span>
> - <span data-ttu-id="c56be-110">Como enviar erros para uma página de erro central.</span><span class="sxs-lookup"><span data-stu-id="c56be-110">How to send errors to a central error page.</span></span>
> - <span data-ttu-id="c56be-111">Como adicionar autenticação a todas as páginas em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-111">How to add authentication to all pages in a folder.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="c56be-112">Versões de software usadas no tutorial</span><span class="sxs-lookup"><span data-stu-id="c56be-112">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="c56be-113">Páginas da Web do ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="c56be-113">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="c56be-114">O WebMatrix 3</span><span class="sxs-lookup"><span data-stu-id="c56be-114">WebMatrix 3</span></span>
> - <span data-ttu-id="c56be-115">ASP.NET Web Helpers Library (pacote do NuGet)</span><span class="sxs-lookup"><span data-stu-id="c56be-115">ASP.NET Web Helpers Library (NuGet package)</span></span>
>   
> 
> <span data-ttu-id="c56be-116">Este tutorial também funciona com o ASP.NET Web Pages 3 e o Visual Studio 2013 (ou o Visual Studio Express 2013 para Web), exceto que você não pode usar o ASP.NET Web Helpers Library.</span><span class="sxs-lookup"><span data-stu-id="c56be-116">This tutorial also works with ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web), except you cannot use the ASP.NET Web Helpers Library.</span></span>


<a id="Adding_Website_Startup_Code"></a>
## <a name="adding-website-startup-code-for-aspnet-web-pages"></a><span data-ttu-id="c56be-117">Adicionando o código de inicialização do site para páginas da Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c56be-117">Adding Website Startup Code for ASP.NET Web Pages</span></span>

<span data-ttu-id="c56be-118">Para a maior parte do código que você escrever em páginas da Web do ASP.NET, uma página individual pode conter todo o código necessário para a página.</span><span class="sxs-lookup"><span data-stu-id="c56be-118">For much of the code that you write in ASP.NET Web Pages, an individual page can contain all the code that's required for that page.</span></span> <span data-ttu-id="c56be-119">Por exemplo, se uma página envia uma mensagem de email, é possível colocar todo o código para essa operação em uma única página.</span><span class="sxs-lookup"><span data-stu-id="c56be-119">For example, if a page sends an email message, it's possible to put all the code for that operation in a single page.</span></span> <span data-ttu-id="c56be-120">Isso pode incluir o código para inicializar as configurações para enviar email (ou seja, para o servidor SMTP) e para enviar a mensagem de email.</span><span class="sxs-lookup"><span data-stu-id="c56be-120">This can include the code to initialize the settings for sending email (that is, for the SMTP server) and for sending the email message.</span></span>

<span data-ttu-id="c56be-121">No entanto, em algumas situações, você talvez queira executar algum código antes de executa qualquer página no site.</span><span class="sxs-lookup"><span data-stu-id="c56be-121">However, in some situations, you might want to run some code before any page on the site runs.</span></span> <span data-ttu-id="c56be-122">Isso é útil para definir valores que podem ser usados em qualquer lugar no site (conhecido como *valores globais*.) Por exemplo, alguns auxiliares exigem que você forneça valores como configurações de email ou chaves de conta.</span><span class="sxs-lookup"><span data-stu-id="c56be-122">This is useful for setting values that can be used anywhere in the site (referred to as *global values*.) For example, some helpers require you to provide values like email settings or account keys.</span></span> <span data-ttu-id="c56be-123">Ele pode ser útil para manter essas configurações em valores globais.</span><span class="sxs-lookup"><span data-stu-id="c56be-123">It can be handy to keep these settings in global values.</span></span>

<span data-ttu-id="c56be-124">Você pode fazer isso criando uma página chamada  *\_AppStart.cshtml* na raiz do site.</span><span class="sxs-lookup"><span data-stu-id="c56be-124">You can do this by creating a page named *\_AppStart.cshtml* in the root of the site.</span></span> <span data-ttu-id="c56be-125">Se não houver essa página, ele é executado na primeira vez que qualquer página no site é solicitada.</span><span class="sxs-lookup"><span data-stu-id="c56be-125">If this page exists, it runs the first time any page in the site is requested.</span></span> <span data-ttu-id="c56be-126">Portanto, é um bom lugar para executar o código para definir os valores globais.</span><span class="sxs-lookup"><span data-stu-id="c56be-126">Therefore, it's a good place to run code to set global values.</span></span> <span data-ttu-id="c56be-127">(Como  *\_AppStart.cshtml* tem um prefixo de sublinhado, ASP.NET não enviará a página em um navegador, mesmo se os usuários solicitarem diretamente.)</span><span class="sxs-lookup"><span data-stu-id="c56be-127">(Because *\_AppStart.cshtml* has an underscore prefix, ASP.NET won't send the page to a browser even if users request it directly.)</span></span>

<span data-ttu-id="c56be-128">O diagrama a seguir mostra como o  *\_AppStart.cshtml* página funciona.</span><span class="sxs-lookup"><span data-stu-id="c56be-128">The following diagram shows how the *\_AppStart.cshtml* page works.</span></span> <span data-ttu-id="c56be-129">Quando chega uma solicitação para uma página, e se esta for a primeira solicitação para qualquer página no site, o ASP.NET primeiro verifica se um  *\_AppStart.cshtml* página existe.</span><span class="sxs-lookup"><span data-stu-id="c56be-129">When a request comes in for a page, and if this is the first request for any page in the site, ASP.NET first checks whether a *\_AppStart.cshtml* page exists.</span></span> <span data-ttu-id="c56be-130">Nesse caso, qualquer código de  *\_AppStart.cshtml* página é executado, e, em seguida, a página solicitada é executado.</span><span class="sxs-lookup"><span data-stu-id="c56be-130">If so, any code in the *\_AppStart.cshtml* page runs, and then the requested page runs.</span></span>

![[imagem]](18-customizing-site-wide-behavior/_static/image1.jpg)

## <a name="setting-global-values-for-your-website"></a><span data-ttu-id="c56be-132">Definindo valores globais para o seu site</span><span class="sxs-lookup"><span data-stu-id="c56be-132">Setting Global Values for Your Website</span></span>

1. <span data-ttu-id="c56be-133">Na pasta raiz de um site do WebMatrix, crie um arquivo chamado  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="c56be-133">In the root folder of a WebMatrix website, create a file named *\_AppStart.cshtml*.</span></span> <span data-ttu-id="c56be-134">O arquivo deve estar na raiz do site.</span><span class="sxs-lookup"><span data-stu-id="c56be-134">The file must be in the root of the site.</span></span>
2. <span data-ttu-id="c56be-135">Substitua o conteúdo existente com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-135">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample1.cshtml)]

    <span data-ttu-id="c56be-136">Esse código armazena um valor de `AppState` dicionário, que está disponível automaticamente para todas as páginas no site.</span><span class="sxs-lookup"><span data-stu-id="c56be-136">This code stores a value in the `AppState` dictionary, which is automatically available to all pages in the site.</span></span> <span data-ttu-id="c56be-137">Observe que o  *\_AppStart.cshtml* arquivo não tem qualquer marcação nele.</span><span class="sxs-lookup"><span data-stu-id="c56be-137">Notice that the *\_AppStart.cshtml* file does not have any markup in it.</span></span> <span data-ttu-id="c56be-138">A página executa o código e, em seguida, Redirecione para a página originalmente solicitada.</span><span class="sxs-lookup"><span data-stu-id="c56be-138">The page will run the code and then redirect to the page that was originally requested.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c56be-139">Tenha cuidado ao colocar o código no  *\_AppStart.cshtml* arquivo.</span><span class="sxs-lookup"><span data-stu-id="c56be-139">Be careful when you put code in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="c56be-140">Se ocorrerem erros no código do  *\_AppStart.cshtml* arquivo, o site não será iniciado.</span><span class="sxs-lookup"><span data-stu-id="c56be-140">If any errors occur in code in the *\_AppStart.cshtml* file, the website won't start.</span></span>
3. <span data-ttu-id="c56be-141">Na pasta raiz, crie uma nova página chamada *AppName.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="c56be-141">In the root folder, create a new page named *AppName.cshtml*.</span></span>
4. <span data-ttu-id="c56be-142">Substitua a marcação padrão e o código com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-142">Replace the default markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample2.html)]

    <span data-ttu-id="c56be-143">Esse código extrai o valor do `AppState` que podem ser definidas no objeto de  *\_AppStart.cshtml* página.</span><span class="sxs-lookup"><span data-stu-id="c56be-143">This code extracts the value from the `AppState` object that you set in the *\_AppStart.cshtml* page.</span></span>
5. <span data-ttu-id="c56be-144">Execute o *AppName.cshtml* página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-144">Run the *AppName.cshtml* page in a browser.</span></span> <span data-ttu-id="c56be-145">(Verifique se a página está selecionada no **arquivos** espaço de trabalho antes de você executá-lo.) A página exibe o valor global.</span><span class="sxs-lookup"><span data-stu-id="c56be-145">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays the global value.</span></span> 

    ![[imagem]](18-customizing-site-wide-behavior/_static/image2.jpg)

<a id="Setting_Values_For_Helpers"></a>
## <a name="setting-values-for-helpers"></a><span data-ttu-id="c56be-147">Valores de configuração para os auxiliares</span><span class="sxs-lookup"><span data-stu-id="c56be-147">Setting Values for Helpers</span></span>

<span data-ttu-id="c56be-148">Um bom uso para o  *\_AppStart.cshtml* arquivo é definir valores para os auxiliares que podem ser usadas em seu site e que precisam ser inicializados.</span><span class="sxs-lookup"><span data-stu-id="c56be-148">A good use for the *\_AppStart.cshtml* file is to set values for helpers that you use in your site and that have to be initialized.</span></span> <span data-ttu-id="c56be-149">Exemplos comuns são as configurações de email para o `WebMail` auxiliar e as chaves públicas e privadas para o `ReCaptcha` auxiliar.</span><span class="sxs-lookup"><span data-stu-id="c56be-149">Typical examples are email settings for the `WebMail` helper and the private and public keys for the `ReCaptcha` helper.</span></span> <span data-ttu-id="c56be-150">Em casos assim, você pode definir os valores de uma vez no  *\_AppStart.cshtml* e, em seguida, eles são já definidos para todas as páginas em seu site.</span><span class="sxs-lookup"><span data-stu-id="c56be-150">In cases like these, you can set the values once in the *\_AppStart.cshtml* and then they're already set for all the pages in your site.</span></span>

<span data-ttu-id="c56be-151">Este procedimento mostra como definir `WebMail` configurações globalmente.</span><span class="sxs-lookup"><span data-stu-id="c56be-151">This procedure shows you how to set `WebMail` settings globally.</span></span> <span data-ttu-id="c56be-152">(Para obter mais informações sobre como usar o `WebMail` auxiliar, consulte [Email adicionando a um Site de páginas da Web ASP.NET](../getting-started/11-adding-email-to-your-web-site.md).)</span><span class="sxs-lookup"><span data-stu-id="c56be-152">(For more information about using the `WebMail` helper, see [Adding Email to an ASP.NET Web Pages Site](../getting-started/11-adding-email-to-your-web-site.md).)</span></span>

1. <span data-ttu-id="c56be-153">Adicionar o ASP.NET Web Helpers Library ao seu site, conforme descrito em [auxiliares instalando em um Site de páginas da Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=252372), se você ainda não tenha adicionado.</span><span class="sxs-lookup"><span data-stu-id="c56be-153">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already added it.</span></span>
2. <span data-ttu-id="c56be-154">Se você ainda não tiver um  *\_AppStart.cshtml* de arquivo, na pasta raiz de um site, crie um arquivo chamado  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="c56be-154">If you don't already have a *\_AppStart.cshtml* file, in the root folder of a website create a file named *\_AppStart.cshtml*.</span></span>
3. <span data-ttu-id="c56be-155">Adicione o seguinte `WebMail` configurações para o  *\_AppStart.cshtml* arquivo:</span><span class="sxs-lookup"><span data-stu-id="c56be-155">Add the following `WebMail` settings to the *\_AppStart.cshtml* file:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample3.cshtml?highlight=2-7)]

    <span data-ttu-id="c56be-156">Modificar configurações relacionadas no código de email a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-156">Modify the following email related settings in the code:</span></span>

    - <span data-ttu-id="c56be-157">Defina `your-SMTP-host` para o nome do servidor SMTP que você tem acesso ao.</span><span class="sxs-lookup"><span data-stu-id="c56be-157">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
    - <span data-ttu-id="c56be-158">Defina `your-user-name-here` para o nome de usuário para sua conta do servidor SMTP.</span><span class="sxs-lookup"><span data-stu-id="c56be-158">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
    - <span data-ttu-id="c56be-159">Definir `your-account-password` para a senha de sua conta do servidor SMTP.</span><span class="sxs-lookup"><span data-stu-id="c56be-159">Set `your-account-password` to the password for your SMTP server account.</span></span>
    - <span data-ttu-id="c56be-160">Definir `your-email-address-here` para seu próprio endereço de email.</span><span class="sxs-lookup"><span data-stu-id="c56be-160">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="c56be-161">Este é o endereço de email que a mensagem é enviada.</span><span class="sxs-lookup"><span data-stu-id="c56be-161">This is the email address that the message is sent from.</span></span> <span data-ttu-id="c56be-162">(Alguns provedores de email não permitem que você especifique outro `From` endereço e usará o nome de usuário como o `From` endereço.)</span><span class="sxs-lookup"><span data-stu-id="c56be-162">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

    <span data-ttu-id="c56be-163">Para obter mais informações sobre as configurações de SMTP, consulte [definindo as configurações de Email](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) no artigo [Enviar Email de um Site de páginas da Web do ASP.NET (Razor)](https://go.microsoft.com/fwlink/?LinkID=202899) e [problemas com o envio de Email](https://go.microsoft.com/fwlink/?LinkId=253001#email)no [(Razor) guia de solução de problemas de páginas da Web do ASP.NET](https://go.microsoft.com/fwlink/?LinkId=253001).</span><span class="sxs-lookup"><span data-stu-id="c56be-163">For more information about SMTP settings, see [Configuring Email Settings](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) in the article [Sending Email from an ASP.NET Web Pages (Razor) Site](https://go.microsoft.com/fwlink/?LinkID=202899) and [Issues with Sending Email](https://go.microsoft.com/fwlink/?LinkId=253001#email) in the [ASP.NET Web Pages (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span></span>
- <span data-ttu-id="c56be-164">Salve o  *\_AppStart.cshtml* de arquivo e fechá-la.</span><span class="sxs-lookup"><span data-stu-id="c56be-164">Save the *\_AppStart.cshtml* file and close it.</span></span>
- <span data-ttu-id="c56be-165">Na pasta raiz de um site, crie a nova página chamada *TestEmail.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="c56be-165">In the root folder of a website, create new page named *TestEmail.cshtml*.</span></span>
- <span data-ttu-id="c56be-166">Substitua o conteúdo existente com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-166">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample4.cshtml)]
- <span data-ttu-id="c56be-167">Execute o *TestEmail.cshtml* página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-167">Run the *TestEmail.cshtml* page in a browser.</span></span>
- <span data-ttu-id="c56be-168">Preencha os campos para enviar uma mensagem de email e, em seguida, clique em **enviar**.</span><span class="sxs-lookup"><span data-stu-id="c56be-168">Fill in the fields to send yourself an email message and then click **Send**.</span></span>
- <span data-ttu-id="c56be-169">Verifique seu email para verificar se que você tiver chegado a mensagem.</span><span class="sxs-lookup"><span data-stu-id="c56be-169">Check your email to make sure you've gotten the message.</span></span>

<span data-ttu-id="c56be-170">A parte importante deste exemplo é que as configurações que você normalmente não são alterados — como o nome do servidor SMTP e suas credenciais de email — são definidas no  *\_AppStart.cshtml* arquivo.</span><span class="sxs-lookup"><span data-stu-id="c56be-170">The important part of this example is that the settings that you don't usually change — like the name of your SMTP server and your email credentials — are set in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="c56be-171">Dessa forma, que não é necessário defini-las novamente em cada página para onde enviar o email.</span><span class="sxs-lookup"><span data-stu-id="c56be-171">That way you don't need to set them again in each page where you send email.</span></span> <span data-ttu-id="c56be-172">(Embora se por algum motivo, você precisa alterar essas configurações, você pode defini-las individualmente em uma página.) Na página, você apenas definir os valores que normalmente mudar cada vez, como o destinatário e o corpo da mensagem de email.</span><span class="sxs-lookup"><span data-stu-id="c56be-172">(Although if for some reason you need to change those settings, you can set them individually in a page.) In the page, you only set the values that typically change each time, like the recipient and the body of the email message.</span></span>

<a id="Running_Code_Before_and_After"></a>
## <a name="running-code-before-and-after-files-in-a-folder"></a><span data-ttu-id="c56be-173">Executar código antes e depois de arquivos em uma pasta</span><span class="sxs-lookup"><span data-stu-id="c56be-173">Running Code Before and After Files in a Folder</span></span>

<span data-ttu-id="c56be-174">Assim como você pode usar  *\_AppStart.cshtml* para escrever código antes de executam páginas no site, você pode escrever código que é executado antes (e depois) qualquer página em uma pasta específica de execução.</span><span class="sxs-lookup"><span data-stu-id="c56be-174">Just like you can use *\_AppStart.cshtml* to write code before pages in the site run, you can write code that runs before (and after) any page in a particular folder run.</span></span> <span data-ttu-id="c56be-175">Isso é útil para coisas como configurar a mesma página de layout para todas as páginas em uma pasta, ou para a verificação de que um usuário está conectado antes de executar uma página na pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-175">This is useful for things like setting the same layout page for all the pages in a folder, or for checking that a user is logged in before running a page in the folder.</span></span>

<span data-ttu-id="c56be-176">Para as páginas em particular pastas, você pode criar código em um arquivo chamado  *\_Pagestart*.</span><span class="sxs-lookup"><span data-stu-id="c56be-176">For pages in particular folders, you can create code in a file named *\_PageStart.cshtml*.</span></span> <span data-ttu-id="c56be-177">O diagrama a seguir mostra como o  *\_Pagestart* página funciona.</span><span class="sxs-lookup"><span data-stu-id="c56be-177">The following diagram shows how the *\_PageStart.cshtml* page works.</span></span> <span data-ttu-id="c56be-178">Quando uma solicitação chega para uma página, o ASP.NET verifica primeiro para um  *\_AppStart.cshtml* executa que e página.</span><span class="sxs-lookup"><span data-stu-id="c56be-178">When a request comes in for a page, ASP.NET first checks for a *\_AppStart.cshtml* page and runs that.</span></span> <span data-ttu-id="c56be-179">Em seguida, o ASP.NET verifica se há um  *\_Pagestart* página e, nesse caso, executa que.</span><span class="sxs-lookup"><span data-stu-id="c56be-179">Then ASP.NET checks whether there's a *\_PageStart.cshtml* page, and if so, runs that.</span></span> <span data-ttu-id="c56be-180">Ele é executado, em seguida, a página solicitada.</span><span class="sxs-lookup"><span data-stu-id="c56be-180">It then runs the requested page.</span></span>

<span data-ttu-id="c56be-181">Dentro de  *\_Pagestart* página, você pode especificar onde durante processamento que você deseja que a página solicitada a execução, incluindo um `RunPage` método.</span><span class="sxs-lookup"><span data-stu-id="c56be-181">Inside the *\_PageStart.cshtml* page, you can specify where during processing you want the requested page to run by including a `RunPage` method.</span></span> <span data-ttu-id="c56be-182">Isso permite executar código antes de executa a página solicitada e, em seguida, novamente depois.</span><span class="sxs-lookup"><span data-stu-id="c56be-182">This lets you run code before the requested page runs and then again after it.</span></span> <span data-ttu-id="c56be-183">Se você não incluir `RunPage`, todo o código em  *\_Pagestart* é executado e, em seguida, a página solicitada é executado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c56be-183">If you don't include `RunPage`, all the code in *\_PageStart.cshtml* runs, and then the requested page runs automatically.</span></span>

![[imagem]](18-customizing-site-wide-behavior/_static/image3.jpg)

<span data-ttu-id="c56be-185">ASP.NET permite que você crie uma hierarquia de  *\_Pagestart* arquivos.</span><span class="sxs-lookup"><span data-stu-id="c56be-185">ASP.NET lets you create a hierarchy of *\_PageStart.cshtml* files.</span></span> <span data-ttu-id="c56be-186">Você pode colocar um  *\_Pagestart* arquivo na raiz do site e em qualquer subpasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-186">You can put a *\_PageStart.cshtml* file in the root of the site and in any subfolder.</span></span> <span data-ttu-id="c56be-187">Quando uma página é solicitada, o  *\_Pagestart* arquivo em que a execução de nível superior (mais próximos a raiz do site), seguido de  *\_Pagestart* arquivo na próxima subpasta, e assim por diante na estrutura de subpasta até que a solicitação atinja a pasta que contém a página solicitada.</span><span class="sxs-lookup"><span data-stu-id="c56be-187">When a page is requested, the *\_PageStart.cshtml* file at the top-most level (nearest to the site root) runs, followed by the *\_PageStart.cshtml* file in the next subfolder, and so on down the subfolder structure until the request reaches the folder that contains the requested page.</span></span> <span data-ttu-id="c56be-188">Após todos os aplicável  *\_Pagestart* arquivos tem executado, a página solicitada é executada.</span><span class="sxs-lookup"><span data-stu-id="c56be-188">After all the applicable *\_PageStart.cshtml* files have run, the requested page runs.</span></span>

<span data-ttu-id="c56be-189">Por exemplo, você pode ter a seguinte combinação de  *\_Pagestart* arquivos e *cshtml* arquivo:</span><span class="sxs-lookup"><span data-stu-id="c56be-189">For example, you might have the following combination of *\_PageStart.cshtml* files and *Default.cshtml* file:</span></span>

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample5.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample6.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample7.cshtml)]

<span data-ttu-id="c56be-190">Quando você executa */myfolder/default.cshtml*, você verá o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-190">When you run */myfolder/default.cshtml*, you'll see the following:</span></span>

[!code-console[Main](18-customizing-site-wide-behavior/samples/sample8.cmd)]

## <a name="running-initialization-code-for-all-pages-in-a-folder"></a><span data-ttu-id="c56be-191">Executando o código de inicialização para todas as páginas em uma pasta</span><span class="sxs-lookup"><span data-stu-id="c56be-191">Running Initialization Code for All Pages in a Folder</span></span>

<span data-ttu-id="c56be-192">Um bom uso  *\_Pagestart* de arquivos é a mesma página de layout para todos os arquivos em uma única pasta de inicialização.</span><span class="sxs-lookup"><span data-stu-id="c56be-192">A good use for *\_PageStart.cshtml* files is to initialize the same layout page for all files in a single folder.</span></span>

1. <span data-ttu-id="c56be-193">Na pasta raiz, crie uma nova pasta chamada *InitPages*.</span><span class="sxs-lookup"><span data-stu-id="c56be-193">In the root folder, create a new folder named *InitPages*.</span></span>
2. <span data-ttu-id="c56be-194">No *InitPages* pasta do seu site, crie um arquivo chamado  *\_Pagestart* e substitua a marcação padrão e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-194">In the *InitPages* folder of your website, create a file named *\_PageStart.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample9.cshtml)]
3. <span data-ttu-id="c56be-195">Na raiz do site, crie uma pasta chamada *compartilhado*.</span><span class="sxs-lookup"><span data-stu-id="c56be-195">In the root of the website, create a folder named *Shared*.</span></span>
4. <span data-ttu-id="c56be-196">No *compartilhado* pasta, crie um arquivo chamado  *\_Layout1.cshtml* e substitua a marcação padrão e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-196">In the *Shared* folder, create a file named *\_Layout1.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample10.cshtml)]
5. <span data-ttu-id="c56be-197">No *InitPages* pasta, crie um arquivo chamado *Content1.cshtml* e substitua o conteúdo existente pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-197">In the *InitPages* folder, create a file named *Content1.cshtml* and replace the existing content with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample11.html)]
6. <span data-ttu-id="c56be-198">No *InitPages* pasta, criar outro arquivo chamado *Content2.cshtml* e substitua a marcação padrão pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-198">In the *InitPages* folder, create another file named *Content2.cshtml* and replace the default markup with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample12.html)]
7. <span data-ttu-id="c56be-199">Executar *Content1.cshtml* em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-199">Run *Content1.cshtml* in a browser.</span></span> 

    ![[imagem]](18-customizing-site-wide-behavior/_static/image4.jpg)

    <span data-ttu-id="c56be-201">Quando o *Content1.cshtml* página é executado, o  *\_Pagestart* conjuntos de arquivos `Layout` e também define `PageData["MyBackground"]` como uma cor.</span><span class="sxs-lookup"><span data-stu-id="c56be-201">When the *Content1.cshtml* page runs, the *\_PageStart.cshtml* file sets `Layout` and also sets `PageData["MyBackground"]` to a color.</span></span> <span data-ttu-id="c56be-202">Em *Content1.cshtml*, o layout e cores são aplicadas.</span><span class="sxs-lookup"><span data-stu-id="c56be-202">In *Content1.cshtml*, the layout and color are applied.</span></span>
8. <span data-ttu-id="c56be-203">Exibição *Content2.cshtml* em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-203">Display *Content2.cshtml* in a browser.</span></span> 

    <span data-ttu-id="c56be-204">O layout é o mesmo, porque as duas páginas usam a mesma página de layout e cores como inicializado em  *\_Pagestart*.</span><span class="sxs-lookup"><span data-stu-id="c56be-204">The layout is the same, because both pages use the same layout page and color as initialized in *\_PageStart.cshtml*.</span></span>

## <a name="using-pagestartcshtml-to-handle-errors"></a><span data-ttu-id="c56be-205">Usando \_Pagestart para lidar com erros</span><span class="sxs-lookup"><span data-stu-id="c56be-205">Using \_PageStart.cshtml to Handle Errors</span></span>

<span data-ttu-id="c56be-206">Use outro bom para o  *\_Pagestart* arquivo é criar uma maneira de lidar com erros de programação (exceções) que podem ocorrer em qualquer *. cshtml* página em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-206">Another good use for the *\_PageStart.cshtml* file is to create a way to handle programming errors (exceptions) that might occur in any *.cshtml* page in a folder.</span></span> <span data-ttu-id="c56be-207">Este exemplo mostra uma maneira de fazer isso.</span><span class="sxs-lookup"><span data-stu-id="c56be-207">This example shows you one way to do this.</span></span>

1. <span data-ttu-id="c56be-208">Na pasta raiz, crie uma pasta chamada *InitCatch*.</span><span class="sxs-lookup"><span data-stu-id="c56be-208">In the root folder, create a folder named *InitCatch*.</span></span>
2. <span data-ttu-id="c56be-209">No *InitCatch* pasta do seu site, crie um arquivo chamado  *\_Pagestart* e substitua a marcação existente e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-209">In the *InitCatch* folder of your website, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample13.cshtml)]

    <span data-ttu-id="c56be-210">Nesse código, tente executar a página solicitada explicitamente chamando o `RunPage` método dentro de um `try` bloco.</span><span class="sxs-lookup"><span data-stu-id="c56be-210">In this code, you try running the requested page explicitly by calling the `RunPage` method inside a `try` block.</span></span> <span data-ttu-id="c56be-211">Se ocorrer algum erro de programação em que a solicitação de página, o código dentro do `catch` bloco é executado.</span><span class="sxs-lookup"><span data-stu-id="c56be-211">If any programming errors occur in the requested page, the code inside the `catch` block runs.</span></span> <span data-ttu-id="c56be-212">Nesse caso, o código redireciona para uma página (*Error.cshtml*) e passa o nome do arquivo que ocorreu o erro como parte da URL.</span><span class="sxs-lookup"><span data-stu-id="c56be-212">In this case, the code redirects to a page (*Error.cshtml*) and passes the name of the file that experienced the error as part of the URL.</span></span> <span data-ttu-id="c56be-213">(Você criará a página em breve.)</span><span class="sxs-lookup"><span data-stu-id="c56be-213">(You'll create the page shortly.)</span></span>
3. <span data-ttu-id="c56be-214">No *InitCatch* pasta do seu site, crie um arquivo chamado *Exception.cshtml* e substitua a marcação existente e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-214">In the *InitCatch* folder of your website, create a file named *Exception.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample14.cshtml)]

    <span data-ttu-id="c56be-215">Para fins deste exemplo, o que você está fazendo nesta página é deliberadamente criando um erro ao tentar abrir um arquivo de banco de dados que não existe.</span><span class="sxs-lookup"><span data-stu-id="c56be-215">For purposes of this example, what you're doing in this page is deliberately creating an error by trying to open a database file that doesn't exist.</span></span>
4. <span data-ttu-id="c56be-216">Na pasta raiz, crie um arquivo chamado *Error.cshtml* e substitua a marcação existente e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-216">In the root folder, create a file named *Error.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample15.html)]

    <span data-ttu-id="c56be-217">Nesta página, a expressão `@Request["source"]` obtém o valor da URL e o exibe.</span><span class="sxs-lookup"><span data-stu-id="c56be-217">In this page, the expression `@Request["source"]` gets the value out of the URL and displays it.</span></span>
5. <span data-ttu-id="c56be-218">Na barra de ferramentas, clique em **salvar**.</span><span class="sxs-lookup"><span data-stu-id="c56be-218">In the toolbar, click **Save**.</span></span>
6. <span data-ttu-id="c56be-219">Executar *Exception.cshtml* em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-219">Run *Exception.cshtml* in a browser.</span></span> 

    ![[imagem]](18-customizing-site-wide-behavior/_static/image5.jpg)

    <span data-ttu-id="c56be-221">Porque ocorre um erro em *Exception.cshtml*, o  *\_Pagestart* redirecionamentos de página para o *Error.cshtml* arquivo, que exibe a mensagem.</span><span class="sxs-lookup"><span data-stu-id="c56be-221">Because an error occurs in *Exception.cshtml*, the *\_PageStart.cshtml* page redirects to the *Error.cshtml* file, which displays the message.</span></span>

    <span data-ttu-id="c56be-222">Para obter mais informações sobre exceções, consulte [Introdução ao ASP.NET páginas da Web de programação usando a sintaxe do Razor](https://go.microsoft.com/fwlink/?LinkID=251587).</span><span class="sxs-lookup"><span data-stu-id="c56be-222">For more information about exceptions, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587).</span></span>

<a id="Using__PageStart.cshtml_to_Restrict_Folder_Access"></a>
## <a name="using-pagestartcshtml-to-restrict-folder-access"></a><span data-ttu-id="c56be-223">Usando \_Pagestart para restringir o acesso à pasta</span><span class="sxs-lookup"><span data-stu-id="c56be-223">Using \_PageStart.cshtml to Restrict Folder Access</span></span>

<span data-ttu-id="c56be-224">Você também pode usar o  *\_Pagestart* arquivo para restringir o acesso a todos os arquivos em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-224">You can also use the *\_PageStart.cshtml* file to restrict access to all the files in a folder.</span></span>

1. <span data-ttu-id="c56be-225">No WebMatrix, crie um novo site usando o **Site a partir do modelo** opção.</span><span class="sxs-lookup"><span data-stu-id="c56be-225">In WebMatrix, create a new website using the **Site From Template** option.</span></span>
2. <span data-ttu-id="c56be-226">Os modelos disponíveis, selecione **Site inicial**.</span><span class="sxs-lookup"><span data-stu-id="c56be-226">From the available templates, select **Starter Site**.</span></span>
3. <span data-ttu-id="c56be-227">Na pasta raiz, crie uma pasta chamada *AuthenticatedContent*.</span><span class="sxs-lookup"><span data-stu-id="c56be-227">In the root folder, create a folder named *AuthenticatedContent*.</span></span>
4. <span data-ttu-id="c56be-228">No *AuthenticatedContent* pasta, crie um arquivo chamado  *\_Pagestart* e substitua a marcação existente e o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c56be-228">In the *AuthenticatedContent* folder, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample16.cshtml)]

    <span data-ttu-id="c56be-229">O código começa, impedindo que todos os arquivos na pasta que está sendo armazenado em cache.</span><span class="sxs-lookup"><span data-stu-id="c56be-229">The code starts by preventing all files in the folder from being cached.</span></span> <span data-ttu-id="c56be-230">(Isso é necessário para cenários como computadores públicos, onde você não deseja páginas armazenadas em cache de um usuário esteja disponível para o próximo usuário.) Em seguida, o código determina se o usuário tem conectado ao site antes que possam exibir qualquer uma das páginas na pasta.</span><span class="sxs-lookup"><span data-stu-id="c56be-230">(This is required for scenarios like public computers, where you don't want one user's cached pages to be available to the next user.) Next, the code determines whether the user has signed in to the site before they can view any of the pages in the folder.</span></span> <span data-ttu-id="c56be-231">Se o usuário não está conectado, o código redireciona para a página de logon.</span><span class="sxs-lookup"><span data-stu-id="c56be-231">If the user is not signed in, the code redirects to the login page.</span></span> <span data-ttu-id="c56be-232">A página de logon pode retornar o usuário para a página originalmente solicitada se você incluir um valor de cadeia de caracteres de consulta chamado `ReturnUrl`.</span><span class="sxs-lookup"><span data-stu-id="c56be-232">The login page can return the user to the page that was originally requested if you include a query string value named `ReturnUrl`.</span></span>
5. <span data-ttu-id="c56be-233">Criar uma nova página no *AuthenticatedContent* pasta denominada *Page.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="c56be-233">Create a new page in the *AuthenticatedContent* folder named *Page.cshtml*.</span></span>
6. <span data-ttu-id="c56be-234">Substitua a marcação padrão pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="c56be-234">Replace the default markup with the following:</span></span>  

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample17.cshtml)]
7. <span data-ttu-id="c56be-235">Executar *Page.cshtml* em um navegador.</span><span class="sxs-lookup"><span data-stu-id="c56be-235">Run *Page.cshtml* in a browser.</span></span> <span data-ttu-id="c56be-236">O código redireciona para uma página de logon.</span><span class="sxs-lookup"><span data-stu-id="c56be-236">The code redirects you to a login page.</span></span> <span data-ttu-id="c56be-237">Você deve registrar antes de efetuar login.</span><span class="sxs-lookup"><span data-stu-id="c56be-237">You must register before logging in.</span></span> <span data-ttu-id="c56be-238">Depois de registrado e conectado, você pode navegar até a página e exibir seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="c56be-238">After you've registered and logged in, you can navigate to the page and view its contents.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="c56be-239">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="c56be-239">Additional Resources</span></span>

[<span data-ttu-id="c56be-240">Introdução a páginas da Web ASP.NET usando a sintaxe do Razor de programação</span><span class="sxs-lookup"><span data-stu-id="c56be-240">Introduction to ASP.NET Web Pages Programming Using the Razor Syntax</span></span>](https://go.microsoft.com/fwlink/?LinkID=251587)
