---
uid: visual-studio/overview/2012/windows-azure-authentication
title: "Windows autenticação do Azure | Microsoft Docs"
author: Rick-Anderson
description: "Ferramentas do Microsoft ASP.NET para Windows Azure Active Directory torna simples a habilitar a autenticação para aplicativos web hospedados no Windows Azure Web Sites..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2013
ms.topic: article
ms.assetid: a3cef801-a54b-4ebd-93c3-55764e2e14b1
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /visual-studio/overview/2012/windows-azure-authentication
msc.type: authoredcontent
ms.openlocfilehash: 4deb3536699f1ef3025f8858ee71a76a1c2def18
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/24/2018
---
<a name="windows-azure-authentication"></a><span data-ttu-id="1aa53-103">Windows autenticação do Azure</span><span class="sxs-lookup"><span data-stu-id="1aa53-103">Windows Azure Authentication</span></span>
====================
<span data-ttu-id="1aa53-104">Por [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="1aa53-104">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="1aa53-105">Ferramentas de Microsoft ASP.NET para Windows Azure Active Directory torna simples para habilitar a autenticação para aplicativos web hospedados no [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="1aa53-105">Microsoft ASP.NET tools for Windows Azure Active Directory makes it simple to enable authentication for web applications hosted on [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="1aa53-106">Você pode usar a autenticação do Windows Azure para autenticar usuários do Office 365 da sua organização, as contas corporativas sincronizadas do Active Directory local ou os usuários criados no seu próprio domínio personalizado do Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1aa53-106">You can use Windows Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Windows Azure Active Directory domain.</span></span> <span data-ttu-id="1aa53-107">Habilitar a autenticação do Windows Azure configura seu aplicativo para autenticar usuários usando uma única [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) locatário.</span><span class="sxs-lookup"><span data-stu-id="1aa53-107">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
> 
> <span data-ttu-id="1aa53-108">Não há suporte para a ferramenta de autenticação do Windows Azure do ASP.NET para funções web em um serviço de nuvem, mas estamos planejando fazer isso em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="1aa53-108">The ASP.NET Windows Azure Authentication tool is not supported for web roles in a cloud service but we plan to do so in a future release.</span></span> <span data-ttu-id="1aa53-109">[O Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) é suportado em funções da web do Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="1aa53-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) is supported in Windows Azure web roles.</span></span>
> 
> <span data-ttu-id="1aa53-110">Para obter detalhes sobre como configurar a sincronização entre o Active Directory no local e seu locatário do Active Directory do Windows Azure, consulte [usar o AD FS 2.0 para implementar e gerenciar o logon único](https://technet.microsoft.com/library/jj205462.aspx).</span><span class="sxs-lookup"><span data-stu-id="1aa53-110">For details on how to setup synchronization between your on-premise Active Directory and your Windows Azure Active Directory tenant please see [Use AD FS 2.0 to implement and manage single sign-on](https://technet.microsoft.com/library/jj205462.aspx).</span></span>
> 
> <span data-ttu-id="1aa53-111">Windows Azure Active Directory está disponível como um [visualização serviço gratuito](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="1aa53-111">Windows Azure Active Directory is currently available as a [free preview service](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>


## <a name="requirements"></a><span data-ttu-id="1aa53-112">Requisitos:</span><span class="sxs-lookup"><span data-stu-id="1aa53-112">Requirements:</span></span>

- <span data-ttu-id="1aa53-113">O Visual Studio 2012 ou [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span><span class="sxs-lookup"><span data-stu-id="1aa53-113">Visual Studio 2012 or [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span></span>
- <span data-ttu-id="1aa53-114">[Extensões para o Visual Studio 2012 de ferramentas do Web](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) ou [extensões de ferramentas da Web para o Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="1aa53-114">[Web Tools Extensions for Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) or [Web Tools Extensions for Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span></span>
- <span data-ttu-id="1aa53-115">[Ferramentas do Microsoft ASP.NET para Windows Active Directory do Azure – o Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) ou [ferramentas Microsoft ASP.NET para Windows Azure Active Directory do Visual Studio Express 2012 para Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span><span class="sxs-lookup"><span data-stu-id="1aa53-115">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) or [Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio Express 2012 for Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span></span>

## <a name="create-an-aspnet-web-application-with-visual-studio-2012"></a><span data-ttu-id="1aa53-116">Criar um aplicativo Web ASP.NET com o Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="1aa53-116">Create an ASP.NET Web Application with Visual Studio 2012</span></span>

<span data-ttu-id="1aa53-117">Você pode criar qualquer aplicativo da Web com o Visual Studio 2012, este tutorial usa o modelo de intranet ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="1aa53-117">You can create any Web Application with Visual Studio 2012, this tutorial uses the ASP.NET MVC intranet template.</span></span>

1. <span data-ttu-id="1aa53-118">Criar um novo aplicativo ASP.NET MVC 4 Intranet e aceite todos os padrões.</span><span class="sxs-lookup"><span data-stu-id="1aa53-118">Create a new ASP.NET MVC 4 Intranet Application and accept all the defaults.</span></span> <span data-ttu-id="1aa53-119">(Deve ser um In **Traversal** net e não no **igite** net projeto).</span><span class="sxs-lookup"><span data-stu-id="1aa53-119">(It must be an In **tra** net and not In **ter** net project).</span></span>  
     ![](windows-azure-authentication/_static/image1.png)

## <a name="enable-window-azure-authentication-when-you-are-a-global-administrator-of-the-tenet"></a><span data-ttu-id="1aa53-120">Habilitar a autenticação do Windows Azure (quando você for um Administrador Global da filosofia)</span><span class="sxs-lookup"><span data-stu-id="1aa53-120">Enable Window Azure Authentication (When you are a Global Administrator of the Tenet)</span></span>

<span data-ttu-id="1aa53-121">Se você não tiver um locatário existente do Windows Azure Active Directory (por exemplo, por meio de uma conta existente do Office 365) você pode criar um novo locatário inscrevendo um [nova conta do Windows Azure Active Directory](http://g.microsoftonline.com/0AX00en/5).</span><span class="sxs-lookup"><span data-stu-id="1aa53-121">If you do not have an existing Windows Azure Active Directory tenant (For example, through an existing Office 365 account) you can create a new tenant by signing up for a [new Windows Azure Active Directory account](http://g.microsoftonline.com/0AX00en/5).</span></span>

1. <span data-ttu-id="1aa53-122">No menu projeto, selecione **habilitar a autenticação do Windows Azure**:</span><span class="sxs-lookup"><span data-stu-id="1aa53-122">From the Project menu select **Enable Windows Azure Authentication**:</span></span>  
  
 ![](windows-azure-authentication/_static/image2.png)

2. <span data-ttu-id="1aa53-123">Digite o domínio para seu locatário do Windows Azure Active Directory (por exemplo, contoso.onmicrosoft.com) e clique em **habilitar**:</span><span class="sxs-lookup"><span data-stu-id="1aa53-123">Enter the domain for your Windows Azure Active Directory tenant (for example, contoso.onmicrosoft.com) and click **Enable**:</span></span>

![](windows-azure-authentication/_static/image3.png)

3. <span data-ttu-id="1aa53-124">Em que a autenticação da Web diálogo entrar como um administrador para seu locatário do Active Directory do Windows Azure:</span><span class="sxs-lookup"><span data-stu-id="1aa53-124">In the Web Authentication dialog sign in as an administrator for your Windows Azure Active Directory tenant:</span></span>  
  
 ![](windows-azure-authentication/_static/image4.png)

![](windows-azure-authentication/_static/image5.png)

## <a name="enable-window-azure-by-a-non-administrator-of-the-tenet"></a><span data-ttu-id="1aa53-125">Habilitar o Windows Azure por um não administrador do princípio</span><span class="sxs-lookup"><span data-stu-id="1aa53-125">Enable Window Azure by a non-administrator of the Tenet</span></span>

<span data-ttu-id="1aa53-126">Se você não tem privilégios de Administrador Global para seu locatário do Active Directory do Windows Azure, você pode desmarcar a caixa de seleção para provisionamento do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1aa53-126">If you do not have Global Administrator privilege for your Windows Azure Active Directory tenant, you can uncheck the checkbox for provisioning the application.</span></span>

![](windows-azure-authentication/_static/image6.png)

<span data-ttu-id="1aa53-127">A caixa de diálogo exibirá o **domínio**, **Id do aplicativo Principal** e **URL de resposta** que são necessário para provisionamento do aplicativo com um Active Directory do Azure princípio.</span><span class="sxs-lookup"><span data-stu-id="1aa53-127">The dialog will display the **Domain**, **Application Principal Id** and **Reply URL** which are required for provisioning the application with an Azure Active Directory tenet.</span></span> <span data-ttu-id="1aa53-128">Você precisa fornecer essas informações para uma conta que tenha privilégios suficientes para configurar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1aa53-128">You need to give this information to someone who has sufficient privilege to provision the application.</span></span> <span data-ttu-id="1aa53-129">Consulte[como implementar o logon único com o Windows Azure Active Directory - aplicativo ASP.NET](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) para obter detalhes sobre como usar o cmdlet para criar a entidade de serviço manualmente.</span><span class="sxs-lookup"><span data-stu-id="1aa53-129">See[How to implement single sign-on with Windows Azure Active Directory - ASP.NET Application](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) for details on how to use cmdlet to create the service principal manually.</span></span>  
<span data-ttu-id="1aa53-130">Depois que o aplicativo tiver sido configurado com êxito, você pode clicar em **continuar Atualizar Web. config com as configurações selecionadas**.</span><span class="sxs-lookup"><span data-stu-id="1aa53-130">Once the application has been successfully provisioned, you can click on **Continue to update web.config with the selected settings**.</span></span> <span data-ttu-id="1aa53-131">Se você quiser continuar a desenvolver o aplicativo durante a espera para provisionamento em acontecer, você pode clicar em **Fechar para memorizar as configurações no arquivo de projeto**.</span><span class="sxs-lookup"><span data-stu-id="1aa53-131">If you want to continue developing the application while waiting for provisioning to happen, you can click **Close to remember the settings in project file**.</span></span> <span data-ttu-id="1aa53-132">Na próxima vez que invocar habilitar a autenticação do Windows Azure e desmarque a caixa de seleção de provisionamento, você verá as mesmas configurações e você pode clicar em **continuar**, em seguida, clique em, **aplicar essas configurações em Web. config**.</span><span class="sxs-lookup"><span data-stu-id="1aa53-132">The next time you invoke Enable Windows Azure Authentication and uncheck the provisioning checkbox, you will see the same settings and you can click **Continue**, then click, **Apply these settings in web.config**.</span></span>

1. <span data-ttu-id="1aa53-133">Aguarde enquanto o aplicativo está configurado para autenticação do Windows Azure e provisionado com o Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1aa53-133">Wait while your application is configured for Windows Azure Authentication and provisioned with Windows Azure Active Directory.</span></span>
2. <span data-ttu-id="1aa53-134">Depois que a autenticação do Windows Azure foi habilitada para seu aplicativo, clique em **fechar:**</span><span class="sxs-lookup"><span data-stu-id="1aa53-134">Once Windows Azure Authentication has been enabled for your application, click **Close:**</span></span> 

    ![](windows-azure-authentication/_static/image7.png)
3. <span data-ttu-id="1aa53-135">Pressione F5 para executar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1aa53-135">Hit F5 to run your application.</span></span> <span data-ttu-id="1aa53-136">Você deve obter redirecionado automaticamente para a página de logon.</span><span class="sxs-lookup"><span data-stu-id="1aa53-136">You should automatically get redirected to login page.</span></span> <span data-ttu-id="1aa53-137">Use as credenciais de usuário do diretório princípio ao fazer logon no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1aa53-137">Use the directory tenet user credentials to login to the application..</span></span>  

    ![](windows-azure-authentication/_static/image1.jpg)
4. <span data-ttu-id="1aa53-138">Porque o aplicativo está usando um certificado de teste autoassinado, você receberá um aviso do navegador que o certificado não foi emitido por uma autoridade de certificação confiável.</span><span class="sxs-lookup"><span data-stu-id="1aa53-138">Because your application is currently using a self-signed test certificate you will receive a warning from the browser that the certificate was not issued by a trusted certificate authority.</span></span>

    <span data-ttu-id="1aa53-139">Esse aviso pode ser ignorado durante o desenvolvimento local, clicando em **continuar neste site:**</span><span class="sxs-lookup"><span data-stu-id="1aa53-139">This warning can be safely ignored during local development by clicking **Continue to this website:**</span></span> 

    ![](windows-azure-authentication/_static/image8.png)
5. <span data-ttu-id="1aa53-140">Você agora efetuou com êxito seu aplicativo usando a autenticação do Windows Azure!</span><span class="sxs-lookup"><span data-stu-id="1aa53-140">You have now successfully logged in to your application using Windows Azure Authentication!</span></span>

    ![](windows-azure-authentication/_static/image2.jpg)

<span data-ttu-id="1aa53-141">Habilitação do Windows Azure autenticação faz as seguintes alterações para seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="1aa53-141">Enabling Windows Azure authentication makes the following changes to your application:</span></span>

- <span data-ttu-id="1aa53-142">Falsificação de solicitação de um Site a entre ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) classe ( *aplicativo\_Start\AntiXsrfConfig.cs* ) é adicionado ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="1aa53-142">An Anti-Cross-Site Request Forgery ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) class ( *App\_Start\AntiXsrfConfig.cs* ) is added to your project.</span></span>
- <span data-ttu-id="1aa53-143">Os pacotes do NuGet `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` é adicionado ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="1aa53-143">The NuGet packages `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` is added to your project.</span></span>
- <span data-ttu-id="1aa53-144">Configurações do Windows Identity Foundation no seu aplicativo serão configuradas para aceitar tokens de segurança de seu locatário do Active Directory do Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="1aa53-144">Windows Identity Foundation settings in your application will be configured to accept security tokens from your Windows Azure Active Directory tenant.</span></span> <span data-ttu-id="1aa53-145">Clique na imagem abaixo para ver uma exibição expandida das alterações feitas a *Web. config* arquivo.</span><span class="sxs-lookup"><span data-stu-id="1aa53-145">Click on the image below to see an expanded view of the changes made to the *Web.config* file.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.png)
- <span data-ttu-id="1aa53-146">Uma entidade de serviço para seu aplicativo no seu locatário do Windows Azure Active Directory será provisionado.</span><span class="sxs-lookup"><span data-stu-id="1aa53-146">A service principal for your application in your Windows Azure Active Directory tenant will be provisioned.</span></span>
- <span data-ttu-id="1aa53-147">HTTPS é habilitado.</span><span class="sxs-lookup"><span data-stu-id="1aa53-147">HTTPS is enabled.</span></span>

## <a name="deploy-the-application-to-windows-azure"></a><span data-ttu-id="1aa53-148">Implantar o aplicativo no Windows Azure</span><span class="sxs-lookup"><span data-stu-id="1aa53-148">Deploy the application to Windows Azure</span></span>

<span data-ttu-id="1aa53-149">Para obter instruções completas, consulte [Implantando um aplicativo Web do ASP.NET a um Site do Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="1aa53-149">For complete instructions, see [Deploying an ASP.NET Web Application to a Windows Azure Web Site](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

<span data-ttu-id="1aa53-150">Para publicar um aplicativo usando a autenticação do Windows Azure para um Site do Azure:</span><span class="sxs-lookup"><span data-stu-id="1aa53-150">To publish an application using Windows Azure Authentication to an Azure Web Site:</span></span>

1. <span data-ttu-id="1aa53-151">Clique com o botão direito em seu aplicativo e selecione **publicação:**</span><span class="sxs-lookup"><span data-stu-id="1aa53-151">Right click on your application and select **Publish:**</span></span> 

    ![](windows-azure-authentication/_static/image3.jpg)
2. <span data-ttu-id="1aa53-152">Na caixa de diálogo Publicar Web baixar e importar um perfil de publicação para seu Site do Azure.</span><span class="sxs-lookup"><span data-stu-id="1aa53-152">From the Publish Web dialog download and import a publishing profile for your Azure Web Site.</span></span>

    ![](windows-azure-authentication/_static/image4.jpg)
3. <span data-ttu-id="1aa53-153">O **Conexão** guia mostra o **URL de destino** (a voltado para URL pública para o seu aplicativo).</span><span class="sxs-lookup"><span data-stu-id="1aa53-153">The **Connection** tab shows the **Destination URL** (the public facing URL for your application).</span></span> <span data-ttu-id="1aa53-154">Clique em **Conexão validar** para testar sua conexão:</span><span class="sxs-lookup"><span data-stu-id="1aa53-154">Click **Validate Connection** to test your connection:</span></span>

    ![](windows-azure-authentication/_static/image5.jpg)
4. <span data-ttu-id="1aa53-155">Se você publicou para este Site do Azure anteriormente considere verificar o **remover arquivos adicionais no destino** para garantir que seu aplicativo publica corretamente.</span><span class="sxs-lookup"><span data-stu-id="1aa53-155">If you have published to this Azure Web Site previously consider checking the **Remove additional files at destination** setting to ensure your application publishes cleanly.</span></span> <span data-ttu-id="1aa53-156">Observe o **habilitar a autenticação do Windows Azure** caixa de seleção é slected.</span><span class="sxs-lookup"><span data-stu-id="1aa53-156">Notice the **Enable Windows Azure Authentication** check box is slected.</span></span>  

    ![](windows-azure-authentication/_static/image10.png)
5. <span data-ttu-id="1aa53-157">Opcional: No **visualização** guia, clique em **iniciar visualização** para ver os arquivos de implantação.</span><span class="sxs-lookup"><span data-stu-id="1aa53-157">Optional: On the **Preview** tab click **Start Preview** to see the files deployed.</span></span>

    ![](windows-azure-authentication/_static/image6.jpg)
6. <span data-ttu-id="1aa53-158">Clique em **publicar.**</span><span class="sxs-lookup"><span data-stu-id="1aa53-158">Click **Publish.**</span></span>

    <span data-ttu-id="1aa53-159">Você será solicitado a habilitar a autenticação do Windows Azure para o host de destino.</span><span class="sxs-lookup"><span data-stu-id="1aa53-159">You will be prompted to enable Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="1aa53-160">Clique em **habilitar** para continuar:</span><span class="sxs-lookup"><span data-stu-id="1aa53-160">Click **Enable** to continue:</span></span>

    ![](windows-azure-authentication/_static/image11.png)
7. <span data-ttu-id="1aa53-161">Insira suas credenciais de administrador para seu locatário do Active Directory do Windows Azure:</span><span class="sxs-lookup"><span data-stu-id="1aa53-161">Enter your administrator credentials for your Windows Azure Active Directory tenant:</span></span>

    ![](windows-azure-authentication/_static/image7.jpg)
8. <span data-ttu-id="1aa53-162">Depois que o aplicativo foi publicado com êxito, um navegador abrirá o site da web publicado.</span><span class="sxs-lookup"><span data-stu-id="1aa53-162">Once your application has been successfully published, a browser will open to the published web site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1aa53-163">Ele pode levar até cinco minutos (normalmente deve menor) do seu aplicativo para ser totalmente provisionados com o Windows Azure Active Directory depois de habilitar a autenticação do Windows Azure para o host de destino.</span><span class="sxs-lookup"><span data-stu-id="1aa53-163">It may take up to five minutes (typically must less) for your application to be fully provisioned with Windows Azure Active Directory after enabling Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="1aa53-164">Quando você primeiro executar o aplicativo se você receber o erro ACS50001: terceira parte confiável com o nome '[Território]' não foi encontrado, em seguida, aguarde alguns minutos e tente executar o aplicativo novamente.</span><span class="sxs-lookup"><span data-stu-id="1aa53-164">When you first run your application if you receive error ACS50001: Relying party with name ‘[realm]' was not found, then wait a few minutes and try running the application again.</span></span>
9. <span data-ttu-id="1aa53-165">Quando solicitado, faça logon como um usuário em seu diretório:</span><span class="sxs-lookup"><span data-stu-id="1aa53-165">When prompted, log in as a user in your directory:</span></span>

    ![](windows-azure-authentication/_static/image8.jpg)
10. <span data-ttu-id="1aa53-166">Você agora conectado com êxito ao seu Azure hospedado aplicativo usando a autenticação do Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="1aa53-166">You have now successfully logged into your Azure hosted application using Windows Azure Authentication.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.jpg)

## <a name="known-issues"></a><span data-ttu-id="1aa53-167">Problemas Conhecidos</span><span class="sxs-lookup"><span data-stu-id="1aa53-167">Known Issues</span></span>

#### <a name="role-based-authorization-fails-when-using-windows-azure-authenticationopop"></a><span data-ttu-id="1aa53-168">Falha de autorização baseada em função ao usar a autenticação do Windows Azure: < p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-168">Role-based authorization fails when using Windows Azure Authentication<o:p></o:p></span></span>

<span data-ttu-id="1aa53-169">Autenticação do Windows Azure atualmente não fornece a declaração de função necessários para que a autorização baseada em função pode ser executada.</span><span class="sxs-lookup"><span data-stu-id="1aa53-169">Windows Azure Authentication does not currently provide the necessary role claim so that role-based authorization can be performed.</span></span> <span data-ttu-id="1aa53-170">A função do usuário autenticado deve ser recuperada do Windows Azure Active Directory. <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-170">The role of the authenticated user must be manually retrieved from Windows Azure Active Directory.<o:p></o:p></span></span>

#### <a name="browsing-to-an-application-with-windows-azure-authentication-results-in-the-error-acs20016-the-domain-of-the-logged-in-user-livecom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="1aa53-171">Navegando para um aplicativo com resultados de autenticação do Windows Azure no erro "ACS20016 o domínio do usuário conectado (live.com) não corresponde qualquer permitido domínio desse STS" <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-171">Browsing to an application with Windows Azure Authentication results in the error "ACS20016 The domain of the logged in user (live.com) does not match any allowed domain of this STS"<o:p></o:p></span></span>

<span data-ttu-id="1aa53-172">Se você já estiver conectado a um Account da Microsoft (por exemplo, hotmail.com, live.com, outlook.com) e você tentar acessar um aplicativo que tenha habilitado a autenticação do Windows Azure poderá receber uma resposta de 400 erro porque o domínio da sua Account da Microsoft não é reconhecida pelo Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1aa53-172">If you are already logged in to a Microsoft Account (for example hotmail.com, live.com, outlook.com) and you attempt to access an application that has enabled Windows Azure Authentication you may get a 400 error response because the domain of your Microsoft Account is not recognized by Windows Azure Active Directory.</span></span> <span data-ttu-id="1aa53-173">Para fazer logon no aplicativo, faça logoff da Microsoft Account primeiro. <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-173">To log into the application, log out from your Microsoft Account first.<o:p></o:p></span></span>

#### <a name="logging-into-an-application-with-windows-azure-authentication-enabled-and-a-x509certificatevalidationmode-other-than-none-results-in-certificate-validation-errors-for-the-accountsaccesscontrolwindowsnet-certificateopop"></a><span data-ttu-id="1aa53-174">Nenhum registro em log em um aplicativo com autenticação do Windows Azure habilitada e um X509CertificateValidationMode que resulta em erros de validação de certificado para o certificado accounts.accesscontrol.windows.net <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-174">Logging into an application with Windows Azure Authentication enabled and a X509CertificateValidationMode other than None results in certificate validation errors for the accounts.accesscontrol.windows.net certificate<o:p></o:p></span></span>

<span data-ttu-id="1aa53-175">Validação de certificado não é necessária e deve ser deixada desativado.</span><span class="sxs-lookup"><span data-stu-id="1aa53-175">Certificate validation is not required and should be left disabled.</span></span> <span data-ttu-id="1aa53-176">A impressão digital do certificado do emissor é validada pelo WSFederationAuthenticationModule. <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-176">The thumbprint of the issuer certificate is validated by the WSFederationAuthenticationModule.<o:p></o:p></span></span>

#### <a name="when-attempting-to-enable-windows-azure-authentication-the-web-authentication-dialog-shows-the-error-acs20016-the-domain-of-the-logged-in-user-contosoonmicrosoftcom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="1aa53-177">Durante a tentativa de habilitar a autenticação do Windows Azure a caixa de diálogo de autenticação da Web mostra o erro "ACS20016: O domínio do usuário conectado (contoso.onmicrosoft.com) não corresponde a nenhum domínio permitido desse STS." < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-177">When attempting to enable Windows Azure Authentication the Web Authentication dialog shows the error "ACS20016: The domain of the logged in user (contoso.onmicrosoft.com) does not match any allowed domain of this STS."<o:p></o:p></span></span>

<span data-ttu-id="1aa53-178">Você poderá ver esse erro quando com êxito anteriormente fazer logon usando uma conta do Windows Azure Active Directory diferente de dentro do mesmo processo do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1aa53-178">You may see this error when you have previously successfully logged in using a different Windows Azure Active Directory account from within the same Visual Studio process.</span></span> <span data-ttu-id="1aa53-179">Faça logoff da conta especificada ou reinicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1aa53-179">Log out from the specified account or restart Visual Studio.</span></span> <span data-ttu-id="1aa53-180">Se conectado anteriormente e selecionado a opção "Mantenha-me conectado", talvez seja necessário limpar seus cookies do navegador. <: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-180">If you previously logged in and selected the option to "Keep me signed in" then you may need to clear your browser cookies.<o:p></o:p></span></span>

## <a name="acs20012-the-request-is-not-a-valid-ws-federation-protocol-message-opop"></a><span data-ttu-id="1aa53-181">ACS20012: A solicitação não é uma mensagem de protocolo WS-Federation válida: < p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-181">ACS20012: The request is not a valid WS-Federation protocol message <o:p></o:p></span></span>

<span data-ttu-id="1aa53-182">Isso pode acontecer se você já estiver conectado com alguns outros ID da Microsoft para um dos serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="1aa53-182">This can happen if you are already logged in with some other Microsoft ID to one of the Azure services.</span></span> <span data-ttu-id="1aa53-183">Janela do navegador de uso particular como InPrivate no Internet Explorer ou Incognito no Chrome ou limpar todos os cookies.</span><span class="sxs-lookup"><span data-stu-id="1aa53-183">Use Private browser window like InPrivate in IE or Incognito in Chrome or clear all the cookies.</span></span> <span data-ttu-id="1aa53-184">< o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="1aa53-184"><o:p></o:p></span></span>

## <a name="additional-resources"></a><span data-ttu-id="1aa53-185">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="1aa53-185">Additional Resources</span></span>

- <span data-ttu-id="1aa53-186">[Ferramentas do Microsoft ASP.NET para Windows Azure Active Directory – o Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="1aa53-186">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="1aa53-187">Windows Azure recursos: identidade</span><span class="sxs-lookup"><span data-stu-id="1aa53-187">Windows Azure Features: Identity</span></span>](https://docs.microsoft.com/azure/active-directory/)
- [<span data-ttu-id="1aa53-188">TechNet: Windows Active Directory do Azure</span><span class="sxs-lookup"><span data-stu-id="1aa53-188">TechNet: Windows Azure Active Directory</span></span>](https://technet.microsoft.com/library/hh967619.aspx)
- [<span data-ttu-id="1aa53-189">Windows Azure Active Directory: desenvolver aplicativos para sua organização</span><span class="sxs-lookup"><span data-stu-id="1aa53-189">Windows Azure Active Directory: Develop Apps for your organization</span></span>](https://activedirectory.windowsazure.com/Develop/Single-Tenant.aspx)
- [<span data-ttu-id="1aa53-190">Windows Azure Active Directory: desenvolver aplicativos para várias organizações</span><span class="sxs-lookup"><span data-stu-id="1aa53-190">Windows Azure Active Directory: Develop Apps for multiple organizations</span></span>](https://activedirectory.windowsazure.com/Develop/Multi-Tenant.aspx)
- [<span data-ttu-id="1aa53-191">Como implementar o logon único com o Active Directory do Windows Azure</span><span class="sxs-lookup"><span data-stu-id="1aa53-191">How to implement single sign-on with Windows Azure Active Directory</span></span>](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect)
- <span data-ttu-id="1aa53-192">[Single Sign-On com o Windows Azure Active Directory: um mergulho profundo](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="1aa53-192">[Single Sign-On with Windows Azure Active Directory: a Deep Dive](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="1aa53-193">Usar o AD FS 2.0 para implementar e gerenciar o logon único</span><span class="sxs-lookup"><span data-stu-id="1aa53-193">Use AD FS 2.0 to implement and manage single sign-on</span></span>](https://technet.microsoft.com/library/jj205462.aspx)
