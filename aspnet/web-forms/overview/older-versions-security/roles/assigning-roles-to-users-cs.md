---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: Atribuir funções aos usuários (c#) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, que vamos criar duas páginas do ASP.NET para ajudá-lo a gerenciar o que os usuários pertencem a quais funções. A primeira página inclui recursos para ver qual...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/24/2008
ms.topic: article
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: a0518cd04f6b7f055a413b2b236712965451839c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="assigning-roles-to-users-c"></a><span data-ttu-id="b6bae-104">Atribuir funções aos usuários (c#)</span><span class="sxs-lookup"><span data-stu-id="b6bae-104">Assigning Roles to Users (C#)</span></span>
====================
<span data-ttu-id="b6bae-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b6bae-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b6bae-106">[Baixar o código](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) ou [baixar PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="b6bae-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="b6bae-107">Neste tutorial, que vamos criar duas páginas do ASP.NET para ajudá-lo a gerenciar o que os usuários pertencem a quais funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="b6bae-108">A primeira página inclui recursos para ver o que os usuários pertencem a uma determinada função, as funções que um usuário específico pertence e a capacidade de atribuir ou remover um usuário específico de uma função específica.</span><span class="sxs-lookup"><span data-stu-id="b6bae-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="b6bae-109">Na segunda página, serão aumentar o controle CreateUserWizard para que ele inclui uma etapa para especificar a quais funções pertence o usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="b6bae-110">Isso é útil em cenários onde um administrador é capaz de criar novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="b6bae-111">Introdução</span><span class="sxs-lookup"><span data-stu-id="b6bae-111">Introduction</span></span>

<span data-ttu-id="b6bae-112">O <a id="_msoanchor_1"> </a> [tutorial anterior](creating-and-managing-roles-cs.md) examinou o framework de funções e o `SqlRoleProvider`; vimos como usar o `Roles` classe para criar, recuperar e excluir funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="b6bae-113">Além de criar e excluir funções, é preciso ser capaz de atribuir ou remover usuários de uma função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="b6bae-114">Infelizmente, o ASP.NET não é fornecido com os controles da Web para que os usuários pertencem a quais funções de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="b6bae-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="b6bae-115">Em vez disso, devemos criar nossas própria páginas ASP.NET para gerenciar essas associações.</span><span class="sxs-lookup"><span data-stu-id="b6bae-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="b6bae-116">A boa notícia é que a adição e remoção de usuários às funções é muito fácil.</span><span class="sxs-lookup"><span data-stu-id="b6bae-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="b6bae-117">O `Roles` classe contém um número de métodos para adicionar um ou mais usuários a uma ou mais funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="b6bae-118">Neste tutorial, que vamos criar duas páginas do ASP.NET para ajudá-lo a gerenciar o que os usuários pertencem a quais funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="b6bae-119">A primeira página inclui recursos para ver o que os usuários pertencem a uma determinada função, as funções que um usuário específico pertence e a capacidade de atribuir ou remover um usuário específico de uma função específica.</span><span class="sxs-lookup"><span data-stu-id="b6bae-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="b6bae-120">Na segunda página, serão aumentar o controle CreateUserWizard para que ele inclui uma etapa para especificar a quais funções pertence o usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="b6bae-121">Isso é útil em cenários onde um administrador é capaz de criar novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="b6bae-122">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="b6bae-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="b6bae-123">Listando o que os usuários pertencem a quais funções</span><span class="sxs-lookup"><span data-stu-id="b6bae-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="b6bae-124">A primeira tarefa prioritária para este tutorial é criar uma página da web do qual os usuários podem ser atribuídos a funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="b6bae-125">Antes de em nós preocupar com como atribuir usuários a funções, vamos primeiro se concentrem em como determinar o que os usuários pertencem a quais funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="b6bae-126">Há duas maneiras de exibir essas informações: "função" ou "por usuário."</span><span class="sxs-lookup"><span data-stu-id="b6bae-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="b6bae-127">Pode permitir que o visitante selecionar uma função e, em seguida, mostrá-los todos os usuários que pertencem à função (a exibição "por função"), ou podemos pode solicitar o visitante para selecionar um usuário e mostrá-los as funções atribuídas ao usuário (a exibição "por usuário").</span><span class="sxs-lookup"><span data-stu-id="b6bae-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="b6bae-128">O modo de exibição "por função" é útil em circunstâncias em que o visitante que saber o conjunto de usuários que pertencem a uma função específica; o modo de exibição "por usuário" é ideal quando o visitante precisa saber as funções de um usuário específico.</span><span class="sxs-lookup"><span data-stu-id="b6bae-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="b6bae-129">Vamos dar nossa página incluem "pela função" e "por usuário" interfaces.</span><span class="sxs-lookup"><span data-stu-id="b6bae-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="b6bae-130">Vamos começar a criar a interface "pelo usuário".</span><span class="sxs-lookup"><span data-stu-id="b6bae-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="b6bae-131">Essa interface consistirá em uma lista suspensa e uma lista de caixas de seleção.</span><span class="sxs-lookup"><span data-stu-id="b6bae-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="b6bae-132">A lista suspensa será preenchida com o conjunto de usuários no sistema. as caixas de seleção vai enumerar as funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="b6bae-133">Selecionar um usuário na lista suspensa verificará essas funções que o usuário pertence.</span><span class="sxs-lookup"><span data-stu-id="b6bae-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="b6bae-134">A pessoa que está visitando a página pode, em seguida, marque ou desmarque as caixas de seleção para adicionar ou remover o usuário selecionado de funções correspondentes.</span><span class="sxs-lookup"><span data-stu-id="b6bae-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="b6bae-135">Usando uma lista suspensa lista para as contas de usuário não é uma opção ideal para sites onde pode haver centenas de contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="b6bae-136">Uma lista suspensa foi projetada para permitir que um usuário selecione um item de uma lista relativamente curto de opções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="b6bae-137">Rapidamente torna difícil à medida que aumenta o número de itens da lista.</span><span class="sxs-lookup"><span data-stu-id="b6bae-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="b6bae-138">Se você estiver criando um site que terá um grande número de contas de usuário, você talvez queira considerar usando uma interface de usuário alternativas, como prompts de GridView paginável ou uma interface filtrável que lista o visitante para escolher uma letra e somente mostra os usuários cujo nome começa com a letra selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="b6bae-139">Etapa 1: Criar a Interface do usuário "Pelo usuário"</span><span class="sxs-lookup"><span data-stu-id="b6bae-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="b6bae-140">Abra o `UsersAndRoles.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="b6bae-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="b6bae-141">Na parte superior da página, adicione um controle de rótulo Web chamado `ActionStatus` e limpar seu `Text` propriedade.</span><span class="sxs-lookup"><span data-stu-id="b6bae-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="b6bae-142">Usaremos esse rótulo para fornecer comentários sobre as ações executadas, exibindo mensagens como, "usuário Tito foi adicionado à função administradores do" ou "Jisun de usuário foi removido da função de supervisores."</span><span class="sxs-lookup"><span data-stu-id="b6bae-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="b6bae-143">Para fazer essas mensagens se destacam, defina o rótulo `CssClass` propriedade como "Importante".</span><span class="sxs-lookup"><span data-stu-id="b6bae-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="b6bae-144">Em seguida, adicione a seguinte definição de classe CSS para o `Styles.css` folha de estilos:</span><span class="sxs-lookup"><span data-stu-id="b6bae-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="b6bae-145">Esta definição CSS instrui o navegador para exibir o rótulo usando uma fonte grande, vermelha.</span><span class="sxs-lookup"><span data-stu-id="b6bae-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="b6bae-146">A Figura 1 mostra esse efeito por meio do Designer do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b6bae-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="b6bae-147">[![A propriedade do rótulo CssClass resulta em uma fonte grande, vermelha](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span></span>

<span data-ttu-id="b6bae-148">**Figura 1**: do rótulo `CssClass` resultados de propriedade em uma grande, fonte vermelha ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>


<span data-ttu-id="b6bae-149">Em seguida, adicionar DropDownList para a página, defina seu `ID` propriedade `UserList`e defina seu `AutoPostBack` propriedade como True.</span><span class="sxs-lookup"><span data-stu-id="b6bae-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="b6bae-150">Usaremos essa DropDownList para listar todos os usuários no sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="b6bae-151">Este DropDownList será associada a uma coleção de objetos MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="b6bae-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="b6bae-152">Como desejamos DropDownList para exibir a propriedade de nome de usuário do objeto MembershipUser (e usá-lo como o valor dos itens de lista), defina a DropDownList `DataTextField` e `DataValueField` propriedades para "UserName".</span><span class="sxs-lookup"><span data-stu-id="b6bae-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="b6bae-153">Abaixo DropDownList, adicione um repetidor denominado `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="b6bae-154">Este repetidor lista todas as funções no sistema como uma série de caixas de seleção.</span><span class="sxs-lookup"><span data-stu-id="b6bae-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="b6bae-155">Definir o repetidor `ItemTemplate` usando a seguinte marcação declarativa:</span><span class="sxs-lookup"><span data-stu-id="b6bae-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="b6bae-156">O `ItemTemplate` marcação inclui um controle de caixa de seleção Web único chamado `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="b6bae-157">A caixa de seleção `AutoPostBack` propriedade é definida como True e o `Text` propriedade está vinculada a `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="b6bae-158">O motivo pelo qual a sintaxe de associação de dados é simplesmente `Container.DataItem` porque a estrutura de funções retorna a lista de nomes de função como uma matriz de cadeia de caracteres, e é essa matriz de cadeia de caracteres que haverá a ligação para Repetidor.</span><span class="sxs-lookup"><span data-stu-id="b6bae-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="b6bae-159">Uma descrição completa de por que essa sintaxe é usada para exibir o conteúdo de uma matriz associada a um controle de Web de dados está além do escopo deste tutorial.</span><span class="sxs-lookup"><span data-stu-id="b6bae-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="b6bae-160">Para obter mais informações sobre esse assunto, consulte [uma matriz escalar de associação a um controle de Web dados](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bae-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="b6bae-161">Neste ponto declarativo seu "pelo usuário" da interface deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="b6bae-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="b6bae-162">Agora você está pronto para escrever o código para associar o conjunto de contas de usuário para DropDownList e o conjunto de funções de Repetidor.</span><span class="sxs-lookup"><span data-stu-id="b6bae-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="b6bae-163">Na classe de code-behind da página, adicione um método chamado `BindUsersToUserList` e outro chamado `BindRolesList`, usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="b6bae-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="b6bae-164">O `BindUsersToUserList` método recupera todas as contas de usuário no sistema por meio de [ `Membership.GetAllUsers` método](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bae-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="b6bae-165">Isso retorna um [ `MembershipUserCollection` objeto](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), que é uma coleção de [ `MembershipUser` instâncias](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bae-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="b6bae-166">Essa coleção é então associada para o `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b6bae-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="b6bae-167">O `MembershipUser` instâncias que composição a coleção contém uma variedade de propriedades, como `UserName`, `Email`, `CreationDate`, e `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="b6bae-168">Para instruir o DropDownList para exibir o valor da `UserName` propriedade, certifique-se de que o `UserList` do DropDownList `DataTextField` e `DataValueField` propriedades foram definidas como "UserName".</span><span class="sxs-lookup"><span data-stu-id="b6bae-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="b6bae-169">O `Membership.GetAllUsers` método tem duas sobrecargas: um que não aceita nenhum parâmetro de entrada e retorna todos os usuários e outro que usa valores inteiros para o índice de página e tamanho de página e retorna somente o subconjunto especificado dos usuários.</span><span class="sxs-lookup"><span data-stu-id="b6bae-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="b6bae-170">Quando houver grandes quantidades de contas de usuário que está sendo exibidas em um elemento de interface do usuário paginável, a segunda sobrecarga pode ser usado para percorrer com mais eficiência os usuários já que ele retorna apenas o subconjunto preciso de contas de usuário em vez de todos eles.</span><span class="sxs-lookup"><span data-stu-id="b6bae-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="b6bae-171">O `BindRolesToList` método inicia chamando o `Roles` da classe [ `GetAllRoles` método](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), que retorna uma matriz de cadeia de caracteres que contém as funções do sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="b6bae-172">Esta matriz de cadeia de caracteres é então associado a Repetidor.</span><span class="sxs-lookup"><span data-stu-id="b6bae-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="b6bae-173">Por fim, é preciso chamar esses dois métodos, quando a página for carregada pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="b6bae-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="b6bae-174">Adicione o seguinte código ao manipulador de eventos do `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="b6bae-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="b6bae-175">Com esse código, reserve um tempo para visitar a página por meio de um navegador. sua tela deve ser semelhante a Figura 2.</span><span class="sxs-lookup"><span data-stu-id="b6bae-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="b6bae-176">Todas as contas de usuário são preenchidas na lista suspensa e, abaixo dele, cada função é exibida como uma caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="b6bae-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="b6bae-177">Como definimos o `AutoPostBack` propriedades do DropDownList e caixas de seleção para True, alterando o usuário selecionado ou marcar ou desmarcar uma função causa um postback.</span><span class="sxs-lookup"><span data-stu-id="b6bae-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="b6bae-178">Nenhuma ação é executada, no entanto, como temos ainda escrever código para lidar com essas ações.</span><span class="sxs-lookup"><span data-stu-id="b6bae-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="b6bae-179">Que abordaremos essas tarefas nas próximas duas seções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="b6bae-180">[![A página exibe os usuários e funções](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span></span>

<span data-ttu-id="b6bae-181">**Figura 2**: A página exibe os usuários e funções ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="b6bae-182">Verificando as funções do usuário selecionado pertence a</span><span class="sxs-lookup"><span data-stu-id="b6bae-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="b6bae-183">Quando a página for carregada pela primeira vez, ou sempre que o visitante seleciona um novo usuário na lista suspensa, precisamos atualizar o `UsersRoleList`de caixas de seleção para que uma caixa de seleção de função é verificada apenas se o usuário selecionado pertence a essa função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="b6bae-184">Para fazer isso, crie um método chamado `CheckRolesForSelectedUser` com o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="b6bae-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="b6bae-185">Inicia o código acima, determinando quem é o usuário selecionado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="b6bae-186">Ele então usa a classe de funções [ `GetRolesForUser(userName)` método](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) para retornar conjunto do usuário especificado de funções como uma matriz de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="b6bae-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="b6bae-187">Em seguida, os itens do repetidor são enumeradas e cada item `RoleCheckBox` caixa de seleção é referenciada por meio de programação.</span><span class="sxs-lookup"><span data-stu-id="b6bae-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="b6bae-188">A caixa de seleção estiver marcada, somente se ela corresponde à função está dentro do `selectedUsersRoles` matriz de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="b6bae-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="b6bae-189">O `selectedUserRoles.Contains<string>(...)` sintaxe não serão compilados se você estiver usando o ASP.NET versão 2.0.</span><span class="sxs-lookup"><span data-stu-id="b6bae-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="b6bae-190">O `Contains<string>` método é parte do [biblioteca LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query), que é novo no ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="b6bae-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="b6bae-191">Se você ainda estiver usando o ASP.NET versão 2.0, use o [ `Array.IndexOf<string>` método](https://msdn.microsoft.com/library/eha9t187.aspx) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="b6bae-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="b6bae-192">O `CheckRolesForSelectedUser` método precisa ser chamado em dois casos: quando a página for carregada pela primeira vez e sempre que o `UserList` índice selecionado do DropDownList é alterado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="b6bae-193">Portanto, chamar esse método a partir de `Page_Load` manipulador de eventos (após as chamadas para `BindUsersToUserList` e `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="b6bae-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="b6bae-194">Além disso, crie um manipulador de eventos para o DropDownList `SelectedIndexChanged` eventos e chamar esse método de lá.</span><span class="sxs-lookup"><span data-stu-id="b6bae-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="b6bae-195">Com esse código, você pode testar a página por meio do navegador.</span><span class="sxs-lookup"><span data-stu-id="b6bae-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="b6bae-196">No entanto, como o `UsersAndRoles.aspx` página atualmente não tem a capacidade de atribuir usuários a funções, nenhum usuário tem funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="b6bae-197">Vamos criar a interface para atribuir usuários a funções mais tarde, você pode levar o word que esse código funciona e verificar que ele faz isso mais tarde, ou você pode adicionar manualmente os usuários a funções, inserindo registros no `aspnet_UsersInRoles` tabela para testar este functi onality agora.</span><span class="sxs-lookup"><span data-stu-id="b6bae-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="b6bae-198">Atribuir e remover usuários das funções</span><span class="sxs-lookup"><span data-stu-id="b6bae-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="b6bae-199">Quando o visitante ou desmarca uma caixa de seleção no `UsersRoleList` repetidor precisamos adicionar ou remover o usuário selecionado da função correspondente.</span><span class="sxs-lookup"><span data-stu-id="b6bae-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="b6bae-200">A caixa de seleção `AutoPostBack` propriedade atualmente está definida como True, o que causa um postback sempre que uma caixa de seleção no repetidor estiver marcada ou desmarcada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="b6bae-201">Em resumo, precisamos criar um manipulador de eventos para a caixa de seleção `CheckChanged` eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="b6bae-202">Como a caixa de seleção em um controle repetidor, precisamos adicionar manualmente a estrutura do manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="b6bae-203">Comece adicionando o manipulador de eventos para a classe code-behind, como um `protected` método, da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="b6bae-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="b6bae-204">Podemos retornará para escrever o código para este manipulador de eventos em breve.</span><span class="sxs-lookup"><span data-stu-id="b6bae-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="b6bae-205">Mas primeiro vamos concluir o direcionamento de manipulação de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="b6bae-206">Na caixa de seleção dentro do repetidor `ItemTemplate`, adicionar `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="b6bae-207">Essa sintaxe conecta o `RoleCheckBox_CheckChanged` manipulador de eventos para o `RoleCheckBox`do `CheckedChanged` evento.</span><span class="sxs-lookup"><span data-stu-id="b6bae-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="b6bae-208">É nossa tarefa final concluir o `RoleCheckBox_CheckChanged` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="b6bae-209">É preciso iniciar referenciando o controle de caixa de seleção que gerou o evento porque esta instância de caixa de seleção indica qual função foi marcada ou desmarcada por meio de seu `Text` e `Checked` propriedades.</span><span class="sxs-lookup"><span data-stu-id="b6bae-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="b6bae-210">Usando essas informações junto com o nome de usuário do usuário selecionado, podemos adicionar ou remover o usuário da função por meio de `Roles` da classe [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) ou [ `RemoveUserFromRole` método](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bae-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="b6bae-211">O código acima inicia referenciando programaticamente a caixa de seleção que gerou o evento, que está disponível por meio de `sender` parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="b6bae-212">Se a caixa de seleção estiver marcada, o usuário selecionado é adicionado à função especificada, caso contrário, que eles serão removidos da função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="b6bae-213">Em ambos os casos, o `ActionStatus` exibirá uma mensagem de resumo a ação que acabou de ser executada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="b6bae-214">Dedicar um tempo para testar esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="b6bae-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="b6bae-215">Selecione o usuário Tito e adicione Tito às funções de administradores e supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="b6bae-216">[![Tito foi adicionado para as funções de supervisores e administradores](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span></span>

<span data-ttu-id="b6bae-217">**Figura 3**: Tito foi adicionado para os administradores e funções de supervisores ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>


<span data-ttu-id="b6bae-218">Em seguida, selecione o usuário Bruce na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="b6bae-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="b6bae-219">Há um postback e caixas de seleção do repetidor são atualizadas por meio de `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="b6bae-220">Como Bruce ainda não pertence a nenhuma função, as duas caixas de seleção estão desmarcadas.</span><span class="sxs-lookup"><span data-stu-id="b6bae-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="b6bae-221">Em seguida, adicione Bruce à função de supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="b6bae-222">[![Bruce foi adicionado à função de supervisores](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span></span>

<span data-ttu-id="b6bae-223">**Figura 4**: Bruce foi adicionado à função de supervisores ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>


<span data-ttu-id="b6bae-224">Para verificar a funcionalidade do `CheckRolesForSelectedUser` método, selecione um usuário diferente Tito ou Bruce.</span><span class="sxs-lookup"><span data-stu-id="b6bae-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="b6bae-225">Observe como as caixas de seleção estão desmarcadas, automaticamente, indicando que não pertence a nenhuma função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="b6bae-226">Retorne ao Tito.</span><span class="sxs-lookup"><span data-stu-id="b6bae-226">Return to Tito.</span></span> <span data-ttu-id="b6bae-227">Os administradores e supervisores de caixas de seleção devem ser verificadas.</span><span class="sxs-lookup"><span data-stu-id="b6bae-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="b6bae-228">Etapa 2: Criar a Interface do usuário "Pelas funções"</span><span class="sxs-lookup"><span data-stu-id="b6bae-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="b6bae-229">Nesse ponto, podemos concluiu a interface "por"usuários e está prontos para começar a lidar com a interface "pelas funções".</span><span class="sxs-lookup"><span data-stu-id="b6bae-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="b6bae-230">A interface "pelas funções" solicita que o usuário selecionar uma função de uma lista suspensa e, em seguida, exibe o conjunto de usuários que pertencem a essa função em um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="b6bae-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="b6bae-231">Adicione outro controle DropDownList para o `UsersAndRoles.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="b6bae-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="b6bae-232">Coloque esse um sob o controle repetidor, nomeie-o `RoleList`e defina seu `AutoPostBack` propriedade como True.</span><span class="sxs-lookup"><span data-stu-id="b6bae-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="b6bae-233">Abaixo dele, adicione um controle GridView e denomine- `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="b6bae-234">Este GridView listará os usuários que pertencem à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="b6bae-235">Definir o GridView `AutoGenerateColumns` a propriedade como False, adicionar um TemplateField à grade `Columns` coleção e defina seu `HeaderText` propriedade como "Usuários".</span><span class="sxs-lookup"><span data-stu-id="b6bae-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="b6bae-236">Definir o TemplateField `ItemTemplate` para que ele exibe o valor da expressão de associação de dados `Container.DataItem` no `Text` propriedade de um rótulo denominado `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="b6bae-237">Depois de adicionar e configurar o GridView, marcação declarativa seu "pela função" da interface deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="b6bae-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="b6bae-238">É necessário preencher o `RoleList` DropDownList com o conjunto de funções do sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="b6bae-239">Para fazer isso, atualize o `BindRolesToList` método para que seja associado a matriz de cadeia de caracteres retornada pelo `Roles.GetAllRoles` método para o `RolesList` DropDownList (bem como a `UsersRoleList` repetidor).</span><span class="sxs-lookup"><span data-stu-id="b6bae-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="b6bae-240">As duas últimas linhas no `BindRolesToList` método foram adicionados ao associar o conjunto de funções para o `RoleList` controle DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b6bae-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="b6bae-241">A Figura 5 mostra o resultado final quando visualizada através de um navegador – uma lista suspensa preenchida com funções do sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="b6bae-242">[![As funções são exibidas na RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span></span>

<span data-ttu-id="b6bae-243">**Figura 5**: as funções são exibidas no `RoleList` DropDownList ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="b6bae-244">Exibindo os usuários que pertencem à função selecionada</span><span class="sxs-lookup"><span data-stu-id="b6bae-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="b6bae-245">Quando a página for carregada pela primeira vez ou quando uma nova função é selecionada do `RoleList` DropDownList, é necessário exibir a lista de usuários que pertencem a essa função em GridView.</span><span class="sxs-lookup"><span data-stu-id="b6bae-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="b6bae-246">Crie um método chamado `DisplayUsersBelongingToRole` usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="b6bae-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="b6bae-247">Esse método inicia fazendo com que a função selecionada do `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b6bae-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="b6bae-248">Ele usa o [ `Roles.GetUsersInRole(roleName)` método](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) para recuperar uma matriz de cadeia de caracteres de nomes de usuário dos usuários que pertencem a essa função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="b6bae-249">Esta matriz é então associada para o `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="b6bae-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="b6bae-250">Esse método precisa ser chamado em duas circunstâncias: quando a página for carregada inicialmente e quando a função selecionada no `RoleList` DropDownList alterações.</span><span class="sxs-lookup"><span data-stu-id="b6bae-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="b6bae-251">Portanto, atualizar o `Page_Load` manipulador de eventos para que esse método é chamado após a chamada a `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="b6bae-252">Em seguida, crie um manipulador de eventos para o `RoleList`do `SelectedIndexChanged` evento e chame esse método a partir daí, muito.</span><span class="sxs-lookup"><span data-stu-id="b6bae-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="b6bae-253">Com esse código no local, o `RolesUserList` GridView deve exibir os usuários que pertencem à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="b6bae-254">Como mostra a Figura 6, a função de supervisores consiste em dois membros: Bruce e Tito.</span><span class="sxs-lookup"><span data-stu-id="b6bae-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="b6bae-255">[![GridView lista os usuários que pertencem à função selecionada](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span></span>

<span data-ttu-id="b6bae-256">**Figura 6**: O GridView lista os usuários que pertencem à função selecionada ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="b6bae-257">Remover usuários da função selecionada</span><span class="sxs-lookup"><span data-stu-id="b6bae-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="b6bae-258">Vamos ampliar o `RolesUserList` GridView para que ele inclui uma coluna de "remover" botões.</span><span class="sxs-lookup"><span data-stu-id="b6bae-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="b6bae-259">Clicar no botão "Remover" para um usuário específico removerá dessa função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="b6bae-260">Comece adicionando um campo de botão de exclusão para o GridView.</span><span class="sxs-lookup"><span data-stu-id="b6bae-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="b6bae-261">Tornar este campo aparecem como arquivada mais à esquerda e alterar seu `DeleteText` propriedade de "Excluir" (o padrão) para "Remover".</span><span class="sxs-lookup"><span data-stu-id="b6bae-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="b6bae-262">[![Adicionar o](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-262">[![Add the](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span></span>

<span data-ttu-id="b6bae-263">**Figura 7**: adicionar o botão "Remover" para o GridView ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>


<span data-ttu-id="b6bae-264">Ao clicar no botão "Remover" um postback tem lugar e a GridView `RowDeleting` é gerado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="b6bae-265">É preciso criar um manipulador de eventos para esse evento e escrever código que remove o usuário da função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="b6bae-266">Crie o manipulador de eventos e, em seguida, adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="b6bae-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="b6bae-267">O código começa determinando o nome da função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="b6bae-268">Em seguida, por meio de programação referências a `UserNameLabel` controle da linha cuja "Remover" foi clicada para determinar o nome do usuário a ser removido.</span><span class="sxs-lookup"><span data-stu-id="b6bae-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="b6bae-269">O usuário é então removido da função por meio de uma chamada para o `Roles.RemoveUserFromRole` método.</span><span class="sxs-lookup"><span data-stu-id="b6bae-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="b6bae-270">O `RolesUserList` GridView é atualizada e será exibida uma mensagem por meio de `ActionStatus` controle de rótulo.</span><span class="sxs-lookup"><span data-stu-id="b6bae-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="b6bae-271">O botão "Remover" não requer qualquer tipo de confirmação do usuário antes de remover o usuário da função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="b6bae-272">Eu convido você a adicionar algum nível de confirmação do usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="b6bae-273">Uma das maneiras mais fáceis para confirmar uma ação é por meio de uma caixa de diálogo de confirmação do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="b6bae-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="b6bae-274">Para obter mais informações sobre essa técnica, consulte [' adicionando confirmação do lado do cliente quando excluindo](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bae-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>


<span data-ttu-id="b6bae-275">Figura 8 mostra a página depois que o usuário Tito foi removido do grupo de supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="b6bae-276">[![Infelizmente, Tito não é mais um Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span></span>

<span data-ttu-id="b6bae-277">**Figura 8**: Infelizmente, Tito não é mais um Supervisor ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="b6bae-278">Adicionar novos usuários à função selecionada</span><span class="sxs-lookup"><span data-stu-id="b6bae-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="b6bae-279">Junto com a remoção de usuários da função selecionada, o visitante a essa página também deve ser capaz de adicionar um usuário à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="b6bae-280">A melhor interface para adicionar um usuário à função selecionada depende do número de contas de usuário que você espera ter.</span><span class="sxs-lookup"><span data-stu-id="b6bae-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="b6bae-281">Se seu site conterá apenas algumas contas de usuário dúzias ou menos, você pode usar DropDownList aqui.</span><span class="sxs-lookup"><span data-stu-id="b6bae-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="b6bae-282">Se pode haver milhares de contas de usuário, convém inclui uma interface de usuário que permite que o visitante a página por meio de contas, procure uma conta específica, ou filtrar as contas de usuário de alguma outra forma.</span><span class="sxs-lookup"><span data-stu-id="b6bae-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="b6bae-283">Para essa página Vamos usar uma interface muito simples que funciona independentemente do número de contas de usuário no sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="b6bae-284">Ou seja, vamos usar uma caixa de texto, solicitando que o visitante para digitar o nome do usuário que deseja adicionar à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="b6bae-285">Se não existe um usuário com esse nome, ou se o usuário já é um membro da função, exibirá uma mensagem em `ActionStatus` rótulo.</span><span class="sxs-lookup"><span data-stu-id="b6bae-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="b6bae-286">Mas, se o usuário existe e não é um membro da função, vamos adicioná-los para a função e atualizar a grade.</span><span class="sxs-lookup"><span data-stu-id="b6bae-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="b6bae-287">Adicione uma caixa de texto e um botão abaixo GridView.</span><span class="sxs-lookup"><span data-stu-id="b6bae-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="b6bae-288">Defina a caixa de texto `ID` para `UserNameToAddToRole` e definir o botão `ID` e `Text` propriedades `AddUserToRoleButton` e "Adicionar a função de usuário", respectivamente.</span><span class="sxs-lookup"><span data-stu-id="b6bae-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="b6bae-289">Em seguida, crie um `Click` manipulador de eventos para o `AddUserToRoleButton` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="b6bae-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="b6bae-290">A maior parte do código de `Click` manipulador de eventos executa várias verificações de validação.</span><span class="sxs-lookup"><span data-stu-id="b6bae-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="b6bae-291">Garante que o visitante fornecido um nome de usuário no `UserNameToAddToRole` caixa de texto, que o usuário existe no sistema e que eles já não pertencem à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="b6bae-292">Se qualquer uma dessas verificações falhar, uma mensagem apropriada será exibida no `ActionStatus` e o manipulador de eventos é encerrado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="b6bae-293">Se todas as verificações passarem, o usuário é adicionado à função por meio de `Roles.AddUserToRole` método.</span><span class="sxs-lookup"><span data-stu-id="b6bae-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="b6bae-294">Depois disso, a caixa de texto `Text` propriedade é limpo, GridView é atualizada e o `ActionStatus` rótulo exibe uma mensagem indicando que o usuário especificado foi adicionado com êxito à função selecionada.</span><span class="sxs-lookup"><span data-stu-id="b6bae-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="b6bae-295">Para garantir que o usuário especificado já não pertence à função selecionada, usamos o [ `Roles.IsUserInRole(userName, roleName)` método](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), que retorna um valor booliano que indica se *userName* é um membro de *roleName*.</span><span class="sxs-lookup"><span data-stu-id="b6bae-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="b6bae-296">Usaremos esse método novamente no <a id="_msoanchor_2"> </a> [tutorial próxima](role-based-authorization-cs.md) quando vamos examinar a autorização baseada em função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="b6bae-297">Visite a página por meio de um navegador e selecione a função de supervisores do `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b6bae-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="b6bae-298">Tente digitar um nome de usuário inválido – você deve ver uma mensagem explicando que o usuário não existe no sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="b6bae-299">[![Você não pode adicionar um usuário inexistente para uma função](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span></span>

<span data-ttu-id="b6bae-300">**Figura 9**: você não pode adicionar um usuário inexistente para uma função ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>


<span data-ttu-id="b6bae-301">Agora, tente adicionar um usuário válido.</span><span class="sxs-lookup"><span data-stu-id="b6bae-301">Now try adding a valid user.</span></span> <span data-ttu-id="b6bae-302">Vá em frente e adicione novamente Tito à função de supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="b6bae-303">[![Tito é novamente um Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span></span>

<span data-ttu-id="b6bae-304">**Figura 10**: Tito é novamente um Supervisor!</span><span class="sxs-lookup"><span data-stu-id="b6bae-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="b6bae-305">([Clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="b6bae-306">Etapa 3: Cross-atualizando o "Pelo usuário" e "função" Interfaces</span><span class="sxs-lookup"><span data-stu-id="b6bae-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="b6bae-307">O `UsersAndRoles.aspx` página oferece duas interfaces diferentes para gerenciar usuários e funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="b6bae-308">Atualmente, essas duas interfaces agir independentemente das outras portanto, é possível que uma alteração feita em uma interface não aparecerá imediatamente no outro.</span><span class="sxs-lookup"><span data-stu-id="b6bae-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="b6bae-309">Por exemplo, imagine que o visitante para a página seleciona a função de supervisores do `RoleList` DropDownList, que lista Bruce e Tito como seus membros.</span><span class="sxs-lookup"><span data-stu-id="b6bae-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="b6bae-310">Em seguida, o visitante seleciona Tito do `UserList` DropDownList, que verifica as caixas de seleção de administradores e supervisores do `UsersRoleList` Repetidor.</span><span class="sxs-lookup"><span data-stu-id="b6bae-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="b6bae-311">Se o visitante desmarca, em seguida, a função de Supervisor do repetidor, Tito é removido da função supervisores, mas essa modificação não será refletida na interface "pela função".</span><span class="sxs-lookup"><span data-stu-id="b6bae-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="b6bae-312">GridView ainda mostrará Tito como sendo um membro da função de supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="b6bae-313">Para corrigir isso, precisamos atualizar o GridView sempre que uma função é marcada ou desmarcada do `UsersRoleList` Repetidor.</span><span class="sxs-lookup"><span data-stu-id="b6bae-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="b6bae-314">Da mesma forma, é preciso atualizar repetidor sempre que um usuário for removido ou adicionado a uma função da interface "pela função".</span><span class="sxs-lookup"><span data-stu-id="b6bae-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="b6bae-315">Repetidor na interface "pelo usuário" é atualizada por chamar o `CheckRolesForSelectedUser` método.</span><span class="sxs-lookup"><span data-stu-id="b6bae-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="b6bae-316">A interface "pela função" pode ser modificada no `RolesUserList` do GridView `RowDeleting` manipulador de eventos e o `AddUserToRoleButton` do botão `Click` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="b6bae-317">Portanto, precisamos chamar o `CheckRolesForSelectedUser` método de cada um desses métodos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="b6bae-318">Da mesma forma, o GridView na interface "pela função" é atualizado chamando o `DisplayUsersBelongingToRole` método e a interface "pelo usuário" é modificada por meio de `RoleCheckBox_CheckChanged` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="b6bae-319">Portanto, precisamos chamar o `DisplayUsersBelongingToRole` método este manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="b6bae-320">Com essas pequenas alterações de código, o "pelo usuário" e "função" interfaces agora atualização cruzada corretamente.</span><span class="sxs-lookup"><span data-stu-id="b6bae-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="b6bae-321">Para verificar isso, visite a página por meio de um navegador e selecione Tito e supervisores do `UserList` e `RoleList` DropDownLists, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="b6bae-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="b6bae-322">Observe que que você desmarque a função supervisores para Tito do repetidor na interface "pelo usuário", Tito será removido automaticamente do GridView na interface "pela função".</span><span class="sxs-lookup"><span data-stu-id="b6bae-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="b6bae-323">Adicionar Tito volta para a função de supervisores da interface "pela função" automaticamente novamente verifica a caixa de seleção de supervisores na interface "pelo usuário".</span><span class="sxs-lookup"><span data-stu-id="b6bae-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="b6bae-324">Etapa 4: Personalizar o CreateUserWizard para incluir uma etapa "Especificar funções"</span><span class="sxs-lookup"><span data-stu-id="b6bae-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="b6bae-325">No <a id="_msoanchor_3"> </a> [ *criando contas de usuário* ](../membership/creating-user-accounts-cs.md) tutorial vimos como usar o controle CreateUserWizard Web para fornecer uma interface para criar uma nova conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="b6bae-326">O controle CreateUserWizard pode ser usado em uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="b6bae-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="b6bae-327">Como um meio de visitantes criar sua própria conta de usuário no site, e</span><span class="sxs-lookup"><span data-stu-id="b6bae-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="b6bae-328">Como um meio para administradores criar novas contas</span><span class="sxs-lookup"><span data-stu-id="b6bae-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="b6bae-329">No primeiro caso de uso, um visitante fornecido para o site e preenche CreateUserWizard, inserir suas informações para registrar no site.</span><span class="sxs-lookup"><span data-stu-id="b6bae-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="b6bae-330">No segundo caso, um administrador cria uma nova conta para outra pessoa.</span><span class="sxs-lookup"><span data-stu-id="b6bae-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="b6bae-331">Quando uma conta está sendo criada por um administrador para alguma outra pessoa, pode ser útil permitir que o administrador especifique as funções que a nova conta de usuário pertence.</span><span class="sxs-lookup"><span data-stu-id="b6bae-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="b6bae-332">No <a id="_msoanchor_4"> </a> [ *armazenamento* *informações adicionais do usuário* ](../membership/storing-additional-user-information-cs.md) tutorial vimos como personalizar CreateUserWizard adicionando adicionais `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="b6bae-333">Vamos ver como adicionar uma etapa adicional para CreateUserWizard para especificar as novas funções do usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="b6bae-334">Abra o `CreateUserWizardWithRoles.aspx` página e adicione um controle CreateUserWizard chamado `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="b6bae-335">Definir o controle `ContinueDestinationPageUrl` propriedade como "~ / default. aspx".</span><span class="sxs-lookup"><span data-stu-id="b6bae-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="b6bae-336">Como a ideia aqui é que um administrador usará esse controle CreateUserWizard para criar novas contas de usuário, defina o controle `LoginCreatedUser` a propriedade como False.</span><span class="sxs-lookup"><span data-stu-id="b6bae-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="b6bae-337">Isso `LoginCreatedUser` propriedade especifica se o visitante é automaticamente conectado como usuário recém-criada e o padrão é True.</span><span class="sxs-lookup"><span data-stu-id="b6bae-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="b6bae-338">Vamos configurá-lo como False quando um administrador cria uma nova conta queremos mantê-lo conectado como ele mesmo.</span><span class="sxs-lookup"><span data-stu-id="b6bae-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="b6bae-339">Em seguida, selecione o "Adicionar ou remover `WizardSteps`..."</span><span class="sxs-lookup"><span data-stu-id="b6bae-339">Next, select the "Add/Remove `WizardSteps`…"</span></span> <span data-ttu-id="b6bae-340">opção de marca inteligente do CreateUserWizard e adicionar um novo `WizardStep`, configuração seu `ID` para `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-340">option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="b6bae-341">Mover o `SpecifyRolesStep WizardStep` para que ele vem após a etapa de "Logon se sua nova conta", mas antes da etapa "Concluído".</span><span class="sxs-lookup"><span data-stu-id="b6bae-341">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="b6bae-342">Definir o `WizardStep`do `Title` propriedade como "Especificar funções", seu `StepType` propriedade `Step`e seu `AllowReturn` propriedade como False.</span><span class="sxs-lookup"><span data-stu-id="b6bae-342">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="b6bae-343">[![Adicionar o](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-343">[![Add the](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span></span>

<span data-ttu-id="b6bae-344">**Figura 11**: adicionar "Especificar funções" `WizardStep` para CreateUserWizard ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-344">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>


<span data-ttu-id="b6bae-345">Depois dessa alteração declarativo do CreateUserWizard deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="b6bae-345">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="b6bae-346">Em "Funções especificar" `WizardStep`, adicionar um CheckBoxList denominado `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-346">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="b6bae-347">Este CheckBoxList listará as funções disponíveis, permitindo que a pessoa visitar a página verificar se as funções que pertence o usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-347">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="b6bae-348">Continuamos com duas tarefas de codificação: primeiro é necessário preencher o `RoleList` CheckBoxList com as funções do sistema; em seguida, precisamos adicionar o usuário criado para as funções selecionadas quando o usuário move da etapa "Especificar funções" para a etapa "Completo".</span><span class="sxs-lookup"><span data-stu-id="b6bae-348">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="b6bae-349">Podemos pode fazer a primeira tarefa no `Page_Load` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="b6bae-349">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="b6bae-350">O código a seguir programaticamente as referências a `RoleList` caixa de seleção na primeira visita à página e uma associação as funções no sistema.</span><span class="sxs-lookup"><span data-stu-id="b6bae-350">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="b6bae-351">O código acima deve parecer familiar.</span><span class="sxs-lookup"><span data-stu-id="b6bae-351">The above code should look familiar.</span></span> <span data-ttu-id="b6bae-352">No <a id="_msoanchor_5"> </a> [ *armazenamento* *informações adicionais do usuário* ](../membership/storing-additional-user-information-cs.md) tutorial, usamos dois `FindControl` instruções para fazer referência a um controle da Web de dentro de um personalizado `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-352">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="b6bae-353">E o código que associa as funções para o CheckBoxList foi obtido anteriormente neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="b6bae-353">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="b6bae-354">Para executar a segunda tarefa de programação, precisamos saber quando a etapa "Especificar funções" foi concluída.</span><span class="sxs-lookup"><span data-stu-id="b6bae-354">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="b6bae-355">Lembre-se que o CreateUserWizard tem um `ActiveStepChanged` evento, que é acionado sempre que o visitante navega a partir de uma etapa para outra.</span><span class="sxs-lookup"><span data-stu-id="b6bae-355">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="b6bae-356">Aqui é possível determinar se o usuário atingiu a etapa "Completo". Nesse caso, precisamos adicionar o usuário a funções selecionadas.</span><span class="sxs-lookup"><span data-stu-id="b6bae-356">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="b6bae-357">Criar um manipulador de eventos para o `ActiveStepChanged` evento e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="b6bae-357">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="b6bae-358">Se o usuário atingiu apenas a etapa de "Concluído", o manipulador de eventos enumera os itens do `RoleList` CheckBoxList e o usuário recém-criada é atribuído às funções selecionadas.</span><span class="sxs-lookup"><span data-stu-id="b6bae-358">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="b6bae-359">Visite essa página através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="b6bae-359">Visit this page through a browser.</span></span> <span data-ttu-id="b6bae-360">A primeira etapa na CreateUserWizard é a etapa de "Logon se sua nova conta" padrão, que solicitará o novo nome do usuário, senha, email e outras informações importantes.</span><span class="sxs-lookup"><span data-stu-id="b6bae-360">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="b6bae-361">Insira as informações para criar um novo usuário chamado Wanda.</span><span class="sxs-lookup"><span data-stu-id="b6bae-361">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="b6bae-362">[![Criar um novo usuário chamado Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-362">[![Create a New User Named Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span></span>

<span data-ttu-id="b6bae-363">**Figura 12**: criar um novo usuário chamado Wanda ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-363">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>


<span data-ttu-id="b6bae-364">Clique no botão "Criar usuário".</span><span class="sxs-lookup"><span data-stu-id="b6bae-364">Click the "Create User" button.</span></span> <span data-ttu-id="b6bae-365">CreateUserWizard chama internamente o `Membership.CreateUser` método, criar a nova conta de usuário e, em seguida, passa para a próxima etapa, "Especifica funções."</span><span class="sxs-lookup"><span data-stu-id="b6bae-365">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="b6bae-366">Aqui, as funções do sistema são listadas.</span><span class="sxs-lookup"><span data-stu-id="b6bae-366">Here the system roles are listed.</span></span> <span data-ttu-id="b6bae-367">Marque a caixa de seleção de supervisores e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="b6bae-367">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="b6bae-368">[![Tornar um membro da função de supervisores de Wanda](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-368">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span></span>

<span data-ttu-id="b6bae-369">**Figura 13**: tornar um membro da função de supervisores de Wanda ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-369">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>


<span data-ttu-id="b6bae-370">Clicar em Avançar causa um postback e atualizações de `ActiveStep` para a etapa "Completo".</span><span class="sxs-lookup"><span data-stu-id="b6bae-370">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="b6bae-371">No `ActiveStepChanged` manipulador de eventos, a conta de usuário criado recentemente é atribuída à função de supervisores.</span><span class="sxs-lookup"><span data-stu-id="b6bae-371">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="b6bae-372">Para verificar isso, retornar o `UsersAndRoles.aspx` página e selecione supervisores do `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b6bae-372">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="b6bae-373">Como mostra a Figura 14, supervisores agora são compostos de três usuários: Bruce Tito e Wanda.</span><span class="sxs-lookup"><span data-stu-id="b6bae-373">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="b6bae-374">[![Bruce, Tito e Wanda são todos os supervisores](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="b6bae-374">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span></span>

<span data-ttu-id="b6bae-375">**Figura 14**: Bruce, Tito e Wanda são todos os supervisores ([clique para exibir a imagem em tamanho normal](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="b6bae-375">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b6bae-376">Resumo</span><span class="sxs-lookup"><span data-stu-id="b6bae-376">Summary</span></span>

<span data-ttu-id="b6bae-377">A estrutura de funções oferece métodos para recuperar informações sobre funções e métodos para determinar o que os usuários pertencem a uma função especificada de um usuário específico.</span><span class="sxs-lookup"><span data-stu-id="b6bae-377">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="b6bae-378">Além disso, há vários métodos para adicionar e remover um ou mais usuários para uma ou mais funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-378">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="b6bae-379">Este tutorial nos concentramos em apenas dois desses métodos: `AddUserToRole` e `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="b6bae-379">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="b6bae-380">Há variantes projetadas para adicionar vários usuários a uma única função e atribuir várias funções a um único usuário.</span><span class="sxs-lookup"><span data-stu-id="b6bae-380">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="b6bae-381">Este tutorial também incluídos examinar estendendo o controle CreateUserWizard para incluir um `WizardStep` para especificar as funções do usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="b6bae-381">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="b6bae-382">Essa é uma etapa pode ajudar um administrador simplificar o processo de criação de contas de usuário para novos usuários.</span><span class="sxs-lookup"><span data-stu-id="b6bae-382">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="b6bae-383">Neste ponto, vimos como criar e excluir funções e como adicionar e remover usuários das funções.</span><span class="sxs-lookup"><span data-stu-id="b6bae-383">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="b6bae-384">Mas, ainda precisamos examinar aplicar a autorização baseada em função.</span><span class="sxs-lookup"><span data-stu-id="b6bae-384">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="b6bae-385">No <a id="_msoanchor_6"> </a> [seguinte tutorial](role-based-authorization-cs.md) examinaremos definindo regras de autorização de URL em uma base de função por função, bem como limitar a funcionalidade de nível de página com base nas funções do usuário conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="b6bae-385">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="b6bae-386">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="b6bae-386">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b6bae-387">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="b6bae-387">Further Reading</span></span>

<span data-ttu-id="b6bae-388">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="b6bae-388">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b6bae-389">Visão geral de ferramenta de administração de Site da Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b6bae-389">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="b6bae-390">Examinando ASP. Associação, funções e perfil do NET</span><span class="sxs-lookup"><span data-stu-id="b6bae-390">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="b6bae-391">Implantar sua própria ferramenta de administração de site</span><span class="sxs-lookup"><span data-stu-id="b6bae-391">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="b6bae-392">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="b6bae-392">About the Author</span></span>

<span data-ttu-id="b6bae-393">Scott Mitchell, autor de vários livros sobre ASP/ASP.NET e fundador da 4GuysFromRolla. com, trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="b6bae-393">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b6bae-394">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="b6bae-394">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b6bae-395">Seu livro mais recente é  *[Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="b6bae-395">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="b6bae-396">Scott pode ser contatado pelo [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) ou em seu blog [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="b6bae-396">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b6bae-397">Agradecimentos especiais a...</span><span class="sxs-lookup"><span data-stu-id="b6bae-397">Special Thanks To…</span></span>

<span data-ttu-id="b6bae-398">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="b6bae-398">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b6bae-399">Revisor levar para este tutorial foi Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="b6bae-399">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="b6bae-400">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="b6bae-400">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b6bae-401">Nesse caso, me enviar uma linha em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b6bae-401">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b6bae-402">[Anterior](creating-and-managing-roles-cs.md)
> [Próximo](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b6bae-402">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
