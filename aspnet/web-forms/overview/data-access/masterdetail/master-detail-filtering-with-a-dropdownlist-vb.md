---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: Mestre/detalhes filtragem com DropDownList (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, veremos como exibir os registros mestres em um controle DropDownList e os detalhes do item da lista selecionado em um controle GridView.
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 3f66e133b2bc8cdececf55b4d92508e6ff157d95
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/24/2018
---
<a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="5fb10-103">Filtragem com DropDownList (VB) mestre/detalhes</span><span class="sxs-lookup"><span data-stu-id="5fb10-103">Master/Detail Filtering With a DropDownList (VB)</span></span>
====================
<span data-ttu-id="5fb10-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5fb10-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5fb10-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) ou [baixar PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5fb10-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="5fb10-106">Neste tutorial, veremos como exibir os registros mestres em um controle DropDownList e os detalhes do item da lista selecionado em um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="5fb10-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="5fb10-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="5fb10-107">Introduction</span></span>

<span data-ttu-id="5fb10-108">Um tipo comum de relatório é o *relatório de detalhes/mestre*, em que o relatório começa mostrando um conjunto de registros "mestres".</span><span class="sxs-lookup"><span data-stu-id="5fb10-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="5fb10-109">O usuário pode, em seguida, fazer drill down em um dos registros mestres, assim, detalhes do registro mestre "."</span><span class="sxs-lookup"><span data-stu-id="5fb10-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="5fb10-110">Detalhes/mestre relatórios é uma opção ideal para visualizar relações um-para-muitos, como um relatório mostrando todas as categorias e, em seguida, permitir que um usuário selecione uma categoria específica e exibir seus produtos associados.</span><span class="sxs-lookup"><span data-stu-id="5fb10-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="5fb10-111">Além disso, os relatórios mestre/detalhes são úteis para exibir informações detalhadas de tabelas particularmente "grande" (aqueles que têm muitas colunas).</span><span class="sxs-lookup"><span data-stu-id="5fb10-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="5fb10-112">Por exemplo, o nível de "mestre" de um relatório de detalhes/mestre pode mostrar apenas o nome e a unidade de preço do produto de produtos no banco de dados e fazer uma busca detalhada em um determinado produto mostra os campos adicionais do produto (categoria, fornecedor, quantidade por unidade, e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="5fb10-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="5fb10-113">Há muitas maneiras com que um relatório de detalhes/mestre pode ser implementado.</span><span class="sxs-lookup"><span data-stu-id="5fb10-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="5fb10-114">Sobre isso e os próximos três tutoriais vamos examinar uma variedade de relatórios mestre/detalhes.</span><span class="sxs-lookup"><span data-stu-id="5fb10-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="5fb10-115">Neste tutorial, veremos como exibir os registros mestres em um [controle DropDownList](https://msdn.microsoft.com/library/dtx91y0z.aspx) e os detalhes do item da lista selecionado em um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="5fb10-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="5fb10-116">Em particular, o relatório de detalhes/mestre neste tutorial listará informações de categoria e produto.</span><span class="sxs-lookup"><span data-stu-id="5fb10-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="5fb10-117">Etapa 1: Exibindo as categorias em DropDownList</span><span class="sxs-lookup"><span data-stu-id="5fb10-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="5fb10-118">Nosso relatório mestre/detalhes listará as categorias de DropDownList, com produtos do item de lista selecionado exibidos mais abaixo na página em um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="5fb10-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="5fb10-119">A primeira tarefa à frente de nós, em seguida, é ter as categorias exibidas no DropDownList.</span><span class="sxs-lookup"><span data-stu-id="5fb10-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="5fb10-120">Abra o `FilterByDropDownList.aspx` página o `Filtering` pasta, arraste DropDownList da caixa de ferramentas para o designer da página e defina seu `ID` propriedade `Categories`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="5fb10-121">Em seguida, clique no link de marca inteligente do DropDownList Escolher fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="5fb10-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="5fb10-122">Isso exibirá o Assistente de configuração de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="5fb10-122">This will display the Data Source Configuration wizard.</span></span>


<span data-ttu-id="5fb10-123">[![Especifique a fonte de dados do DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="5fb10-124">**Figura 1**: especificar fonte de dados do DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>


<span data-ttu-id="5fb10-125">Escolha adicionar um novo ObjectDataSource denominado `CategoriesDataSource` que invoca o `CategoriesBLL` da classe `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="5fb10-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="5fb10-126">[![Adicionar um novo ObjectDataSource denominado CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="5fb10-127">**Figura 2**: adicionar um novo ObjectDataSource nomeado `CategoriesDataSource` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>


<span data-ttu-id="5fb10-128">[![Optar por usar a classe CategoriesBLL](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="5fb10-129">**Figura 3**: escolher usar o `CategoriesBLL` classe ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>


<span data-ttu-id="5fb10-130">[![Configurar o ObjectDataSource para usar o método GetCategories()](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="5fb10-131">**Figura 4**: configurar o ObjectDataSource para usar o `GetCategories()` método ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>


<span data-ttu-id="5fb10-132">Depois de configurar o ObjectDataSource ainda é necessário especificar o campo de fonte de dados deve ser exibido em DropDownList e quais um deve ser associado como o valor do item de lista.</span><span class="sxs-lookup"><span data-stu-id="5fb10-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="5fb10-133">Ter o `CategoryName` campo como a exibição e `CategoryID` como o valor para cada item de lista.</span><span class="sxs-lookup"><span data-stu-id="5fb10-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="5fb10-134">[![Ter a exibição DropDownList CategoryName campo e Use CategoryID como o valor](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="5fb10-135">**Figura 5**: têm a exibição DropDownList a `CategoryName` campo e Use `CategoryID` como o valor ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>


<span data-ttu-id="5fb10-136">Neste ponto, temos um controle DropDownList que é preenchido com os registros da `Categories` tabela (todos realizada em cerca de cinco segundos).</span><span class="sxs-lookup"><span data-stu-id="5fb10-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="5fb10-137">A Figura 6 mostra nosso progresso até o momento quando visualizada através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5fb10-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="5fb10-138">[![Uma lista suspensa lista as categorias atuais](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="5fb10-139">**Figura 6**: A lista suspensa lista as categorias atual ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>


## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="5fb10-140">Etapa 2: Adicionando produtos GridView</span><span class="sxs-lookup"><span data-stu-id="5fb10-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="5fb10-141">A última etapa em nosso relatório mestre/detalhes é listar os produtos associados a categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="5fb10-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="5fb10-142">Para fazer isso, adicione um controle GridView à página e criar um novo ObjectDataSource denominado `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="5fb10-143">Ter o `productsDataSource` controle analisar seus dados a partir de `ProductsBLL` da classe `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="5fb10-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="5fb10-144">[![Selecione o método GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="5fb10-145">**Figura 7**: selecione o `GetProductsByCategoryID(categoryID)` método ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>


<span data-ttu-id="5fb10-146">Depois de escolher esse método, o assistente ObjectDataSource solicita a nós para o valor para o método  *`categoryID`*  parâmetro.</span><span class="sxs-lookup"><span data-stu-id="5fb10-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="5fb10-147">Para usar o valor do selecionado `categories` item DropDownList define a origem de parâmetro de controle e ControlID para `Categories`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="5fb10-148">[![Defina o parâmetro categoryID com o valor de DropDownList categorias](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="5fb10-149">**Figura 8**: definir o  *`categoryID`*  parâmetro para o valor da `Categories` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>


<span data-ttu-id="5fb10-150">Responda fazer check-out nosso progresso em um navegador.</span><span class="sxs-lookup"><span data-stu-id="5fb10-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="5fb10-151">Ao primeiro visitar a página, os produtos pertencem à categoria selecionada (Bebidas) são exibidas (conforme mostrado na Figura 9), mas alterar DropDownList não atualiza os dados.</span><span class="sxs-lookup"><span data-stu-id="5fb10-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="5fb10-152">Isso ocorre porque um postback deve ocorrer para que o GridView atualizar.</span><span class="sxs-lookup"><span data-stu-id="5fb10-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="5fb10-153">Para fazer isso, temos duas opções (nenhum deles requer gravar nenhum código):</span><span class="sxs-lookup"><span data-stu-id="5fb10-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="5fb10-154">**Definir as categorias DropDownList**[propriedade AutoPostBack](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**como True.**</span><span class="sxs-lookup"><span data-stu-id="5fb10-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="5fb10-155">(Você pode fazer isso marcando a opção Enable AutoPostBack na marca inteligente do DropDownList.) Isso vai disparar um postback sempre que a DropDownList selecionada item é alterado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="5fb10-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="5fb10-156">Portanto, quando o usuário seleciona uma nova categoria na lista suspensa um postback ocorrerá e GridView será atualizada com os produtos para a categoria selecionada recentemente.</span><span class="sxs-lookup"><span data-stu-id="5fb10-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="5fb10-157">(Essa é a abordagem usados neste tutorial.)</span><span class="sxs-lookup"><span data-stu-id="5fb10-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="5fb10-158">**Adicione um controle de botão Web ao lado de DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="5fb10-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="5fb10-159">Definir seu `Text` propriedade para atualização ou algo semelhante.</span><span class="sxs-lookup"><span data-stu-id="5fb10-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="5fb10-160">Com essa abordagem, o usuário deverá selecionar uma nova categoria e, em seguida, clique no botão.</span><span class="sxs-lookup"><span data-stu-id="5fb10-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="5fb10-161">Clique no botão causar um postback e atualizar o GridView para listar os produtos da categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="5fb10-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="5fb10-162">Figuras 9 e 10 ilustram o relatório de detalhes/mestre em ação.</span><span class="sxs-lookup"><span data-stu-id="5fb10-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="5fb10-163">[![Quando o primeiro visitando a página, os produtos de bebidas são exibidos](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="5fb10-164">**Figura 9**: ao primeiro visitar a página, os produtos de bebidas são exibidos ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>


<span data-ttu-id="5fb10-165">[![Selecionar um novo produto (produção) automaticamente faz com que um PostBack, atualizando o GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="5fb10-166">**Figura 10**: selecionar um novo produto (produção) automaticamente faz com que um PostBack, atualizando o GridView ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="5fb10-167">Adicionar um Item de lista "-- Escolha uma categoria –"</span><span class="sxs-lookup"><span data-stu-id="5fb10-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="5fb10-168">Ao visitar primeiro o `FilterByDropDownList.aspx` página as categorias primeiro item da lista do DropDownList (Bebidas) é selecionado por padrão, mostrando os produtos de bebidas em GridView.</span><span class="sxs-lookup"><span data-stu-id="5fb10-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="5fb10-169">Em vez de Mostrar produtos da primeira categoria, que queremos ter em vez disso, um item DropDownList selecionado que diz que algo como "-- Escolha uma categoria –".</span><span class="sxs-lookup"><span data-stu-id="5fb10-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="5fb10-170">Para adicionar um novo item de lista a DropDownList, vá para a janela de propriedades e clique nas elipses no `Items` propriedade.</span><span class="sxs-lookup"><span data-stu-id="5fb10-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="5fb10-171">Adicionar um novo item de lista com o `Text` "-- Escolha uma categoria –" e o `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>


<span data-ttu-id="5fb10-172">[![Adicionar um – escolha uma categoria - Item de lista](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="5fb10-173">**Figura 11**: adicionar um – escolha uma categoria - Item de lista ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>


<span data-ttu-id="5fb10-174">Como alternativa, você pode adicionar o item de lista, adicionando a seguinte marcação para DropDownList:</span><span class="sxs-lookup"><span data-stu-id="5fb10-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>


[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="5fb10-175">Além disso, é preciso definir o controle de DropDownList `AppendDataBoundItems` como True porque quando as categorias são associadas a DropDownList de ObjectDataSource vai substituir itens de lista adicionados manualmente se `AppendDataBoundItems` não é True.</span><span class="sxs-lookup"><span data-stu-id="5fb10-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>


![Defina a propriedade AppendDataBoundItems como True](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="5fb10-177">**Figura 12**: definir o `AppendDataBoundItems` propriedade como True</span><span class="sxs-lookup"><span data-stu-id="5fb10-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="5fb10-178">Após essas alterações, quando o primeiro visitar a página é selecionada a opção "-- Escolha uma categoria –" e nenhum produto é exibido.</span><span class="sxs-lookup"><span data-stu-id="5fb10-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>


<span data-ttu-id="5fb10-179">[![O carregamento de página inicial sem produtos são exibidos.](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="5fb10-180">**Figura 13**: sobre o inicial página carga não produtos são exibidos ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>


<span data-ttu-id="5fb10-181">O motivo pelo qual não há produtos são exibidos quando porque o item de lista "-- Escolha uma categoria –" é selecionado é porque seu valor é `-1` e não há nenhum produto no banco de dados com um `CategoryID` de `-1`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="5fb10-182">Se esse é o comportamento desejado e terminar agora!</span><span class="sxs-lookup"><span data-stu-id="5fb10-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="5fb10-183">Se, no entanto, você deseja exibir *todos os* das categorias de quando o item de lista "-- Escolha uma categoria –" é selecionado, retorne para o `ProductsBLL` classe e personalizar o `GetProductsByCategoryID(categoryID)` método para que ele chama o `GetProducts()` método se passado na  *`categoryID`*  parâmetro é menor que zero:</span><span class="sxs-lookup"><span data-stu-id="5fb10-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>


[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="5fb10-184">A técnica usada aqui é similar à abordagem são usados para exibir todos os fornecedores de volta a [parâmetros declarativos](../basic-reporting/declarative-parameters-cs.md) tutorial, embora para este exemplo, estamos usando um valor de `-1` para indicar que todos os registros devem ser recuperar em vez de `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="5fb10-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="5fb10-185">Isso ocorre porque o  *`categoryID`*  parâmetro o `GetProductsByCategoryID(categoryID)` método espera como valor de inteiro passado, enquanto o tutorial de parâmetros declarativos foram passando um parâmetro de entrada de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="5fb10-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="5fb10-186">A Figura 14 mostra uma captura de tela de `FilterByDropDownList.aspx` quando a opção "-- Escolha uma categoria –" estiver selecionada.</span><span class="sxs-lookup"><span data-stu-id="5fb10-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="5fb10-187">Aqui, todos os produtos são exibidos por padrão, e o usuário pode restringir a exibição, escolhendo uma categoria específica.</span><span class="sxs-lookup"><span data-stu-id="5fb10-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>


<span data-ttu-id="5fb10-188">[![Todos os produtos estão agora listados por padrão](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="5fb10-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="5fb10-189">**Figura 14**: todos os produtos estão agora listados por padrão ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="5fb10-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>


## <a name="summary"></a><span data-ttu-id="5fb10-190">Resumo</span><span class="sxs-lookup"><span data-stu-id="5fb10-190">Summary</span></span>

<span data-ttu-id="5fb10-191">Ao exibir dados relacionados hierarquicamente, isso geralmente ajuda a apresentar os dados usando os relatórios de detalhes/mestre, do qual o usuário pode começar a examinar os dados da parte superior da hierarquia e fazer drill down nos detalhes.</span><span class="sxs-lookup"><span data-stu-id="5fb10-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="5fb10-192">Neste tutorial examinamos a criação de um relatório simples mestre/detalhes mostrando produtos de uma determinada categoria.</span><span class="sxs-lookup"><span data-stu-id="5fb10-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="5fb10-193">Isso foi realizado usando DropDownList para a lista de categorias e GridView para os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="5fb10-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="5fb10-194">No [tutorial próxima](master-detail-filtering-with-two-dropdownlists-vb.md) levaremos o DropDownList interface, uma etapa adicional, usando dois DropDownLists.</span><span class="sxs-lookup"><span data-stu-id="5fb10-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="5fb10-195">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="5fb10-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5fb10-196">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="5fb10-196">About the Author</span></span>

<span data-ttu-id="5fb10-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="5fb10-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5fb10-198">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="5fb10-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5fb10-199">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5fb10-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5fb10-200">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5fb10-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="5fb10-201">[Anterior](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Próximo](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5fb10-201">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>
