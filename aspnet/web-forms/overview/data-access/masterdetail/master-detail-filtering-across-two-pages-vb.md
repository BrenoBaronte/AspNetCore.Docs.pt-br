---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: Mestre/detalhes filtragem em duas páginas (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, implementaremos esse padrão usando um GridView para listar os fornecedores no banco de dados. Cada linha de fornecedor em GridView conterá um e de exibição...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: b8250c0f8d1befacf66d6be517514aad8bc31b09
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30886999"
---
<a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="c1ca7-104">Filtragem em duas páginas (VB) mestre/detalhes</span><span class="sxs-lookup"><span data-stu-id="c1ca7-104">Master/Detail Filtering Across Two Pages (VB)</span></span>
====================
<span data-ttu-id="c1ca7-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c1ca7-106">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) ou [baixar PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="c1ca7-107">Neste tutorial, implementaremos esse padrão usando um GridView para listar os fornecedores no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="c1ca7-108">Cada linha de fornecedor em GridView conterá um link de produtos de modo que, quando clicado, levará o usuário para uma página separada que lista os produtos para o fornecedor selecionado.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>


## <a name="introduction"></a><span data-ttu-id="c1ca7-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="c1ca7-109">Introduction</span></span>

<span data-ttu-id="c1ca7-110">Nos dois tutoriais anteriores, vimos como exibir relatórios mestre/detalhes em uma única página da web usando DropDownLists para exibir os registros de "mestres" e um [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) ou [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) controle para exibir o " Detalhes".</span><span class="sxs-lookup"><span data-stu-id="c1ca7-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="c1ca7-111">Outro padrão comum usado para relatórios de detalhes/mestre é o registro mestre em uma página da web e os detalhes exibidos em outro.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="c1ca7-112">Um site de fórum, como [fóruns do ASP.NET](https://forums.asp.net/), é um bom exemplo desse padrão na prática.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="c1ca7-113">Fóruns do ASP.NET são compostos de uma variedade de fóruns do guia de Introdução, formulários da Web, controles de apresentação de dados e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="c1ca7-114">Cada Fórum é composto de vários threads e cada thread é composto de um número de mensagens.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="c1ca7-115">Na home page fóruns do ASP.NET, os fóruns são listados.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="c1ca7-116">Clicar em um fórum levado a uma `ShowForum.aspx` página, que lista os threads de Fórum.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="c1ca7-117">Da mesma forma, clicando em um thread necessário para `ShowPost.aspx`, que exibe as postagens do thread foi clicado.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="c1ca7-118">Neste tutorial, implementaremos esse padrão usando um GridView para listar os fornecedores no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="c1ca7-119">Cada linha de fornecedor em GridView conterá um link de produtos de modo que, quando clicado, levará o usuário para uma página separada que lista os produtos para o fornecedor selecionado.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="c1ca7-120">Etapa 1: Adicionando`SupplierListMaster.aspx`e`ProductsForSupplierDetails.aspx`páginas para o`Filtering`pasta</span><span class="sxs-lookup"><span data-stu-id="c1ca7-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="c1ca7-121">Ao definir o layout de página no terceiro tutorial adicionamos um número de páginas "início" o `BasicReporting`, `Filtering`, e `CustomFormatting` pastas.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="c1ca7-122">No entanto, não adicionamos uma página inicial para este tutorial nesse momento, portanto, dedique um tempo para adicionar duas novas páginas para o `Filtering` pasta: `SupplierListMaster.aspx` e `ProductsForSupplierDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="c1ca7-123">`SupplierListMaster.aspx` lista os registros "mestres" (os fornecedores) ao `ProductsForSupplierDetails.aspx` exibirá os produtos para o fornecedor selecionado.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="c1ca7-124">Ao criar essas duas novas páginas ser determinadas para associá-los com o `Site.master` página mestra.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>


![Adicionar as páginas de ProductsForSupplierDetails.aspx e SupplierListMaster.aspx para a pasta de filtragem](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="c1ca7-126">**Figura 1**: adicionar o `SupplierListMaster.aspx` e `ProductsForSupplierDetails.aspx` páginas para o `Filtering` pasta</span><span class="sxs-lookup"><span data-stu-id="c1ca7-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>


<span data-ttu-id="c1ca7-127">Além disso, ao adicionar novas páginas ao projeto, certifique-se atualizar o arquivo de mapa de site, `Web.sitemap`, adequadamente.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="c1ca7-128">Para este tutorial simplesmente adicionar o `SupplierListMaster.aspx` página para o mapa do site usando o seguinte conteúdo XML como um filho dos relatórios de filtragem `<siteMapNode>` elemento:</span><span class="sxs-lookup"><span data-stu-id="c1ca7-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>


[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="c1ca7-129">Você pode ajudar a automatizar o processo de atualizar o arquivo de mapa do site quando adicionar novos ASP.NET páginas usando [K. Scott Allen](http://odetocode.com/Blogs/scott/)do Visual Studio de livre [macros de mapa de Site](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span><span class="sxs-lookup"><span data-stu-id="c1ca7-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>


## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="c1ca7-130">Etapa 2: Exibir a lista de fornecedor no`SupplierListMaster.aspx`</span><span class="sxs-lookup"><span data-stu-id="c1ca7-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="c1ca7-131">Com o `SupplierListMaster.aspx` e `ProductsForSupplierDetails.aspx` páginas criadas, nossa próxima etapa é criar o GridView de fornecedores `SupplierListMaster.aspx`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="c1ca7-132">Adicionar um controle GridView à página e associá-lo a um novo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="c1ca7-133">Este ObjectDataSource deve usar o `SuppliersBLL` da classe `GetSuppliers()` método para retornar todos os fornecedores.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>


<span data-ttu-id="c1ca7-134">[![Selecione a classe SuppliersBLL](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="c1ca7-135">**Figura 2**: selecione o `SuppliersBLL` classe ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>


<span data-ttu-id="c1ca7-136">[![Configurar o ObjectDataSource para usar o método GetSuppliers()](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="c1ca7-137">**Figura 3**: configurar o ObjectDataSource para usar o `GetSuppliers()` método ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>


<span data-ttu-id="c1ca7-138">É preciso incluir um link chamado exibir produtos em cada linha GridView que, quando clicado, leva o usuário para `ProductsForSupplierDetails.aspx` passando a linha selecionada `SupplierID` valor por meio de querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="c1ca7-139">Por exemplo, se o usuário clica no link Exibir produtos para o fornecedor de Tokyo Traders (que tem um `SupplierID` valor de 4), eles devem ser enviados para `ProductsForSupplierDetails.aspx?SupplierID=4`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="c1ca7-140">Para fazer isso, adicione um [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) GridView, que adiciona um hiperlink para cada linha em GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="c1ca7-141">Iniciar clicando no link Editar colunas de marcas inteligentes do GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="c1ca7-142">Em seguida, selecione o HyperLinkField da lista na parte superior esquerda e clique em Adicionar para incluir o HyperLinkField na lista de campos do GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>


<span data-ttu-id="c1ca7-143">[![Adicionar um HyperLinkField a GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="c1ca7-144">**Figura 4**: adicionar um HyperLinkField a GridView ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>


<span data-ttu-id="c1ca7-145">O HyperLinkField pode ser configurado para usar o mesmo texto ou URL valores no link em cada linha em GridView, ou pode basear esses valores nos valores de dados associados a cada linha específica.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="c1ca7-146">Para especificar um estático valor em todas as linhas usar o HyperLinkField `Text` ou `NavigateUrl` propriedades.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="c1ca7-147">Como queremos que o texto do link para ser o mesmo para todas as linhas, definir o HyperLinkField `Text` propriedade para exibir os produtos.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>


<span data-ttu-id="c1ca7-148">[![Defina a propriedade de texto do HyperLinkField para exibir os produtos](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="c1ca7-149">**Figura 5**: definir o HyperLinkField `Text` propriedade para exibir os produtos ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>


<span data-ttu-id="c1ca7-150">Para definir o texto ou valores de URL a ser com base nos dados subjacentes associados à linha GridView, especifique o texto de campos de dados ou valores da URL devem ser extraídos no `DataTextField` ou `DataNavigateUrlFields` propriedades.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="c1ca7-151">`DataTextField` só pode ser definida como um único campo de dados; `DataNavigateUrlFields`, no entanto, pode ser definido como uma lista delimitada por vírgulas de campos de dados.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="c1ca7-152">Com frequência, é preciso basear o texto ou a URL em uma combinação de valor de campo de dados da linha atual e alguns marcação estática.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="c1ca7-153">Neste tutorial, por exemplo, queremos que a URL de links do HyperLinkField ser `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, onde *`supplierID`* é uma linha de cada GridView `SupplierID` valor.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="c1ca7-154">Observe que precisamos estáticos e controlados por dados valores aqui: o `ProductsForSupplierDetails.aspx?SupplierID=` parte da URL do link é estático, enquanto o *`supplierID`* parte é controlada por dados como seu valor é a cada linha própria `SupplierID` valor.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="c1ca7-155">Para indicar uma combinação de valores estáticos e controlados por dados, use o `DataTextFormatString` e `DataNavigateUrlFormatString` propriedades.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="c1ca7-156">Nessas propriedades, digite a marcação estática conforme necessário e, em seguida, use o marcador `{0}` onde você deseja que o valor do campo especificado no `DataTextField` ou `DataNavigateUrlFields` propriedades a serem exibidos.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="c1ca7-157">Se o `DataNavigateUrlFields` propriedade tem uso especificado do vários campos `{0}` onde você deseja que o primeiro valor do campo inserido, `{1}` para o segundo valor de campo e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="c1ca7-158">Aplicar isso em nosso tutorial, precisamos definir o `DataNavigateUrlFields` propriedade `SupplierID`, já que é o campo de dados cujo valor é necessário para personalizar em uma base por linha, e o `DataNavigateUrlFormatString` propriedade `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>


<span data-ttu-id="c1ca7-159">[![Configurar o HyperLinkField para incluir a URL do Link apropriado com base no SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="c1ca7-160">**Figura 6**: configurar o HyperLinkField para incluir o adequada Link URL com base na `SupplierID` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>


<span data-ttu-id="c1ca7-161">Depois de adicionar o HyperLinkField, fique à vontade para personalizar e reordenar os campos do GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="c1ca7-162">A marcação a seguir mostra GridView depois de feitas algumas personalizações secundárias do nível de campo.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>


[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="c1ca7-163">Reserve um tempo para exibir o `SupplierListMaster.aspx` página através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="c1ca7-164">Como mostra a Figura 7, a página atualmente lista todos os fornecedores, incluindo um link Exibir produtos.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="c1ca7-165">Clicando em Exibir produtos link o levará para `ProductsForSupplierDetails.aspx`, passando ao longo do fornecedor `SupplierID` na querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>


<span data-ttu-id="c1ca7-166">[![Cada linha de fornecedor contém um Link de produtos do modo de exibição](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="c1ca7-167">**Figura 7**: cada linha de fornecedor contém um Link de produtos do modo de exibição ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>


## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="c1ca7-168">Etapa 3: Lista os produtos do fornecedor no`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="c1ca7-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="c1ca7-169">Neste ponto o `SupplierListMaster.aspx` página está enviando os usuários `ProductsForSupplierDetails.aspx`, passando o fornecedor selecionado `SupplierID` na querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="c1ca7-170">Etapa final do tutorial é exibir os produtos em um GridView no `ProductsForSupplierDetails.aspx` cujo `SupplierID` é igual a `SupplierID` passado querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="c1ca7-171">Para fazer isso, inicie adicionando um controle GridView para o `ProductsForSupplierDetails.aspx` página, usando um novo controle ObjectDataSource chamado `ProductsBySupplierDataSource` que invoca o `GetProductsBySupplierID(supplierID)` método do `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>


<span data-ttu-id="c1ca7-172">[![Adicionar um novo ObjectDataSource denominado ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="c1ca7-173">**Figura 8**: adicionar um novo ObjectDataSource nomeado `ProductsBySupplierDataSource` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>


<span data-ttu-id="c1ca7-174">[![Selecione a classe ProductsBLL](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="c1ca7-175">**Figura 9**: selecione o `ProductsBLL` classe ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>


<span data-ttu-id="c1ca7-176">[![Ter o ObjectDataSource invocar o método GetProductsBySupplierID(supplierID)](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="c1ca7-177">**Figura 10**: tem o ObjectDataSource invocar o `GetProductsBySupplierID(supplierID)` método ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>


<span data-ttu-id="c1ca7-178">A etapa final do Assistente para configurar a fonte de dados nos pede para fornecer a origem do `GetProductsBySupplierID(supplierID)` do método *`supplierID`* parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="c1ca7-179">Para usar o valor de querystring, defina a origem do parâmetro QueryString e insira o nome do valor de querystring para usar na caixa de texto QueryStringField (`SupplierID`).</span><span class="sxs-lookup"><span data-stu-id="c1ca7-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>


<span data-ttu-id="c1ca7-180">[![Preencher o valor do parâmetro do valor de Querystring SupplierID supplierID](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="c1ca7-181">**Figura 11**: preencher o *`supplierID`* valor do parâmetro de `SupplierID` valor de Querystring ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>


<span data-ttu-id="c1ca7-182">Isso é tudo que é necessário para que ele!</span><span class="sxs-lookup"><span data-stu-id="c1ca7-182">That's all there is to it!</span></span> <span data-ttu-id="c1ca7-183">A Figura 12 mostra o `ProductsForSupplierDetails.aspx` página quando visitado clicando no link de Tokyo Traders de `SupplierListMaster.aspx`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>


<span data-ttu-id="c1ca7-184">[![Os produtos fornecidos pela Tokyo Traders são mostrados](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="c1ca7-185">**Figura 12**: os produtos fornecidos pela Tokyo Traders são mostrados ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>


## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="c1ca7-186">Exibindo informações do fornecedor no`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="c1ca7-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="c1ca7-187">Como mostra a Figura 12, o `ProductsForSupplierDetails.aspx` página simplesmente lista os produtos que são fornecidos pelo `SupplierID` especificado na querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="c1ca7-188">Alguém enviados diretamente para essa página, no entanto, não saberia que Figura 12 está mostrando produtos Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="c1ca7-189">Para corrigir isso, que podemos exibir informações de fornecedor também nesta página.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="c1ca7-190">Comece adicionando um FormView acima os produtos GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="c1ca7-191">Criar um novo controle ObjectDataSource chamado `SuppliersDataSource` que invoca o `SuppliersBLL` da classe `GetSupplierBySupplierID(supplierID)` método.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>


<span data-ttu-id="c1ca7-192">[![Selecione a classe SuppliersBLL](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="c1ca7-193">**Figura 13**: selecione o `SuppliersBLL` classe ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>


<span data-ttu-id="c1ca7-194">[![Ter o ObjectDataSource invocar o método GetSupplierBySupplierID(supplierID)](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="c1ca7-195">**Figura 14**: tem o ObjectDataSource invocar o `GetSupplierBySupplierID(supplierID)` método ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>


<span data-ttu-id="c1ca7-196">Assim como acontece com o `ProductsBySupplierDataSource`, ter o *`supplierID`* parâmetro recebe o valor da `SupplierID` valor de querystring.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>


<span data-ttu-id="c1ca7-197">[![Preencher o valor do parâmetro do valor de Querystring SupplierID supplierID](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="c1ca7-198">**Figura 15**: preencher o *`supplierID`* valor do parâmetro de `SupplierID` valor de Querystring ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>


<span data-ttu-id="c1ca7-199">Ao associar o FormView a ObjectDataSource no modo Design, o Visual Studio criará automaticamente o FormView `ItemTemplate`, `InsertItemTemplate`, e `EditItemTemplate` com controles de rótulo e da Web da caixa de texto para cada um dos campos de dados retornados pelo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="c1ca7-200">Como queremos apenas exibir fornecedor informações à vontade remover o `InsertItemTemplate` e `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="c1ca7-201">Em seguida, edite o ItemTemplate para que ele exibe o nome da empresa do fornecedor em um `<h3>` elemento e o endereço, cidade, país e número de telefone abaixo do nome da empresa.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="c1ca7-202">Como alternativa, você pode definir manualmente o FormView `DataSourceID` e crie o `ItemTemplate` marcação, como foi volta a "[exibindo dados com o ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="c1ca7-203">Após essas edições marcação declarativa de FormView deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="c1ca7-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="c1ca7-204">A Figura 16 mostra uma captura de tela de `ProductsForSupplierDetails.aspx` página depois que as informações do fornecedor detalhadas acima foi incluídas.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>


<span data-ttu-id="c1ca7-205">[![A lista de produtos inclui um resumo sobre o fornecedor](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="c1ca7-206">**Figura 16**: A lista de produtos inclui um resumo sobre o fornecedor ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>


## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="c1ca7-207">Aplicar o último toca para o`ProductsForSupplierDetails.aspx`interface do usuário</span><span class="sxs-lookup"><span data-stu-id="c1ca7-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="c1ca7-208">Para melhorar o usuário experiência para este relatório lá estão algumas inclusões devemos fazer o `ProductsForSupplierDetails.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="c1ca7-209">Atualmente a única maneira de um usuário pode ir do `ProductsForSupplierDetails.aspx` página de volta para a lista de fornecedores é clique do botão Voltar do seu navegador.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="c1ca7-210">Vamos adicionar um controle de hiperlink para o `ProductsForSupplierDetails.aspx` página links de volta para `SupplierListMaster.aspx`, fornecendo outra maneira para o usuário retornar à lista mestra.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>


<span data-ttu-id="c1ca7-211">[![Adicionar um controle de hiperlink para levar o usuário ao SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="c1ca7-212">**Figura 17**: adicionar um controle de hiperlink para levar o usuário voltar para `SupplierListMaster.aspx` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>


<span data-ttu-id="c1ca7-213">Se o usuário clica no link Exibir produtos para um fornecedor que não tenha todos os produtos, o `ProductsBySupplierDataSource` ObjectDataSource em `ProductsForSupplierDetails.aspx` não retornar nenhum resultado.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="c1ca7-214">O GridView associado a ObjectDataSource não processa qualquer marcação resultando em uma região em branco na página no navegador do usuário.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="c1ca7-215">Para maior clareza se comunicar com o usuário que não há nenhum produto associado com o fornecedor selecionado podemos definir o GridView `EmptyDataText` propriedade na mensagem que deseja exibir quando surge uma situação.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="c1ca7-216">Defini essa propriedade como "Não há nenhum produto fornecido por esse fornecedor"</span><span class="sxs-lookup"><span data-stu-id="c1ca7-216">I've set this property to "There are no products provided by this supplier�"</span></span>

<span data-ttu-id="c1ca7-217">Por padrão, todos os fornecedores no banco de dados Northwind fornecem pelo menos um produto.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="c1ca7-218">No entanto, para este tutorial, você modificado manualmente o `Products` para que o fornecedor Escargots Nouveaux não está mais associado a todos os produtos da tabela.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="c1ca7-219">Figura 18 mostra a página de detalhes para Escargots Nouveaux após essa alteração foi feita.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>


<span data-ttu-id="c1ca7-220">[![Os usuários serão informados de que o fornecedor não fornece todos os produtos](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="c1ca7-221">**Figura 18**: os usuários serão informados de que o fornecedor não fornece todos os produtos ([clique para exibir a imagem em tamanho normal](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="c1ca7-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>


## <a name="summary"></a><span data-ttu-id="c1ca7-222">Resumo</span><span class="sxs-lookup"><span data-stu-id="c1ca7-222">Summary</span></span>

<span data-ttu-id="c1ca7-223">Enquanto os relatórios mestre/detalhes podem exibir registros mestre e de detalhes em uma única página, em muitos sites eles são separados em duas páginas da web.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="c1ca7-224">Neste tutorial vimos como implementar tal relatório mestre/detalhes com os fornecedores listados em um GridView na página da web "mestre" e os produtos associados listados na página "Detalhes".</span><span class="sxs-lookup"><span data-stu-id="c1ca7-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="c1ca7-225">Cada linha de fornecedor na página da web mestre continha um link para a página de detalhes do passado ao longo da linha `SupplierID` valor.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="c1ca7-226">Esses links específicas de linha podem ser adicionados facilmente usando HyperLinkField do GridView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="c1ca7-227">Na página de detalhes recuperar os produtos para o fornecedor especificado foi realizada invocando o `ProductsBLL` da classe `GetProductsBySupplierID(supplierID)` método.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="c1ca7-228">O *`supplierID`* o valor do parâmetro foi especificado declarativamente usando querystring como a origem do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="c1ca7-229">Também vimos como exibir os detalhes de fornecedor na página de detalhes do usando um FormView.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="c1ca7-230">Nosso [tutorial próxima](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) é o final em relatórios de detalhes/mestre.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="c1ca7-231">Vamos examinar como exibir uma lista de produtos em um GridView onde cada linha tem um botão de seleção.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="c1ca7-232">Clicar no botão de seleção exibirá os detalhes do produto em um controle DetailsView na mesma página.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="c1ca7-233">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="c1ca7-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c1ca7-234">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="c1ca7-234">About the Author</span></span>

<span data-ttu-id="c1ca7-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c1ca7-236">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c1ca7-237">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c1ca7-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c1ca7-238">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c1ca7-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c1ca7-239">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="c1ca7-239">Special Thanks To</span></span>

<span data-ttu-id="c1ca7-240">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-240">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c1ca7-241">Revisor levar para este tutorial foi Giesenow Hilton.</span><span class="sxs-lookup"><span data-stu-id="c1ca7-241">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="c1ca7-242">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="c1ca7-242">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c1ca7-243">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-243">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c1ca7-244">[Anterior](master-detail-filtering-with-two-dropdownlists-vb.md)
> [Próximo](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c1ca7-244">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>
