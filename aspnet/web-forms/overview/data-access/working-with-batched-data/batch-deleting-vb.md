---
uid: web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
title: Lote excluindo (VB) | Microsoft Docs
author: rick-anderson
description: Saiba como excluir vários registros de banco de dados em uma única operação. Na camada de Interface do usuário que criamos em um GridView avançado criado no anterior tut...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: 4fb72f75-32ab-4bf7-a764-be20367be726
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 0d17ec6ec20be65b3ec9369f1c5a08d5970ec0dd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30880109"
---
<a name="batch-deleting-vb"></a><span data-ttu-id="0c4a8-104">Lote excluindo (VB)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-104">Batch Deleting (VB)</span></span>
====================
<span data-ttu-id="0c4a8-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0c4a8-106">[Baixar o código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) ou [baixar PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) or [Download PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span></span>

> <span data-ttu-id="0c4a8-107">Saiba como excluir vários registros de banco de dados em uma única operação.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-107">Learn how to delete multiple database records in a single operation.</span></span> <span data-ttu-id="0c4a8-108">Na camada de Interface do usuário é baseiam-se um GridView avançado criado um tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-108">In the User Interface Layer we build upon an enhanced GridView created in an earlier tutorial.</span></span> <span data-ttu-id="0c4a8-109">Na camada de acesso a dados encerrar as várias operações de exclusão em uma transação para garantir que todas as exclusões de êxito ou todas as exclusões são revertidas.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-109">In the Data Access Layer we wrap the multiple Delete operations within a transaction to ensure that all deletions succeed or all deletions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="0c4a8-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="0c4a8-110">Introduction</span></span>

<span data-ttu-id="0c4a8-111">O [tutorial anterior](batch-updating-vb.md) explorados como criar um lote edição interface usando um GridView totalmente editável.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-111">The [preceding tutorial](batch-updating-vb.md) explored how to create a batch editing interface using a fully-editable GridView.</span></span> <span data-ttu-id="0c4a8-112">Em situações onde usuários são geralmente editando vários registros de uma vez, um lote edição interface exigirá muito menos postbacks e contexto de teclado para mouse comutadores, melhorando a eficiência de s do usuário final.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-112">In situations where users are commonly editing many records at once, a batch editing interface will require far fewer postbacks and keyboard-to-mouse context switches, thereby improving the end user s efficiency.</span></span> <span data-ttu-id="0c4a8-113">Essa técnica é útil da mesma forma para páginas em que é comum que os usuários excluir vários registros de uma só vez.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-113">This technique is similarly useful for pages where it is common for users to delete many records in one go.</span></span>

<span data-ttu-id="0c4a8-114">Qualquer pessoa que tenha usado um cliente de email online já esteja familiarizada com um dos mais comuns lote excluindo interfaces: uma caixa de seleção em cada linha em uma grade com um correspondente excluir todos os itens verificados botão (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-114">Anyone who has used an online email client is already familiar with one of the most common batch deleting interfaces: a checkbox in each row in a grid with a corresponding Delete All Checked Items button (see Figure 1).</span></span> <span data-ttu-id="0c4a8-115">Este tutorial é curto em vez disso, porque podemos ve feita todo o trabalho de disco rígido nos tutoriais anteriores ao criar a interface baseada na web e um método para excluir uma série de registros como uma única operação atômica.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-115">This tutorial is rather short because we ve already done all of the hard work in previous tutorials in creating both the web-based interface and a method to delete a series of records as a single atomic operation.</span></span> <span data-ttu-id="0c4a8-116">No [adicionando uma coluna de GridView das caixas de seleção](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial criamos um GridView com uma coluna de caixas de seleção e no [encapsulamento modificações de banco de dados em uma transação](wrapping-database-modifications-within-a-transaction-vb.md) tutorial criamos um método em a BLL que usa uma transação para excluir um `List<T>` de `ProductID` valores.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-116">In the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial we created a GridView with a column of checkboxes and in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial we created a method in the BLL that would use a transaction to delete a `List<T>` of `ProductID` values.</span></span> <span data-ttu-id="0c4a8-117">Neste tutorial, vamos construir em cima e mesclar nossas experiências anteriores para criar um lote de trabalho excluindo exemplo.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-117">In this tutorial, we will build upon and merge our previous experiences to create a working batch deleting example.</span></span>


<span data-ttu-id="0c4a8-118">[![Cada linha incluem uma caixa de seleção](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-118">[![Each Row Includes a Checkbox](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="0c4a8-119">**Figura 1**: cada linha incluem uma caixa de seleção ([clique para exibir a imagem em tamanho normal](batch-deleting-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="0c4a8-119">**Figure 1**: Each Row Includes a Checkbox ([Click to view full-size image](batch-deleting-vb/_static/image2.png))</span></span>


## <a name="step-1-creating-the-batch-deleting-interface"></a><span data-ttu-id="0c4a8-120">Etapa 1: Criar lote excluindo Interface</span><span class="sxs-lookup"><span data-stu-id="0c4a8-120">Step 1: Creating the Batch Deleting Interface</span></span>

<span data-ttu-id="0c4a8-121">Como já criamos o lote excluindo interface no [adicionando uma coluna de GridView das caixas de seleção](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial, podemos pode simplesmente copiar a `BatchDelete.aspx` em vez de criá-lo a partir do zero.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-121">Since we already created the batch deleting interface in the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial, we can simply copy it to `BatchDelete.aspx` rather than creating it from scratch.</span></span> <span data-ttu-id="0c4a8-122">Comece abrindo o `BatchDelete.aspx` página o `BatchData` pasta e o `CheckBoxField.aspx` página o `EnhancedGridView` pasta.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-122">Start by opening the `BatchDelete.aspx` page in the `BatchData` folder and the `CheckBoxField.aspx` page in the `EnhancedGridView` folder.</span></span> <span data-ttu-id="0c4a8-123">Do `CheckBoxField.aspx` página, vá para o modo de exibição de fonte e copie a marcação entre o `<asp:Content>` marcas conforme mostrado na Figura 2.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-123">From the `CheckBoxField.aspx` page, go to the Source view and copy the markup between the `<asp:Content>` tags as shown in Figure 2.</span></span>


<span data-ttu-id="0c4a8-124">[![Copie a marcação declarativa de CheckBoxField.aspx na área de transferência](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-124">[![Copy the Declarative Markup of CheckBoxField.aspx to the Clipboard](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span></span>

<span data-ttu-id="0c4a8-125">**Figura 2**: copiar a marcação declarativa de `CheckBoxField.aspx` na área de transferência ([clique para exibir a imagem em tamanho normal](batch-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0c4a8-125">**Figure 2**: Copy the Declarative Markup of `CheckBoxField.aspx` to the Clipboard ([Click to view full-size image](batch-deleting-vb/_static/image4.png))</span></span>


<span data-ttu-id="0c4a8-126">Em seguida, vá para a exibição da fonte `BatchDelete.aspx` e cole o conteúdo da área de transferência dentro de `<asp:Content>` marcas.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-126">Next, go to the Source view in `BatchDelete.aspx` and paste the contents of the clipboard within the `<asp:Content>` tags.</span></span> <span data-ttu-id="0c4a8-127">Também, copie e cole o código de dentro da classe por trás do código em `CheckBoxField.aspx.vb` para dentro da classe por trás do código em `BatchDelete.aspx.vb` (o `DeleteSelectedProducts` botão s `Click` manipulador de eventos, o `ToggleCheckState` método e o `Click` manipuladores de eventos para o `CheckAll` e `UncheckAll` botões).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-127">Also copy and paste the code from within the code-behind class in `CheckBoxField.aspx.vb` to within the code-behind class in `BatchDelete.aspx.vb` (the `DeleteSelectedProducts` Button s `Click` event handler, the `ToggleCheckState` method, and the `Click` event handlers for the `CheckAll` and `UncheckAll` Buttons).</span></span> <span data-ttu-id="0c4a8-128">Depois de copiar esse conteúdo, a `BatchDelete.aspx` classe code-behind de página s deve conter o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="0c4a8-128">After copying over this content, the `BatchDelete.aspx` page s code-behind class should contain the following code:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="0c4a8-129">Depois de copiar as declarativa marcação e código-fonte, reserve um tempo para testar `BatchDelete.aspx` exibindo-o por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-129">After copying over the declarative markup and source code, take a moment to test `BatchDelete.aspx` by viewing it through a browser.</span></span> <span data-ttu-id="0c4a8-130">Você deve ver um GridView listando os dez primeiros produtos em um GridView com cada linha que lista o nome do produto s, categoria e preço junto com uma caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-130">You should see a GridView listing the first ten products in a GridView with each row listing the product s name, category, and price along with a checkbox.</span></span> <span data-ttu-id="0c4a8-131">Deve haver três botões: Verifique todos os, desmarque todas as e excluir produtos selecionados.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-131">There should be three buttons: Check All, Uncheck All, and Delete Selected Products.</span></span> <span data-ttu-id="0c4a8-132">Clicar no botão Verificar todos os seleciona todas as caixas de seleção, enquanto desmarque todos os limpa todas as caixas de seleção.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-132">Clicking the Check All button selects all checkboxes, while Uncheck All clears all checkboxes.</span></span> <span data-ttu-id="0c4a8-133">Clicando em excluir produtos selecionados exibe uma mensagem que lista o `ProductID` valores dos produtos selecionados, mas não excluir, na verdade, os produtos.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-133">Clicking Delete Selected Products displays a message that lists the `ProductID` values of the selected products, but does not actually delete the products.</span></span>


<span data-ttu-id="0c4a8-134">[![A Interface de CheckBoxField.aspx foi movida para BatchDeleting.aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-134">[![The Interface from CheckBoxField.aspx has been Moved to BatchDeleting.aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="0c4a8-135">**Figura 3**: A Interface de `CheckBoxField.aspx` foi movido para `BatchDeleting.aspx` ([clique para exibir a imagem em tamanho normal](batch-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0c4a8-135">**Figure 3**: The Interface from `CheckBoxField.aspx` has been Moved to `BatchDeleting.aspx` ([Click to view full-size image](batch-deleting-vb/_static/image6.png))</span></span>


## <a name="step-2-deleting-the-checked-products-using-transactions"></a><span data-ttu-id="0c4a8-136">Etapa 2: Excluindo os produtos verificados usando transações</span><span class="sxs-lookup"><span data-stu-id="0c4a8-136">Step 2: Deleting the Checked Products Using Transactions</span></span>

<span data-ttu-id="0c4a8-137">Com o lote interface copiado com êxito para a exclusão `BatchDeleting.aspx`, tudo o que resta é atualizar o código para que o botão excluir produtos selecionados exclui os produtos verificados usando o `DeleteProductsWithTransaction` método o `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-137">With the batch deleting interface successfully copied over to `BatchDeleting.aspx`, all that remains is to update the code so that the Delete Selected Products button deletes the checked products using the `DeleteProductsWithTransaction` method in the `ProductsBLL` class.</span></span> <span data-ttu-id="0c4a8-138">Esse método, adicionado no [encapsulamento modificações de banco de dados em uma transação](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, aceita como entrada uma `List(Of T)` de `ProductID` valores e exclui cada correspondente `ProductID` dentro do escopo de um transação.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-138">This method, added in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, accepts as its input a `List(Of T)` of `ProductID` values and deletes each corresponding `ProductID` within the scope of a transaction.</span></span>

<span data-ttu-id="0c4a8-139">O `DeleteSelectedProducts` botão s `Click` manipulador de eventos atualmente usa os seguintes `For Each` para iterar por meio de cada linha GridView:</span><span class="sxs-lookup"><span data-stu-id="0c4a8-139">The `DeleteSelectedProducts` Button s `Click` event handler currently uses the following `For Each` loop to iterate through each GridView row:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample2.vb)]

<span data-ttu-id="0c4a8-140">Para cada linha, o `ProductSelector` controle da Web da caixa de seleção é referenciado por meio de programação.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-140">For each row, the `ProductSelector` CheckBox Web control is programmatically referenced.</span></span> <span data-ttu-id="0c4a8-141">Se estiver marcada, a linha s `ProductID` é recuperado do `DataKeys` coleção e o `DeleteResults` rótulo s `Text` propriedade é atualizada para incluir uma mensagem indicando que a linha foi selecionada para exclusão.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-141">If it is checked, the row s `ProductID` is retrieved from the `DataKeys` collection and the `DeleteResults` Label s `Text` property is updated to include a message indicating that the row was selected for deletion.</span></span>

<span data-ttu-id="0c4a8-142">O código acima, na verdade, não exclui qualquer registro como a chamada para o `ProductsBLL` classe s `Delete` método está marcado como ignorado. Foram essa lógica de exclusão a ser aplicado, o código excluirá os produtos, mas não dentro de uma operação atômica.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-142">The above code does not actually delete any records as the call to the `ProductsBLL` class s `Delete` method is commented out. Were this delete logic to be applied, the code would delete the products but not within an atomic operation.</span></span> <span data-ttu-id="0c4a8-143">Ou seja, se as exclusões de alguns primeiro na sequência foi bem-sucedida, mas um posterior falha (talvez devido a uma violação de restrição de chave estrangeira), uma exceção será lançada, mas os produtos já excluídos permaneceria excluídos.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-143">That is, if the first few deletes in the sequence succeeded, but a later one failed (perhaps due to a foreign key constraint violation), an exception would be thrown but those products already deleted would remain deleted.</span></span>

<span data-ttu-id="0c4a8-144">Para garantir a atomicidade, precisamos em vez disso, use o `ProductsBLL` classe s `DeleteProductsWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-144">In order to assure atomicity, we need to instead use the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="0c4a8-145">Como esse método aceita uma lista de `ProductID` valores, é preciso primeiro compilar esta lista da grade e, em seguida, passa-a como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-145">Because this method accepts a list of `ProductID` values, we need to first compile this list from the grid and then pass it as a parameter.</span></span> <span data-ttu-id="0c4a8-146">Primeiro, criamos uma instância de um `List(Of T)` do tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-146">We first create an instance of a `List(Of T)` of type `Integer`.</span></span> <span data-ttu-id="0c4a8-147">Dentro de `For Each` loop que precisamos adicionar os produtos selecionados `ProductID` valores para este `List(Of T)`.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-147">Within the `For Each` loop we need to add the selected products `ProductID` values to this `List(Of T)`.</span></span> <span data-ttu-id="0c4a8-148">Após o loop isso `List(Of T)` devem ser passados para o `ProductsBLL` classe s `DeleteProductsWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-148">After the loop this `List(Of T)` must be passed to the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="0c4a8-149">Atualização de `DeleteSelectedProducts` botão s `Click` manipulador de eventos com o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="0c4a8-149">Update the `DeleteSelectedProducts` Button s `Click` event handler with the following code:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample3.vb)]

<span data-ttu-id="0c4a8-150">O código atualizado cria um `List(Of T)` do tipo `Integer` (`productIDsToDelete`) e o preenche com o `ProductID` valores para excluir.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-150">The updated code creates a `List(Of T)` of type `Integer` (`productIDsToDelete`) and populates it with the `ProductID` values to delete.</span></span> <span data-ttu-id="0c4a8-151">Após o `For Each` loop, se houver pelo menos um produto selecionado, o `ProductsBLL` classe s `DeleteProductsWithTransaction` método é chamado e passado a esta lista.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-151">After the `For Each` loop, if there is at least one product selected, the `ProductsBLL` class s `DeleteProductsWithTransaction` method is called and passed this list.</span></span> <span data-ttu-id="0c4a8-152">O `DeleteResults` rótulo também é exibido e os dados religados a GridView (de modo que os registros excluídos recentemente não aparecem como linhas na grade).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-152">The `DeleteResults` Label is also displayed and the data rebound to the GridView (so that the newly-deleted records no longer appear as rows in the grid).</span></span>

<span data-ttu-id="0c4a8-153">A Figura 4 mostra o GridView, após um número de linhas foram selecionado para exclusão.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-153">Figure 4 shows the GridView after a number of rows have been selected for deletion.</span></span> <span data-ttu-id="0c4a8-154">Figura 5 mostra a tela imediatamente após clicou no botão excluir produtos selecionados.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-154">Figure 5 shows the screen immediately after the Delete Selected Products button has been clicked.</span></span> <span data-ttu-id="0c4a8-155">Observe que na Figura 5 a `ProductID` valores de registros excluídos são exibidos no rótulo abaixo GridView e as linhas não estão mais em GridView.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-155">Note that in Figure 5 the `ProductID` values of the deleted records are displayed in the Label beneath the GridView and those rows are no longer in the GridView.</span></span>


<span data-ttu-id="0c4a8-156">[![Os produtos selecionados serão excluídos](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-156">[![The Selected Products Will Be Deleted](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="0c4a8-157">**Figura 4**: O selecionado produtos serão excluídos ([clique para exibir a imagem em tamanho normal](batch-deleting-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0c4a8-157">**Figure 4**: The Selected Products Will Be Deleted ([Click to view full-size image](batch-deleting-vb/_static/image8.png))</span></span>


<span data-ttu-id="0c4a8-158">[![Os valores de ProductID produtos excluído são listados abaixo a GridView](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-158">[![The Deleted Products ProductID Values are Listed Beneath the GridView](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span></span>

<span data-ttu-id="0c4a8-159">**Figura 5**: os produtos excluído `ProductID` valores estão listados abaixo a GridView ([clique para exibir a imagem em tamanho normal](batch-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="0c4a8-159">**Figure 5**: The Deleted Products `ProductID` Values are Listed Beneath the GridView ([Click to view full-size image](batch-deleting-vb/_static/image10.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0c4a8-160">Para testar o `DeleteProductsWithTransaction` atomicidade método s, adicione manualmente uma entrada de um produto a `Order Details` de tabela e, em seguida, tente excluir o produto (junto com outros).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-160">To test the `DeleteProductsWithTransaction` method s atomicity, manually add an entry for a product in the `Order Details` table and then attempt to delete that product (along with others).</span></span> <span data-ttu-id="0c4a8-161">Você receberá uma violação de restrição de chave estrangeira durante a tentativa de excluir o produto com um pedido associado, mas observe como as outras exclusões de produtos selecionados serão revertidas.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-161">You will receive a foreign key constraint violation when attempting to delete the product with an associated order, but note how the other selected products deletions are rolled back.</span></span>


## <a name="summary"></a><span data-ttu-id="0c4a8-162">Resumo</span><span class="sxs-lookup"><span data-stu-id="0c4a8-162">Summary</span></span>

<span data-ttu-id="0c4a8-163">Criar um lote excluindo interface envolve a adição de um GridView com uma coluna de caixas de seleção e controle da Web de um botão que, quando clicado, excluirá todas as linhas selecionadas como uma única operação atômica.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-163">Creating a batch deleting interface involves adding a GridView with a column of checkboxes and a Button Web control that, when clicked, will delete all of the selected rows as a single atomic operation.</span></span> <span data-ttu-id="0c4a8-164">Neste tutorial, criamos tal interface por montando o trabalho feito em dois tutoriais anteriores, [adicionando uma coluna de GridView das caixas de seleção](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) e [encapsulamento modificações de banco de dados em uma transação](wrapping-database-modifications-within-a-transaction-vb.md).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-164">In this tutorial we built such an interface by piecing together work done in two previous tutorials, [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) and [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md).</span></span> <span data-ttu-id="0c4a8-165">No primeiro tutorial, criamos um GridView com uma coluna de caixas de seleção e no último implementamos um método na BLL que, quando passado um `List(Of T)` de `ProductID` excluído valores, eles todos dentro do escopo de uma transação.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-165">In the first tutorial we created a GridView with a column of checkboxes and in the latter we implemented a method in the BLL that, when passed a `List(Of T)` of `ProductID` values, deleted them all within the scope of a transaction.</span></span>

<span data-ttu-id="0c4a8-166">O seguinte tutorial, criaremos uma interface para executar inserções em lotes.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-166">In the next tutorial we'll create an interface for performing batch inserts.</span></span>

<span data-ttu-id="0c4a8-167">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="0c4a8-167">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0c4a8-168">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="0c4a8-168">About the Author</span></span>

<span data-ttu-id="0c4a8-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0c4a8-170">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-170">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0c4a8-171">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-171">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0c4a8-172">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0c4a8-172">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0c4a8-173">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="0c4a8-173">Special Thanks To</span></span>

<span data-ttu-id="0c4a8-174">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-174">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0c4a8-175">Revisores levar para este tutorial foram Giesenow Hilton e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="0c4a8-175">Lead reviewers for this tutorial were Hilton Giesenow and Teresa Murphy.</span></span> <span data-ttu-id="0c4a8-176">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="0c4a8-176">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0c4a8-177">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-177">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0c4a8-178">[Anterior](batch-updating-vb.md)
> [Próximo](batch-inserting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0c4a8-178">[Previous](batch-updating-vb.md)
[Next](batch-inserting-vb.md)</span></span>
