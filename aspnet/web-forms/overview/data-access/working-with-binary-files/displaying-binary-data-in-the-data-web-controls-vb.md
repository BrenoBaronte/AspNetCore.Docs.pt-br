---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
title: Exibindo dados binários na Web dados controles (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, examine as opções para apresentar dados binários em uma página da Web, incluindo a exibição de um arquivo de imagem e o fornecimento de um link de 'Baixar' f...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/27/2007
ms.topic: article
ms.assetid: 9201656a-e1c2-4020-824b-18fb632d2925
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
msc.type: authoredcontent
ms.openlocfilehash: 006a4d014b610f3079d7f25e9420f687447a1b26
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="displaying-binary-data-in-the-data-web-controls-vb"></a><span data-ttu-id="f549d-103">Exibindo dados binários nos controles da Web de dados (VB)</span><span class="sxs-lookup"><span data-stu-id="f549d-103">Displaying Binary Data in the Data Web Controls (VB)</span></span>
====================
<span data-ttu-id="f549d-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f549d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f549d-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) ou [baixar PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f549d-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span></span>

> <span data-ttu-id="f549d-106">Neste tutorial, examine as opções para apresentar dados binários em uma página da Web, incluindo a exibição de um arquivo de imagem e o fornecimento de um link de 'Download' para um arquivo PDF.</span><span class="sxs-lookup"><span data-stu-id="f549d-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>


## <a name="introduction"></a><span data-ttu-id="f549d-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="f549d-107">Introduction</span></span>

<span data-ttu-id="f549d-108">No tutorial anterior, explorados duas técnicas para a associação de dados binários com um modelo de dados subjacente do aplicativo s e usou o controle de carregamento de arquivos para carregar arquivos em um navegador para o sistema de arquivo do web server s.</span><span class="sxs-lookup"><span data-stu-id="f549d-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="f549d-109">Podemos ver ainda para ver como associar os dados binários carregados com o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="f549d-110">Ou seja, depois que um arquivo foi carregado e salvo no sistema de arquivo, um caminho para o arquivo deve armazenado no registro do banco de dados apropriado.</span><span class="sxs-lookup"><span data-stu-id="f549d-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="f549d-111">Se os dados estão sendo armazenados diretamente no banco de dados, em seguida, os dados binários carregados não precisam ser salvos no sistema de arquivo, mas devem ser inseridos no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="f549d-112">Antes de examinarmos associando os dados com o modelo de dados, no entanto, deixe-s primeiro examinar como fornecer os dados binários para o usuário final.</span><span class="sxs-lookup"><span data-stu-id="f549d-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="f549d-113">Apresentação de dados de texto é simple o suficiente, mas como dados binários devem ser apresentados?</span><span class="sxs-lookup"><span data-stu-id="f549d-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="f549d-114">Depende, é claro, o tipo de dados binários.</span><span class="sxs-lookup"><span data-stu-id="f549d-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="f549d-115">Para imagens, provavelmente queremos exibir a imagem; para PDFs, documentos do Microsoft Word, arquivos ZIP e outros tipos de dados binários, fornecendo um link de Download é mais apropriado.</span><span class="sxs-lookup"><span data-stu-id="f549d-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="f549d-116">Neste tutorial, de que examinaremos como apresentar os dados binários juntamente com seus dados de texto associada usando dados controles da Web como o GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="f549d-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="f549d-117">O tutorial Avançar voltaremos nossa atenção ao associar um arquivo carregado com o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="f549d-118">Etapa 1: Fornecendo`BrochurePath`valores</span><span class="sxs-lookup"><span data-stu-id="f549d-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="f549d-119">O `Picture` coluna o `Categories` tabela já contém dados binários para as várias imagens de categoria.</span><span class="sxs-lookup"><span data-stu-id="f549d-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="f549d-120">Especificamente, o `Picture` coluna para cada registro contém o conteúdo binário de uma imagem de bitmap granulados, baixa qualidade, 16 cores.</span><span class="sxs-lookup"><span data-stu-id="f549d-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="f549d-121">Cada imagem de categoria é 172 pixels de largura e 120 pixels de altura e consome aproximadamente 11 KB.</span><span class="sxs-lookup"><span data-stu-id="f549d-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="f549d-122">O que é mais, o conteúdo binário a `Picture` coluna inclui um 78 bytes [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) cabeçalho que deve ser removido antes de exibir a imagem.</span><span class="sxs-lookup"><span data-stu-id="f549d-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="f549d-123">Essas informações de cabeçalho estão presentes porque o banco de dados Northwind tem suas raízes no Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="f549d-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="f549d-124">No Access, os dados binários são armazenados usando o tipo de dados do objeto OLE, move sobre este cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="f549d-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="f549d-125">Por enquanto, veremos como Tire os cabeçalhos dessas imagens de baixa qualidade para exibir a imagem.</span><span class="sxs-lookup"><span data-stu-id="f549d-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="f549d-126">Em um futuro tutorial, criaremos uma interface para a atualização de uma categoria s `Picture` coluna e substituir essas imagens de bitmap que usam cabeçalhos OLE com equivalentes imagens JPG sem o cabeçalho OLE desnecessário.</span><span class="sxs-lookup"><span data-stu-id="f549d-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="f549d-127">No tutorial anterior, vimos como usar o controle de carregamento de arquivos.</span><span class="sxs-lookup"><span data-stu-id="f549d-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="f549d-128">Portanto, você pode prosseguir e adicionar arquivos de publicação para o sistema de arquivo do web server s.</span><span class="sxs-lookup"><span data-stu-id="f549d-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="f549d-129">Ao fazer isso, no entanto, não atualiza o `BrochurePath` coluna o `Categories` tabela.</span><span class="sxs-lookup"><span data-stu-id="f549d-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="f549d-130">No tutorial de Avançar, veremos como fazer isso, mas agora é preciso fornecer manualmente os valores dessa coluna.</span><span class="sxs-lookup"><span data-stu-id="f549d-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="f549d-131">Este download tutorial s, você encontrará sete arquivos de publicação PDF no `~/Brochures` pasta, um para cada categoria exceto Frutos do mar.</span><span class="sxs-lookup"><span data-stu-id="f549d-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="f549d-132">Eu intencionalmente omitido adicionando uma publicação de Frutos do mar para ilustrar como lidar com cenários em que nem todos os registros com dados binários associados.</span><span class="sxs-lookup"><span data-stu-id="f549d-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="f549d-133">Para atualizar o `Categories` da tabela com esses valores, com o botão direito no `Categories` nó do Gerenciador de servidores e escolha Mostrar dados da tabela.</span><span class="sxs-lookup"><span data-stu-id="f549d-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="f549d-134">Em seguida, insira os caminhos virtuais para os arquivos de publicação para cada categoria que tenha uma publicação, como mostra a Figura 1.</span><span class="sxs-lookup"><span data-stu-id="f549d-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="f549d-135">Como não há nenhuma publicação para a categoria de Frutos do mar, deixe seu `BrochurePath` valor da coluna s como `NULL`.</span><span class="sxs-lookup"><span data-stu-id="f549d-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>


<span data-ttu-id="f549d-136">[![Insira manualmente os valores para a coluna de BrochurePath tabela s categorias](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span></span>

<span data-ttu-id="f549d-137">**Figura 1**: inserir manualmente os valores para o `Categories` tabela s `BrochurePath` coluna ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span></span>


## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="f549d-138">Etapa 2: Fornecer um Link de Download para os folhetos em um GridView</span><span class="sxs-lookup"><span data-stu-id="f549d-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="f549d-139">Com o `BrochurePath` valores fornecidos para o `Categories` tabela, podemos re pronto para criar um controle GridView que lista cada categoria junto com um link para baixar a publicação de categoria s.</span><span class="sxs-lookup"><span data-stu-id="f549d-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="f549d-140">Na etapa 4, estenderemos esse GridView para também exibir a imagem de categoria s.</span><span class="sxs-lookup"><span data-stu-id="f549d-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="f549d-141">Iniciar arrastando um GridView da caixa de ferramentas para o Designer do `DisplayOrDownloadData.aspx` página o `BinaryData` pasta.</span><span class="sxs-lookup"><span data-stu-id="f549d-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="f549d-142">Definir o GridView s `ID` para `Categories` e por meio de GridView s marca inteligente, escolha para associá-lo para uma nova fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="f549d-143">Especificamente, associá-lo a um ObjectDataSource denominado `CategoriesDataSource` que recupera dados usando o `CategoriesBLL` objeto s `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="f549d-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>


<span data-ttu-id="f549d-144">[![Criar um novo ObjectDataSource denominado CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span></span>

<span data-ttu-id="f549d-145">**Figura 2**: criar um novo ObjectDataSource nomeado `CategoriesDataSource` ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span></span>


<span data-ttu-id="f549d-146">[![Configurar o ObjectDataSource para usar a classe CategoriesBLL](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span></span>

<span data-ttu-id="f549d-147">**Figura 3**: configurar o ObjectDataSource para usar o `CategoriesBLL` classe ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span></span>


<span data-ttu-id="f549d-148">[![Recuperar a lista de categorias usando o método GetCategories()](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span></span>

<span data-ttu-id="f549d-149">**Figura 4**: recuperar a lista de categorias usando o `GetCategories()` método ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span></span>


<span data-ttu-id="f549d-150">Depois de concluir o Assistente Configurar fonte de dados, o Visual Studio adicionará automaticamente um BoundField para o `Categories` GridView para o `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, e `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="f549d-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="f549d-151">Vá em frente e remover o `NumberOfProducts` BoundField desde o `GetCategories()` consulta método s não recuperar essas informações.</span><span class="sxs-lookup"><span data-stu-id="f549d-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="f549d-152">Também removerá o `CategoryID` BoundField e renomear o `CategoryName` e `BrochurePath` BoundFields `HeaderText` propriedades para a categoria e a publicação, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f549d-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="f549d-153">Depois de fazer essas alterações, a marcação de declarativa s GridView e ObjectDataSource deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="f549d-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample1.aspx)]

<span data-ttu-id="f549d-154">Exibir esta página por meio de um navegador (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="f549d-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="f549d-155">Cada um dos oito categorias está listada.</span><span class="sxs-lookup"><span data-stu-id="f549d-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="f549d-156">As sete categorias com `BrochurePath` valores têm o `BrochurePath` valor exibido do respectivo BoundField.</span><span class="sxs-lookup"><span data-stu-id="f549d-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="f549d-157">Frutos do mar, que tem um `NULL` valor para seu `BrochurePath`, exibe uma célula vazia.</span><span class="sxs-lookup"><span data-stu-id="f549d-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>


<span data-ttu-id="f549d-158">[![Cada categoria é o nome, descrição e o valor de BrochurePath está listada](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span></span>

<span data-ttu-id="f549d-159">**Figura 5**: s de cada categoria nome, descrição, e `BrochurePath` valor é listado ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span></span>


<span data-ttu-id="f549d-160">Em vez de exibir o texto do `BrochurePath` coluna, quer criar um link para a publicação.</span><span class="sxs-lookup"><span data-stu-id="f549d-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="f549d-161">Para fazer isso, remova o `BrochurePath` BoundField e substitua-o por um HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="f549d-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="f549d-162">Definir o novo s HyperLinkField `HeaderText` propriedade de publicação, seu `Text` propriedade para exibir a publicação e sua `DataNavigateUrlFields` propriedade `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="f549d-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>


![Adicionar um HyperLinkField para BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.gif)

<span data-ttu-id="f549d-164">**Figura 6**: adicionar um HyperLinkField para `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="f549d-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>


<span data-ttu-id="f549d-165">Isso adicionará uma coluna de links GridView, como mostra a Figura 7.</span><span class="sxs-lookup"><span data-stu-id="f549d-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="f549d-166">Clicar em um link Exibir publicação irá exibir o PDF diretamente no navegador ou solicitar o usuário para baixar o arquivo, dependendo se um leitor de PDF está instalado e as configurações do navegador s.</span><span class="sxs-lookup"><span data-stu-id="f549d-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>


<span data-ttu-id="f549d-167">[![Uma categoria s publicação pode ser exibida clicando no Link de publicação do modo de exibição](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span></span>

<span data-ttu-id="f549d-168">**Figura 7**: A categoria s publicação podem ser exibidos clicando no Link de publicação do modo de exibição ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span></span>


<span data-ttu-id="f549d-169">[![A categoria s PDF de publicação é exibida](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span></span>

<span data-ttu-id="f549d-170">**Figura 8**: A categoria s PDF de publicação é exibido ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span></span>


## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="f549d-171">Ocultando o texto de exibição da publicação para categorias sem uma publicação</span><span class="sxs-lookup"><span data-stu-id="f549d-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="f549d-172">Como mostra a Figura 7, o `BrochurePath` HyperLinkField exibe seu `Text` o valor de propriedade (exibição de publicação) para todos os registros, independentemente se há s não`NULL` valor para `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="f549d-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="f549d-173">É claro que, se `BrochurePath` é `NULL`, em seguida, o link será exibido como texto, como é o caso com a categoria de Frutos do Mar (consulte novamente a Figura 7).</span><span class="sxs-lookup"><span data-stu-id="f549d-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="f549d-174">Em vez de exibir o texto de exibição de publicação, talvez seja interessante ter nessas categorias sem um `BrochurePath` valor exibir um texto alternativo, como não há publicação disponível.</span><span class="sxs-lookup"><span data-stu-id="f549d-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="f549d-175">Para fornecer esse comportamento, precisamos usar um TemplateField cujo conteúdo é gerado por meio de uma chamada para um método de página que emite a saída apropriada com base no `BrochurePath` valor.</span><span class="sxs-lookup"><span data-stu-id="f549d-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="f549d-176">Podemos primeiro explorados isso formatação técnica novamente o [Usando TemplateFields no controle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="f549d-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="f549d-177">Ativar o HyperLinkField em um TemplateField selecionando o `BrochurePath` HyperLinkField e, em seguida, clicando em converter este campo em um TemplateField link na caixa de diálogo Editar colunas.</span><span class="sxs-lookup"><span data-stu-id="f549d-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>


![Converter o HyperLinkField em um TemplateField](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.gif)

<span data-ttu-id="f549d-179">**Figura 9**: converter o HyperLinkField em um TemplateField</span><span class="sxs-lookup"><span data-stu-id="f549d-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>


<span data-ttu-id="f549d-180">Isso criará um TemplateField com um `ItemTemplate` que contém um hiperlink Web controle cuja `NavigateUrl` propriedade está vinculada a `BrochurePath` valor.</span><span class="sxs-lookup"><span data-stu-id="f549d-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="f549d-181">Substitua essa marcação com uma chamada ao método `GenerateBrochureLink`, passando o valor de `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="f549d-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample2.aspx)]

<span data-ttu-id="f549d-182">Em seguida, crie um `Protected` método no ASP.NET página classe code-behind de s denominado `GenerateBrochureLink` que retorna um `String` e aceita um `Object` como um parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="f549d-182">Next, create a `Protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `String` and accepts an `Object` as an input parameter.</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample3.vb)]

<span data-ttu-id="f549d-183">Este método determina se passado `Object` valor é um banco de dados `NULL` e, em caso afirmativo, retorna uma mensagem indicando que a categoria não tem uma publicação.</span><span class="sxs-lookup"><span data-stu-id="f549d-183">This method determines if the passed-in `Object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="f549d-184">Caso contrário, se houver um `BrochurePath` valor, ele s exibido em um hiperlink.</span><span class="sxs-lookup"><span data-stu-id="f549d-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="f549d-185">Observe que, se o `BrochurePath` valor é apresentá-lo s passado para o [ `ResolveUrl(url)` método](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="f549d-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="f549d-186">Este método resolve transmitido *url*, substituindo o `~` caractere com o caminho virtual apropriado.</span><span class="sxs-lookup"><span data-stu-id="f549d-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="f549d-187">Por exemplo, se o aplicativo tem raiz em `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` retornará `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="f549d-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="f549d-188">A Figura 10 mostra a página após essas alterações foram aplicadas.</span><span class="sxs-lookup"><span data-stu-id="f549d-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="f549d-189">Observe que a categoria de Frutos do mar s `BrochurePath` campo agora exibe o texto não há publicação disponível.</span><span class="sxs-lookup"><span data-stu-id="f549d-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>


<span data-ttu-id="f549d-190">[![O texto não há publicação disponível é exibida para as categorias sem uma publicação](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span></span>

<span data-ttu-id="f549d-191">**Figura 10**: O texto não há publicação disponível é exibida para as categorias sem uma publicação ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span></span>


## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="f549d-192">Etapa 3: Adicionando uma página da Web para exibir uma imagem de categoria s</span><span class="sxs-lookup"><span data-stu-id="f549d-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="f549d-193">Quando um usuário acessa uma página ASP.NET, eles recebem a s HTML da página do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f549d-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="f549d-194">O HTML recebido é somente texto e não contém quaisquer dados binários.</span><span class="sxs-lookup"><span data-stu-id="f549d-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="f549d-195">Quaisquer dados binários adicionais, como imagens, arquivos de som, aplicativos do Macromedia Flash, vídeos do Windows Media Player incorporado e assim por diante, existam como recursos separados no servidor web.</span><span class="sxs-lookup"><span data-stu-id="f549d-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="f549d-196">O HTML contém referências a esses arquivos, mas não inclui o conteúdo real dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="f549d-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="f549d-197">Por exemplo, em HTML a `<img>` elemento é usado para fazer referência a uma imagem, com o `src` atributo apontando para o arquivo de imagem da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="f549d-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>


[!code-html[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample4.html)]

<span data-ttu-id="f549d-198">Quando um navegador recebe esse HTML, faz outra solicitação para o servidor web para recuperar o conteúdo binário do arquivo de imagem, que então são exibidos no navegador.</span><span class="sxs-lookup"><span data-stu-id="f549d-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="f549d-199">O mesmo conceito se aplica a todos os dados binários.</span><span class="sxs-lookup"><span data-stu-id="f549d-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="f549d-200">Na etapa 2, a publicação não foi enviada para baixo para o navegador como parte da marcação HTML da página s.</span><span class="sxs-lookup"><span data-stu-id="f549d-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="f549d-201">Em vez disso, o HTML renderizado fornecido hiperlinks que, quando clicado, causou o navegador solicitar o documento PDF diretamente.</span><span class="sxs-lookup"><span data-stu-id="f549d-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="f549d-202">Para exibir ou permitir que usuários baixem dados binários que residem no banco de dados, é preciso criar uma página da web separado que retorna os dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="f549d-203">Em nosso aplicativo, o campo de dados binários apenas um lá s armazenado diretamente na imagem s a categoria de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="f549d-204">Portanto, precisamos de uma página que, quando chamado, retorna os dados da imagem para uma determinada categoria.</span><span class="sxs-lookup"><span data-stu-id="f549d-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="f549d-205">Adicione uma nova página ASP.NET para o `BinaryData` pasta denominada `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f549d-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="f549d-206">Ao fazer isso, marque a caixa de seleção Selecionar página mestra.</span><span class="sxs-lookup"><span data-stu-id="f549d-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="f549d-207">Esta página espera um `CategoryID` valor na querystring e retorna os dados binários da categoria s `Picture` coluna.</span><span class="sxs-lookup"><span data-stu-id="f549d-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="f549d-208">Como essa página retorna dados binários e nada mais, ele não precisa de qualquer marcação na seção de HTML.</span><span class="sxs-lookup"><span data-stu-id="f549d-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="f549d-209">Portanto, clique na guia fonte, no canto inferior esquerdo e remova todos de marcação da página s, exceto para o `<%@ Page %>` diretiva.</span><span class="sxs-lookup"><span data-stu-id="f549d-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="f549d-210">Ou seja, `DisplayCategoryPicture.aspx` declarativo s deve consistir em uma única linha:</span><span class="sxs-lookup"><span data-stu-id="f549d-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample5.aspx)]

<span data-ttu-id="f549d-211">Se você vir o `MasterPageFile` atributo o `<%@ Page %>` diretiva, removê-lo.</span><span class="sxs-lookup"><span data-stu-id="f549d-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="f549d-212">Na classe code-behind de páginas, adicione o seguinte código para o `Page_Load` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="f549d-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample6.vb)]

<span data-ttu-id="f549d-213">Esse código inicia lendo o `CategoryID` querystring valor em uma variável chamada `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="f549d-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="f549d-214">Em seguida, os dados da imagem são recuperados por meio de uma chamada para o `CategoriesBLL` classe s `GetCategoryWithBinaryDataByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="f549d-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="f549d-215">Esses dados são retornados para o cliente usando o `Response.BinaryWrite(data)` método, mas antes que isso é chamado, o `Picture` cabeçalho da coluna valor s OLE deve ser removido.</span><span class="sxs-lookup"><span data-stu-id="f549d-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="f549d-216">Isso é feito criando um `Byte` matriz chamada `strippedImageData` que armazenará precisamente 78 caracteres menor do que no `Picture` coluna.</span><span class="sxs-lookup"><span data-stu-id="f549d-216">This is accomplished by creating a `Byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="f549d-217">O [ `Array.Copy` método](https://msdn.microsoft.com/library/z50k9bft.aspx) é usado para copiar os dados de `category.Picture` começando na posição 78 sobre a `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="f549d-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="f549d-218">O `Response.ContentType` propriedade especifica o [tipo MIME](http://en.wikipedia.org/wiki/MIME) do conteúdo que está sendo retornado de modo que o navegador sabe como processá-lo.</span><span class="sxs-lookup"><span data-stu-id="f549d-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="f549d-219">Como o `Categories` tabela s `Picture` a coluna é uma imagem de bitmap, o tipo MIME de bitmap é usado aqui (imagem bmp).</span><span class="sxs-lookup"><span data-stu-id="f549d-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="f549d-220">Se você omitir o tipo MIME, a maioria dos navegadores ainda exibirá a imagem corretamente porque eles podem inferir o tipo com base no conteúdo do arquivo s binário de dados de imagem.</span><span class="sxs-lookup"><span data-stu-id="f549d-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="f549d-221">No entanto, ele prudente incluem MIME tipo quando possível.</span><span class="sxs-lookup"><span data-stu-id="f549d-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="f549d-222">Consulte o [site de s Internet Assigned Numbers Authority](http://www.iana.org/) para uma lista completa de [tipos de mídia MIME](http://www.iana.org/assignments/media-types/).</span><span class="sxs-lookup"><span data-stu-id="f549d-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="f549d-223">Com esta página foi criada, uma imagem de categoria específico s pode ser exibida visitando `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="f549d-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="f549d-224">A Figura 11 mostra a imagem de categoria s Bebidas, que pode ser exibida no `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="f549d-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>


<span data-ttu-id="f549d-225">[![O s de categoria de bebidas que imagem é exibida](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span></span>

<span data-ttu-id="f549d-226">**Figura 11**: A categoria de bebidas s imagem é exibida ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span></span>


<span data-ttu-id="f549d-227">Se, ao visitar `DisplayCategoryPicture.aspx?CategoryID=categoryID`, você receberá uma exceção que lê não é possível converter o objeto do tipo 'System. DBNull' para o tipo 'System. Byte []', há duas coisas que podem ter causado isso.</span><span class="sxs-lookup"><span data-stu-id="f549d-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="f549d-228">Primeiro, o `Categories` tabela s `Picture` coluna permitir `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="f549d-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="f549d-229">O `DisplayCategoryPicture.aspx` página, no entanto, assume que há não`NULL` valor presente.</span><span class="sxs-lookup"><span data-stu-id="f549d-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="f549d-230">O `Picture` propriedade o `CategoriesDataTable` não pode ser acessado diretamente se ele tem um `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="f549d-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="f549d-231">Se você quiser permitir `NULL` valores para o `Picture` coluna d deseja incluir a seguinte condição:</span><span class="sxs-lookup"><span data-stu-id="f549d-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample7.vb)]

<span data-ttu-id="f549d-232">O código acima presume que existem s alguns imagem arquivo chamado `NoPictureAvailable.gif` no `Images` pasta que você deseja exibir para essas categorias sem uma imagem.</span><span class="sxs-lookup"><span data-stu-id="f549d-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="f549d-233">Essa exceção também pode ser causada se o `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` instrução voltou a lista de colunas de consulta principal s, que pode ocorrer se você estiver usando instruções SQL ad hoc e que você execute novamente o Assistente para o s TableAdapter consulta principal.</span><span class="sxs-lookup"><span data-stu-id="f549d-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="f549d-234">Verifique se que `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` instrução ainda inclui o `Picture` coluna.</span><span class="sxs-lookup"><span data-stu-id="f549d-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="f549d-235">Toda vez que o `DisplayCategoryPicture.aspx` é visitada, o banco de dados é acessado e os dados de imagem de categoria especificada s são retornados.</span><span class="sxs-lookup"><span data-stu-id="f549d-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="f549d-236">Se t categoria s imagem tenha sido alterado desde que o usuário tem última exibida, no entanto, esse é inútil esforço.</span><span class="sxs-lookup"><span data-stu-id="f549d-236">If the category s picture hasn t changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="f549d-237">Felizmente, HTTP permite *condicional obtém*.</span><span class="sxs-lookup"><span data-stu-id="f549d-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="f549d-238">Com GET condicional, o cliente faz a solicitação HTTP envia ao longo de um [ `If-Modified-Since` cabeçalho HTTP](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) que fornece a data e hora que o cliente recuperou última esse recurso do servidor web.</span><span class="sxs-lookup"><span data-stu-id="f549d-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="f549d-239">Se o conteúdo não foi alterado desde a data especificado, o servidor web pode responder com uma [código de status não modificado (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) e abrir mão retornando o conteúdo do recurso solicitado s.</span><span class="sxs-lookup"><span data-stu-id="f549d-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="f549d-240">Em resumo, essa técnica libera o servidor web de ter que enviar conteúdo para um recurso se ele não tiver sido modificado desde que o cliente do último acesso.</span><span class="sxs-lookup"><span data-stu-id="f549d-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>


<span data-ttu-id="f549d-241">Para implementar esse comportamento, no entanto, é necessário adicionar um `PictureLastModified` coluna para o `Categories` tabela da qual capturar quando o `Picture` coluna da última atualização, bem como o código para verificar a `If-Modified-Since` cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="f549d-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="f549d-242">Para obter mais informações sobre o `If-Modified-Since` cabeçalho e o fluxo de trabalho GET condicional, consulte [HTTP GET condicional para Hackers RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) e [um mais profunda examinar executar solicitações HTTP em uma página ASP.NET](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f549d-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="f549d-243">Etapa 4: Exibir as imagens de categoria em um controle GridView</span><span class="sxs-lookup"><span data-stu-id="f549d-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="f549d-244">Agora que temos uma página da web para exibir uma imagem de categoria específico s, podemos exibir usando o [controle Image Web](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) ou um HTML `<img>` elemento apontando para `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="f549d-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="f549d-245">Imagens cuja URL é determinado pelo banco de dados podem ser exibidas no GridView ou usando o ImageField de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="f549d-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="f549d-246">Contém o ImageField `DataImageUrlField` e `DataImageUrlFormatString` propriedades que funcionam como os s HyperLinkField `DataNavigateUrlFields` e `DataNavigateUrlFormatString` propriedades.</span><span class="sxs-lookup"><span data-stu-id="f549d-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="f549d-247">Permitir que o s aumentar o `Categories` GridView no `DisplayOrDownloadData.aspx` adicionando um ImageField para mostrar cada imagem de categoria s.</span><span class="sxs-lookup"><span data-stu-id="f549d-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="f549d-248">Basta adicionar o ImageField e definir seu `DataImageUrlField` e `DataImageUrlFormatString` propriedades `CategoryID` e `DisplayCategoryPicture.aspx?CategoryID={0}`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f549d-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="f549d-249">Isso criará uma coluna de GridView que renderiza uma `<img>` elemento cujo `src` as referências ao atributo `DisplayCategoryPicture.aspx?CategoryID={0}`, onde {0} é substituído com a linha GridView s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="f549d-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>


![Adicionar um ImageField a GridView](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.gif)

<span data-ttu-id="f549d-251">**Figura 12**: adicionar um ImageField a GridView</span><span class="sxs-lookup"><span data-stu-id="f549d-251">**Figure 12**: Add an ImageField to the GridView</span></span>


<span data-ttu-id="f549d-252">Depois de adicionar o ImageField, sua sintaxe declarativa do GridView s deve ser parecido com soothe seguintes:</span><span class="sxs-lookup"><span data-stu-id="f549d-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample8.aspx)]

<span data-ttu-id="f549d-253">Dedicar um tempo para exibir esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="f549d-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="f549d-254">Observe como cada registro agora inclui uma imagem para a categoria.</span><span class="sxs-lookup"><span data-stu-id="f549d-254">Note how each record now includes a picture for the category.</span></span>


<span data-ttu-id="f549d-255">[![A categoria s imagem será exibida para cada linha](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f549d-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span></span>

<span data-ttu-id="f549d-256">**Figura 13**: s categoria a imagem é exibida para cada linha ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f549d-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span></span>


## <a name="summary"></a><span data-ttu-id="f549d-257">Resumo</span><span class="sxs-lookup"><span data-stu-id="f549d-257">Summary</span></span>

<span data-ttu-id="f549d-258">Neste tutorial, examinamos como apresentar dados binários.</span><span class="sxs-lookup"><span data-stu-id="f549d-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="f549d-259">Como os dados são apresentados depende do tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="f549d-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="f549d-260">Para os arquivos de publicação PDF, podemos ofereceram ao usuário uma publicação de exibição de link que, quando clicado, levou o usuário diretamente para o arquivo PDF.</span><span class="sxs-lookup"><span data-stu-id="f549d-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="f549d-261">Para a imagem de s categoria, é criado pela primeira vez uma página para recuperar e retornar os dados binários do banco de dados e usado, em seguida, essa página para exibir cada imagem de s categoria em um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="f549d-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="f549d-262">Agora que possamos ve examinamos como exibir dados binários, podemos re pronto para examinar como executar insert, atualizações e exclusões no banco de dados com os dados binários.</span><span class="sxs-lookup"><span data-stu-id="f549d-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="f549d-263">O seguinte tutorial, examinaremos como associar um arquivo carregado com o seu registro de banco de dados correspondente.</span><span class="sxs-lookup"><span data-stu-id="f549d-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="f549d-264">O tutorial depois disso, veremos como atualizar dados binários existentes, bem como excluir os dados binários quando seu registro associado é removido.</span><span class="sxs-lookup"><span data-stu-id="f549d-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="f549d-265">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="f549d-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f549d-266">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="f549d-266">About the Author</span></span>

<span data-ttu-id="f549d-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="f549d-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f549d-268">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="f549d-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f549d-269">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f549d-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f549d-270">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f549d-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f549d-271">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="f549d-271">Special Thanks To</span></span>

<span data-ttu-id="f549d-272">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="f549d-272">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f549d-273">Revisores levar para este tutorial foram Teresa Murphy e Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="f549d-273">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="f549d-274">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="f549d-274">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f549d-275">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f549d-275">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f549d-276">[Anterior](uploading-files-vb.md)
> [Próximo](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f549d-276">[Previous](uploading-files-vb.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span></span>
