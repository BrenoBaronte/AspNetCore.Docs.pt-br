---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
title: Depuração de procedimentos armazenados (c#) | Microsoft Docs
author: rick-anderson
description: As edições do Visual Studio Professional e Team System permitem que você definir pontos de interrupção e a procedimentos armazenados do SQL Server, a etapa fazer depuração armazenados...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: c655c324-2ffa-4c21-8265-a254d79a693d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-cs
msc.type: authoredcontent
ms.openlocfilehash: 52bb409798dae550c664b78521f0fb4793464833
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="debugging-stored-procedures-c"></a><span data-ttu-id="a33e7-103">Depuração de procedimentos armazenados (c#)</span><span class="sxs-lookup"><span data-stu-id="a33e7-103">Debugging Stored Procedures (C#)</span></span>
====================
<span data-ttu-id="a33e7-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a33e7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a33e7-105">[Baixar o código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) ou [baixar PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a33e7-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_CS.zip) or [Download PDF](debugging-stored-procedures-cs/_static/datatutorial74cs1.pdf)</span></span>

> <span data-ttu-id="a33e7-106">As edições do Visual Studio Professional e Team System permitem que você definir pontos de interrupção e a procedimentos armazenados do SQL Server, a etapa fazer a depuração de procedimentos armazenados mais fácil depurar o código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="a33e7-107">Este tutorial demonstra a depuração de banco de dados direto e depuração de procedimentos armazenados do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>


## <a name="introduction"></a><span data-ttu-id="a33e7-108">Introdução</span><span class="sxs-lookup"><span data-stu-id="a33e7-108">Introduction</span></span>

<span data-ttu-id="a33e7-109">Visual Studio fornece uma experiência de depuração.</span><span class="sxs-lookup"><span data-stu-id="a33e7-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="a33e7-110">Com alguns pressionamentos de tecla ou cliques do mouse, ele s possível usar pontos de interrupção para parar a execução de um programa e examine seu fluxo de controle e estado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="a33e7-111">Junto com a depuração de código do aplicativo, o Visual Studio oferece suporte para depuração de procedimentos armazenados a partir do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="a33e7-112">Assim como pontos de interrupção podem ser definidos dentro de uma classe de code-behind do ASP.NET ou a classe da camada de lógica de negócios, o código de forma muito eles ser colocados dentro de procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="a33e7-113">Neste tutorial, examinaremos entrando em procedimentos armazenados do Gerenciador de servidores no Visual Studio, bem como definir pontos de interrupção são atingidos quando o procedimento armazenado é chamado do aplicativo ASP.NET em execução.</span><span class="sxs-lookup"><span data-stu-id="a33e7-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="a33e7-114">Infelizmente, os procedimentos armazenados só podem ser entrados em e depurados por meio de versões Professional e sistemas de equipe do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a33e7-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="a33e7-115">Se você estiver usando o Visual Web Developer ou a versão padrão do Visual Studio, você está bem-vindo ao longo de leitura percorremos as etapas necessárias para depurar procedimentos armazenados, mas você não poderá replicar essas etapas em seu computador.</span><span class="sxs-lookup"><span data-stu-id="a33e7-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>


## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="a33e7-116">Conceitos de depuração do SQL Server</span><span class="sxs-lookup"><span data-stu-id="a33e7-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="a33e7-117">Microsoft SQL Server 2005 foi projetado para fornecer integração com o [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), que é o tempo de execução usado por todos os assemblies do .NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="a33e7-118">Consequentemente, o SQL Server 2005 dá suporte a objetos de banco de dados gerenciados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="a33e7-119">Ou seja, você pode criar objetos de banco de dados como procedimentos armazenados e funções definidas pelo usuário (UDFs) como métodos na classe c#.</span><span class="sxs-lookup"><span data-stu-id="a33e7-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a C# class.</span></span> <span data-ttu-id="a33e7-120">Isso permite que esses procedimentos armazenados e UDFs para utilizar a funcionalidade do .NET Framework e de suas próprias classes personalizadas.</span><span class="sxs-lookup"><span data-stu-id="a33e7-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="a33e7-121">Naturalmente, o SQL Server 2005 também fornece suporte para objetos de banco de dados do T-SQL.</span><span class="sxs-lookup"><span data-stu-id="a33e7-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="a33e7-122">SQL Server 2005 oferece suporte à depuração de T-SQL e objetos de banco de dados gerenciados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="a33e7-123">No entanto, esses objetos podem ser depurados somente por meio de edições do Visual Studio 2005 Professional e sistemas de equipe.</span><span class="sxs-lookup"><span data-stu-id="a33e7-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="a33e7-124">Neste tutorial, examinaremos depuração objetos de banco de dados do T-SQL.</span><span class="sxs-lookup"><span data-stu-id="a33e7-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="a33e7-125">O tutorial subsequente olha para depurar objetos de banco de dados gerenciados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="a33e7-126">O [visão geral do T-SQL e a depuração CLR no SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) entrada de blog do [equipe de integração de CLR do SQL Server 2005](https://blogs.msdn.com/sqlclr/default.aspx) destaca as três maneiras de depurar objetos do SQL Server 2005 do Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="a33e7-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="a33e7-127">**Direcionar o banco de dados de depuração (DDD)** - do Gerenciador de servidores que podem entrar em qualquer objeto de banco de dados do T-SQL, como procedimentos armazenados e UDFs.</span><span class="sxs-lookup"><span data-stu-id="a33e7-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="a33e7-128">Vamos examinar DDD na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="a33e7-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="a33e7-129">**A depuração de aplicativo** -podemos definir pontos de interrupção dentro de um objeto de banco de dados e, em seguida, execute o aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="a33e7-130">Quando o objeto de banco de dados é executado, o ponto de interrupção será atingido e controle transformada para o depurador.</span><span class="sxs-lookup"><span data-stu-id="a33e7-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="a33e7-131">Observe que a depuração de aplicativo não é possível passar em um objeto de banco de dados do código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="a33e7-132">Nós deve definir explicitamente os pontos de interrupção nesses procedimentos armazenados ou UDFs onde desejamos que o depurador para interromper.</span><span class="sxs-lookup"><span data-stu-id="a33e7-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="a33e7-133">Depuração de aplicativo é examinado começando na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="a33e7-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="a33e7-134">**Depuração de um projeto do SQL Server** -edições do Visual Studio Professional e sistemas de equipe incluem um tipo de projeto do SQL Server que é normalmente usado para criar objetos de banco de dados gerenciados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="a33e7-135">Vamos examinar usando projetos do SQL Server e a depuração de seu conteúdo no tutorial Avançar.</span><span class="sxs-lookup"><span data-stu-id="a33e7-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="a33e7-136">O Visual Studio pode depurar procedimentos armazenados em instâncias do SQL Server locais e remotos.</span><span class="sxs-lookup"><span data-stu-id="a33e7-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="a33e7-137">Uma instância local do SQL Server é aquele que está instalado no mesmo computador que o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a33e7-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="a33e7-138">Se o banco de dados do SQL Server que você está usando não estiver localizado no computador de desenvolvimento, ele será considerado uma instância remota.</span><span class="sxs-lookup"><span data-stu-id="a33e7-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="a33e7-139">Para esses tutoriais estamos usando as instâncias locais do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="a33e7-140">A depuração de procedimentos armazenados em uma instância remota do SQL server requer mais etapas de configuração que ao depurar procedimentos armazenados em uma instância local.</span><span class="sxs-lookup"><span data-stu-id="a33e7-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="a33e7-141">Se você estiver usando uma instância local do SQL Server, você pode começar com a etapa 1 e trabalhar com este tutorial até o final.</span><span class="sxs-lookup"><span data-stu-id="a33e7-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="a33e7-142">Se você estiver usando uma instância remota do SQL Server, no entanto, você será necessário primeiro certifique-se de que durante a depuração, você está conectado à sua máquina de desenvolvimento com uma conta de usuário do Windows que tem um logon do SQL Server na instância remota.</span><span class="sxs-lookup"><span data-stu-id="a33e7-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="a33e7-143">Moveover, esse logon de banco de dados e o logon de banco de dados usado para se conectar ao banco de dados do aplicativo ASP.NET em execução deve ser membros do `sysadmin` função.</span><span class="sxs-lookup"><span data-stu-id="a33e7-143">Moveover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="a33e7-144">Consulte os objetos de banco de dados de depuração T-SQL na seção de instâncias remotas no final deste tutorial para obter mais informações sobre como configurar o Visual Studio e o SQL Server para uma instância remota de depuração.</span><span class="sxs-lookup"><span data-stu-id="a33e7-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="a33e7-145">Por fim, entenda que suporte à depuração para objetos de banco de dados do T-SQL não é como um recurso avançado como o suporte à depuração para aplicativos .NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="a33e7-146">Por exemplo, condições de ponto de interrupção e filtros não são suportados, somente um subconjunto das janelas de depuração estão disponíveis, você não pode usar Editar e continuar, a janela imediata é renderizada inútil e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a33e7-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="a33e7-147">Consulte [limitações sobre os recursos e comandos do depurador](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="a33e7-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="a33e7-148">Etapa 1: Depuração diretamente em um procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="a33e7-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="a33e7-149">O Visual Studio facilita a depurar diretamente um objeto de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="a33e7-150">Permitem s examinar como usar o recurso de depuração de banco de dados direta (DDD) para passar para o `Products_SelectByCategoryID` procedimento armazenado no banco de dados Northwind.</span><span class="sxs-lookup"><span data-stu-id="a33e7-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="a33e7-151">Como o nome sugere, `Products_SelectByCategoryID` retorna informações de produto para uma determinada categoria; ele foi criado o [usando existente procedimentos armazenados para o conjunto de dados tipado de s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="a33e7-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="a33e7-152">Iniciar, vá para o Gerenciador de servidores e expanda o nó do banco de dados Northwind.</span><span class="sxs-lookup"><span data-stu-id="a33e7-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="a33e7-153">Em seguida, fazer uma busca detalhada na pasta Stored Procedures, com o botão direito no `Products_SelectByCategoryID` procedimento armazenado e escolha a opção de etapa no procedimento armazenado do menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="a33e7-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="a33e7-154">Isso irá iniciar o depurador.</span><span class="sxs-lookup"><span data-stu-id="a33e7-154">This will start the debugger.</span></span>

<span data-ttu-id="a33e7-155">Como o `Products_SelectByCategoryID` procedimento armazenado espera um `@CategoryID` parâmetro de entrada, seremos solicitados a fornecer esse valor.</span><span class="sxs-lookup"><span data-stu-id="a33e7-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="a33e7-156">Insira 1, que retorna informações sobre as bebidas.</span><span class="sxs-lookup"><span data-stu-id="a33e7-156">Enter 1, which will return information about the beverages.</span></span>


![Use o valor 1 para o @CategoryID parâmetro](debugging-stored-procedures-cs/_static/image1.png)

<span data-ttu-id="a33e7-158">**Figura 1**: usar o valor 1 para o `@CategoryID` parâmetro</span><span class="sxs-lookup"><span data-stu-id="a33e7-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>


<span data-ttu-id="a33e7-159">Depois de fornecer o valor para o `@CategoryID` , o procedimento armazenado é executado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="a33e7-160">Em vez de em execução até a conclusão, no entanto, o depurador interromperá a execução na primeira instrução.</span><span class="sxs-lookup"><span data-stu-id="a33e7-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="a33e7-161">Observe a seta amarela na margem, que indica o local atual no procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="a33e7-162">Você pode exibir e editar valores de parâmetro através da janela de observação ou passando o mouse sobre o nome do parâmetro no procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>


<span data-ttu-id="a33e7-163">[![O depurador foi interrompida na primeira instrução do procedimento armazenado](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-cs/_static/image3.png)](debugging-stored-procedures-cs/_static/image2.png)</span></span>

<span data-ttu-id="a33e7-164">**Figura 2**: O depurador foi interrompida na primeira instrução do procedimento armazenado ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image4.png))</span></span>


<span data-ttu-id="a33e7-165">Para depurar a declaração de um procedimento armazenado por vez, clique no botão Avançar na barra de ferramentas ou pressione a tecla F10.</span><span class="sxs-lookup"><span data-stu-id="a33e7-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="a33e7-166">O `Products_SelectByCategoryID` procedimento armazenado contém uma única `SELECT` instrução, para atingir F10 guiará pela instrução única e concluir a execução do procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will Step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="a33e7-167">Depois que o procedimento armazenado é concluído, a saída será exibida na janela de saída e o depurador será encerrado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="a33e7-168">A depuração T-SQL ocorre no nível de instrução; Você não pode entrar em um `SELECT` instrução.</span><span class="sxs-lookup"><span data-stu-id="a33e7-168">T-SQL debugging occurs at the statement level; you cannot Step into a `SELECT` statement.</span></span>


## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="a33e7-169">Etapa 2: Configurando o site para a depuração de aplicativo</span><span class="sxs-lookup"><span data-stu-id="a33e7-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="a33e7-170">Durante a depuração de um procedimento armazenado diretamente do Gerenciador de servidores úteis, em muitos cenários estão mais interessados em depuração o procedimento armazenado quando ele é chamado de nosso aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="a33e7-171">Podemos adicionar pontos de interrupção para um procedimento armazenado de dentro do Visual Studio e, em seguida, iniciar a depuração do aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="a33e7-172">Quando um procedimento armazenado com os pontos de interrupção é invocado do aplicativo, a execução será interrompida no ponto de interrupção e podemos exibir e alterar os valores de parâmetro do procedimento armazenado s e percorrer suas instruções, como na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="a33e7-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="a33e7-173">Para que possamos começar a depuração de procedimentos armazenados chamados do aplicativo, é preciso instruir o aplicativo da web ASP.NET para integrar com o depurador do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="a33e7-174">Iniciar clicando no nome do site no Gerenciador de soluções (`ASPNET_Data_Tutorial_74_CS`).</span><span class="sxs-lookup"><span data-stu-id="a33e7-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_CS`).</span></span> <span data-ttu-id="a33e7-175">Escolha a opção de páginas de propriedades no menu de contexto, selecione o item de opções de inicialização à esquerda e marque a caixa de seleção do SQL Server na seção depuradores (consulte a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="a33e7-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>


<span data-ttu-id="a33e7-176">[![Marque a caixa de seleção de servidor SQL nas páginas de propriedade de aplicativo s](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-cs/_static/image6.png)](debugging-stored-procedures-cs/_static/image5.png)</span></span>

<span data-ttu-id="a33e7-177">**Figura 3**: marque a caixa de seleção de servidor SQL em aplicativo s páginas de propriedades ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image7.png))</span></span>


<span data-ttu-id="a33e7-178">Além disso, é necessário atualizar a cadeia de caracteres de conexão de banco de dados usada pelo aplicativo para que o pool de conexão está desabilitado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="a33e7-179">Quando uma conexão para um banco de dados for fechada, correspondente `SqlConnection` objeto é colocado em um pool de conexões disponíveis.</span><span class="sxs-lookup"><span data-stu-id="a33e7-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="a33e7-180">Ao estabelecer uma conexão para um banco de dados, um objeto de conexão disponíveis podem ser recuperados desse pool em vez de ter de criar e estabelecer uma nova conexão.</span><span class="sxs-lookup"><span data-stu-id="a33e7-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="a33e7-181">Este pool de objetos de conexão é um aprimoramento de desempenho e é habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="a33e7-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="a33e7-182">No entanto, ao depurar você deseja desativar o pool de conexão porque a infraestrutura de depuração não é restabelecida corretamente ao trabalhar com uma conexão que foi tirada do pool.</span><span class="sxs-lookup"><span data-stu-id="a33e7-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="a33e7-183">Para o pool de conexão desabilitado, atualizar o `NORTHWNDConnectionString` na `Web.config` para que ele inclui a configuração `Pooling=false` .</span><span class="sxs-lookup"><span data-stu-id="a33e7-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>


[!code-xml[Main](debugging-stored-procedures-cs/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="a33e7-184">Depois de terminar de depuração do SQL Server por meio do aplicativo ASP.NET Certifique-se restabelecer o pooling de conexão, removendo o `Pooling` configuração da cadeia de conexão (ou definindo-a como `Pooling=true` ).</span><span class="sxs-lookup"><span data-stu-id="a33e7-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>


<span data-ttu-id="a33e7-185">Neste ponto o aplicativo do ASP.NET foi configurado para permitir que o Visual Studio para depurar objetos de banco de dados do SQL Server quando invocado por meio do aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="a33e7-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="a33e7-186">Tudo o que resta agora é adicionar um ponto de interrupção para um procedimento armazenado e iniciar a depuração!</span><span class="sxs-lookup"><span data-stu-id="a33e7-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="a33e7-187">Etapa 3: Adicionando um ponto de interrupção e depuração</span><span class="sxs-lookup"><span data-stu-id="a33e7-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="a33e7-188">Abra o `Products_SelectByCategoryID` procedimento armazenado e defina um ponto de interrupção no início do `SELECT` instrução clicando na margem no local apropriado ou colocando o cursor no início do `SELECT` instrução e pressionando F9.</span><span class="sxs-lookup"><span data-stu-id="a33e7-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="a33e7-189">Como ilustra a Figura 4, o ponto de interrupção aparece como um círculo vermelho na margem.</span><span class="sxs-lookup"><span data-stu-id="a33e7-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>


<span data-ttu-id="a33e7-190">[![Definir um ponto de interrupção no Products_SelectByCategoryID procedimento armazenado](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-cs/_static/image9.png)](debugging-stored-procedures-cs/_static/image8.png)</span></span>

<span data-ttu-id="a33e7-191">**Figura 4**: definir um ponto de interrupção no `Products_SelectByCategoryID` procedimento armazenado ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-cs/_static/image10.png))</span></span>


<span data-ttu-id="a33e7-192">Para um objeto de banco de dados SQL a ser depurado por meio de um aplicativo cliente, é fundamental que o banco de dados ser configurado para oferecer suporte à depuração de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="a33e7-193">Quando você primeiro definir um ponto de interrupção, esta configuração automaticamente deve ser ativada, mas é recomendável verificar novamente.</span><span class="sxs-lookup"><span data-stu-id="a33e7-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="a33e7-194">Clique com botão direito no `NORTHWND.MDF` nó no Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="a33e7-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="a33e7-195">O menu de contexto deve incluir um menu marcados item denominado depuração de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-195">The context menu should include a checked menu item named Application Debugging .</span></span>


![Verifique se a opção de depuração de aplicativo está habilitada](debugging-stored-procedures-cs/_static/image11.png)

<span data-ttu-id="a33e7-197">**Figura 5**: Verifique se a opção de depuração de aplicativo está habilitada</span><span class="sxs-lookup"><span data-stu-id="a33e7-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>


<span data-ttu-id="a33e7-198">Com o conjunto de ponto de interrupção e a opção de depuração de aplicativo habilitada, você está pronto para depurar o procedimento armazenado quando chamado a partir do aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a33e7-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="a33e7-199">Iniciar o depurador indo até o menu de depuração e escolhendo iniciar depuração, pressionando F5 ou clicando o verde reproduzir o ícone na barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="a33e7-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="a33e7-200">Isso inicia o depurador e iniciar o site.</span><span class="sxs-lookup"><span data-stu-id="a33e7-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="a33e7-201">O `Products_SelectByCategoryID` procedimento armazenado foi criado na [usando existente procedimentos armazenados para o conjunto de dados tipado de s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="a33e7-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="a33e7-202">A página da web correspondente (`~/AdvancedDAL/ExistingSprocs.aspx`) contém um GridView que exibe os resultados retornados por esse procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="a33e7-203">Visite essa página por meio do navegador.</span><span class="sxs-lookup"><span data-stu-id="a33e7-203">Visit this page through the browser.</span></span> <span data-ttu-id="a33e7-204">Ao atingir a página, o ponto de interrupção a `Products_SelectByCategoryID` procedimento armazenado será atingido e o controle é retornado para o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a33e7-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="a33e7-205">Assim como na etapa 1, você pode percorrer as instruções do procedimento armazenado s e exibir e modificar os valores de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a33e7-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>


<span data-ttu-id="a33e7-206">[![A página de ExistingSprocs.aspx exibe inicialmente as bebidas](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-cs/_static/image13.png)](debugging-stored-procedures-cs/_static/image12.png)</span></span>

<span data-ttu-id="a33e7-207">**Figura 6**: O `ExistingSprocs.aspx` página exibe inicialmente as bebidas ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-cs/_static/image14.png))</span></span>


<span data-ttu-id="a33e7-208">[![O procedimento armazenado s ponto de interrupção foi atingido](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-cs/_static/image16.png)](debugging-stored-procedures-cs/_static/image15.png)</span></span>

<span data-ttu-id="a33e7-209">**Figura 7**: O procedimento armazenado s ponto de interrupção for atingido ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-cs/_static/image17.png))</span></span>


<span data-ttu-id="a33e7-210">Como a janela de inspeção na Figura 7 mostra, o valor de `@CategoryID` parâmetro é 1.</span><span class="sxs-lookup"><span data-stu-id="a33e7-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="a33e7-211">Isso ocorre porque o `ExistingSprocs.aspx` página inicialmente exibe os produtos na categoria de bebidas, que tem um `CategoryID` valor de 1.</span><span class="sxs-lookup"><span data-stu-id="a33e7-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="a33e7-212">Escolha uma categoria diferente na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="a33e7-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="a33e7-213">Isso causa um postback e executa novamente o `Products_SelectByCategoryID` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="a33e7-214">O ponto de interrupção é atingido novamente, mas desta vez o `@CategoryID` o valor do parâmetro s reflete o item selecionado na lista suspensa s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="a33e7-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>


<span data-ttu-id="a33e7-215">[![Escolha uma categoria diferente na lista suspensa](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-cs/_static/image19.png)](debugging-stored-procedures-cs/_static/image18.png)</span></span>

<span data-ttu-id="a33e7-216">**Figura 8**: escolha uma categoria diferente na lista suspensa ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-cs/_static/image20.png))</span></span>


<span data-ttu-id="a33e7-217">[![O @CategoryID parâmetro reflete a categoria selecionada da página da Web](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a33e7-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-cs/_static/image22.png)](debugging-stored-procedures-cs/_static/image21.png)</span></span>

<span data-ttu-id="a33e7-218">**Figura 9**: O `@CategoryID` parâmetro reflete a categoria selecionada da página da Web ([clique para exibir a imagem em tamanho normal](debugging-stored-procedures-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="a33e7-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-cs/_static/image23.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a33e7-219">Se o ponto de interrupção a `Products_SelectByCategoryID` procedimento armazenado não é atingido quando visitar o `ExistingSprocs.aspx` página, certifique-se de que a caixa de seleção do SQL Server foi verificada na seção depuradores do aplicativo ASP.NET s página de propriedades, o pooling de conexão tiver sido desabilitado e que o banco de dados s opção de depuração de aplicativo está habilitado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="a33e7-220">Se você ainda tiver problemas, reinicie o Visual Studio e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="a33e7-220">If you re still having problems, restart Visual Studio and try again.</span></span>


## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="a33e7-221">Objetos de banco de dados do T-SQL em instâncias remotas de depuração</span><span class="sxs-lookup"><span data-stu-id="a33e7-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="a33e7-222">Depuração de objetos de banco de dados por meio do Visual Studio é bastante simples quando a instância de banco de dados do SQL Server estiver no mesmo computador que o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a33e7-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="a33e7-223">No entanto, se o SQL Server e Visual Studio residem em computadores diferentes alguma configuração cuidadosa é necessário para obter tudo estiver funcionando corretamente.</span><span class="sxs-lookup"><span data-stu-id="a33e7-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="a33e7-224">Há duas tarefas principais que existem:</span><span class="sxs-lookup"><span data-stu-id="a33e7-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="a33e7-225">Certifique-se de que o logon usado para se conectar ao banco de dados por meio do ADO.NET pertence a `sysadmin` função.</span><span class="sxs-lookup"><span data-stu-id="a33e7-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="a33e7-226">Certifique-se de que a conta de usuário do Windows usada pelo Visual Studio no computador de desenvolvimento é uma conta de logon válida do SQL Server que pertence a `sysadmin` função.</span><span class="sxs-lookup"><span data-stu-id="a33e7-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="a33e7-227">A primeira etapa é relativamente simples.</span><span class="sxs-lookup"><span data-stu-id="a33e7-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="a33e7-228">Primeiro, identifique a conta de usuário usada para se conectar ao banco de dados do aplicativo ASP.NET e, em seguida, no SQL Server Management Studio, adicione essa conta de logon para o `sysadmin` função.</span><span class="sxs-lookup"><span data-stu-id="a33e7-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="a33e7-229">A segunda tarefa requer que a conta de usuário do Windows que usam para depurar o aplicativo ser um logon válido no banco de dados remoto.</span><span class="sxs-lookup"><span data-stu-id="a33e7-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="a33e7-230">No entanto, a probabilidade é registrado sua estação de trabalho com a conta do Windows não é um logon válido no SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="a33e7-231">Em vez de adicionar sua conta de logon específica para o SQL Server, uma opção melhor seria designar alguma conta de usuário do Windows como a conta de depuração de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="a33e7-232">Em seguida, para depurar os objetos de banco de dados de uma instância remota do SQL Server, você executaria Visual Studio usando que credenciais de conta s de logon do Windows.</span><span class="sxs-lookup"><span data-stu-id="a33e7-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="a33e7-233">Um exemplo pode ajudar a esclarecer coisas.</span><span class="sxs-lookup"><span data-stu-id="a33e7-233">An example should help clarify things.</span></span> <span data-ttu-id="a33e7-234">Imagine que há uma conta do Windows chamada `SQLDebug` dentro do domínio do Windows.</span><span class="sxs-lookup"><span data-stu-id="a33e7-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="a33e7-235">Essa conta precisa ser adicionado à instância remota do SQL Server como um logon válido e um membro do `sysadmin` função.</span><span class="sxs-lookup"><span data-stu-id="a33e7-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="a33e7-236">Em seguida, para depurar a instância remota do SQL Server no Visual Studio, temos que executar o Visual Studio como o `SQLDebug` usuário.</span><span class="sxs-lookup"><span data-stu-id="a33e7-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="a33e7-237">Isso pode ser feito pelo log fora de nosso estação de trabalho, fazer logon novamente como `SQLDebug`, e, em seguida, iniciar o Visual Studio, mas uma abordagem mais simples seria nossa estação de trabalho usando nossas próprias credenciais de logon e, em seguida, usar `runas.exe` para iniciar o Visual Studio como o `SQLDebug` usuário.</span><span class="sxs-lookup"><span data-stu-id="a33e7-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="a33e7-238">`runas.exe` permite que um aplicativo específico a ser executada na forma de uma conta de usuário diferente.</span><span class="sxs-lookup"><span data-stu-id="a33e7-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="a33e7-239">Para iniciar o Visual Studio como `SQLDebug`, você poderia inserir a instrução a seguir na linha de comando:</span><span class="sxs-lookup"><span data-stu-id="a33e7-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>


[!code-console[Main](debugging-stored-procedures-cs/samples/sample2.cmd)]

<span data-ttu-id="a33e7-240">Para obter uma explicação mais detalhada sobre esse processo, consulte [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker guia para Visual Studio e SQL Server, edição sétimo* , bem como [como: definir permissões do SQL Server para depuração](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="a33e7-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="a33e7-241">Se sua máquina de desenvolvimento estiver executando o Windows XP Service Pack 2, você precisará configurar o Firewall de Conexão de Internet para permitir a depuração remota.</span><span class="sxs-lookup"><span data-stu-id="a33e7-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="a33e7-242">[Como para: habilitar a depuração do SQL Server 2005](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) artigo notas que isso envolve duas etapas: (a) no computador de host do Visual Studio, você deverá adicionar `Devenv.exe` à lista de exceções e abrir a porta TCP 135; e (b) no computador remoto (SQL), você deve abrir o TCP 135 porta e adicionar `sqlservr.exe` à lista de exceções.</span><span class="sxs-lookup"><span data-stu-id="a33e7-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="a33e7-243">Se a diretiva de domínio requer comunicação de rede sejam feitas via IPSec, você deve abrir as portas UDP 4500 e UDP 500.</span><span class="sxs-lookup"><span data-stu-id="a33e7-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>


## <a name="summary"></a><span data-ttu-id="a33e7-244">Resumo</span><span class="sxs-lookup"><span data-stu-id="a33e7-244">Summary</span></span>

<span data-ttu-id="a33e7-245">Além de fornecer suporte à depuração de código do aplicativo .NET, o Visual Studio também fornece uma variedade de opções de depuração para o SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="a33e7-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="a33e7-246">Neste tutorial vimos duas dessas opções: depuração direta do banco de dados e a depuração de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a33e7-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="a33e7-247">Para depurar diretamente um objeto de banco de dados do T-SQL, localize o objeto por meio do Gerenciador de servidores, em seguida, clique nele e escolha entrar.</span><span class="sxs-lookup"><span data-stu-id="a33e7-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="a33e7-248">Isso inicia o depurador e é interrompida na primeira instrução no objeto de banco de dados, no ponto em que você pode percorrer as instruções do objeto s e exibir e modificar valores de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a33e7-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="a33e7-249">Na etapa 1, usamos essa abordagem para passar o `Products_SelectByCategoryID` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="a33e7-250">Depuração de aplicativo permite que os pontos de interrupção a ser definida diretamente dentro dos objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="a33e7-251">Quando um objeto de banco de dados com pontos de interrupção é chamado de um aplicativo cliente (como um aplicativo web do ASP.NET), o programa é interrompida, como o depurador assume.</span><span class="sxs-lookup"><span data-stu-id="a33e7-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="a33e7-252">Depuração de aplicativo é útil porque mostra mais claramente que ação de aplicativo faz com que um objeto de banco de dados específico a ser invocado.</span><span class="sxs-lookup"><span data-stu-id="a33e7-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="a33e7-253">No entanto, ele exige um pouco mais a instalação e configuração de depuração direta do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a33e7-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="a33e7-254">Objetos de banco de dados também podem ser depurados por meio de projetos do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a33e7-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="a33e7-255">Vamos examinar usando projetos do SQL Server e como usá-las para criar e depurar gerenciados objetos de banco de dados no tutorial Avançar.</span><span class="sxs-lookup"><span data-stu-id="a33e7-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="a33e7-256">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="a33e7-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a33e7-257">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="a33e7-257">About the Author</span></span>

<span data-ttu-id="a33e7-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="a33e7-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a33e7-259">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="a33e7-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a33e7-260">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a33e7-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a33e7-261">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a33e7-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a33e7-262">[Anterior](protecting-connection-strings-and-other-configuration-information-cs.md)
> [Próximo](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a33e7-262">[Previous](protecting-connection-strings-and-other-configuration-information-cs.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)</span></span>
