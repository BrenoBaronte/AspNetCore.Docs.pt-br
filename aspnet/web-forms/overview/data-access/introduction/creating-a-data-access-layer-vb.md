---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: Criando uma camada de acesso a dados (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial vamos começar do começo e criar o Data Access DAL (camada), usando conjuntos de dados tipados, para acessar as informações em um banco de dados.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: 5cf1a430d6fe94174a877beb04b930409bdbf084
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="creating-a-data-access-layer-vb"></a><span data-ttu-id="f86e3-103">Criando uma camada de acesso a dados (VB)</span><span class="sxs-lookup"><span data-stu-id="f86e3-103">Creating a Data Access Layer (VB)</span></span>
====================
<span data-ttu-id="f86e3-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f86e3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f86e3-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) ou [baixar PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f86e3-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) or [Download PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)</span></span>

> <span data-ttu-id="f86e3-106">Neste tutorial vamos começar do começo e criar o Data Access DAL (camada), usando conjuntos de dados tipados, para acessar as informações em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="f86e3-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="f86e3-107">Introduction</span></span>

<span data-ttu-id="f86e3-108">Como os desenvolvedores da web, nossa vida giram em torno de trabalhar com dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="f86e3-109">Podemos criar bancos de dados para armazenar os dados, o código para recuperar e modificar e páginas da web para coletar e resumi-lo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="f86e3-110">Este é o primeiro tutorial em uma série extensa explorará técnicas para implementar esses padrões comuns no ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="f86e3-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="f86e3-111">Vamos começar com a criação de um [arquitetura de software](http://en.wikipedia.org/wiki/Software_architecture) composto de uma Data Access DAL (camada) usando DataSets tipados, uma camada de lógica de negócios (BLL) que impõe regras de negócio personalizadas, e as páginas de uma camada de apresentação composta do ASP.NET que Compartilhe um layout de página comuns.</span><span class="sxs-lookup"><span data-stu-id="f86e3-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="f86e3-112">Depois que essa base de back-end foi apresentado, passaremos para emissão de relatórios, mostrando como exibir, resumir, coletar e validar os dados de um aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="f86e3-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="f86e3-113">Esses tutoriais são orientados para ser conciso e fornecem instruções passo a passo com capturas de tela suficiente para orientá-lo pelo processo visualmente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="f86e3-114">Cada tutorial está disponível em c# e Visual Basic versões e inclui um download do código completo usado.</span><span class="sxs-lookup"><span data-stu-id="f86e3-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="f86e3-115">(Esse tutorial primeiro é muito longo, mas o restante são apresentados em partes amostras muito mais.)</span><span class="sxs-lookup"><span data-stu-id="f86e3-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="f86e3-116">Para esses tutoriais usaremos uma versão do Microsoft SQL Server 2005 Express Edition do banco de dados Northwind, colocado no `App_Data` directory.</span><span class="sxs-lookup"><span data-stu-id="f86e3-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the `App_Data` directory.</span></span> <span data-ttu-id="f86e3-117">Além do arquivo de banco de dados, o `App_Data` pasta também contém os scripts SQL para criar o banco de dados, caso você deseje usar uma versão diferente do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-117">In addition to the database file, the `App_Data` folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="f86e3-118">Esses scripts podem também ser [baixado diretamente da Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), se você preferir.</span><span class="sxs-lookup"><span data-stu-id="f86e3-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="f86e3-119">Se você usar uma versão diferente do SQL Server do banco de dados Northwind, você precisará atualizar o `NORTHWNDConnectionString` configuração do aplicativo `Web.config` arquivo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-119">If you use a different SQL Server version of the Northwind database, you will need to update the `NORTHWNDConnectionString` setting in the application's `Web.config` file.</span></span> <span data-ttu-id="f86e3-120">O aplicativo web foi criado usando o Visual Studio 2005 Professional Edition como um projeto de site da Web baseado no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="f86e3-121">No entanto, todos os tutoriais funcionará igualmente bem com a versão gratuita do Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="f86e3-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>

<span data-ttu-id="f86e3-122">Neste tutorial vamos começar do começo e criar o Data Access DAL (camada), seguido por meio da criação de [camada de lógica de negócios (BLL)](creating-a-business-logic-layer-vb.md) no segundo tutorial e trabalhando para [página de layout e navegação](master-pages-and-site-navigation-vb.md) no terceiro.</span><span class="sxs-lookup"><span data-stu-id="f86e3-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the [Business Logic Layer (BLL)](creating-a-business-logic-layer-vb.md) in the second tutorial, and working on [page layout and navigation](master-pages-and-site-navigation-vb.md) in the third.</span></span> <span data-ttu-id="f86e3-123">Os tutoriais depois criará um terceiro com base apresentado nas três primeiras.</span><span class="sxs-lookup"><span data-stu-id="f86e3-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="f86e3-124">Temos muitos abrangem neste tutorial primeiro, portanto, inicie o Visual Studio e vamos começar!</span><span class="sxs-lookup"><span data-stu-id="f86e3-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="f86e3-125">Etapa 1: Criar um projeto da Web e conectar-se ao banco de dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="f86e3-126">Para que possa criar nossa camada de acesso de dados (DAL), é preciso primeiro criar um site da web e nosso banco de dados de configuração.</span><span class="sxs-lookup"><span data-stu-id="f86e3-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="f86e3-127">Comece criando um novo arquivo com base em sistema site ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f86e3-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="f86e3-128">Para fazer isso, vá para o menu Arquivo e escolha o novo Site da Web, exibindo a caixa de diálogo do novo Site da Web.</span><span class="sxs-lookup"><span data-stu-id="f86e3-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="f86e3-129">Escolha o modelo de Site da Web ASP.NET, definir a lista suspensa do local do sistema de arquivos, escolha uma pasta para colocar o site da web e definir a linguagem Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="f86e3-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span>


<span data-ttu-id="f86e3-130">[![Criar um novo arquivo com base em sistema Site da Web](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)</span></span>

<span data-ttu-id="f86e3-131">**Figura 1**: criar um Site New File System-Based ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image3.png))</span></span>


<span data-ttu-id="f86e3-132">Isso criará um novo site com um `Default.aspx` página ASP.NET, um `App_Data` pasta e um `Web.config` arquivo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-132">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

<span data-ttu-id="f86e3-133">Com o site criado, a próxima etapa é adicionar uma referência ao banco de dados no Gerenciador de servidores do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f86e3-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="f86e3-134">Adicionando um banco de dados para o Gerenciador de servidores, você pode adicionar tabelas, procedimentos armazenados, exibições e assim por diante todos de dentro do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f86e3-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="f86e3-135">Você também pode exibir dados de tabelas ou criar suas próprias consultas manual ou graficamente via o construtor de consultas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="f86e3-136">Além disso, quando criamos os conjuntos de dados digitado para a DAL precisaremos ponto Visual Studio para o banco de dados do qual os conjuntos de dados tipado deve ser construídos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="f86e3-137">Enquanto estamos podem fornecer essas informações de conexão no momento, o Visual Studio preenche automaticamente uma lista suspensa dos bancos de dados já está registrado no Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="f86e3-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="f86e3-138">As etapas para adicionar o banco de dados Northwind para o Gerenciador de servidores dependem se você deseja usar o banco de dados do SQL Server 2005 Express Edition no `App_Data` pasta ou se você tiver um Microsoft SQL Server 2000 ou instalação de servidor de banco de dados 2005 que você deseja usar em vez disso.</span><span class="sxs-lookup"><span data-stu-id="f86e3-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the `App_Data` folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="f86e3-139">Usando um banco de dados de`App_Data`pasta</span><span class="sxs-lookup"><span data-stu-id="f86e3-139">Using a Database in the`App_Data`Folder</span></span>

<span data-ttu-id="f86e3-140">Se você não tem um SQL Server 2000 ou 2005 servidor de banco de dados para se conectar ao ou simplesmente desejar evitar ter que adicionar o banco de dados a um servidor de banco de dados, você pode usar a versão do SQL Server 2005 Express Edition do banco de dados Northwind está localizado no websit baixado e's `App_Data` pasta (`NORTHWND.MDF`).</span><span class="sxs-lookup"><span data-stu-id="f86e3-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's `App_Data` folder (`NORTHWND.MDF`).</span></span>

<span data-ttu-id="f86e3-141">Um banco de dados é colocado no `App_Data` pasta é adicionada automaticamente para o Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="f86e3-141">A database placed in the `App_Data` folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="f86e3-142">Supondo que você tenha o SQL Server 2005 Express Edition instalado em seu computador, você deverá ver um nó denominado NORTHWND. MDF no Gerenciador de servidores, que você pode expandir e explorar suas tabelas, exibições, procedimento armazenado e assim por diante (consulte a Figura 2).</span><span class="sxs-lookup"><span data-stu-id="f86e3-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="f86e3-143">O `App_Data` pasta também pode manter o Microsoft Access `.mdb` arquivos, que, assim como suas contrapartes do SQL Server, são adicionados automaticamente para o Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="f86e3-143">The `App_Data` folder can also hold Microsoft Access `.mdb` files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="f86e3-144">Se você não quiser usar qualquer uma das opções do SQL Server, você pode sempre [baixar uma versão do Microsoft Access do arquivo de banco de dados Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) e solte no `App_Data` directory.</span><span class="sxs-lookup"><span data-stu-id="f86e3-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the `App_Data` directory.</span></span> <span data-ttu-id="f86e3-145">Lembre-se, no entanto, que não são bancos de dados do Access como muitos recursos que o SQL Server e não são projetados para serem usados em cenários de site da web.</span><span class="sxs-lookup"><span data-stu-id="f86e3-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="f86e3-146">Além disso, alguns dos tutoriais do 35 + utilizará determinados recursos de nível de banco de dados que não são suportados pelo Access.</span><span class="sxs-lookup"><span data-stu-id="f86e3-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="f86e3-147">Conectar-se ao banco de dados em um servidor de banco de dados do Microsoft SQL Server 2000 ou 2005</span><span class="sxs-lookup"><span data-stu-id="f86e3-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="f86e3-148">Como alternativa, você pode se conectar a um banco de dados Northwind instalado em um servidor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="f86e3-149">Se o servidor de banco de dados ainda não tiver o banco de dados Northwind instalado, você primeiro deve adicioná-lo ao servidor de banco de dados executando o script de instalação incluído no download deste tutorial ou pelo [baixar a versão do SQL Server 2000 do Northwind script de instalação e](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) diretamente do site da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f86e3-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="f86e3-150">Uma vez que o banco de dados instalado, vá para o Gerenciador de servidores no Visual Studio, clique com botão direito no nó de conexões de dados e escolha Adicionar Conexão.</span><span class="sxs-lookup"><span data-stu-id="f86e3-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="f86e3-151">Se você não vir o Gerenciador de servidores, acesse o modo de exibição / Gerenciador de servidores ou ocorrências Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="f86e3-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="f86e3-152">Isso abrirá a caixa de diálogo Adicionar Conexão, onde você pode especificar o servidor para se conectar ao, as informações de autenticação e o nome do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="f86e3-153">Depois de ter configurado as informações de conexão de banco de dados e clicar no botão Okey com êxito, o banco de dados será adicionado como um nó sob o nó de conexões de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="f86e3-154">Você pode expandir o nó de banco de dados para explorar suas tabelas, exibições, procedimentos armazenados e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f86e3-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Adicionar uma Conexão ao banco de dados do seu servidor de banco de dados Northwind](creating-a-data-access-layer-vb/_static/image4.png)

<span data-ttu-id="f86e3-156">**Figura 2**: adicionar uma Conexão ao banco de dados do seu servidor de banco de dados Northwind</span><span class="sxs-lookup"><span data-stu-id="f86e3-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="f86e3-157">Etapa 2: Criar a camada de acesso a dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="f86e3-158">Ao trabalhar com dados de uma opção é inserir a lógica de específicos de dados diretamente para a camada de apresentação (em um aplicativo web, o ASP.NET páginas, compõem a camada de apresentação).</span><span class="sxs-lookup"><span data-stu-id="f86e3-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="f86e3-159">Isso pode assumir a forma de escrever código ADO.NET na parte do código da página ASP.NET ou usando o controle SqlDataSource da parte de marcação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="f86e3-160">Em ambos os casos, essa abordagem acoplada rigidamente a lógica de acesso a dados com a camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="f86e3-161">No entanto, é a abordagem recomendada separar a lógica de acesso a dados da camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="f86e3-162">Essa camada separada é chamada de camada de acesso a dados, a DAL de forma abreviada e geralmente é implementada como um projeto de biblioteca de classes separado.</span><span class="sxs-lookup"><span data-stu-id="f86e3-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="f86e3-163">Os benefícios dessa arquitetura em camadas são bem documentados (consulte a seção "Leituras adicionais" no final deste tutorial para obter informações sobre estas vantagens) e é a abordagem obtemos nesta série.</span><span class="sxs-lookup"><span data-stu-id="f86e3-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="f86e3-164">Todo o código que é específico à fonte de dados subjacente, como a criação de uma conexão ao banco de dados, emitir `SELECT`, `INSERT`, `UPDATE`, e `DELETE` comandos e assim por diante devem estar localizado em DAL.</span><span class="sxs-lookup"><span data-stu-id="f86e3-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing `SELECT`, `INSERT`, `UPDATE`, and `DELETE` commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="f86e3-165">A camada de apresentação não deve conter todas as referências a esse código de acesso de dados, mas em vez disso, deve fazer chamadas para a DAL para solicitações de todos os dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="f86e3-166">Camadas de acesso de dados normalmente contêm métodos para acessar o banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="f86e3-167">Por exemplo, tem um banco de dados Northwind, `Products` e `Categories` tabelas que registram os produtos de venda e as categorias às quais eles pertencem.</span><span class="sxs-lookup"><span data-stu-id="f86e3-167">The Northwind database, for example, has `Products` and `Categories` tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="f86e3-168">Em nosso DAL teremos métodos, como:</span><span class="sxs-lookup"><span data-stu-id="f86e3-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="f86e3-169">`GetCategories(),` retornará informações sobre todas as categorias</span><span class="sxs-lookup"><span data-stu-id="f86e3-169">`GetCategories(),` which will return information about all of the categories</span></span>
- <span data-ttu-id="f86e3-170">`GetProducts()`, que retorna informações sobre todos os produtos</span><span class="sxs-lookup"><span data-stu-id="f86e3-170">`GetProducts()`, which will return information about all of the products</span></span>
- <span data-ttu-id="f86e3-171">`GetProductsByCategoryID(categoryID)`, que retorna todos os produtos que pertencem a uma categoria especificada</span><span class="sxs-lookup"><span data-stu-id="f86e3-171">`GetProductsByCategoryID(categoryID)`, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="f86e3-172">`GetProductByProductID(productID)`, que retorna informações sobre um produto específico</span><span class="sxs-lookup"><span data-stu-id="f86e3-172">`GetProductByProductID(productID)`, which will return information about a particular product</span></span>

<span data-ttu-id="f86e3-173">Esses métodos, quando chamado, conectar-se ao banco de dados, emita a consulta apropriada e retornar os resultados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="f86e3-174">É importante como retornamos esses resultados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-174">How we return these results is important.</span></span> <span data-ttu-id="f86e3-175">Esses métodos podem simplesmente retornar um DataSet ou DataReader preenchida pela consulta de banco de dados, mas idealmente esses resultados devem ser retornados usando *objetos fortemente tipados*.</span><span class="sxs-lookup"><span data-stu-id="f86e3-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="f86e3-176">Um objeto fortemente tipado é um cujo esquema rigidamente é definida em tempo de compilação, enquanto o oposto, um objeto tipadas vagamente, é uma cujo esquema não é conhecida até o tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="f86e3-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="f86e3-177">Por exemplo, o DataReader e o conjunto de dados (por padrão) são objetos tipadas vagamente porque seu esquema é definido pelas colunas retornadas pela consulta de banco de dados usada para preenchê-los.</span><span class="sxs-lookup"><span data-stu-id="f86e3-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="f86e3-178">Para acessar uma coluna específica de um DataTable tipadas vagamente que precisamos usar sintaxe semelhante: `DataTable.Rows(index)("columnName")`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: `DataTable.Rows(index)("columnName")`.</span></span> <span data-ttu-id="f86e3-179">Tipagem flexível a DataTable neste exemplo é apresentado pelo fato de que precisamos para acessar o nome da coluna usando uma cadeia de caracteres ou o índice ordinal.</span><span class="sxs-lookup"><span data-stu-id="f86e3-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="f86e3-180">Uma DataTable fortemente tipado, por outro lado, terá cada uma de suas colunas implementadas como propriedades, resultando em código que se parece com: `DataTable.Rows(index).columnName`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: `DataTable.Rows(index).columnName`.</span></span>

<span data-ttu-id="f86e3-181">Para retornar objetos fortemente tipados, os desenvolvedores podem criar seus próprios objetos de negócios personalizada ou usar conjuntos de dados digitados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="f86e3-182">Um objeto de negócios é implementado pelo desenvolvedor como representa uma classe cujas propriedades normalmente refletem as colunas da tabela de banco de dados subjacentes do objeto comercial.</span><span class="sxs-lookup"><span data-stu-id="f86e3-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="f86e3-183">Um conjunto de dados tipado é uma classe gerada para você pelo Visual Studio com base em um esquema de banco de dados e cujos membros são fortemente tipada de acordo com esse esquema.</span><span class="sxs-lookup"><span data-stu-id="f86e3-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="f86e3-184">O conjunto de dados tipado próprio consiste em classes que estendem as classes de conjunto de dados ADO.NET, DataTable e DataRow.</span><span class="sxs-lookup"><span data-stu-id="f86e3-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="f86e3-185">Além das tabelas de dados fortemente tipados, DataSets tipados agora também incluem TableAdapters, que são classes com métodos para popular tabelas de dados do conjunto de dados e propagar as modificações dentro de tabelas de dados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="f86e3-186">Para obter mais informações sobre as vantagens e desvantagens do uso de DataSets tipados versus objetos comerciais personalizados, consulte [Criando componentes de camada de dados e passando por meio de camadas de dados](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="f86e3-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="f86e3-187">Vamos usar conjuntos de dados fortemente tipado para arquitetura esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="f86e3-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="f86e3-188">A Figura 3 ilustra o fluxo de trabalho entre as diferentes camadas de um aplicativo que usa conjuntos de dados digitados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="f86e3-189">[![Código de acesso a todos os dados é relegados a DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)</span></span>

<span data-ttu-id="f86e3-190">**Figura 3**: código de acesso a todos os dados é relegados a DAL ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="f86e3-191">Criação de um conjunto de dados tipado e o adaptador de tabela</span><span class="sxs-lookup"><span data-stu-id="f86e3-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="f86e3-192">Para começar a criar nossa DAL, vamos começar com a adição de um conjunto de dados tipado ao nosso projeto.</span><span class="sxs-lookup"><span data-stu-id="f86e3-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="f86e3-193">Para fazer isso, clique com botão direito no nó do projeto no Gerenciador de soluções e escolha Adicionar um novo Item.</span><span class="sxs-lookup"><span data-stu-id="f86e3-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="f86e3-194">Selecione a opção de conjunto de dados na lista de modelos e nomeie- `Northwind.xsd`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-194">Select the DataSet option from the list of templates and name it `Northwind.xsd`.</span></span>


<span data-ttu-id="f86e3-195">[![Adicionar um novo conjunto de dados ao seu projeto](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)</span></span>

<span data-ttu-id="f86e3-196">**Figura 4**: adicionar um novo conjunto de dados ao seu projeto ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image10.png))</span></span>


<span data-ttu-id="f86e3-197">Depois de clicar em Adicionar, quando solicitado a adicionar o conjunto de dados para o `App_Code` pasta, escolha ' Sim '.</span><span class="sxs-lookup"><span data-stu-id="f86e3-197">After clicking Add, when prompted to add the DataSet to the `App_Code` folder, choose Yes.</span></span> <span data-ttu-id="f86e3-198">O Designer para o conjunto de dados tipado será exibido e iniciará o Assistente de configuração do TableAdapter, permitindo que você adicione o TableAdapter primeiro para o conjunto de dados tipado.</span><span class="sxs-lookup"><span data-stu-id="f86e3-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="f86e3-199">Um conjunto de dados tipado serve como uma coleção fortemente tipada de dados. ele é composto de instâncias de DataTable fortemente tipada, cada um por sua vez é composta de instâncias de DataRow fortemente tipada.</span><span class="sxs-lookup"><span data-stu-id="f86e3-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="f86e3-200">Vamos criar uma tabela de dados fortemente tipado para cada uma das tabelas de banco de dados subjacente que precisamos para trabalhar com esta série de tutoriais.</span><span class="sxs-lookup"><span data-stu-id="f86e3-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="f86e3-201">Vamos começar com a criação de um DataTable para o `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="f86e3-201">Let's start with creating a DataTable for the `Products` table.</span></span>

<span data-ttu-id="f86e3-202">Tenha em mente que DataTables fortemente tipadas não incluem todas as informações sobre como acessar dados da tabela de banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="f86e3-203">Para recuperar os dados para preencher a DataTable, usamos uma classe do TableAdapter, que funciona como nossa camada de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="f86e3-204">Para nosso `Products` DataTable, o TableAdapter conterá os métodos `GetProducts()`, `GetProductByCategoryID(categoryID)`e assim por diante que vai invocamos da camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-204">For our `Products` DataTable, the TableAdapter will contain the methods `GetProducts()`, `GetProductByCategoryID(categoryID)`, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="f86e3-205">Função da DataTable é servir como os usado para passar dados entre as camadas de objetos fortemente tipados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="f86e3-206">O Assistente de configuração do TableAdapter começa solicitando que você selecione qual banco de dados para trabalhar com.</span><span class="sxs-lookup"><span data-stu-id="f86e3-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="f86e3-207">A lista suspensa mostra esses bancos de dados no Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="f86e3-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="f86e3-208">Se você não adicionou o banco de dados Northwind para o Gerenciador de servidores, você pode clicar no botão Nova Conexão a nesse momento para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="f86e3-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="f86e3-209">[![Escolha o banco de dados Northwind na lista suspensa](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)</span></span>

<span data-ttu-id="f86e3-210">**Figura 5**: escolha o banco de dados Northwind na lista suspensa ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image13.png))</span></span>


<span data-ttu-id="f86e3-211">Após selecionar o banco de dados e clicar em Avançar, será perguntado se você deseja salvar a cadeia de conexão de `Web.config` arquivo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the `Web.config` file.</span></span> <span data-ttu-id="f86e3-212">Salvando a cadeia de caracteres de conexão, você evitará tendo rígido codificados em classes de TableAdapter, que simplifica as coisas se as informações de cadeia de caracteres de conexão é alterado no futuro.</span><span class="sxs-lookup"><span data-stu-id="f86e3-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="f86e3-213">Se você optar por salvar a cadeia de caracteres de conexão no arquivo de configuração é colocado no `<connectionStrings>` seção, que pode ser [opcionalmente criptografado](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) para segurança aprimorada ou modificado posteriormente com a nova página de propriedade do ASP.NET 2.0 em a interface gráfica do usuário ferramenta de administração IIS, que é mais ideal para administradores.</span><span class="sxs-lookup"><span data-stu-id="f86e3-213">If you opt to save the connection string in the configuration file it's placed in the `<connectionStrings>` section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="f86e3-214">[![Salvar a cadeia de caracteres de Conexão em Web. config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)</span></span>

<span data-ttu-id="f86e3-215">**Figura 6**: salvar a cadeia de Conexão para `Web.config` ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-215">**Figure 6**: Save the Connection String to `Web.config` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image16.png))</span></span>


<span data-ttu-id="f86e3-216">Em seguida, precisamos definir o esquema para a primeira DataTable fortemente tipada e fornecer o primeiro método de nosso TableAdapter usar ao preencher o conjunto de dados fortemente tipados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="f86e3-217">Essas duas etapas são executadas simultaneamente, criando uma consulta que retorna as colunas da tabela que queremos refletidos em nossa tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="f86e3-218">No final do assistente vamos dar um nome de método para esta consulta.</span><span class="sxs-lookup"><span data-stu-id="f86e3-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="f86e3-219">Depois que isso for feito, esse método pode ser chamado do nosso camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="f86e3-220">O método irá executar a consulta definida e preencher uma DataTable fortemente tipada.</span><span class="sxs-lookup"><span data-stu-id="f86e3-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="f86e3-221">Para começar a definir a consulta SQL primeiro deve indicar que desejamos TableAdapter para emitir a consulta.</span><span class="sxs-lookup"><span data-stu-id="f86e3-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="f86e3-222">Podemos pode usar uma instrução de SQL ad hoc, crie um novo procedimento armazenado ou usar um procedimento armazenado existente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="f86e3-223">Para esses tutoriais vamos usar instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="f86e3-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="f86e3-224">Consulte [Brian Noyes](http://briannoyes.net/)do artigo, [criar uma camada de acesso de dados com o Designer de conjunto de dados do Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) para obter um exemplo de como usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="f86e3-225">[![Consultar os dados usando uma instrução de SQL Ad Hoc](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)</span></span>

<span data-ttu-id="f86e3-226">**Figura 7**: consultar os dados usando uma instrução de SQL Ad Hoc ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image19.png))</span></span>


<span data-ttu-id="f86e3-227">Agora podemos pode digitar na consulta SQL manualmente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="f86e3-228">Ao criar o primeiro método no TableAdapter normalmente você deseja que a consulta retornar as colunas que precisam ser expressos em DataTable correspondente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="f86e3-229">Podemos pode fazer isso criando uma consulta que retorna todas as colunas e todas as linhas do `Products` tabela:</span><span class="sxs-lookup"><span data-stu-id="f86e3-229">We can accomplish this by creating a query that returns all columns and all rows from the `Products` table:</span></span>


<span data-ttu-id="f86e3-230">[![Insira a consulta SQL na caixa de texto](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)</span></span>

<span data-ttu-id="f86e3-231">**Figura 8**: insira o SQL consulta para a caixa de texto ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image22.png))</span></span>


<span data-ttu-id="f86e3-232">Como alternativa, use o construtor de consultas e graficamente construir a consulta, conforme mostrado na Figura 9.</span><span class="sxs-lookup"><span data-stu-id="f86e3-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="f86e3-233">[![Criar a consulta graficamente, por meio do Editor de consulta](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)</span></span>

<span data-ttu-id="f86e3-234">**Figura 9**: criar a consulta graficamente, por meio do Editor de consulta ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image25.png))</span></span>


<span data-ttu-id="f86e3-235">Depois de criar a consulta, mas antes de passar para a próxima tela, clique no botão Opções avançadas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="f86e3-236">Em projetos de Site da Web, o "Gerar Insert, Update e Delete instruções" é o único avançado opção selecionada por padrão. Se você executar esse assistente em uma biblioteca de classe ou um projeto do Windows também será selecionada a opção "Usar simultaneidade otimista".</span><span class="sxs-lookup"><span data-stu-id="f86e3-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="f86e3-237">Deixe a opção "Usar simultaneidade otimista" desmarcada por enquanto.</span><span class="sxs-lookup"><span data-stu-id="f86e3-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="f86e3-238">Vamos examinar a simultaneidade otimista em tutoriais futuros.</span><span class="sxs-lookup"><span data-stu-id="f86e3-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="f86e3-239">[![Selecione apenas as Generate Insert, Update e Delete instruções opção](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)</span></span>

<span data-ttu-id="f86e3-240">**Figura 10**: somente os Generate Insert, Update e Delete instruções Select opção ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image28.png))</span></span>


<span data-ttu-id="f86e3-241">Depois de verificar as opções avançadas, clique em Avançar para ir para a tela final.</span><span class="sxs-lookup"><span data-stu-id="f86e3-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="f86e3-242">Aqui, serão solicitados a selecionar quais métodos para adicionar ao TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="f86e3-243">Há dois padrões de preenchimento de dados:</span><span class="sxs-lookup"><span data-stu-id="f86e3-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="f86e3-244">**Preencher uma DataTable** com essa abordagem é criado um método que usa uma tabela de dados como um parâmetro e o preenche com base nos resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="f86e3-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="f86e3-245">A classe DataAdapter do ADO.NET, por exemplo, implementa esse padrão com suas `Fill()` método.</span><span class="sxs-lookup"><span data-stu-id="f86e3-245">The ADO.NET DataAdapter class, for example, implements this pattern with its `Fill()` method.</span></span>
- <span data-ttu-id="f86e3-246">**Retornar uma DataTable** com essa abordagem o método cria e preenche DataTable para você e o retorna como os métodos retornam um valor.</span><span class="sxs-lookup"><span data-stu-id="f86e3-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="f86e3-247">Você pode ter o TableAdapter implementar uma ou ambas desses padrões.</span><span class="sxs-lookup"><span data-stu-id="f86e3-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="f86e3-248">Você também pode renomear os métodos fornecidos aqui.</span><span class="sxs-lookup"><span data-stu-id="f86e3-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="f86e3-249">Vamos deixar ambas as caixas de seleção estiver marcadas, mesmo que apenas usaremos o último padrão durante esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="f86e3-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="f86e3-250">Além disso, vamos renomear em vez disso, genérico `GetData` método `GetProducts`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-250">Also, let's rename the rather generic `GetData` method to `GetProducts`.</span></span>

<span data-ttu-id="f86e3-251">Se marcada, a caixa de seleção final, "GenerateDBDirectMethods" cria `Insert()`, `Update()`, e `Delete()` métodos para o TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates `Insert()`, `Update()`, and `Delete()` methods for the TableAdapter.</span></span> <span data-ttu-id="f86e3-252">Se você deixar essa opção está desmarcada, todas as atualizações precisará ser feito por meio de único do TableAdapter `Update()` método, que obtém o conjunto de dados tipado, uma tabela de dados, um DataRow único ou uma matriz de DataRows.</span><span class="sxs-lookup"><span data-stu-id="f86e3-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole `Update()` method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="f86e3-253">(Caso você tenha desmarcado as "Gerar Insert, Update e Delete instruções" opção das propriedades avançadas na Figura 9, essa caixa de seleção configuração não terá efeito.) Vamos deixar essa caixa de seleção marcada.</span><span class="sxs-lookup"><span data-stu-id="f86e3-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="f86e3-254">[![Alterar o nome do método de GetData para GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)</span></span>

<span data-ttu-id="f86e3-255">**Figura 11**: alterar o nome do método de `GetData` para `GetProducts` ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-255">**Figure 11**: Change the Method Name from `GetData` to `GetProducts` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image31.png))</span></span>


<span data-ttu-id="f86e3-256">Conclua o assistente clicando em Concluir.</span><span class="sxs-lookup"><span data-stu-id="f86e3-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="f86e3-257">Depois de fechar o assistente, são retornados para o Designer de conjunto de dados que mostra a DataTable que acabamos de criar.</span><span class="sxs-lookup"><span data-stu-id="f86e3-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="f86e3-258">Você pode ver a lista de colunas no `Products` DataTable (`ProductID`, `ProductName`, e assim por diante), bem como os métodos do `ProductsTableAdapter` (`Fill()` e `GetProducts()`).</span><span class="sxs-lookup"><span data-stu-id="f86e3-258">You can see the list of columns in the `Products` DataTable (`ProductID`, `ProductName`, and so on), as well as the methods of the `ProductsTableAdapter` (`Fill()` and `GetProducts()`).</span></span>


<span data-ttu-id="f86e3-259">[![A DataTable de produtos e ProductsTableAdapter foram adicionados ao conjunto de dados tipado](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)</span></span>

<span data-ttu-id="f86e3-260">**Figura 12**: O `Products` DataTable e `ProductsTableAdapter` foram adicionados ao conjunto de dados tipado ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-260">**Figure 12**: The `Products` DataTable and `ProductsTableAdapter` have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image34.png))</span></span>


<span data-ttu-id="f86e3-261">Neste ponto, temos um conjunto de dados tipado com uma única tabela de dados (`Northwind.Products`) e uma classe de DataAdapter fortemente tipado (`NorthwindTableAdapters.ProductsTableAdapter`) com um `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="f86e3-261">At this point we have a Typed DataSet with a single DataTable (`Northwind.Products`) and a strongly-typed DataAdapter class (`NorthwindTableAdapters.ProductsTableAdapter`) with a `GetProducts()` method.</span></span> <span data-ttu-id="f86e3-262">Esses objetos podem ser usados para acessar uma lista de todos os produtos de código como:</span><span class="sxs-lookup"><span data-stu-id="f86e3-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

<span data-ttu-id="f86e3-263">Esse código não exige a escrever um pouco de código específico de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="f86e3-264">Não tínhamos instanciar as classes ADO.NET, não tinham para se referir a qualquer cadeia de caracteres de conexão, consultas SQL ou procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="f86e3-265">Em vez disso, o TableAdapter fornece o código de acesso a dados de baixo nível para nós.</span><span class="sxs-lookup"><span data-stu-id="f86e3-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="f86e3-266">Cada objeto usado neste exemplo também é fortemente tipada, permitindo que o Visual Studio fornecer o IntelliSense e a verificação de tipo de tempo de compilação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="f86e3-267">E o melhor de todos os as tabelas de dados retornadas pelo TableAdapter pode ser associados a dados ASP.NET controles da Web, como o GridView, DetailsView, DropDownList, CheckBoxList e vários outros.</span><span class="sxs-lookup"><span data-stu-id="f86e3-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="f86e3-268">O exemplo a seguir ilustra a associação DataTable retornada pelo `GetProducts()` método um GridView em apenas um exame três linhas de código dentro de `Page_Load` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-268">The following example illustrates binding the DataTable returned by the `GetProducts()` method to a GridView in just a scant three lines of code within the `Page_Load` event handler.</span></span>

<span data-ttu-id="f86e3-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="f86e3-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

<span data-ttu-id="f86e3-270">AllProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="f86e3-270">AllProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]


<span data-ttu-id="f86e3-271">[![A lista de produtos é exibida em um GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)</span></span>

<span data-ttu-id="f86e3-272">**Figura 13**: A lista de produtos é exibida em um controle GridView ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image37.png))</span></span>


<span data-ttu-id="f86e3-273">Embora este exemplo necessário escrevemos três linhas de código em nossa página de ASP.NET `Page_Load` manipulador de eventos, no futuro tutoriais, examinaremos como usar o ObjectDataSource para declarativamente recuperar os dados da DAL.</span><span class="sxs-lookup"><span data-stu-id="f86e3-273">While this example required that we write three lines of code in our ASP.NET page's `Page_Load` event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="f86e3-274">Com o ObjectDataSource é não terá que escrever nenhum código e obterá suporte de paginação e classificação também!</span><span class="sxs-lookup"><span data-stu-id="f86e3-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="f86e3-275">Etapa 3: Adicionando com parâmetros de métodos para a camada de acesso a dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="f86e3-276">Neste ponto nosso `ProductsTableAdapter` classe tem mas um método, `GetProducts()`, que retorna todos os produtos no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-276">At this point our `ProductsTableAdapter` class has but one method, `GetProducts()`, which returns all of the products in the database.</span></span> <span data-ttu-id="f86e3-277">Enquanto a capacidade trabalhar com todos os produtos é certamente útil, há tempos quando queremos recuperar informações sobre um produto específico ou todos os produtos que pertencem a uma categoria específica.</span><span class="sxs-lookup"><span data-stu-id="f86e3-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="f86e3-278">Para adicionar funcionalidade a nossa camada de acesso a dados, podemos adicionar métodos com parâmetros para o TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="f86e3-279">Vamos adicionar o `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="f86e3-279">Let's add the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="f86e3-280">Para adicionar um novo método para a DAL, retorne ao Designer de conjunto de dados, clique com botão direito no `ProductsTableAdapter` seção e escolha Adicionar consulta.</span><span class="sxs-lookup"><span data-stu-id="f86e3-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the `ProductsTableAdapter` section, and choose Add Query.</span></span>


![Clique com botão direito em TableAdapter e escolha Adicionar consulta](creating-a-data-access-layer-vb/_static/image38.png)

<span data-ttu-id="f86e3-282">**Figura 14**: com o botão direito em TableAdapter e escolha Adicionar consulta</span><span class="sxs-lookup"><span data-stu-id="f86e3-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="f86e3-283">Vamos primeiro serão perguntados se queremos acessar o banco de dados usando uma instrução de SQL ad hoc ou um procedimento armazenado existente ou novo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="f86e3-284">Vamos optar por usar uma instrução de SQL ad hoc novamente.</span><span class="sxs-lookup"><span data-stu-id="f86e3-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="f86e3-285">Em seguida, são perguntados que tipo de consulta SQL deseja usar.</span><span class="sxs-lookup"><span data-stu-id="f86e3-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="f86e3-286">Como queremos retornar todos os produtos que pertencem a uma categoria especificada, queremos gravar um `SELECT` instrução que retorna linhas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-286">Since we want to return all products that belong to a specified category, we want to write a `SELECT` statement which returns rows.</span></span>


<span data-ttu-id="f86e3-287">[![Escolher criar uma instrução SELECT que retorna linhas](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)</span></span>

<span data-ttu-id="f86e3-288">**Figura 15**: optar por criar um `SELECT` instrução que retorna linhas ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-288">**Figure 15**: Choose to Create a `SELECT` Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image41.png))</span></span>


<span data-ttu-id="f86e3-289">A próxima etapa é definir a consulta SQL usada para acessar os dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="f86e3-290">Como queremos retornar somente os produtos que pertencem a uma determinada categoria, posso usar o mesmo `SELECT` instrução do `GetProducts()`, mas adicione o seguinte `WHERE` cláusula: `WHERE CategoryID = @CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-290">Since we want to return only those products that belong to a particular category, I use the same `SELECT` statement from `GetProducts()`, but add the following `WHERE` clause: `WHERE CategoryID = @CategoryID`.</span></span> <span data-ttu-id="f86e3-291">O `@CategoryID` parâmetro indica ao Assistente do TableAdapter que o método que estamos criando exigirá um parâmetro de entrada do tipo correspondente (ou seja, um inteiro anulável).</span><span class="sxs-lookup"><span data-stu-id="f86e3-291">The `@CategoryID` parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="f86e3-292">[![Insira uma consulta para retornar somente os produtos em uma categoria especificada](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)</span></span>

<span data-ttu-id="f86e3-293">**Figura 16**: insira uma consulta para apenas produtos de retorno em uma categoria especificada ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image44.png))</span></span>


<span data-ttu-id="f86e3-294">Na etapa final que podemos escolher qual padrões para usar, bem como personalizar os nomes dos métodos gerados de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="f86e3-295">Para o padrão de preenchimento, vamos alterar o nome para `FillByCategoryID` e para retornar uma DataTable retornar padrão (o `GetX` métodos), vamos usar `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-295">For the Fill pattern, let's change the name to `FillByCategoryID` and for the return a DataTable return pattern (the `GetX` methods), let's use `GetProductsByCategoryID`.</span></span>


<span data-ttu-id="f86e3-296">[![Escolha os nomes para os métodos TableAdapter](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)</span></span>

<span data-ttu-id="f86e3-297">**Figura 17**: escolha os nomes para os métodos TableAdapter ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image47.png))</span></span>


<span data-ttu-id="f86e3-298">Depois de concluir o assistente, o Designer de conjunto de dados inclui os novos métodos do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Os produtos podem agora ser consultados por categoria](creating-a-data-access-layer-vb/_static/image48.png)

<span data-ttu-id="f86e3-300">**Figura 18**: os produtos podem agora ser consultados por categoria</span><span class="sxs-lookup"><span data-stu-id="f86e3-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="f86e3-301">Reserve um tempo para adicionar um `GetProductByProductID(productID)` método usando a mesma técnica.</span><span class="sxs-lookup"><span data-stu-id="f86e3-301">Take a moment to add a `GetProductByProductID(productID)` method using the same technique.</span></span>

<span data-ttu-id="f86e3-302">Essas consultas com parâmetros podem ser testadas diretamente no Designer de conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="f86e3-303">Com o botão direito no método em TableAdapter e escolha a visualização de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="f86e3-304">Em seguida, digite os valores para usar para os parâmetros e clique em Visualizar.</span><span class="sxs-lookup"><span data-stu-id="f86e3-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="f86e3-305">[![São mostrados os pertencentes de produtos para a categoria de bebidas](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)</span></span>

<span data-ttu-id="f86e3-306">**Figura 19**: os produtos que pertencem à categoria de bebidas são mostrados ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image51.png))</span></span>


<span data-ttu-id="f86e3-307">Com o `GetProductsByCategoryID(categoryID)` método nosso DAL, agora podemos criar uma página ASP.NET que exibe apenas os produtos em uma categoria especificada.</span><span class="sxs-lookup"><span data-stu-id="f86e3-307">With the `GetProductsByCategoryID(categoryID)` method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="f86e3-308">O exemplo a seguir mostra todos os produtos na categoria de bebidas, que têm um `CategoryID` de 1.</span><span class="sxs-lookup"><span data-stu-id="f86e3-308">The following example shows all products that are in the Beverages category, which have a `CategoryID` of 1.</span></span>

<span data-ttu-id="f86e3-309">Beverages.aspx</span><span class="sxs-lookup"><span data-stu-id="f86e3-309">Beverages.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

<span data-ttu-id="f86e3-310">Beverages.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="f86e3-310">Beverages.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]


<span data-ttu-id="f86e3-311">[![Os produtos na categoria de bebidas são exibidos](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)</span></span>

<span data-ttu-id="f86e3-312">**Figura 20**: os produtos na categoria de bebidas são exibidos ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="f86e3-313">Etapa 4: Inserir, atualizar e excluir dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="f86e3-314">Há dois padrões usados para inserir, atualizar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="f86e3-315">O padrão primeiro, o que vou chamá o padrão de banco de dados direta, envolve a criação de métodos que, quando chamado, problema um `INSERT`, `UPDATE`, ou `DELETE` comando no banco de dados que opera em um registro único banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an `INSERT`, `UPDATE`, or `DELETE` command to the database that operates on a single database record.</span></span> <span data-ttu-id="f86e3-316">Esses métodos normalmente são passados em uma série de valores escalares (inteiros, cadeias de caracteres, boolianos, DateTimes e assim por diante) que correspondem aos valores para inserir, atualizar ou excluir.</span><span class="sxs-lookup"><span data-stu-id="f86e3-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="f86e3-317">Por exemplo, com esse padrão para o `Products` tabela levaria o método delete em um parâmetro de número inteiro indicando o `ProductID` do registro a excluir, enquanto o método de inserção levaria em uma cadeia de caracteres para o `ProductName`, um decimal para o `UnitPrice`, um inteiro para o `UnitsOnStock`, e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f86e3-317">For example, with this pattern for the `Products` table the delete method would take in an integer parameter, indicating the `ProductID` of the record to delete, while the insert method would take in a string for the `ProductName`, a decimal for the `UnitPrice`, an integer for the `UnitsOnStock`, and so on.</span></span>


<span data-ttu-id="f86e3-318">[![Cada inserção, atualização e Excluir solicitação é enviada para o banco de dados imediatamente](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)</span></span>

<span data-ttu-id="f86e3-319">**Figura 21**: cada inserção, atualização e Excluir solicitação é enviada para o banco de dados imediatamente ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image57.png))</span></span>


<span data-ttu-id="f86e3-320">Padrão que será chamado de como o lote de atualização padrão, é para atualizar um conjunto de dados, DataTable ou coleção de DataRows na chamada de um método inteira.</span><span class="sxs-lookup"><span data-stu-id="f86e3-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="f86e3-321">Com esse padrão de um desenvolvedor exclui, insere, modifica DataRows em uma DataTable e, em seguida, passa esses DataRows ou DataTable em um método de atualização.</span><span class="sxs-lookup"><span data-stu-id="f86e3-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="f86e3-322">Esse método, em seguida, enumera o DataRows passado, determina se ou não eles já foram modificados, adicionados ou excluídos (por meio de DataRow [propriedade RowState](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) valor) e emite a solicitação de banco de dados apropriado para cada registro.</span><span class="sxs-lookup"><span data-stu-id="f86e3-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="f86e3-323">[![Todas as alterações são sincronizadas com o banco de dados quando o método de atualização é invocado](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)</span></span>

<span data-ttu-id="f86e3-324">**A Figura 22**: todas as alterações são sincronizadas com o banco de dados quando o método de atualização é invocado ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image60.png))</span></span>


<span data-ttu-id="f86e3-325">O TableAdapter usa o padrão de atualização em lotes por padrão, mas também suporta o padrão de direta do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="f86e3-326">Já que é selecionado a opção "Gerar Insert, Update e Delete instruções" das propriedades avançadas ao criar nossa TableAdapter o `ProductsTableAdapter` contém um `Update()` método, que implementa o padrão de atualização em lotes.</span><span class="sxs-lookup"><span data-stu-id="f86e3-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the `ProductsTableAdapter` contains an `Update()` method, which implements the batch update pattern.</span></span> <span data-ttu-id="f86e3-327">Especificamente, o TableAdapter contém um `Update()` método que pode ser passado do conjunto de dados tipado, uma DataTable fortemente tipado ou DataRows um ou mais.</span><span class="sxs-lookup"><span data-stu-id="f86e3-327">Specifically, the TableAdapter contains an `Update()` method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="f86e3-328">Se você deixar a caixa de seleção "GenerateDBDirectMethods" check ao criar pela primeira vez o TableAdapter o padrão direto do banco de dados será também implementada por meio de `Insert()`, `Update()`, e `Delete()` métodos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via `Insert()`, `Update()`, and `Delete()` methods.</span></span>

<span data-ttu-id="f86e3-329">Ambos os padrões de modificação de dados usam o TableAdapter `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades para emitir seus `INSERT`, `UPDATE`, e `DELETE` comandos no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-329">Both data modification patterns use the TableAdapter's `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties to issue their `INSERT`, `UPDATE`, and `DELETE` commands to the database.</span></span> <span data-ttu-id="f86e3-330">Você pode inspecionar e modificar o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades clicando no TableAdapter no Designer de conjunto de dados e, em seguida, vai para a janela de propriedades.</span><span class="sxs-lookup"><span data-stu-id="f86e3-330">You can inspect and modify the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="f86e3-331">(Verifique se você selecionou o TableAdapter e que o `ProductsTableAdapter` objeto é selecionado na lista suspensa na janela Propriedades.)</span><span class="sxs-lookup"><span data-stu-id="f86e3-331">(Make sure you have selected the TableAdapter, and that the `ProductsTableAdapter` object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="f86e3-332">[![O TableAdapter tem InsertCommand, UpdateCommand e DeleteCommand propriedades](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)</span></span>

<span data-ttu-id="f86e3-333">**Figura 23**: tem o TableAdapter `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-333">**Figure 23**: The TableAdapter has `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image63.png))</span></span>


<span data-ttu-id="f86e3-334">Para examinar ou modificar qualquer uma dessas propriedades de comando de banco de dados, clique no `CommandText` subpropriedade, o que abrirá o construtor de consultas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-334">To examine or modify any of these database command properties, click on the `CommandText` subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="f86e3-335">[![Configurar instruções DELETE, INSERT e UPDATE no construtor de consultas](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)</span></span>

<span data-ttu-id="f86e3-336">**Figura 24**: configurar o `INSERT`, `UPDATE`, e `DELETE` instruções no construtor de consultas ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-336">**Figure 24**: Configure the `INSERT`, `UPDATE`, and `DELETE` Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image66.png))</span></span>


<span data-ttu-id="f86e3-337">O exemplo de código a seguir mostra como usar o padrão de atualização em lotes para dobrar o preço de todos os produtos que não são interrompidas e que tem 25 unidades em estoque ou menos:</span><span class="sxs-lookup"><span data-stu-id="f86e3-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

<span data-ttu-id="f86e3-338">O código a seguir ilustra como usar o padrão de direta do banco de dados para programaticamente excluir um produto específico e, em seguida, atualizar um e, em seguida, adicione um novo:</span><span class="sxs-lookup"><span data-stu-id="f86e3-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="f86e3-339">Criando personalizado inserir, atualizar e excluir métodos</span><span class="sxs-lookup"><span data-stu-id="f86e3-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="f86e3-340">O `Insert()`, `Update()`, e `Delete()` métodos criados pelo método direto de banco de dados podem ser um pouco complexo, especialmente para tabelas com muitas colunas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-340">The `Insert()`, `Update()`, and `Delete()` methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="f86e3-341">Olhando para o exemplo de código anterior, sem IntelliSense ajuda não está particularmente claro qual `Products` mapeia a coluna de tabela para cada parâmetro de entrada para o `Update()` e `Insert()` métodos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what `Products` table column maps to each input parameter to the `Update()` and `Insert()` methods.</span></span> <span data-ttu-id="f86e3-342">Pode haver momentos em que estamos apenas deseja atualizar uma única coluna ou dois, se preferir, um personalizado `Insert()` método que será, talvez, retornar o valor do registro recém-inserido `IDENTITY` campo (incremento automático).</span><span class="sxs-lookup"><span data-stu-id="f86e3-342">There may be times when we only want to update a single column or two, or want a customized `Insert()` method that will, perhaps, return the value of the newly inserted record's `IDENTITY` (auto-increment) field.</span></span>

<span data-ttu-id="f86e3-343">Para criar esse método um personalizado, retorne para o Designer de conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="f86e3-344">Com o botão direito em TableAdapter e escolha Adicionar consulta, retornando ao Assistente do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="f86e3-345">Na segunda tela, pode indicar o tipo de consulta para criar.</span><span class="sxs-lookup"><span data-stu-id="f86e3-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="f86e3-346">Vamos criar um método que adiciona um novo produto e, em seguida, retorna o valor do registro adicionado recentemente `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-346">Let's create a method that adds a new product and then returns the value of the newly added record's `ProductID`.</span></span> <span data-ttu-id="f86e3-347">Portanto, optar por criar um `INSERT` consulta.</span><span class="sxs-lookup"><span data-stu-id="f86e3-347">Therefore, opt to create an `INSERT` query.</span></span>


<span data-ttu-id="f86e3-348">[![Criar um método para adicionar uma nova linha à tabela produtos](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)</span></span>

<span data-ttu-id="f86e3-349">**Figura 25**: criar um método para adicionar uma nova linha para o `Products` tabela ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-349">**Figure 25**: Create a Method to Add a New Row to the `Products` Table ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image69.png))</span></span>


<span data-ttu-id="f86e3-350">Na próxima tela de `InsertCommand`do `CommandText` é exibida.</span><span class="sxs-lookup"><span data-stu-id="f86e3-350">On the next screen the `InsertCommand`'s `CommandText` appears.</span></span> <span data-ttu-id="f86e3-351">Aumentar essa consulta adicionando `SELECT SCOPE_IDENTITY()` no final da consulta, que retorna o último valor de identidade inserido em um `IDENTITY` coluna no mesmo escopo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-351">Augment this query by adding `SELECT SCOPE_IDENTITY()` at the end of the query, which will return the last identity value inserted into an `IDENTITY` column in the same scope.</span></span> <span data-ttu-id="f86e3-352">(Consulte o [documentação técnica](https://msdn.microsoft.com/library/ms190315.aspx) para obter mais informações sobre `SCOPE_IDENTITY()` e por quê você provavelmente desejará [usar escopo\_IDENTITY() lieu de @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Certifique-se de que você encerrar o `INSERT` instrução com um ponto e vírgula antes de adicionar o `SELECT` instrução.</span><span class="sxs-lookup"><span data-stu-id="f86e3-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about `SCOPE_IDENTITY()` and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the `INSERT` statement with a semi-colon before adding the `SELECT` statement.</span></span>


<span data-ttu-id="f86e3-353">[![Ampliar a consulta para retornar o valor SCOPE_IDENTITY)](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)</span></span>

<span data-ttu-id="f86e3-354">**Figura 26**: ampliar a consulta para retornar o `SCOPE_IDENTITY()` valor ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-354">**Figure 26**: Augment the Query to Return the `SCOPE_IDENTITY()` Value ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image72.png))</span></span>


<span data-ttu-id="f86e3-355">Por fim, nomeie o novo método `InsertProduct`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-355">Finally, name the new method `InsertProduct`.</span></span>


<span data-ttu-id="f86e3-356">[![Defina o nome do novo método para InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)</span></span>

<span data-ttu-id="f86e3-357">**Figura 27**: definir o novo nome do método `InsertProduct` ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-357">**Figure 27**: Set the New Method Name to `InsertProduct` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image75.png))</span></span>


<span data-ttu-id="f86e3-358">Ao retornar para o Designer de conjunto de dados você verá que o `ProductsTableAdapter` contém um novo método, `InsertProduct`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-358">When you return to the DataSet Designer you'll see that the `ProductsTableAdapter` contains a new method, `InsertProduct`.</span></span> <span data-ttu-id="f86e3-359">Se esse novo método não tem um parâmetro para cada coluna a `Products` tabela, a probabilidade é você esqueceu de finalizar o `INSERT` instrução com um ponto e vírgula.</span><span class="sxs-lookup"><span data-stu-id="f86e3-359">If this new method doesn't have a parameter for each column in the `Products` table, chances are you forgot to terminate the `INSERT` statement with a semi-colon.</span></span> <span data-ttu-id="f86e3-360">Configurar o `InsertProduct` método e certifique-se de que você tem um ponto e vírgula de delimitação de `INSERT` e `SELECT` instruções.</span><span class="sxs-lookup"><span data-stu-id="f86e3-360">Configure the `InsertProduct` method and ensure you have a semi-colon delimiting the `INSERT` and `SELECT` statements.</span></span>

<span data-ttu-id="f86e3-361">Por padrão, insert métodos sem consulta de problema de métodos, que significa que elas retornam o número de linhas afetadas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="f86e3-362">No entanto, queremos o `InsertProduct` método para retornar o valor retornado pela consulta, não o número de linhas afetadas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-362">However, we want the `InsertProduct` method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="f86e3-363">Para fazer isso, ajustar o `InsertProduct` do método `ExecuteMode` propriedade `Scalar`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-363">To accomplish this, adjust the `InsertProduct` method's `ExecuteMode` property to `Scalar`.</span></span>


<span data-ttu-id="f86e3-364">[![Altere a propriedade ExecuteMode para escalar](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)</span></span>

<span data-ttu-id="f86e3-365">**Figura 28**: alteração de `ExecuteMode` propriedade `Scalar` ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-365">**Figure 28**: Change the `ExecuteMode` Property to `Scalar` ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image78.png))</span></span>


<span data-ttu-id="f86e3-366">O código a seguir mostra essa nova `InsertProduct` método em ação:</span><span class="sxs-lookup"><span data-stu-id="f86e3-366">The following code shows this new `InsertProduct` method in action:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="f86e3-367">Etapa 5: Concluir a camada de acesso a dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="f86e3-368">Observe que o `ProductsTableAdapters` classe retorna o `CategoryID` e `SupplierID` valores da `Products` de tabela, mas não inclui o `CategoryName` coluna a partir o `Categories` tabela ou o `CompanyName` coluna do `Suppliers` tabela, embora provavelmente são as colunas que desejamos exibir durante a exibição de informações do produto.</span><span class="sxs-lookup"><span data-stu-id="f86e3-368">Note that the `ProductsTableAdapters` class returns the `CategoryID` and `SupplierID` values from the `Products` table, but doesn't include the `CategoryName` column from the `Categories` table or the `CompanyName` column from the `Suppliers` table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="f86e3-369">É possível aumentar o método do TableAdapter inicial, `GetProducts()`, para incluir o `CategoryName` e `CompanyName` valores de coluna, que atualizarão o DataTable fortemente tipado para incluir as novas colunas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-369">We can augment the TableAdapter's initial method, `GetProducts()`, to include both the `CategoryName` and `CompanyName` column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="f86e3-370">Isso pode representar um problema, no entanto, como métodos do TableAdapter para inserir, atualizar, e excluir dados baseiam-se desse método inicial.</span><span class="sxs-lookup"><span data-stu-id="f86e3-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="f86e3-371">Felizmente, os métodos gerados automaticamente para inserir, atualizar e excluir não são afetados por subconsultas no `SELECT` cláusula.</span><span class="sxs-lookup"><span data-stu-id="f86e3-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the `SELECT` clause.</span></span> <span data-ttu-id="f86e3-372">Tomando cuidado para adicionar nossas consultas `Categories` e `Suppliers` como subconsultas, em vez de `JOIN` s, nós não terá que reformular esses métodos para modificar dados.</span><span class="sxs-lookup"><span data-stu-id="f86e3-372">By taking care to add our queries to `Categories` and `Suppliers` as subqueries, rather than `JOIN` s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="f86e3-373">Com o botão direito no `GetProducts()` método o `ProductsTableAdapter` e escolha Configure.</span><span class="sxs-lookup"><span data-stu-id="f86e3-373">Right-click on the `GetProducts()` method in the `ProductsTableAdapter` and choose Configure.</span></span> <span data-ttu-id="f86e3-374">Em seguida, ajuste o `SELECT` cláusula para que ele se parece como:</span><span class="sxs-lookup"><span data-stu-id="f86e3-374">Then, adjust the `SELECT` clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]


<span data-ttu-id="f86e3-375">[![Atualize a instrução SELECT para o método GetProducts()](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)</span></span>

<span data-ttu-id="f86e3-376">**Figura 29**: atualização de `SELECT` instrução para o `GetProducts()` método ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-376">**Figure 29**: Update the `SELECT` Statement for the `GetProducts()` Method ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image81.png))</span></span>


<span data-ttu-id="f86e3-377">Depois de atualizar o `GetProducts()` método para usar essa consulta nova DataTable inclui duas novas colunas: `CategoryName` e `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-377">After updating the `GetProducts()` method to use this new query the DataTable will include two new columns: `CategoryName` and `SupplierName`.</span></span>


![DataTable produtos tem duas novas colunas](creating-a-data-access-layer-vb/_static/image82.png)

<span data-ttu-id="f86e3-379">**Figura 30**: O `Products` DataTable tem duas novas colunas</span><span class="sxs-lookup"><span data-stu-id="f86e3-379">**Figure 30**: The `Products` DataTable has Two New Columns</span></span>


<span data-ttu-id="f86e3-380">Reserve um tempo para atualizar o `SELECT` cláusula de `GetProductsByCategoryID(categoryID)` método também.</span><span class="sxs-lookup"><span data-stu-id="f86e3-380">Take a moment to update the `SELECT` clause in the `GetProductsByCategoryID(categoryID)` method as well.</span></span>

<span data-ttu-id="f86e3-381">Se você atualizar o `GetProducts()` `SELECT` usando `JOIN` sintaxe o Designer de conjunto de dados não poderá gerar automaticamente os métodos de inserção, atualização, e direto de exclusão do banco de dados usando o banco de dados padrão.</span><span class="sxs-lookup"><span data-stu-id="f86e3-381">If you update the `GetProducts()` `SELECT` using `JOIN` syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="f86e3-382">Em vez disso, você precisará criar manualmente-los muito como fizemos com o `InsertProduct` método anteriormente neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="f86e3-382">Instead, you'll have to manually create them much like we did with the `InsertProduct` method earlier in this tutorial.</span></span> <span data-ttu-id="f86e3-383">Além disso, você manualmente precisa fornecer o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` valores de propriedade, se você quiser usar o lote padrão de atualização.</span><span class="sxs-lookup"><span data-stu-id="f86e3-383">Furthermore, you'll manually have to provide the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="f86e3-384">Adicionando os TableAdapters restantes</span><span class="sxs-lookup"><span data-stu-id="f86e3-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="f86e3-385">Até agora, vimos apenas trabalhando com um TableAdapter único para uma tabela de banco de dados único.</span><span class="sxs-lookup"><span data-stu-id="f86e3-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="f86e3-386">No entanto, o banco de dados Northwind contém várias tabelas relacionadas que vamos precisar trabalhar com nosso aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="f86e3-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="f86e3-387">Um conjunto de dados tipado pode conter vários DataTables relacionadas.</span><span class="sxs-lookup"><span data-stu-id="f86e3-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="f86e3-388">Portanto, para concluir nosso DAL que precisamos adicionar tabelas de dados para as outras tabelas que usaremos esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="f86e3-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="f86e3-389">Para adicionar um novo TableAdapter a um conjunto de dados tipado, abra o Designer de conjunto de dados, clique com botão direito no Designer e escolha Adicionar / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="f86e3-390">Isso criará uma nova DataTable e TableAdapter e orientá-lo por meio do assistente examinados anteriormente neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="f86e3-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="f86e3-391">Levar alguns minutos para criar os seguintes TableAdapters e métodos usando as consultas a seguir.</span><span class="sxs-lookup"><span data-stu-id="f86e3-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="f86e3-392">Observe que as consultas a `ProductsTableAdapter` incluem subconsultas para obter nomes de categoria e o fornecedor de cada produto.</span><span class="sxs-lookup"><span data-stu-id="f86e3-392">Note that the queries in the `ProductsTableAdapter` include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="f86e3-393">Além disso, se você estiver acompanhando, você já adicionou o `ProductsTableAdapter` da classe `GetProducts()` e `GetProductsByCategoryID(categoryID)` métodos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-393">Additionally, if you've been following along, you've already added the `ProductsTableAdapter` class's `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods.</span></span>

- <span data-ttu-id="f86e3-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="f86e3-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="f86e3-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
  - <span data-ttu-id="f86e3-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
  - <span data-ttu-id="f86e3-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
  - <span data-ttu-id="f86e3-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- <span data-ttu-id="f86e3-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="f86e3-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="f86e3-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
  - <span data-ttu-id="f86e3-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- <span data-ttu-id="f86e3-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="f86e3-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="f86e3-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
  - <span data-ttu-id="f86e3-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
  - <span data-ttu-id="f86e3-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- <span data-ttu-id="f86e3-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="f86e3-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="f86e3-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
  - <span data-ttu-id="f86e3-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
  - <span data-ttu-id="f86e3-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="f86e3-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]


<span data-ttu-id="f86e3-410">[![O Designer de conjunto de dados após terem sido adicionadas quatro TableAdapters](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)</span></span>

<span data-ttu-id="f86e3-411">**Figura 31**: O DataSet Designer após a quatro TableAdapters foram adicionados ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="f86e3-412">Adicionando código personalizado para a DAL</span><span class="sxs-lookup"><span data-stu-id="f86e3-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="f86e3-413">Os TableAdapters e DataTables adicionado ao conjunto de dados digitados são expressas como um arquivo de definição de esquema XML (`Northwind.xsd`).</span><span class="sxs-lookup"><span data-stu-id="f86e3-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (`Northwind.xsd`).</span></span> <span data-ttu-id="f86e3-414">Você pode exibir essas informações de esquema clicando no `Northwind.xsd` no Gerenciador de soluções e escolhendo o modo de exibição de código.</span><span class="sxs-lookup"><span data-stu-id="f86e3-414">You can view this schema information by right-clicking on the `Northwind.xsd` file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="f86e3-415">[![Conjunto de dados de tipo de arquivo XSD (definição) do esquema XML para a Northwind](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)</span></span>

<span data-ttu-id="f86e3-416">**A Figura 32**: A definição de esquema de XML (XSD) de arquivo para o conjunto de dados tipado Northwind ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image88.png))</span></span>


<span data-ttu-id="f86e3-417">Essas informações de esquema são convertidas em código c# ou Visual Basic em tempo de design, quando compilado ou em tempo de execução (se necessário), no ponto em que você possa percorrê-lo com o depurador.</span><span class="sxs-lookup"><span data-stu-id="f86e3-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="f86e3-418">Para exibir esse código gerado automaticamente vá para o modo de exibição de classe e detalhada para baixo para as classes do TableAdapter ou conjunto de dados tipado.</span><span class="sxs-lookup"><span data-stu-id="f86e3-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="f86e3-419">Se você não vir o modo de exibição de classe na tela, vá para o menu de exibição e selecioná-lo de lá ou ocorrências Ctrl + Shift + C.</span><span class="sxs-lookup"><span data-stu-id="f86e3-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="f86e3-420">A exibição de classe, você verá as propriedades, métodos e eventos das classes de conjunto de dados tipado e TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f86e3-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="f86e3-421">Para exibir o código para um método específico, clique duas vezes no nome do método no modo de exibição de classe ou com o botão direito nele e selecione Ir para definição.</span><span class="sxs-lookup"><span data-stu-id="f86e3-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Inspecione o código gerado automaticamente por selecionar Ir para a definição do modo de exibição de classe](creating-a-data-access-layer-vb/_static/image89.png)

<span data-ttu-id="f86e3-423">**Figura 33**: inspecionar o código gerado automaticamente por selecionar Ir para a definição do modo de exibição de classe</span><span class="sxs-lookup"><span data-stu-id="f86e3-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="f86e3-424">Enquanto o código gerado automaticamente pode ser uma economia de tempo, o código geralmente é muito genérico e precisa ser personalizado para atender às necessidades exclusivas de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f86e3-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="f86e3-425">O risco de estender o código gerado automaticamente, no entanto, é que a ferramenta que o código gerado pode decidir é hora de "regenerar" e substituir suas personalizações.</span><span class="sxs-lookup"><span data-stu-id="f86e3-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="f86e3-426">Com o novo conceito de classe parcial do .NET 2.0, é fácil dividir uma classe em vários arquivos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="f86e3-427">Isso nos permite adicionar nossa própria métodos, propriedades e eventos para as classes geradas automaticamente, sem precisar se preocupar sobre o Visual Studio, substituindo o nosso personalizações.</span><span class="sxs-lookup"><span data-stu-id="f86e3-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="f86e3-428">Para demonstrar como personalizar a DAL, vamos adicionar uma `GetProducts()` método para o `SuppliersRow` classe.</span><span class="sxs-lookup"><span data-stu-id="f86e3-428">To demonstrate how to customize the DAL, let's add a `GetProducts()` method to the `SuppliersRow` class.</span></span> <span data-ttu-id="f86e3-429">O `SuppliersRow` classe representa um único registro no `Suppliers` tabela; cada provedor de fornecedor pode zero para muitos produtos, portanto `GetProducts()` retornará os produtos do fornecedor especificado.</span><span class="sxs-lookup"><span data-stu-id="f86e3-429">The `SuppliersRow` class represents a single record in the `Suppliers` table; each supplier can provider zero to many products, so `GetProducts()` will return those products of the specified supplier.</span></span> <span data-ttu-id="f86e3-430">Para realizar isso cria um novo arquivo de classe no `App_Code` pasta denominada `SuppliersRow.vb` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="f86e3-430">To accomplish this create a new class file in the `App_Code` folder named `SuppliersRow.vb` and add the following code:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

<span data-ttu-id="f86e3-431">Essa classe parcial instrui o compilador que, quando criar o `Northwind.SuppliersRow` classe para incluir o `GetProducts()` método que acabamos de definir.</span><span class="sxs-lookup"><span data-stu-id="f86e3-431">This partial class instructs the compiler that when building the `Northwind.SuppliersRow` class to include the `GetProducts()` method we just defined.</span></span> <span data-ttu-id="f86e3-432">Se você compila o projeto e, em seguida, retorna ao modo de exibição de classe você verá `GetProducts()` agora listado como um método de `Northwind.SuppliersRow`.</span><span class="sxs-lookup"><span data-stu-id="f86e3-432">If you build your project and then return to the Class View you'll see `GetProducts()` now listed as a method of `Northwind.SuppliersRow`.</span></span>


![O método GetProducts() é agora parte da classe Northwind.SuppliersRow](creating-a-data-access-layer-vb/_static/image90.png)

<span data-ttu-id="f86e3-434">**A Figura 34**: O `GetProducts()` método é agora parte do `Northwind.SuppliersRow` classe</span><span class="sxs-lookup"><span data-stu-id="f86e3-434">**Figure 34**: The `GetProducts()` Method is Now Part of the `Northwind.SuppliersRow` Class</span></span>


<span data-ttu-id="f86e3-435">O `GetProducts()` método agora pode ser usado para enumerar o conjunto de produtos para um fornecedor específico, como mostra o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="f86e3-435">The `GetProducts()` method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

<span data-ttu-id="f86e3-436">Esses dados também podem ser exibidos em qualquer uma das ASP. Controles da Web de dados do NET.</span><span class="sxs-lookup"><span data-stu-id="f86e3-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="f86e3-437">A página a seguir usa um controle GridView com dois campos:</span><span class="sxs-lookup"><span data-stu-id="f86e3-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="f86e3-438">Um BoundField que exibe o nome de cada fornecedor e</span><span class="sxs-lookup"><span data-stu-id="f86e3-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="f86e3-439">Um TemplateField que contém um controle BulletedList que está associado aos resultados retornados pelo `GetProducts()` método para cada fornecedor.</span><span class="sxs-lookup"><span data-stu-id="f86e3-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the `GetProducts()` method for each supplier.</span></span>

<span data-ttu-id="f86e3-440">Vamos examinar como exibir esses relatórios de detalhes mestre em tutoriais futuros.</span><span class="sxs-lookup"><span data-stu-id="f86e3-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="f86e3-441">Por enquanto, este exemplo é projetado para ilustrar usando o método personalizado adicionado para o `Northwind.SuppliersRow` classe.</span><span class="sxs-lookup"><span data-stu-id="f86e3-441">For now, this example is designed to illustrate using the custom method added to the `Northwind.SuppliersRow` class.</span></span>

<span data-ttu-id="f86e3-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="f86e3-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

<span data-ttu-id="f86e3-443">SuppliersAndProducts.aspx.vb</span><span class="sxs-lookup"><span data-stu-id="f86e3-443">SuppliersAndProducts.aspx.vb</span></span>

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]


<span data-ttu-id="f86e3-444">[![Nome da empresa do fornecedor é listado na coluna esquerda, seus produtos no canto direito](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="f86e3-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)</span></span>

<span data-ttu-id="f86e3-445">**Figura 35**: o nome do fornecedor a empresa está listado na coluna esquerda, seus produtos no canto direito ([clique para exibir a imagem em tamanho normal](creating-a-data-access-layer-vb/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="f86e3-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-vb/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="f86e3-446">Resumo</span><span class="sxs-lookup"><span data-stu-id="f86e3-446">Summary</span></span>

<span data-ttu-id="f86e3-447">Quando criar um aplicativo da web criando DAL deve ser uma de suas primeiras etapas, antes de começar a criar sua camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f86e3-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="f86e3-448">Com o Visual Studio, criar uma DAL baseada em conjuntos de dados tipado é uma tarefa que pode ser realizada em 10 a 15 minutos sem escrever uma linha de código.</span><span class="sxs-lookup"><span data-stu-id="f86e3-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="f86e3-449">Os tutoriais são encaminhados se baseará este DAL.</span><span class="sxs-lookup"><span data-stu-id="f86e3-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="f86e3-450">No [tutorial próxima](creating-a-business-logic-layer-vb.md) vamos definir uma série de regras de negócio e veja como implementá-los em uma camada de lógica de negócios separada.</span><span class="sxs-lookup"><span data-stu-id="f86e3-450">In the [next tutorial](creating-a-business-logic-layer-vb.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="f86e3-451">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="f86e3-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="f86e3-452">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="f86e3-452">Further Reading</span></span>

<span data-ttu-id="f86e3-453">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="f86e3-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f86e3-454">Criando uma DAL usando TableAdapters fortemente tipado e DataTables no VS 2005 e o ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="f86e3-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="f86e3-455">Criando componentes de camada de dados e transmissão de dados por meio de camadas</span><span class="sxs-lookup"><span data-stu-id="f86e3-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="f86e3-456">Criar uma camada de acesso de dados com o Designer de conjunto de dados do Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="f86e3-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="f86e3-457">Criptografando informações de configuração no ASP.NET 2.0 aplicativos</span><span class="sxs-lookup"><span data-stu-id="f86e3-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="f86e3-458">Visão geral de TableAdapter</span><span class="sxs-lookup"><span data-stu-id="f86e3-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="f86e3-459">Trabalhando com um conjunto de dados tipado</span><span class="sxs-lookup"><span data-stu-id="f86e3-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="f86e3-460">Acesso a dados fortemente tipado no Visual Studio 2005 e o ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="f86e3-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="f86e3-461">Como estender os métodos TableAdapter</span><span class="sxs-lookup"><span data-stu-id="f86e3-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="f86e3-462">Recuperação de dados escalar de um procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="f86e3-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="f86e3-463">Treinamento em vídeo sobre tópicos contidos neste tutorial</span><span class="sxs-lookup"><span data-stu-id="f86e3-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="f86e3-464">Camadas de Acesso a Dados em aplicativos do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f86e3-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="f86e3-465">Como associar um conjunto de dados manualmente para uma grade de dados</span><span class="sxs-lookup"><span data-stu-id="f86e3-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="f86e3-466">Como trabalhar com conjuntos de dados e os filtros de um aplicativo ASP</span><span class="sxs-lookup"><span data-stu-id="f86e3-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="f86e3-467">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="f86e3-467">About the Author</span></span>

<span data-ttu-id="f86e3-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="f86e3-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f86e3-469">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="f86e3-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f86e3-470">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f86e3-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f86e3-471">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f86e3-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f86e3-472">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="f86e3-472">Special Thanks To</span></span>

<span data-ttu-id="f86e3-473">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="f86e3-473">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f86e3-474">Revisores levar para este tutorial foram Ron Green, Giesenow Hilton, Dennis Patterson, Liz Shulok, Abel Gomez e Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="f86e3-474">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="f86e3-475">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="f86e3-475">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f86e3-476">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f86e3-476">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f86e3-477">[Anterior](master-pages-and-site-navigation-cs.md)
> [Próximo](creating-a-business-logic-layer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f86e3-477">[Previous](master-pages-and-site-navigation-cs.md)
[Next](creating-a-business-logic-layer-vb.md)</span></span>
