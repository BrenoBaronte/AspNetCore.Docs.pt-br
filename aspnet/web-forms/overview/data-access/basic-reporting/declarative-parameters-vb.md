---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Parâmetros declarativos (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, isso será mostrado como usar um parâmetro definido como um valor embutido para selecionar os dados a serem exibidos em um controle DetailsView.
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: 933b7276c6dac5cce0e278fd23ff010c5b4a6fdd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="declarative-parameters-vb"></a><span data-ttu-id="dc053-103">Parâmetros declarativos (VB)</span><span class="sxs-lookup"><span data-stu-id="dc053-103">Declarative Parameters (VB)</span></span>
====================
<span data-ttu-id="dc053-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dc053-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dc053-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) ou [baixar PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dc053-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="dc053-106">Neste tutorial, isso será mostrado como usar um parâmetro definido como um valor embutido para selecionar os dados a serem exibidos em um controle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="dc053-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="dc053-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="dc053-107">Introduction</span></span>

<span data-ttu-id="dc053-108">No [tutorial última](displaying-data-with-the-objectdatasource-vb.md) examinamos exibindo dados com os controles GridView, DetailsView e FormView associados a um controle ObjectDataSource que invocou o `GetProducts()` método do `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="dc053-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="dc053-109">O `GetProducts()` método retorna um DataTable fortemente tipada preenchido com todos os registros do banco de dados Northwind `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="dc053-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="dc053-110">O `ProductsBLL` classe contém métodos adicionais para retornar subconjuntos apenas dos produtos - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, e `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="dc053-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="dc053-111">Esses três métodos esperam um parâmetro de entrada que indica como filtrar as informações de produto retornado.</span><span class="sxs-lookup"><span data-stu-id="dc053-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="dc053-112">ObjectDataSource pode ser usado para invocar métodos que esperam parâmetros de entrada, mas para isso é necessário especificar onde vêm os valores para esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="dc053-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="dc053-113">Os valores de parâmetro pode ser embutido ou podem vir de uma variedade de fontes dinâmicos, incluindo: querystring valores, variáveis de sessão, o valor da propriedade de um controle da Web na página ou outras pessoas.</span><span class="sxs-lookup"><span data-stu-id="dc053-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="dc053-114">Para este tutorial vamos começar que ilustram como usar um parâmetro definido como um valor embutido.</span><span class="sxs-lookup"><span data-stu-id="dc053-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="dc053-115">Especificamente, examinaremos adicionando um DetailsView para a página que exibe informações sobre um produto específico, ou seja, do chefe Anton mistura para Gumbo, que tem um `ProductID` de 5.</span><span class="sxs-lookup"><span data-stu-id="dc053-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="dc053-116">Em seguida, veremos como definir o valor do parâmetro com base em um controle da Web.</span><span class="sxs-lookup"><span data-stu-id="dc053-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="dc053-117">Em particular, vamos usar uma caixa de texto para permitir que o usuário digite em um país, após o qual ele podem clicar em um botão para ver a lista de fornecedores que residem no país.</span><span class="sxs-lookup"><span data-stu-id="dc053-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="dc053-118">Usando um valor de parâmetro embutido</span><span class="sxs-lookup"><span data-stu-id="dc053-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="dc053-119">No primeiro exemplo, comece adicionando um controle DetailsView para o `DeclarativeParams.aspx` página o `BasicReporting` pasta.</span><span class="sxs-lookup"><span data-stu-id="dc053-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="dc053-120">Na marca inteligente de DetailsView selecione &lt;nova fonte de dados&gt; na lista suspensa lista e adicione um ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="dc053-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>


<span data-ttu-id="dc053-121">[![Adicione um ObjectDataSource à página](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="dc053-122">**Figura 1**: adicionar um ObjectDataSource para a página ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>


<span data-ttu-id="dc053-123">Isso iniciará o Assistente de escolher fonte de dados do controle ObjectDataSource automaticamente.</span><span class="sxs-lookup"><span data-stu-id="dc053-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="dc053-124">Selecione o `ProductsBLL` classe na primeira tela do assistente.</span><span class="sxs-lookup"><span data-stu-id="dc053-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>


<span data-ttu-id="dc053-125">[![Selecione a classe ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="dc053-126">**Figura 2**: selecione o `ProductsBLL` classe ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>


<span data-ttu-id="dc053-127">Desde que você deseja exibir informações sobre um produto específico, desejamos usar o `GetProductByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="dc053-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="dc053-128">[![Escolha o método GetProductByProductID(productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="dc053-129">**Figura 3**: escolha o `GetProductByProductID(productID)` método ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>


<span data-ttu-id="dc053-130">Como o método selecionamos inclui um parâmetro, há uma tela de mais para que o assistente, em que são solicitados para definir o valor a ser usado para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="dc053-131">A lista à esquerda mostra todos os parâmetros para o método selecionado.</span><span class="sxs-lookup"><span data-stu-id="dc053-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="dc053-132">Para `GetProductByProductID(productID)` há apenas um `productID`.</span><span class="sxs-lookup"><span data-stu-id="dc053-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="dc053-133">À direita, podemos especificar o valor do parâmetro selecionado.</span><span class="sxs-lookup"><span data-stu-id="dc053-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="dc053-134">Lista de lista suspensa de parâmetros origem enumera várias fontes possíveis para o valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="dc053-135">Como queremos especificar um valor embutido de 5 para o `productID` parâmetro, deixar a fonte de parâmetro como None e digite 5 na caixa de texto valor padrão.</span><span class="sxs-lookup"><span data-stu-id="dc053-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>


<span data-ttu-id="dc053-136">[![Um Hard-Coded parâmetro de valor de 5 será usado para o parâmetro productID](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="dc053-137">**Figura 4**: A Hard-Coded parâmetro de valor de 5 será usado para o `productID` parâmetro ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>


<span data-ttu-id="dc053-138">Depois de concluir o Assistente Configurar fonte de dados, declarativo do controle ObjectDataSource inclui um `Parameter` objeto o `SelectParameters` coleção para cada um dos parâmetros de entrada esperados pelo método definido no `SelectMethod` propriedade.</span><span class="sxs-lookup"><span data-stu-id="dc053-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="dc053-139">Como o método que estamos usando neste exemplo espera apenas um único parâmetro de entrada, `parameterID`, há apenas uma entrada aqui.</span><span class="sxs-lookup"><span data-stu-id="dc053-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="dc053-140">O `SelectParameters` coleção pode conter qualquer classe que deriva de `Parameter` classe no `System.Web.UI.WebControls` namespace.</span><span class="sxs-lookup"><span data-stu-id="dc053-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="dc053-141">Para a base de valores de parâmetro embutido `Parameter` classe é usada, mas para o outro parâmetro fonte opções um derivado `Parameter` classe é usada, você também pode criar seus próprios [tipos de parâmetro personalizado](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), se necessário.</span><span class="sxs-lookup"><span data-stu-id="dc053-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="dc053-142">Se você estiver acompanhando em seu próprio computador a marcação declarativa você ver neste momento pode incluir valores para o `InsertMethod`, `UpdateMethod`, e `DeleteMethod` propriedades, bem como `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="dc053-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="dc053-143">Assistente de escolher fonte de dados do ObjectDataSource Especifica os métodos de automaticamente o `ProductBLL` a ser usado para inserir, atualizar e excluir, portanto, a menos que explicitamente desmarcada aqueles out, serão incluídos na marcação acima.</span><span class="sxs-lookup"><span data-stu-id="dc053-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>


<span data-ttu-id="dc053-144">Ao visitar essa página, os dados de controle da Web invocará o ObjectDataSource `Select` método, que chamará o `ProductsBLL` da classe `GetProductByProductID(productID)` método usando o valor inserido no código de 5 para o `productID` parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="dc053-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="dc053-145">O método retornará fortemente tipado `ProductDataTable` objeto que contém uma única linha com informações sobre a mistura de para Gumbo do chefe Anton (o produto com `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="dc053-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>


<span data-ttu-id="dc053-146">[![Para Gumbo mistura informações sobre do chefe Anton são exibidos](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="dc053-147">**Figura 5**: para Gumbo mistura informações sobre do chefe Anton são exibidas ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>


## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="dc053-148">Definir o valor de parâmetro para o valor da propriedade de um controle de Web</span><span class="sxs-lookup"><span data-stu-id="dc053-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="dc053-149">Parâmetro do ObjectDataSource valores também podem ser definidos com base no valor de um controle da Web na página.</span><span class="sxs-lookup"><span data-stu-id="dc053-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="dc053-150">Para ilustrar isso, vamos dar um GridView que lista todos os fornecedores que estão localizados em um país especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="dc053-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="dc053-151">Para fazer isso, inicie com a adição de uma caixa de texto para a página na qual o usuário pode inserir um nome de país.</span><span class="sxs-lookup"><span data-stu-id="dc053-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="dc053-152">Defina esse controle de caixa de texto `ID` propriedade `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="dc053-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="dc053-153">Também adicione um controle de botão de Web.</span><span class="sxs-lookup"><span data-stu-id="dc053-153">Also add a Button Web control.</span></span>


<span data-ttu-id="dc053-154">[![Adicionar uma caixa de texto para a página com ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="dc053-155">**Figura 6**: adicionar uma caixa de texto para a página com `ID` `CountryName` ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>


<span data-ttu-id="dc053-156">Em seguida, adicionar um controle GridView à página e, na marca inteligente, escolha Adicionar um novo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="dc053-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="dc053-157">Como desejamos exibir select de informações do fornecedor a `SuppliersBLL` classe da tela de primeiro do assistente.</span><span class="sxs-lookup"><span data-stu-id="dc053-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="dc053-158">Na segunda tela, escolha o `GetSuppliersByCountry(country)` método.</span><span class="sxs-lookup"><span data-stu-id="dc053-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>


<span data-ttu-id="dc053-159">[![Escolha o método GetSuppliersByCountry(country)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="dc053-160">**Figura 7**: escolha o `GetSuppliersByCountry(country)` método ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>


<span data-ttu-id="dc053-161">Desde o `GetSuppliersByCountry(country)` método tem um parâmetro de entrada, o assistente novamente inclui uma tela final para escolher o valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="dc053-162">Neste momento, defina a origem do parâmetro de controle.</span><span class="sxs-lookup"><span data-stu-id="dc053-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="dc053-163">Isso preencherá lista suspensa ControlID com os nomes dos controles da página. Selecione o `CountryName` controle da lista.</span><span class="sxs-lookup"><span data-stu-id="dc053-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="dc053-164">Quando a página for visitada primeiro o `CountryName` caixa de texto estará em branco, portanto, nenhum resultado será retornado e nada é exibido.</span><span class="sxs-lookup"><span data-stu-id="dc053-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="dc053-165">Se você deseja exibir alguns resultados por padrão, definido adequadamente a caixa de texto do valor padrão.</span><span class="sxs-lookup"><span data-stu-id="dc053-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>


<span data-ttu-id="dc053-166">[![Defina o valor de parâmetro para o valor do controle CountryName](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="dc053-167">**Figura 8**: definir o valor do parâmetro o `CountryName` valor de controle ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>


<span data-ttu-id="dc053-168">Marcação declarativa do ObjectDataSource difere ligeiramente do nosso primeiro exemplo, usando um [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) em vez do padrão `Parameter` objeto.</span><span class="sxs-lookup"><span data-stu-id="dc053-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="dc053-169">Um `ControlParameter` tem propriedades adicionais para especificar o `ID` do controle da Web e o valor da propriedade a ser usado para o parâmetro (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="dc053-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="dc053-170">O Assistente Configurar fonte de dados foi inteligente para determinar que, para uma caixa de texto, provavelmente desejará usar o `Text` propriedade para o valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="dc053-171">Se, no entanto, você quiser usar um valor de outra propriedade do controle da Web que você pode alterar o `PropertyName` valor aqui ou clicando no link "Mostrar as propriedades avançadas" no assistente.</span><span class="sxs-lookup"><span data-stu-id="dc053-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="dc053-172">Ao visitar a página pela primeira vez o `CountryName` caixa de texto está vazia.</span><span class="sxs-lookup"><span data-stu-id="dc053-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="dc053-173">O ObjectDataSource `Select` método ainda é invocado por GridView, mas um valor de `Nothing` é passado para o `GetSuppliersByCountry(country)` método.</span><span class="sxs-lookup"><span data-stu-id="dc053-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="dc053-174">Converte o TableAdapter o `Nothing` em um banco de dados `NULL` valor (`DBNull.Value`), mas a consulta usada pelo `GetSuppliersByCountry(country)` método é gravada, de modo que ele não retorna qualquer valores quando um `NULL` valor for especificado para o `@CategoryID`parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="dc053-175">Em resumo, nenhum fornecedores são retornados.</span><span class="sxs-lookup"><span data-stu-id="dc053-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="dc053-176">Depois que o visitante entra em um país, no entanto e clicar no botão Mostrar fornecedores para causar um postback, ObjectDataSource `Select` método é novamente consultado, passando o controle de caixa de texto `Text` valor como o `country` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dc053-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>


<span data-ttu-id="dc053-177">[![São mostrados os fornecedores do Canadá](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="dc053-178">**Figura 9**: os fornecedores do Canadá são mostrados ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>


## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="dc053-179">Mostrando todos os fornecedores por padrão</span><span class="sxs-lookup"><span data-stu-id="dc053-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="dc053-180">Em vez de mostrar nenhum dos fornecedores ao primeiro exibir a página pode queremos Mostrar *todos os* fornecedores primeiro, permitindo que o usuário reduzir a lista, digitando um nome de país na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="dc053-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="dc053-181">Quando a caixa de texto estiver vazia, o `SuppliersBLL` da classe `GetSuppliersByCountry(country)` método é passado `Nothing` para seus *`country`* parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="dc053-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="dc053-182">Isso `Nothing` valor, em seguida, é passado para a DAL `GetSupplierByCountry(country)` método, onde ele é convertido em um banco de dados `NULL` valor para o `@Country` parâmetro na consulta a seguir:</span><span class="sxs-lookup"><span data-stu-id="dc053-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="dc053-183">A expressão `Country = NULL` sempre retorna falso, mesmo para os registros cujo `Country` coluna tem um `NULL` valor; portanto, nenhum registro será retornado.</span><span class="sxs-lookup"><span data-stu-id="dc053-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="dc053-184">Para retornar *todos os* fornecedores quando o caixa de texto de país está vazio, pode aumentar a `GetSuppliersByCountry(country)` método na BLL para invocar o `GetSuppliers()` método quando seu parâmetro país é `Nothing` e chamar a DAL `GetSuppliersByCountry(country)` método caso contrário.</span><span class="sxs-lookup"><span data-stu-id="dc053-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="dc053-185">Isso terá o efeito de retornar o subconjunto apropriado de fornecedores e de todos os fornecedores quando nenhum é especificado quando o parâmetro country é incluído.</span><span class="sxs-lookup"><span data-stu-id="dc053-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="dc053-186">Alterar o `GetSuppliersByCountry(country)` método o `SuppliersBLL` classe para o seguinte:</span><span class="sxs-lookup"><span data-stu-id="dc053-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="dc053-187">Com essa alteração de `DeclarativeParams.aspx` página mostra todos os fornecedores quando visitado primeiro (ou sempre que o `CountryName` caixa de texto está vazia).</span><span class="sxs-lookup"><span data-stu-id="dc053-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>


<span data-ttu-id="dc053-188">[![Todos os fornecedores são agora são mostradas por padrão](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="dc053-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="dc053-189">**Figura 10**: todos os fornecedores são agora é mostrada por padrão ([clique para exibir a imagem em tamanho normal](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="dc053-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="dc053-190">Resumo</span><span class="sxs-lookup"><span data-stu-id="dc053-190">Summary</span></span>

<span data-ttu-id="dc053-191">Para usar métodos com parâmetros de entrada, é necessário especificar os valores para os parâmetros no ObjectDataSource `SelectParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="dc053-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="dc053-192">Permitir que diferentes tipos de parâmetros para o valor do parâmetro ser obtidos de fontes diferentes.</span><span class="sxs-lookup"><span data-stu-id="dc053-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="dc053-193">O tipo de parâmetro padrão usa um valor embutido, mas apenas como facilmente (e sem uma linha de código) valores de parâmetro podem ser obtidos o querystring, variáveis de sessão, cookies e valores mesmo inseridos pelo usuário dos controles da Web na página.</span><span class="sxs-lookup"><span data-stu-id="dc053-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="dc053-194">Os exemplos que observamos neste tutorial ilustrado como usar valores de parâmetro declarativa.</span><span class="sxs-lookup"><span data-stu-id="dc053-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="dc053-195">No entanto, pode haver ocasiões em que precisamos usar uma fonte de parâmetro que não está disponível, como a data e hora atuais ou, se nosso site estava usando a associação, a ID de usuário do visitante.</span><span class="sxs-lookup"><span data-stu-id="dc053-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="dc053-196">Para esses cenários podemos definir os valores de parâmetro programaticamente antes do ObjectDataSource invocar o método do seu objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="dc053-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="dc053-197">Veremos como fazer isso no [tutorial próximo](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span><span class="sxs-lookup"><span data-stu-id="dc053-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="dc053-198">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="dc053-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dc053-199">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="dc053-199">About the Author</span></span>

<span data-ttu-id="dc053-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="dc053-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dc053-201">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="dc053-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dc053-202">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="dc053-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dc053-203">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="dc053-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dc053-204">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="dc053-204">Special Thanks To</span></span>

<span data-ttu-id="dc053-205">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="dc053-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dc053-206">Revisor levar para este tutorial foi Giesenow Hilton.</span><span class="sxs-lookup"><span data-stu-id="dc053-206">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="dc053-207">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="dc053-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dc053-208">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dc053-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dc053-209">[Anterior](displaying-data-with-the-objectdatasource-vb.md)
> [Próximo](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="dc053-209">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
