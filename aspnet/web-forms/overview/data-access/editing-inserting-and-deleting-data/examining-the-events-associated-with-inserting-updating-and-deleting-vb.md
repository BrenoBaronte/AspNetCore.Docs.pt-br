---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Examinando os eventos associados inserindo, atualizando e excluindo (VB) | Microsoft Docs
author: rick-anderson
description: "Neste tutorial, examinaremos usando os eventos que ocorrem antes, durante e após uma inserção, atualização ou exclusão de operação de um controle da Web de dados do ASP.NET. W..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 88f6beb3f3514c6a9784d4cb936a5b779ce75ae1
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/24/2018
---
<a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="6d1f2-104">Examinando os eventos associados ao inserindo, atualizando e excluindo (VB)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>
====================
<span data-ttu-id="6d1f2-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6d1f2-106">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) ou [baixar PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="6d1f2-107">Neste tutorial, examinaremos usando os eventos que ocorrem antes, durante e após uma inserção, atualização ou exclusão de operação de um controle da Web de dados do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="6d1f2-108">Também veremos como personalizar a interface de edição para atualizar apenas um subconjunto dos campos do produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>


## <a name="introduction"></a><span data-ttu-id="6d1f2-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="6d1f2-109">Introduction</span></span>

<span data-ttu-id="6d1f2-110">Ao usar a inserção internas, editar ou excluir recursos de controles GridView, DetailsView ou FormView, várias etapas ocorrer quando o usuário final conclui o processo de adicionar um novo registro ou atualizar ou excluir um registro existente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="6d1f2-111">Conforme abordado no [tutorial anterior](an-overview-of-inserting-updating-and-deleting-data-vb.md), quando uma linha é editada em GridView no botão de edição é substituído por botões Cancelar e de atualização e a ativar BoundFields em caixas de texto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="6d1f2-112">Depois que o usuário final atualiza os dados e clica em atualizar, as etapas a seguir são executadas em um postback:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="6d1f2-113">GridView preenche seu ObjectDataSource `UpdateParameters` com campos de identificação exclusivo do Registro editado (por meio de `DataKeyNames` propriedade) junto com os valores inseridos pelo usuário</span><span class="sxs-lookup"><span data-stu-id="6d1f2-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="6d1f2-114">GridView invoca seu ObjectDataSource `Update()` método, que por sua vez chama o método apropriado no objeto subjacente (`ProductsDAL.UpdateProduct`, em nosso tutorial anterior)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="6d1f2-115">Os dados subjacentes, que agora incluem as alterações atualizadas, é vinculada outra vez a GridView</span><span class="sxs-lookup"><span data-stu-id="6d1f2-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="6d1f2-116">Durante essa sequência de etapas, um número de eventos acionados, permitindo a criação de manipuladores de eventos para adicionar lógica personalizada quando for necessário.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="6d1f2-117">Por exemplo, antes do etapa 1, GridView `RowUpdating` evento ser acionado.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="6d1f2-118">Neste ponto, podemos pode, cancelar a solicitação de atualização se houver algum erro de validação.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="6d1f2-119">Quando o `Update()` método é chamado, o ObjectDataSource `Updating` evento ser acionado, fornecendo uma oportunidade de adicionar ou personalize os valores de qualquer um do `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="6d1f2-120">Depois que o ObjectDataSource a base do método do objeto completou a execução, o ObjectDataSource `Updated` é gerado.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="6d1f2-121">Um manipulador de eventos para o `Updated` evento pode inspecionar os detalhes sobre a operação de atualização, como quantas linhas foram afetadas e se ocorreu uma exceção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="6d1f2-122">Por fim, após a do etapa 2, GridView `RowUpdated` evento ser acionado; um manipulador de eventos para esse evento pode examinar informações adicionais sobre a operação de atualização apenas executadas.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="6d1f2-123">A Figura 1 mostra esta série de eventos e etapas ao atualizar um GridView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="6d1f2-124">O padrão de evento na Figura 1 não é exclusivo para a atualização com um controle GridView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="6d1f2-125">Inserindo, atualizando ou excluindo dados de GridView, DetailsView ou FormView precipitates a mesma sequência de eventos de pré e pós-níveis para o controle de dados Web e ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>


<span data-ttu-id="6d1f2-126">[![Uma série de pré e pós-eventos acionados quando a atualização de dados em um controle GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="6d1f2-127">**Figura 1**: uma série de pré e pós-eventos acionados quando atualizando dados em um controle GridView ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>


<span data-ttu-id="6d1f2-128">Neste tutorial, que examinaremos usando esses eventos para estender o internos inserindo, atualizando e excluindo recursos dos dados ASP.NET controles da Web.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="6d1f2-129">Também veremos como personalizar a interface de edição para atualizar apenas um subconjunto dos campos do produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="6d1f2-130">Etapa 1: Atualizar um produto`ProductName`e`UnitPrice`campos</span><span class="sxs-lookup"><span data-stu-id="6d1f2-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="6d1f2-131">As interfaces de edição do tutorial anterior *todos os* campos de produto que não eram somente leitura tinha que ser incluído.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="6d1f2-132">Se tivéssemos remover um campo de GridView - dizer `QuantityPerUnit` - ao atualizar os dados de controle de Web de dados não definiria o ObjectDataSource `QuantityPerUnit` `UpdateParameters` valor.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="6d1f2-133">ObjectDataSource, em seguida, transmita um valor de `Nothing` para o `UpdateProduct` método de camada de lógica de negócios (BLL), que alteraria o registro de banco de dados editados `QuantityPerUnit` coluna para um `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="6d1f2-134">Da mesma forma, se um campo obrigatório, como `ProductName`, é removido da interface de edição, a atualização falhará com um "*'ProductName' da coluna não permite nulls*" exceção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="6d1f2-135">O motivo para esse comportamento foi porque o ObjectDataSource foi configurado para chamar o `ProductsBLL` da classe `UpdateProduct` método, que espera um parâmetro de entrada para cada um dos campos de produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="6d1f2-136">Portanto, do ObjectDataSource `UpdateParameters` coleção continha um parâmetro para cada método de parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="6d1f2-137">Se você deseja fornecer um controle da Web que permite ao usuário final atualizar somente um subconjunto de campos de dados, precisamos programaticamente definir ausentes `UpdateParameters` valores do ObjectDataSource `Updating` manipulador de eventos ou criar e chamar um método BLL que espera apenas um subconjunto dos campos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="6d1f2-138">Vamos explorar essa última abordagem.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="6d1f2-139">Especificamente, vamos criar uma página que exibe apenas o `ProductName` e `UnitPrice` campos em um GridView editável.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="6d1f2-140">Interface de edição do GridView este só permitirá que o usuário atualizar os dois campos exibidos, `ProductName` e `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="6d1f2-141">Como essa interface edição fornece somente um subconjunto de campos de um produto, é necessário criar um ObjectDataSource que usa o BLL existente `UpdateProduct` método e os valores de campo ausente do produto definiu programaticamente no seu `Updating` evento manipulador de ou é necessário criar um novo método BLL que espera apenas o subconjunto de campos definidos em GridView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="6d1f2-142">Para este tutorial, vamos usar a última opção e criar uma sobrecarga de `UpdateProduct` método, que leva em apenas três parâmetros de entrada: `productName`, `unitPrice`, e `productID`:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="6d1f2-143">Como o original `UpdateProduct` essa sobrecarga de método, inicia para verificar se há um produto no banco de dados com especificado `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="6d1f2-144">Se não, ele retorna `False`, indicando que houve falha na solicitação para atualizar as informações de produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="6d1f2-145">Caso contrário, ele atualiza o registro de produto existente `ProductName` e `UnitPrice` campos adequadamente e confirma a atualização chamando o TableAdpater `Update()` método, passando o `ProductsRow` instância.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdpater's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="6d1f2-146">Com essa adição a nossas `ProductsBLL` classe, estamos prontos para criar a interface de GridView simplificada.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="6d1f2-147">Abra o `DataModificationEvents.aspx` no `EditInsertDelete` pasta e adicionar um controle GridView à página.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="6d1f2-148">Criar um novo ObjectDataSource e configurá-lo para usar o `ProductsBLL` classe com seu `Select()` mapeamento de método `GetProducts` e sua `Update()` mapeamento de método para o `UpdateProduct` sobrecarga que recebe apenas o `productName`, `unitPrice`, e `productID` parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="6d1f2-149">A Figura 2 mostra o assistente Criar fonte de dados ao mapear o ObjectDataSource `Update()` método para o `ProductsBLL` classe do novo `UpdateProduct` sobrecarga do método.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>


<span data-ttu-id="6d1f2-150">[![Mapear o método de Update () do ObjectDataSource para a sobrecarga de UpdateProduct novo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="6d1f2-151">**Figura 2**: mapear o ObjectDataSource `Update()` método para o novo `UpdateProduct` de sobrecarga ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>


<span data-ttu-id="6d1f2-152">Como o nosso exemplo inicialmente apenas precisará da capacidade para editar dados, mas não para inserir ou excluir registros, reserve um tempo para indicar explicitamente que o ObjectDataSource `Insert()` e `Delete()` métodos não devem ser mapeados para qualquer uma da `ProductsBLL` métodos da classe indo para as guias INSERT e DELETE e escolhendo (nenhum) na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>


<span data-ttu-id="6d1f2-153">[![Escolha (nenhum) na lista suspensa para a inserção e excluir guias](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="6d1f2-154">**Figura 3**: escolha (nenhum) da lista suspensa para a inserção e excluir guias ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>


<span data-ttu-id="6d1f2-155">Depois de concluir este assistente, marque a caixa de seleção Habilitar edição de marcas inteligentes do GridView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="6d1f2-156">Com a conclusão do assistente Criar fonte de dados e a associação que o GridView, o Visual Studio criou a sintaxe declarativa para ambos os controles.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="6d1f2-157">Vá para o modo de exibição de fonte para inspecionar declarativo do ObjectDataSource, que é mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="6d1f2-158">Como não há nenhum mapeamento para o ObjectDataSource `Insert()` e `Delete()` métodos, não há nenhum `InsertParameters` ou `DeleteParameters` seções.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="6d1f2-159">Além disso, desde o `Update()` método é mapeado para o `UpdateProduct` sobrecarga do método que só aceita três parâmetros de entrada, o `UpdateParameters` seção tem apenas três `Parameter` instâncias.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="6d1f2-160">Observe que o ObjectDataSource `OldValuesParameterFormatString` está definida como `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="6d1f2-161">Essa propriedade é definida automaticamente pelo Visual Studio ao usar o Assistente Configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="6d1f2-162">No entanto, desde que nossos métodos BLL não espera que o original `ProductID` valor a ser passado, remova essa atribuição de propriedade completamente sintaxe declarativa do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="6d1f2-163">Se você simplesmente limpar o `OldValuesParameterFormatString` valor da propriedade na janela de propriedades na exibição de Design, a propriedade ainda existirá na sintaxe declarativa, mas será definido como uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="6d1f2-164">Remova a propriedade completamente da sintaxe declarativa ou, na janela Propriedades, defina o valor como o padrão, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


<span data-ttu-id="6d1f2-165">Enquanto o ObjectDataSource só `UpdateParameters` para nome, preço e ID do produto, o Visual Studio adicionou um BoundField ou CheckBoxField em GridView para cada um dos campos do produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>


<span data-ttu-id="6d1f2-166">[![GridView contém um BoundField ou CheckBoxField para cada um dos campos do produto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="6d1f2-167">**Figura 4**: GridView contém um BoundField ou CheckBoxField para cada um dos campos do produto ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>


<span data-ttu-id="6d1f2-168">Quando o usuário final edita um produto e clica no botão de atualização, o GridView enumera os campos que não eram somente leitura.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="6d1f2-169">Ele define o valor do parâmetro correspondente no ObjectDataSource `UpdateParameters` coleção para o valor inserido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="6d1f2-170">Se não houver um parâmetro correspondente, GridView adiciona um à coleção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="6d1f2-171">Portanto, se o nosso GridView contém BoundFields e CheckBoxFields para todos os campos do produto, ObjectDataSource termina invocando o `UpdateProduct` sobrecarga que recebe todos esses parâmetros, apesar do fato de que o ObjectDataSource marcação declarativa especifica apenas três parâmetros de entrada (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="6d1f2-172">Da mesma forma, se houver alguma combinação de não somente leitura produto campos em GridView que não corresponde aos parâmetros de entrada para um `UpdateProduct` sobrecarga, será gerada uma exceção ao tentar atualizar.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>


<span data-ttu-id="6d1f2-173">[![O GridView será adicionar parâmetros a coleção de UpdateParameters do ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="6d1f2-174">**Figura 5**: O GridView será adicionar parâmetros o ObjectDataSource `UpdateParameters` coleção ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>


<span data-ttu-id="6d1f2-175">Para garantir que o ObjectDataSource invoca o `UpdateProduct` sobrecarga que usa apenas o produto nome, preço e ID, é preciso restringir GridView a ter campos editáveis para apenas o `ProductName` e `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="6d1f2-176">Isso pode ser feito com a remoção de BoundFields e CheckBoxFields, definindo os outros campos `ReadOnly` propriedade `True`, ou por uma combinação dos dois.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="6d1f2-177">Para este tutorial vamos simplesmente remova todos os campos de GridView, exceto o `ProductName` e `UnitPrice` BoundFields, após o qual declarativo do GridView será semelhante a:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="6d1f2-178">Embora o `UpdateProduct` sobrecarga espera três parâmetros de entrada, somente temos duas BoundFields em nosso GridView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="6d1f2-179">Isso ocorre porque o `productID` parâmetro de entrada é um valor de chave primária e passado por meio do valor da `DataKeyNames` propriedade da linha editada.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="6d1f2-180">Nosso GridView, juntamente com o `UpdateProduct` sobrecarga, permite que o usuário edite apenas o nome e o preço de um produto sem perder qualquer um dos campos do produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>


<span data-ttu-id="6d1f2-181">[![A Interface permite a edição apenas o produto nome e preços](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="6d1f2-182">**Figura 6**: O permite que a Interface edição apenas o produto nome e preço ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="6d1f2-183">Como discutido no tutorial anterior, é extremamente importante que o GridView s estado de exibição ser habilitado (o comportamento padrão).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="6d1f2-184">Se você definir o GridView s `EnableViewState` propriedade `false`, você corre o risco de ter acidentalmente excluir ou editar registros de usuários simultâneos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="6d1f2-185">Consulte [Aviso: problema de simultaneidade com ASP.NET 2.0 GridViews/DetailsView/FormViews que suporte a edição e/ou excluindo e cujo estado de exibição é desativado](http://scottonwriting.net/sowblog/posts/10054.aspx) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>


## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="6d1f2-186">Melhorando o`UnitPrice`formatação</span><span class="sxs-lookup"><span data-stu-id="6d1f2-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="6d1f2-187">Embora o exemplo de GridView mostrado na Figura 6 funciona, o `UnitPrice` campo não está formatado, resultando em uma exibição de preços que não tem qualquer moeda símbolos e tem quatro casas decimais.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="6d1f2-188">Para aplicar uma formatação para as linhas não editável de moeda, basta definir o `UnitPrice` do BoundField `DataFormatString` propriedade `{0:c}` e sua `HtmlEncode` propriedade `False`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>


<span data-ttu-id="6d1f2-189">[![Definir o UnitPrice DataFormatString e propriedades HtmlEncode adequadamente](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="6d1f2-190">**Figura 7**: definir o `UnitPrice`do `DataFormatString` e `HtmlEncode` propriedades adequadamente ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>


<span data-ttu-id="6d1f2-191">Com essa alteração, as linhas não editável formatar o preço como uma moeda; No entanto, a linha editada, ainda exibe o valor sem o símbolo de moeda e com quatro casas decimais.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>


<span data-ttu-id="6d1f2-192">[![As linhas não editável são agora formatados como valores de moeda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="6d1f2-193">**Figura 8**: as linhas não editável são agora são formatados como valores de moeda ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>


<span data-ttu-id="6d1f2-194">As instruções de formatação especificadas no `DataFormatString` propriedade pode ser aplicada para a interface de edição, definindo o BoundField `ApplyFormatInEditMode` propriedade `True` (o padrão é `False`).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="6d1f2-195">Reserve um tempo para definir essa propriedade como `True`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-195">Take a moment to set this property to `True`.</span></span>


<span data-ttu-id="6d1f2-196">[![Definir propriedade de ApplyFormatInEditMode de UnitPrice BoundField como True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="6d1f2-197">**Figura 9**: definir o `UnitPrice` do BoundField `ApplyFormatInEditMode` propriedade `True` ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>


<span data-ttu-id="6d1f2-198">Com essa alteração, o valor da `UnitPrice` exibido no editado linha também é formatada como uma moeda.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>


<span data-ttu-id="6d1f2-199">[![UnitPrice valor da linha editada é formatado agora como uma moeda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="6d1f2-200">**Figura 10**: O editado linha `UnitPrice` valor é formatado agora como uma moeda ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>


<span data-ttu-id="6d1f2-201">No entanto, atualizar um produto com o símbolo de moeda na caixa de texto, como $19.00 lança um `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="6d1f2-202">Quando tenta atribuir os valores fornecidos pelo usuário para o ObjectDataSource GridView `UpdateParameters` coleção não é possível converter o `UnitPrice` cadeia de caracteres "$19.00" para o `Decimal` exigido pelo parâmetro (consulte a Figura 11).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="6d1f2-203">Para corrigir isso podemos criar um manipulador de eventos do GridView `RowUpdating` eventos e colocá-lo a analisar o usuário forneceu `UnitPrice` como um formato de moeda `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="6d1f2-204">O GridView `RowUpdating` evento aceita como seu segundo parâmetro, um objeto do tipo [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), que inclui um `NewValues` dicionário como uma de suas propriedades que contém os valores fornecidos pelo usuário prontos para ser atribuído a ObjectDataSource `UpdateParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="6d1f2-205">Podemos pode substituir a existente `UnitPrice` valor o `NewValues` coleção com um valor decimal analisado usando o formato de moeda com as seguintes linhas de código no `RowUpdating` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="6d1f2-206">Se o usuário forneceu um `UnitPrice` valor (como "$19.00"), esse valor é substituído com o valor decimal calculado pelo [Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), ao analisar o valor como uma moeda.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="6d1f2-207">Isso irá analisar corretamente o decimal no caso de qualquer símbolos de moeda, vírgulas, pontos decimais e assim por diante e usa o [enumeração NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) no [System. Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="6d1f2-208">A Figura 11 mostra ambos o problema causado pelo símbolos de moeda em que o usuário forneceu `UnitPrice`, juntamente com como o GridView `RowUpdating` manipulador de eventos pode ser usado para analisar corretamente essa entrada.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>


<span data-ttu-id="6d1f2-209">[![UnitPrice valor da linha editada é formatado agora como uma moeda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="6d1f2-210">**Figura 11**: O editado linha `UnitPrice` valor é formatado agora como uma moeda ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>


## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="6d1f2-211">Etapa 2: proibindo`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="6d1f2-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="6d1f2-212">Enquanto o banco de dados está configurado para permitir `NULL` valores no `Products` da tabela `UnitPrice` coluna, podemos desejar impedir que os usuários visitar essa página específica da especificação de um `NULL` `UnitPrice` valor.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="6d1f2-213">Ou seja, se um usuário não insere uma `UnitPrice` valor ao editar uma linha de produto, em vez de salvar os resultados para o banco de dados que você deseja exibir uma mensagem informando ao usuário que, por meio desta página, todos os produtos editados devem ter um preço especificado.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="6d1f2-214">O `GridViewUpdateEventArgs` objeto passado para o GridView `RowUpdating` manipulador de eventos contém um `Cancel` propriedade que, se definido como `True`, encerra o processo de atualização.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="6d1f2-215">Vamos estender o `RowUpdating` manipulador de eventos para definir `e.Cancel` para `True` e exibirá uma mensagem explicando por que se o `UnitPrice` valor o `NewValues` coleção tem um valor de `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="6d1f2-216">Comece adicionando um controle da Web de rótulo para a página chamada `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="6d1f2-217">Este controle de rótulo será exibido se o usuário não especificar um `UnitPrice` valor ao atualizar um produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="6d1f2-218">Defina o rótulo `Text` propriedade como "Você deve fornecer um preço para o produto".</span><span class="sxs-lookup"><span data-stu-id="6d1f2-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="6d1f2-219">Também criei uma nova classe CSS em `Styles.css` chamado `Warning` com a seguinte definição:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>


[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="6d1f2-220">Finalmente, defina o rótulo `CssClass` propriedade `Warning`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="6d1f2-221">Neste ponto o Designer deve mostrar a mensagem de aviso em um vermelho, negrito, itálico, tamanho da fonte extra grande acima GridView, conforme mostrado na Figura 12.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>


<span data-ttu-id="6d1f2-222">[![Foi adicionado um rótulo acima GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="6d1f2-223">**Figura 12**: um rótulo tem sido adicionados acima a GridView ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>


<span data-ttu-id="6d1f2-224">Por padrão, este rótulo deve ficar oculto, portanto, definir seu `Visible` propriedade `False` no `Page_Load` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="6d1f2-225">Se o usuário tenta atualizar um produto sem especificar o `UnitPrice`, você deseja cancelar a atualização e exibir o rótulo de aviso.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="6d1f2-226">Aumentar o GridView `RowUpdating` manipulador de eventos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="6d1f2-227">Se um usuário tenta salvar um produto sem especificar um preço, a atualização será cancelada e será exibida uma mensagem útil.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="6d1f2-228">Enquanto o banco de dados (e a lógica de negócios) permite `NULL` `UnitPrice` s, essa página específica do ASP.NET não.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>


<span data-ttu-id="6d1f2-229">[![Um usuário não é possível deixar em branco de UnitPrice](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="6d1f2-230">**Figura 13**: um usuário não pode sair `UnitPrice` em branco ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>


<span data-ttu-id="6d1f2-231">Até agora, vimos como usar o GridView `RowUpdating` eventos programaticamente alterar os valores de parâmetro atribuídos a ObjectDataSource `UpdateParameters` coleção, bem como para cancelar a atualização processar completamente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="6d1f2-232">Esses conceitos são transferidas para os controles de DetailsView e FormView e também se aplicam a inserção e exclusão.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="6d1f2-233">Essas tarefas também podem ser feitas no nível de ObjectDataSource por meio de manipuladores de eventos para sua `Inserting`, `Updating`, e `Deleting` eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="6d1f2-234">Esses eventos acionam antes do método associado do objeto subjacente é chamado e fornecem uma oportunidade de última chance para modificar a coleção de parâmetros de entrada ou cancelar a operação imediatamente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="6d1f2-235">Manipuladores de eventos para esses três eventos são passados a um objeto do tipo [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) que tem duas propriedades de interesse:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="6d1f2-236">[Cancelar](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), que, se definido como `True`, cancela a operação que está sendo executada</span><span class="sxs-lookup"><span data-stu-id="6d1f2-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="6d1f2-237">[ParâmetrosDeEntrada](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), que é a coleção de `InsertParameters`, `UpdateParameters`, ou `DeleteParameters`, dependendo se o manipulador de eventos é para o `Inserting`, `Updating`, ou `Deleting` evento</span><span class="sxs-lookup"><span data-stu-id="6d1f2-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="6d1f2-238">Para ilustrar a trabalhar com os valores de parâmetro no nível de ObjectDataSource, vamos incluir um DetailsView em nossa página que permite que os usuários adicionar um novo produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="6d1f2-239">Este DetailsView será usado para fornecer uma interface para adicionar rapidamente um novo produto no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="6d1f2-240">Para manter uma interface de usuário consistente quando adicionar um novo produto vamos permitir que o usuário insira apenas valores para o `ProductName` e `UnitPrice` campos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="6d1f2-241">Por padrão, os valores que não são fornecidos na interface de inserção de DetailsView serão definidos um `NULL` valor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="6d1f2-242">No entanto, podemos usar o ObjectDataSource `Inserting` evento inserir valores padrão diferentes, como você verá em breve.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="6d1f2-243">Etapa 3: Fornecer uma Interface para adicionar novos produtos</span><span class="sxs-lookup"><span data-stu-id="6d1f2-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="6d1f2-244">Arraste um DetailsView da caixa de ferramentas para o Designer acima GridView, limpe seu `Height` e `Width` propriedades e vincular a ObjectDataSource já está presente na página.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="6d1f2-245">Isso adicionará um BoundField ou CheckBoxField para cada um dos campos do produto.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="6d1f2-246">Como queremos usar este DetailsView para adicionar novos produtos, é necessário marcar a opção Permitir inserção de marca inteligente; No entanto, há essa opção não porque o ObjectDataSource `Insert()` método não está mapeado para um método em de `ProductsBLL` classe (Lembre-se de que podemos definir esse mapeamento (nenhum) ao configurar a fonte de dados Consulte a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="6d1f2-247">Para configurar o ObjectDataSource, selecione o link de configurar fonte de dados de marca inteligente, iniciar o assistente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="6d1f2-248">A primeira tela permite que você altere o objeto subjacente que ObjectDataSource está associado a; Deixe-a configurada para `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="6d1f2-249">A próxima tela lista os mapeamentos entre os métodos do ObjectDataSource para o objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="6d1f2-250">Mesmo que explicitamente indicado que o `Insert()` e `Delete()` métodos não devem ser mapeados para todos os métodos, se você for para inserir e excluir guias você verá que um mapeamento está lá.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="6d1f2-251">Isso ocorre porque o `ProductsBLL`do `AddProduct` e `DeleteProduct` métodos usam o `DataObjectMethodAttribute` atributo para indicar que eles são os métodos padrão para `Insert()` e `Delete()`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="6d1f2-252">Portanto, o Assistente de ObjectDataSource seleciona essa cada vez que você executar o assistente, a menos que haja algum outro valor explicitamente especificado.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="6d1f2-253">Deixe o `Insert()` método apontando para o `AddProduct` método, mas novamente definido lista suspensa de exclusão da guia como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>


<span data-ttu-id="6d1f2-254">[![Defina lista suspensa lista a guia Inserir ao método AddProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="6d1f2-255">**Figura 14**: altere na lista suspensa da guia Inserir para o `AddProduct` método ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>


<span data-ttu-id="6d1f2-256">[![Definição suspensa lista da guia DELETE como (nenhum)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="6d1f2-257">**Figura 15**: definição suspensa lista da guia excluir como (nenhum) ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>


<span data-ttu-id="6d1f2-258">Depois de fazer essas alterações, a sintaxe declarativa do ObjectDataSource será expandida para incluir um `InsertParameters` coleção, conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="6d1f2-259">Executar novamente o assistente adicionado novamente a `OldValuesParameterFormatString` propriedade.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="6d1f2-260">Reserve um tempo para limpar esta propriedade definindo-a como o valor padrão (`{0}`) ou removê-lo totalmente da sintaxe declarativa.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="6d1f2-261">Com o ObjectDataSource fornecendo recursos de inserção, marca inteligente de DetailsView agora incluem a caixa de seleção Permitir inserção; Volte para o Designer e marque esta opção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="6d1f2-262">Em seguida, diminuir DetailsView para que ele tem apenas dois BoundFields - `ProductName` e `UnitPrice` - e o CommandField.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="6d1f2-263">Neste ponto, a sintaxe declarativa de DetailsView deve parecer com:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-263">At this point the DetailsView's declarative syntax should look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="6d1f2-264">A Figura 16 mostra essa página quando exibido neste momento por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="6d1f2-265">Como você pode ver, DetailsView lista o nome e o preço do produto (Chai) primeiro.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="6d1f2-266">No entanto, o que queremos, é uma interface de inserção que fornece um meio para o usuário adicionar rapidamente um novo produto no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>


<span data-ttu-id="6d1f2-267">[![O DetailsView é renderizada atualmente no modo somente leitura](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="6d1f2-268">**Figura 16**: O DetailsView é renderizada atualmente no modo somente leitura ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>


<span data-ttu-id="6d1f2-269">Para mostrar o DetailsView no modo de inserção, precisamos definir o `DefaultMode` propriedade `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="6d1f2-270">Isso renderiza DetailsView no modo de inserção quando visitado primeiro e mantém-lo depois de inserir um novo registro.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="6d1f2-271">Como mostra a Figura 17, tal um DetailsView fornece uma interface rápida para adicionar um novo registro.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>


<span data-ttu-id="6d1f2-272">[![O DetailsView fornece uma Interface para adicionar rapidamente um novo produto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="6d1f2-273">**Figura 17**: DetailsView fornece uma Interface para adicionar rapidamente um novo produto ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>


<span data-ttu-id="6d1f2-274">Quando o usuário insere um nome de produto e o preço (como "Água Acme" e 1.99, como na Figura 17) e clicar em Inserir, um postback tem lugar e inicia o fluxo de trabalho inserindo, culminando em um novo registro de produto que está sendo adicionado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="6d1f2-275">O DetailsView mantém sua interface de inserção e GridView é automaticamente vinculada outra vez para a fonte de dados para incluir o novo produto, conforme mostrado na Figura 18.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>


![O produto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="6d1f2-277">**Figura 18**: O produto "Água Acme" foi adicionado ao banco de dados</span><span class="sxs-lookup"><span data-stu-id="6d1f2-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>


<span data-ttu-id="6d1f2-278">Embora o GridView na Figura 18 não mostre, os campos de produto ausente na interface do DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`, e assim por diante são atribuídos `NULL` valores do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="6d1f2-279">Você pode ver isso executando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="6d1f2-280">Vá para o Gerenciador de servidores no Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6d1f2-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="6d1f2-281">Expandindo o `NORTHWND.MDF` nó banco de dados</span><span class="sxs-lookup"><span data-stu-id="6d1f2-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="6d1f2-282">Clique com botão direito no `Products` nó da tabela de banco de dados</span><span class="sxs-lookup"><span data-stu-id="6d1f2-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="6d1f2-283">Selecione Mostrar dados de tabela</span><span class="sxs-lookup"><span data-stu-id="6d1f2-283">Select Show Table Data</span></span>

<span data-ttu-id="6d1f2-284">Isso listará todos os registros no `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="6d1f2-285">Como a Figura 19 mostra, todas as colunas do nosso novo produto diferente de `ProductID`, `ProductName`, e `UnitPrice` ter `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>


<span data-ttu-id="6d1f2-286">[![O produto campos não fornecido em DetailsView são atribuídos valores nulos](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="6d1f2-287">**Figura 19**: O produto campos não fornecido em DetailsView recebem `NULL` valores ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>


<span data-ttu-id="6d1f2-288">Podemos desejar fornecer um valor padrão diferente de `NULL` para um ou mais dos seguintes valores de coluna, ou porque `NULL` não é a melhor opção padrão ou porque a coluna de banco de dados em si não permite `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="6d1f2-289">Para fazer isso, pode definir os valores dos parâmetros de DetailsView `InputParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="6d1f2-290">Essa atribuição pode ser feita ou no evento manipulador para o DetailsView `ItemInserting` evento ou o ObjectDataSource `Inserting` eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="6d1f2-291">Como já encontramos no usando os eventos de pré e pós-níveis os dados da Web controlar o nível, vamos explorar usando eventos do ObjectDataSource neste momento.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="6d1f2-292">Etapa 4: Atribuir valores para o`CategoryID`e`SupplierID`parâmetros</span><span class="sxs-lookup"><span data-stu-id="6d1f2-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="6d1f2-293">Para este tutorial vamos imaginar que nosso aplicativo ao adicionar um novo produto por meio dessa interface deve ser atribuído um `CategoryID` e `SupplierID` valor de 1.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="6d1f2-294">Como mencionado anteriormente, o ObjectDataSource tem um par de pré e pós-níveis de eventos que disparem durante o processo de modificação de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="6d1f2-295">Quando seu `Insert()` método é invocado, ObjectDataSource primeiro dispara seu `Inserting` evento, em seguida, chama o método que seu `Insert()` método foi mapeado para e, finalmente, gera o `Inserted` evento.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="6d1f2-296">O `Inserting` manipulador de eventos nos dá uma última oportunidade de ajustar os parâmetros de entrada ou cancelar a operação imediatamente.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="6d1f2-297">Em um aplicativo do mundo real provavelmente seria recomendável para permitir que o usuário especificar o fornecedor e a categoria ou escolheria esse valor para eles com base em alguns critérios ou business lógica (em vez de cegamente selecionando uma ID de 1).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="6d1f2-298">Independentemente, o exemplo ilustra como definir programaticamente o valor de um parâmetro de entrada de evento de pré-nível do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>


<span data-ttu-id="6d1f2-299">Reserve um tempo para criar um manipulador de eventos para o ObjectDataSource `Inserting` eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="6d1f2-300">Observe que o segundo parâmetro de entrada do manipulador de eventos é um objeto do tipo `ObjectDataSourceMethodEventArgs`, que tem uma propriedade para acessar a coleção de parâmetros (`InputParameters`) e uma propriedade para cancelar a operação (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="6d1f2-301">Neste ponto, o `InputParameters` propriedade contém o ObjectDataSource `InsertParameters` coleção com os valores atribuídos de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="6d1f2-302">Para alterar o valor de um desses parâmetros, basta usar: `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="6d1f2-303">Portanto, para definir o `CategoryID` e `SupplierID` para valores de 1, ajustar o `Inserting` manipulador de eventos para se parecer com o seguinte:</span><span class="sxs-lookup"><span data-stu-id="6d1f2-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="6d1f2-304">Esse tempo ao adicionar um novo produto (como Soda Acme), o `CategoryID` e `SupplierID` colunas do novo produto são definidas como 1 (consulte a Figura 20).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>


<span data-ttu-id="6d1f2-305">[![Novos produtos agora tem CategoryID e SupplierID valores definidos como 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="6d1f2-306">**Figura 20**: novos produtos agora têm seus `CategoryID` e `SupplierID` valores definidos como 1 ([clique para exibir a imagem em tamanho normal](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="6d1f2-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="6d1f2-307">Resumo</span><span class="sxs-lookup"><span data-stu-id="6d1f2-307">Summary</span></span>

<span data-ttu-id="6d1f2-308">Durante a edição, inserção e exclusão de processo, o controle de dados Web e ObjectDataSource continuar por meio de um número de eventos de pré e pós-níveis.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="6d1f2-309">Neste tutorial examinou os eventos de níveis previamente e viu como usá-los para personalizar os parâmetros de entrada ou cancelar a operação de modificação de dados completamente ambos a partir do controle da Web de dados e eventos do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="6d1f2-310">O seguinte tutorial, examinaremos a criando e usando manipuladores de eventos para os eventos pós-níveis.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="6d1f2-311">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="6d1f2-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6d1f2-312">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="6d1f2-312">About the Author</span></span>

<span data-ttu-id="6d1f2-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla. com](http://www.4guysfromrolla.com), trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6d1f2-314">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6d1f2-315">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 2.0 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6d1f2-316">Ele pode ser contatado em [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6d1f2-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6d1f2-317">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="6d1f2-317">Special Thanks To</span></span>

<span data-ttu-id="6d1f2-318">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6d1f2-319">Revisores levar para este tutorial foram Jackie Goor e Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="6d1f2-319">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="6d1f2-320">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="6d1f2-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6d1f2-321">Nesse caso, me enviar uma linha no [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="6d1f2-322">[Anterior](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Próximo](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6d1f2-322">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>
